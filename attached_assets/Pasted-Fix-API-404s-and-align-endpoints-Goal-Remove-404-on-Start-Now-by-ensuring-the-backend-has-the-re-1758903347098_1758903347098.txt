Fix API 404s and align endpoints

Goal: Remove 404 on “Start Now” by ensuring the backend has the required routes, and align frontend calls.

Do (server):

Open server/routes/workouts.ts (or the file where workout routes live). Add/confirm:

// GET a suggestion for the current user (creates it if missing)
router.get('/api/workouts/suggest', requireAuth, async (req, res) => {
  // find or create today’s suggestion for req.user.id
  // return { id, title, focus, rationale, ... }
});

// Optional rotate endpoint (or support ?rotate=1 on GET)
router.post('/api/workouts/suggest/rotate', requireAuth, async (req, res) => {
  // create a new suggestion with a different focus
  // return the new suggestion payload
});

// Start a suggested workout
router.post('/api/workouts/:id/start', requireAuth, async (req, res) => {
  const { id } = req.params;
  // validate workout exists and belongs to user
  // mark started_at = now (or create a session row)
  // return 200 with { id } or 204
});

// Generate from wizard
router.post('/api/workouts/generate', requireAuth, async (req, res) => {
  // payload: { focus, duration, intensity, seed? }
  // persist workout, return { id }
});

// Detail
router.get('/api/workouts/:id', requireAuth, async (req, res) => {
  // return full workout by ID
});


Ensure these route files are mounted in server/index.ts:

app.use(express.json());
app.use(workoutsRouter);


CORS: Confirm Vercel/preview origins are allowed (already handled, just re-check).

Do (client):

In client/src/features/workouts/api.ts (or similar) export:

export async function getDailySuggestion() { /* GET /api/workouts/suggest */ }
export async function rotateSuggestion() { /* POST /api/workouts/suggest/rotate */ }
export async function startWorkout(id: string) { /* POST /api/workouts/:id/start */ }
export async function generateWorkout(cfg: GeneratePayload) { /* POST /api/workouts/generate */ }
export async function getWorkout(id: string) { /* GET /api/workouts/:id */ }


Ensure the “Start Now” button calls startWorkout(suggestion.id) and then navigate('/workout/'+id).

Acceptance:

curl -i $API_BASE/api/workouts/suggest returns JSON with an id.

curl -i -X POST $API_BASE/api/workouts/<id>/start returns 200/204.

UI no longer logs Failed to start workout: 404.