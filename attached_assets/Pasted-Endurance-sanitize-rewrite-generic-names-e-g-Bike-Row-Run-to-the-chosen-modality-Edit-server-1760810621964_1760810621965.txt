Endurance sanitize: rewrite generic names (e.g., “Bike/Row/Run”) to the chosen modality

Edit server/ai/generators/premium.ts: inside sanitizeWorkout() (after blocks are assembled), add this small fixer:

function rewriteEnduranceGenericNames(workout:any){
  const style = (workout.meta?.style || workout.style || '').toLowerCase();
  if (style !== 'endurance' && style !== 'aerobic') return;

  const sets = workout.sets || [];
  let currentHeader = null;
  let chosenHeaderMod: string | null = null;

  for (const s of sets){
    if (s.is_header){
      currentHeader = s;
      // infer chosen modality from the header text
      const t = String(s.title || s.exercise || '').toLowerCase();
      if (/row/.test(t)) chosenHeaderMod = 'Row';
      else if (/bike/.test(t)) chosenHeaderMod = 'Bike';
      else if (/\brun\b/.test(t)) chosenHeaderMod = 'Run';
      else if (/ski/.test(t)) chosenHeaderMod = 'Ski Erg';
      else if (/jump rope/.test(t)) chosenHeaderMod = 'Jump Rope';
      else chosenHeaderMod = null;
      continue;
    }
    // only touch items under an endurance main header
    if (currentHeader && /steady|cruise|vo2|intervals|endurance|aerobic/i.test(currentHeader.title || currentHeader.exercise || '')){
      const name = String(s.exercise || s.name || '').toLowerCase();
      if (/bike\/row\/run/.test(name) || /cyclical/i.test(name) || /modality/i.test(name)){
        if (chosenHeaderMod){
          s.exercise = chosenHeaderMod;
          // optional: hint a registry id string for clarity; harmless if unknown
          if (chosenHeaderMod === 'Row') s.registry_id = 'row';
          if (chosenHeaderMod === 'Bike') s.registry_id = 'bike';
          if (chosenHeaderMod === 'Run') s.registry_id = 'run';
          if (chosenHeaderMod === 'Ski Erg') s.registry_id = 'ski';
          if (chosenHeaderMod === 'Jump Rope') s.registry_id = 'jump_rope';
        }
      }
    }
  }
}


…and call it inside sanitizeWorkout() near the other cleanup steps:

if (workout.meta?.style === 'endurance' || workout.meta?.style === 'aerobic') {
  rewriteEnduranceGenericNames(workout);
}
