Add Endurance pack builder (duration-aware) + extend builder index

Goal: Build only cyclical blocks; never inject KB/BB lifts; map intensity → zones/interval structure.

Action: Edit server/ai/config/patternPackBuilders.ts (or create if missing) and add/endurance builder + export

// server/ai/config/patternPackBuilders.ts
import type { PatternPack } from './patternPackBuilders'; // if split; else co-locate types

export function buildEndurancePack(totalMin: number, requestedIntensity = 6): PatternPack {
  const warmup = totalMin >= 40 ? 8 : totalMin >= 30 ? 6 : 5;
  const cooldown = totalMin >= 40 ? 6 : totalMin >= 30 ? 4 : 3;
  const budget = Math.max(10, totalMin - warmup - cooldown);

  // Translate 1–10 to zones/structure:
  // 4–5 → steady Z2/Z3, 6–7 → tempo / cruise intervals, 8+ → VO2 short repeats.
  const i = Math.max(1, Math.min(10, requestedIntensity));
  const isSteady = i <= 5;
  const isTempo = i >= 6 && i <= 7;
  const isVO2   = i >= 8;

  const mainBlocks = [];

  if (isSteady) {
    // One steady block
    mainBlocks.push({
      pattern: "Steady",
      minutes: budget,
      select: [
        // pick 1 cyclical modality matched to equipment; movementService will filter
        { categories: ["endurance","aerobic"], patterns: ["cyclical","cardio","run","row","bike","erg","ski","swim","jump_rope"], items: 1 }
      ],
      title: "Steady Z2–Z3",
    });
  } else if (isTempo) {
    // Cruise intervals e.g., 3 x 6' @ Z3/4 with 2' easy
    mainBlocks.push({
      pattern: "CRUISE",
      minutes: budget,
      select: [
        { categories: ["endurance","aerobic"], patterns: ["cyclical","cardio","run","row","bike","erg","ski","swim"], items: 1 }
      ],
      title: "Cruise Intervals Z3–Z4",
    });
  } else if (isVO2) {
    // VO2 repeats e.g., 10 x 1' hard / 1' easy
    mainBlocks.push({
      pattern: "VO2",
      minutes: budget,
      select: [
        { categories: ["endurance","aerobic"], patterns: ["cyclical","cardio","run","row","bike","erg","ski"], items: 1 }
      ],
      title: "VO2 Repeats Z4–Z5",
    });
  }

  return {
    name: "Endurance",
    warmupMin: warmup,
    cooldownMin: cooldown,
    hardnessFloor: 0.80,
    mainBlocks,
  };
}


Note: We’re intentionally not including any strength/ballistic patterns. Selection lists only cyclical/cardio.

Action: Update premium generator to use this builder when style=endurance

// server/ai/generators/premium.ts
import { buildEndurancePack } from '../config/patternPackBuilders';

// where pack is resolved from style:
if (style === 'endurance') {
  pack = buildEndurancePack(request.duration_min || 45, request.intensity || 6);
}
