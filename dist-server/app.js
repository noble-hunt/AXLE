import { createRequire as topLevelCreateRequire } from 'module';
const require = topLevelCreateRequire(import.meta.url);
import { fileURLToPath as topLevelFileURLToPath } from 'url';
import { dirname as topLevelDirname } from 'path';
const __filename = topLevelFileURLToPath(import.meta.url);
const __dirname = topLevelDirname(__filename);
var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __require = /* @__PURE__ */ ((x) => typeof require !== "undefined" ? require : typeof Proxy !== "undefined" ? new Proxy(x, {
  get: (a2, b) => (typeof require !== "undefined" ? require : a2)[b]
}) : x)(function(x) {
  if (typeof require !== "undefined") return require.apply(this, arguments);
  throw Error('Dynamic require of "' + x + '" is not supported');
});
var __esm = (fn, res) => function __init() {
  return fn && (res = (0, fn[__getOwnPropNames(fn)[0]])(fn = 0)), res;
};
var __commonJS = (cb, mod) => function __require2() {
  return mod || (0, cb[__getOwnPropNames(cb)[0]])((mod = { exports: {} }).exports, mod), mod.exports;
};
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc7) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc7 = __getOwnPropDesc(from, key)) || desc7.enumerable });
  }
  return to;
};
var __toESM = (mod, isNodeMode, target) => (target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(
  // If the importer is in node compatibility mode or this is not an ESM
  // file that has been converted to a CommonJS file using a Babel-
  // compatible transform (i.e. "__esModule" has not been set), then set
  // "default" to the CommonJS "module.exports" for node compatibility.
  isNodeMode || !mod || !mod.__esModule ? __defProp(target, "default", { value: mod, enumerable: true }) : target,
  mod
));

// server/config/env.ts
import * as dotenv from "dotenv";
var mask, asBool, NODE_ENV, DEV, OPENAI_API_KEY, AZURE_OPENAI_API_KEY, HAS_OPENAI_KEY, FORCE_PREMIUM, DISABLE_SIMPLE, DISABLE_MOCK, PREMIUM_NOTES_MODE_LOCAL, PREMIUM_STRICT, ENV_DEBUG;
var init_env = __esm({
  "server/config/env.ts"() {
    "use strict";
    dotenv.config();
    mask = (v) => v ? `${v.slice(0, 6)}\u2026${v.slice(-4)}` : null;
    asBool = (v) => v === "1" || v === "true";
    NODE_ENV = process.env.NODE_ENV || "development";
    DEV = NODE_ENV !== "production";
    OPENAI_API_KEY = process.env.OPENAI_API_KEY || "";
    AZURE_OPENAI_API_KEY = process.env.AZURE_OPENAI_API_KEY || "";
    HAS_OPENAI_KEY = Boolean(OPENAI_API_KEY || AZURE_OPENAI_API_KEY);
    FORCE_PREMIUM = asBool(process.env.HOBH_FORCE_PREMIUM);
    DISABLE_SIMPLE = asBool(process.env.AXLE_DISABLE_SIMPLE);
    DISABLE_MOCK = asBool(process.env.AXLE_DISABLE_MOCK);
    if (DEV) {
      if (!FORCE_PREMIUM) FORCE_PREMIUM = true;
      if (!DISABLE_SIMPLE) DISABLE_SIMPLE = true;
      if (!DISABLE_MOCK) DISABLE_MOCK = true;
    }
    PREMIUM_NOTES_MODE_LOCAL = process.env.HOBH_PREMIUM_NOTES_MODE === "local";
    PREMIUM_STRICT = process.env.HOBH_PREMIUM_STRICT === "1" || process.env.HOBH_PREMIUM_STRICT === "true";
    ENV_DEBUG = {
      NODE_ENV,
      DEV,
      HAS_OPENAI_KEY,
      OPENAI_KEY_SAMPLE: mask(OPENAI_API_KEY || AZURE_OPENAI_API_KEY || ""),
      AXLE_DISABLE_SIMPLE: DISABLE_SIMPLE,
      AXLE_DISABLE_MOCK: DISABLE_MOCK,
      HOBH_FORCE_PREMIUM: FORCE_PREMIUM,
      HOBH_PREMIUM_NOTES_MODE: process.env.HOBH_PREMIUM_NOTES_MODE || null,
      HOBH_PREMIUM_STRICT: PREMIUM_STRICT
    };
  }
});

// node_modules/drizzle-zod/index.mjs
import { getTableColumns as e, is as t } from "drizzle-orm";
import { MySqlVarChar as n, MySqlVarBinary as r, MySqlChar as o } from "drizzle-orm/mysql-core";
import { PgUUID as i, PgChar as a, PgVarchar as l } from "drizzle-orm/pg-core";
import { SQLiteText as s } from "drizzle-orm/sqlite-core";
import { z as u } from "zod";
function c(t2, n2) {
  const r4 = e(t2), o2 = Object.entries(r4);
  let i2 = Object.fromEntries(o2.map((([e2, t3]) => [e2, p(t3)])));
  n2 && (i2 = Object.assign(i2, Object.fromEntries(Object.entries(n2).map((([e2, t3]) => [e2, "function" == typeof t3 ? t3(i2) : t3])))));
  for (const [e2, t3] of o2) t3.notNull ? t3.hasDefault && (i2[e2] = i2[e2].optional()) : i2[e2] = i2[e2].nullable().optional();
  return u.object(i2);
}
function p(e2) {
  let m2;
  if ((function(e3) {
    return "enumValues" in e3 && Array.isArray(e3.enumValues) && e3.enumValues.length > 0;
  })(e2) && (m2 = e2.enumValues.length ? u.enum(e2.enumValues) : u.string()), !m2) {
    if (t(e2, i)) m2 = u.string().uuid();
    else if ("custom" === e2.dataType) m2 = u.any();
    else if ("json" === e2.dataType) m2 = f;
    else if ("array" === e2.dataType) m2 = u.array(p(e2.baseColumn));
    else if ("number" === e2.dataType) m2 = u.number();
    else if ("bigint" === e2.dataType) m2 = u.bigint();
    else if ("boolean" === e2.dataType) m2 = u.boolean();
    else if ("date" === e2.dataType) m2 = u.date();
    else if ("string" === e2.dataType) {
      let i2 = u.string();
      (t(e2, a) || t(e2, l) || t(e2, n) || t(e2, r) || t(e2, o) || t(e2, s)) && "number" == typeof e2.length && (i2 = i2.max(e2.length)), m2 = i2;
    }
  }
  return m2 || (m2 = u.any()), m2;
}
var m, f;
var init_drizzle_zod = __esm({
  "node_modules/drizzle-zod/index.mjs"() {
    m = u.union([u.string(), u.number(), u.boolean(), u.null()]);
    f = u.lazy((() => u.union([m, u.array(f), u.record(f)])));
  }
});

// shared/schema.ts
var schema_exports = {};
__export(schema_exports, {
  Category: () => Category,
  achievements: () => achievements,
  axleReports: () => axleReports,
  deviceTokens: () => deviceTokens,
  generatedWorkoutSchema: () => generatedWorkoutSchema,
  groupAchievements: () => groupAchievements,
  groupEventRsvps: () => groupEventRsvps,
  groupInvites: () => groupInvites,
  groupMembers: () => groupMembers,
  groupMessages: () => groupMessages,
  groupPosts: () => groupPosts,
  groupReactions: () => groupReactions,
  groups: () => groups,
  healthReports: () => healthReports,
  insertAchievementSchema: () => insertAchievementSchema,
  insertAxleReportSchema: () => insertAxleReportSchema,
  insertDeviceTokenSchema: () => insertDeviceTokenSchema,
  insertGroupAchievementSchema: () => insertGroupAchievementSchema,
  insertGroupEventRsvpSchema: () => insertGroupEventRsvpSchema,
  insertGroupInviteSchema: () => insertGroupInviteSchema,
  insertGroupMemberSchema: () => insertGroupMemberSchema,
  insertGroupPostSchema: () => insertGroupPostSchema,
  insertGroupReactionSchema: () => insertGroupReactionSchema,
  insertGroupSchema: () => insertGroupSchema,
  insertHealthReportSchema: () => insertHealthReportSchema,
  insertNotificationPrefsSchema: () => insertNotificationPrefsSchema,
  insertNotificationSchema: () => insertNotificationSchema,
  insertNotificationTopicSchema: () => insertNotificationTopicSchema,
  insertPRSchema: () => insertPRSchema,
  insertPostSchema: () => insertPostSchema,
  insertProfileSchema: () => insertProfileSchema,
  insertPushSubscriptionSchema: () => insertPushSubscriptionSchema,
  insertReferralSchema: () => insertReferralSchema,
  insertSuggestedWorkoutSchema: () => insertSuggestedWorkoutSchema,
  insertWearableConnectionSchema: () => insertWearableConnectionSchema,
  insertWearableTokenSchema: () => insertWearableTokenSchema,
  insertWorkoutEventSchema: () => insertWorkoutEventSchema,
  insertWorkoutFeedbackSchema: () => insertWorkoutFeedbackSchema,
  insertWorkoutSchema: () => insertWorkoutSchema,
  insertWorkoutsHistorySchema: () => insertWorkoutsHistorySchema,
  legacyWorkoutFeedbackSchema: () => legacyWorkoutFeedbackSchema,
  notificationPrefs: () => notificationPrefs,
  notificationTopics: () => notificationTopics,
  notifications: () => notifications,
  personalRecords: () => personalRecords,
  postKindEnum: () => postKindEnum,
  posts: () => posts,
  profiles: () => profiles,
  prs: () => prs,
  pushSubscriptions: () => pushSubscriptions,
  referrals: () => referrals,
  reportCadenceEnum: () => reportCadenceEnum,
  reportFrequencyEnum: () => reportFrequencyEnum,
  reportInsightsSchema: () => reportInsightsSchema,
  reportMetricsSchema: () => reportMetricsSchema,
  reportPreferencesSchema: () => reportPreferencesSchema,
  reportStatusEnum: () => reportStatusEnum,
  suggestedWorkouts: () => suggestedWorkouts,
  users: () => users,
  wearableConnections: () => wearableConnections,
  wearableTokens: () => wearableTokens,
  workoutEvents: () => workoutEvents,
  workoutFeedback: () => workoutFeedback,
  workoutRequestSchema: () => workoutRequestSchema,
  workoutSetSchema: () => workoutSetSchema,
  workouts: () => workouts,
  workoutsHistory: () => workoutsHistory
});
import { sql } from "drizzle-orm";
import { pgTable, text, uuid, integer, timestamp, jsonb, boolean, numeric, smallint, date, uniqueIndex, pgEnum, real, time, check, index } from "drizzle-orm/pg-core";
import { z as z2 } from "zod";
var reportFrequencyEnum, reportCadenceEnum, reportStatusEnum, profiles, workouts, workoutFeedback, prs, achievements, axleReports, postKindEnum, groups, groupMembers, posts, groupPosts, groupMessages, groupReactions, groupEventRsvps, groupInvites, referrals, groupAchievements, wearableConnections, wearableTokens, healthReports, deviceTokens, notificationPrefs, notificationTopics, pushSubscriptions, notifications, suggestedWorkouts, workoutEvents, workoutsHistory, insertProfileSchema, insertWorkoutSchema, insertPRSchema, insertAchievementSchema, insertWearableConnectionSchema, insertWearableTokenSchema, insertHealthReportSchema, insertSuggestedWorkoutSchema, insertWorkoutEventSchema, insertWorkoutFeedbackSchema, insertWorkoutsHistorySchema, insertDeviceTokenSchema, insertNotificationPrefsSchema, insertNotificationTopicSchema, insertPushSubscriptionSchema, insertNotificationSchema, Category, workoutRequestSchema, workoutSetSchema, generatedWorkoutSchema, legacyWorkoutFeedbackSchema, insertGroupSchema, insertGroupMemberSchema, insertPostSchema, insertGroupPostSchema, insertGroupReactionSchema, insertGroupEventRsvpSchema, insertGroupInviteSchema, insertReferralSchema, insertGroupAchievementSchema, reportMetricsSchema, reportInsightsSchema, reportPreferencesSchema, insertAxleReportSchema, users, personalRecords;
var init_schema = __esm({
  "shared/schema.ts"() {
    "use strict";
    init_drizzle_zod();
    reportFrequencyEnum = pgEnum("report_frequency", ["none", "weekly", "monthly", "both"]);
    reportCadenceEnum = pgEnum("report_cadence", ["weekly", "monthly"]);
    reportStatusEnum = pgEnum("report_status", ["generating", "ready", "delivered", "failed"]);
    profiles = pgTable("profiles", {
      userId: uuid("user_id").primaryKey(),
      // References auth.users(id) in Supabase
      username: text("username"),
      firstName: text("first_name"),
      lastName: text("last_name"),
      avatarUrl: text("avatar_url"),
      dateOfBirth: date("date_of_birth"),
      preferredUnit: text("preferred_unit").notNull().default("lbs"),
      // User's preferred weight unit (lbs or kg)
      favoriteMovements: text("favorite_movements").array().notNull().default(sql`'{}'`),
      // Array of favorite movement names
      providers: text("providers").array().notNull().default(sql`'{}'`),
      // Array of linked identity providers
      // Location data for environment service integration
      latitude: real("latitude"),
      longitude: real("longitude"),
      timezone: text("timezone"),
      // AXLE Reports preferences
      reportFrequency: reportFrequencyEnum("report_frequency").notNull().default("weekly"),
      // Report delivery frequency
      reportWeeklyDay: integer("report_weekly_day"),
      // Day of week (0-6) for weekly reports (0=Sunday, 1=Monday, etc.)
      reportMonthlyDay: integer("report_monthly_day"),
      // Day of month (1-31) for monthly reports
      reportDeliveryTime: time("report_delivery_time").default("09:00:00"),
      // Time of day for report delivery (HH:MM:SS)
      enableNotifications: boolean("enable_notifications").notNull().default(true),
      // Enable in-app notifications for reports
      enableEmail: boolean("enable_email").notNull().default(false),
      // Enable email delivery for reports
      createdAt: timestamp("created_at").defaultNow()
    });
    workouts = pgTable("workouts", {
      id: uuid("id").primaryKey().default(sql`gen_random_uuid()`),
      userId: uuid("user_id").notNull(),
      // References auth.users(id) in Supabase
      createdAt: timestamp("created_at").defaultNow(),
      startedAt: timestamp("started_at"),
      // When the workout was started (for active workout tracking)
      request: jsonb("request").notNull(),
      title: text("title").notNull(),
      notes: text("notes"),
      sets: jsonb("sets").notNull(),
      completed: boolean("completed").default(false),
      feedback: jsonb("feedback"),
      seed: text("seed"),
      // Legacy seed for deterministic workout generation
      // Deterministic generation fields
      genSeed: jsonb("gen_seed").notNull().default(sql`'{}'`),
      // Comprehensive seed object
      generatorVersion: text("generator_version").notNull().default("v0.3.0"),
      // Generator version
      generationId: text("generation_id"),
      // For telemetry tracking
      // AI-generated workout fields
      rationale: text("rationale"),
      // AI rationale for the workout design
      criticScore: integer("critic_score"),
      // 0-100 critic score
      criticIssues: text("critic_issues").array(),
      // Array of identified issues
      rawWorkoutJson: jsonb("raw_workout_json"),
      // Full AI-generated workout JSON for debugging
      // User score tracking
      userScore: jsonb("user_score")
      // { value: string, type: 'time'|'weight'|'rounds'|'reps', blockKey: string }
    });
    workoutFeedback = pgTable("workout_feedback", {
      id: uuid("id").primaryKey().default(sql`gen_random_uuid()`),
      workoutId: uuid("workout_id").notNull(),
      // FK to workouts(id)
      userId: uuid("user_id").notNull(),
      // FK to auth.users(id) in Supabase
      perceivedIntensity: smallint("perceived_intensity").notNull(),
      // 1-10 RPE scale
      notes: text("notes"),
      createdAt: timestamp("created_at").defaultNow()
    }, (table) => ({
      // Unique constraint - one feedback per user per workout
      uniqueUserWorkout: uniqueIndex("workout_feedback_user_workout_unique").on(table.userId, table.workoutId)
    }));
    prs = pgTable("prs", {
      id: uuid("id").primaryKey().default(sql`gen_random_uuid()`),
      userId: uuid("user_id").notNull(),
      // References auth.users(id) in Supabase
      category: text("category").notNull(),
      movement: text("movement").notNull(),
      // Flexible PR value system
      value: numeric("value").notNull(),
      // The PR value (weight, time, distance, reps, etc.)
      unit: text("unit").notNull(),
      // Unit: lbs, kg, seconds, meters, reps, calories, etc.
      // Legacy fields (optional for backward compatibility)
      repMax: smallint("rep_max"),
      // Optional: 1,3,5,10 for strength PRs
      weightKg: numeric("weight_kg"),
      // Optional: weight in kg for backward compatibility
      // Metadata
      notes: text("notes"),
      workoutId: uuid("workout_id"),
      // Optional: link to workout where PR was achieved
      date: date("date").notNull().default(sql`current_date`),
      createdAt: timestamp("created_at").defaultNow().notNull()
      // For historical tracking
    });
    achievements = pgTable("achievements", {
      id: uuid("id").primaryKey().default(sql`gen_random_uuid()`),
      userId: uuid("user_id").notNull(),
      // References auth.users(id) in Supabase
      name: text("name").notNull(),
      description: text("description").notNull(),
      progress: numeric("progress").notNull().default(sql`0`),
      unlocked: boolean("unlocked").notNull().default(false),
      updatedAt: timestamp("updated_at").defaultNow()
    });
    axleReports = pgTable("axle_reports", {
      id: uuid("id").primaryKey().default(sql`gen_random_uuid()`),
      userId: uuid("user_id").notNull(),
      // References auth.users(id) in Supabase
      frequency: reportCadenceEnum("frequency").notNull(),
      // 'weekly' | 'monthly'
      timeframeStart: timestamp("timeframe_start", { withTimezone: true }).notNull(),
      // UTC timestamp
      timeframeEnd: timestamp("timeframe_end", { withTimezone: true }).notNull(),
      // UTC timestamp
      status: reportStatusEnum("status").notNull().default("generating"),
      generatorVersion: text("generator_version").notNull().default("v1.0.0"),
      // Report data stored as JSONB for flexibility
      metrics: jsonb("metrics").notNull(),
      // Workout stats, PR stats, health stats, trends
      insights: jsonb("insights").notNull(),
      // Headlines, highlights, recommendations, fun facts
      viewedAt: timestamp("viewed_at"),
      // When user first opened the report
      deliveredAt: timestamp("delivered_at"),
      // When report was delivered (email/push)
      deliveryChannel: text("delivery_channel").array().default(sql`'{}'`),
      // ['email', 'push', 'in-app']
      createdAt: timestamp("created_at").defaultNow()
    }, (table) => ({
      // Prevent duplicate reports for same period
      uniqueUserPeriod: uniqueIndex("axle_reports_user_period_unique").on(table.userId, table.frequency, table.timeframeStart),
      // Index for efficient queries
      userTimeframeIdx: index("axle_reports_user_timeframe_idx").on(table.userId, table.timeframeStart),
      // Ensure valid timeframes
      timeframeOrderCheck: check("timeframe_order_check", sql`${table.timeframeEnd} > ${table.timeframeStart}`)
    }));
    postKindEnum = pgEnum("post_kind", ["text", "workout", "pr", "event"]);
    groups = pgTable("groups", {
      id: uuid("id").primaryKey().default(sql`gen_random_uuid()`),
      name: text("name").notNull(),
      description: text("description"),
      photoUrl: text("photo_url"),
      isPublic: boolean("is_public").notNull().default(false),
      ownerId: uuid("owner_id").notNull(),
      createdAt: timestamp("created_at").defaultNow()
    });
    groupMembers = pgTable("group_members", {
      groupId: uuid("group_id").notNull(),
      userId: uuid("user_id").notNull(),
      role: text("role").notNull().default("member"),
      // owner|admin|member
      joinedAt: timestamp("joined_at").defaultNow()
    }, (table) => ({
      pk: { primaryKey: [table.groupId, table.userId] }
    }));
    posts = pgTable("posts", {
      id: uuid("id").primaryKey().default(sql`gen_random_uuid()`),
      userId: uuid("user_id").notNull(),
      kind: postKindEnum("kind").notNull(),
      content: jsonb("content").notNull(),
      createdAt: timestamp("created_at").defaultNow()
    });
    groupPosts = pgTable("group_posts", {
      groupId: uuid("group_id").notNull(),
      postId: uuid("post_id").notNull(),
      createdAt: timestamp("created_at").defaultNow()
    }, (table) => ({
      pk: { primaryKey: [table.groupId, table.postId] }
    }));
    groupMessages = pgTable("group_messages", {
      id: uuid("id").primaryKey().default(sql`gen_random_uuid()`),
      groupId: uuid("group_id").notNull(),
      authorId: uuid("author_id").notNull(),
      body: text("body").notNull(),
      meta: jsonb("meta"),
      createdAt: timestamp("created_at").defaultNow()
    });
    groupReactions = pgTable("group_reactions", {
      groupId: uuid("group_id").notNull(),
      postId: uuid("post_id").notNull(),
      userId: uuid("user_id").notNull(),
      emoji: text("emoji").notNull(),
      createdAt: timestamp("created_at").defaultNow()
    }, (table) => ({
      pk: { primaryKey: [table.groupId, table.postId, table.userId, table.emoji] }
    }));
    groupEventRsvps = pgTable("group_event_rsvps", {
      groupId: uuid("group_id").notNull(),
      postId: uuid("post_id").notNull(),
      userId: uuid("user_id").notNull(),
      status: text("status").notNull(),
      // going|maybe|no
      createdAt: timestamp("created_at").defaultNow()
    }, (table) => ({
      pk: { primaryKey: [table.groupId, table.postId, table.userId] }
    }));
    groupInvites = pgTable("group_invites", {
      id: uuid("id").primaryKey().default(sql`gen_random_uuid()`),
      groupId: uuid("group_id").notNull(),
      code: text("code").notNull().unique(),
      invitedEmail: text("invited_email"),
      createdBy: uuid("created_by").notNull(),
      expiresAt: timestamp("expires_at").notNull().default(sql`(now() + interval '14 days')`),
      createdAt: timestamp("created_at").defaultNow()
    });
    referrals = pgTable("referrals", {
      id: uuid("id").primaryKey().default(sql`gen_random_uuid()`),
      referrerUserId: uuid("referrer_user_id").notNull(),
      referredUserId: uuid("referred_user_id"),
      groupId: uuid("group_id"),
      createdAt: timestamp("created_at").defaultNow()
    });
    groupAchievements = pgTable("group_achievements", {
      id: uuid("id").primaryKey().default(sql`gen_random_uuid()`),
      groupId: uuid("group_id").notNull(),
      name: text("name").notNull(),
      description: text("description").notNull(),
      progress: numeric("progress").notNull().default(sql`0`),
      unlocked: boolean("unlocked").notNull().default(false),
      updatedAt: timestamp("updated_at").defaultNow()
    });
    wearableConnections = pgTable("wearable_connections", {
      id: uuid("id").primaryKey().default(sql`gen_random_uuid()`),
      userId: uuid("user_id").notNull(),
      // References auth.users(id) in Supabase
      provider: text("provider").notNull(),
      connected: boolean("connected").notNull().default(false),
      lastSync: timestamp("last_sync"),
      providerUserId: text("provider_user_id"),
      status: text("status").notNull().default("disconnected"),
      // disconnected|connected|error
      error: text("error")
    });
    wearableTokens = pgTable("wearable_tokens", {
      id: uuid("id").primaryKey().default(sql`gen_random_uuid()`),
      userId: uuid("user_id").notNull(),
      // References auth.users(id) in Supabase
      provider: text("provider").notNull(),
      accessToken: text("access_token").notNull(),
      // encrypted
      refreshToken: text("refresh_token"),
      // encrypted
      expiresAt: timestamp("expires_at"),
      scope: text("scope"),
      createdAt: timestamp("created_at").defaultNow(),
      updatedAt: timestamp("updated_at").defaultNow()
    });
    healthReports = pgTable("health_reports", {
      id: uuid("id").primaryKey().default(sql`gen_random_uuid()`),
      userId: uuid("user_id").notNull(),
      // References auth.users(id) in Supabase
      date: date("date").notNull(),
      summary: text("summary"),
      metrics: jsonb("metrics").notNull().default(sql`'{}'`),
      suggestions: text("suggestions").array().notNull().default(sql`'{}'`),
      fatigueScore: real("fatigue_score")
      // 0.0-1.0 fatigue score based on health metrics
    });
    deviceTokens = pgTable("device_tokens", {
      id: uuid("id").primaryKey().default(sql`gen_random_uuid()`),
      userId: uuid("user_id").notNull(),
      // References auth.users(id) in Supabase
      platform: text("platform").notNull().default("ios"),
      // 'ios' | 'web'
      token: text("token").notNull(),
      // APNs device token or web push subscription
      createdAt: timestamp("created_at").defaultNow(),
      lastSeen: timestamp("last_seen").defaultNow()
    }, (table) => ({
      uniqueUserToken: uniqueIndex("unique_user_token").on(table.userId, table.token)
    }));
    notificationPrefs = pgTable("notification_prefs", {
      id: uuid("id").primaryKey().default(sql`gen_random_uuid()`),
      userId: uuid("user_id").notNull().unique(),
      // References auth.users(id) in Supabase
      enabled: boolean("enabled").notNull().default(false),
      dailyReminders: boolean("daily_reminders").notNull().default(false),
      reminderTime: text("reminder_time").default("09:00"),
      // HH:mm format
      platform: text("platform").notNull().default("auto"),
      // 'auto' | 'native' | 'web'
      createdAt: timestamp("created_at").defaultNow(),
      updatedAt: timestamp("updated_at").defaultNow()
    });
    notificationTopics = pgTable("notification_topics", {
      userId: uuid("user_id").notNull(),
      // References auth.users(id) in Supabase
      topic: text("topic").notNull(),
      // e.g., 'weekly-report', 'workout-reminder'
      enabled: boolean("enabled").notNull().default(true),
      updatedAt: timestamp("updated_at").defaultNow()
    }, (table) => ({
      pk: { primaryKey: [table.userId, table.topic] }
    }));
    pushSubscriptions = pgTable("push_subscriptions", {
      id: uuid("id").primaryKey().default(sql`gen_random_uuid()`),
      userId: uuid("user_id").notNull(),
      // References auth.users(id) in Supabase
      endpoint: text("endpoint").notNull(),
      p256dh: text("p256dh").notNull(),
      auth: text("auth").notNull(),
      createdAt: timestamp("created_at").defaultNow(),
      lastUsed: timestamp("last_used").defaultNow()
    }, (table) => ({
      uniqueUserEndpoint: uniqueIndex("unique_user_endpoint").on(table.userId, table.endpoint)
    }));
    notifications = pgTable("notifications", {
      id: uuid("id").primaryKey().default(sql`gen_random_uuid()`),
      userId: uuid("user_id").notNull(),
      // References auth.users(id) in Supabase
      title: text("title").notNull(),
      body: text("body").notNull(),
      data: jsonb("data"),
      // Additional payload data
      channel: text("channel").notNull().default("auto"),
      // 'auto' | 'apns' | 'webpush'
      scheduled_for: timestamp("scheduled_for").notNull(),
      status: text("status").notNull().default("pending"),
      // 'pending' | 'sent' | 'failed'
      sent_at: timestamp("sent_at"),
      error: text("error"),
      // Error message if failed
      createdAt: timestamp("created_at").defaultNow()
    });
    suggestedWorkouts = pgTable("suggested_workouts", {
      id: uuid("id").primaryKey().default(sql`gen_random_uuid()`),
      userId: uuid("user_id").notNull(),
      // References auth.users(id) in Supabase
      date: date("date").notNull(),
      // suggestion day (UTC)
      request: jsonb("request").notNull(),
      // WorkoutRequest { category, duration, intensity }
      rationale: jsonb("rationale").notNull(),
      // SuggestionRationale with rulesApplied, scores, sources
      workoutId: uuid("workout_id"),
      // the generated workouts.id if we also generated one
      createdAt: timestamp("created_at").defaultNow()
    }, (table) => ({
      userDateIdx: uniqueIndex("suggested_workouts_user_date_idx").on(table.userId, table.date)
    }));
    workoutEvents = pgTable("workout_events", {
      id: uuid("id").primaryKey().default(sql`gen_random_uuid()`),
      userId: uuid("user_id").notNull(),
      // References auth.users(id) in Supabase
      event: text("event").notNull(),
      // 'generate' | 'feedback'
      workoutId: uuid("workout_id"),
      // References workouts.id if applicable
      generationId: uuid("generation_id"),
      // Links feedback to specific generation
      requestHash: text("request_hash"),
      // Hash of generation request for deduplication
      payload: jsonb("payload").notNull(),
      // Event-specific data (generation details or feedback)
      responseTimeMs: integer("response_time_ms"),
      // Generation response time in milliseconds
      createdAt: timestamp("created_at").defaultNow()
    });
    workoutsHistory = pgTable("workouts_history", {
      id: uuid("id").primaryKey().default(sql`gen_random_uuid()`),
      userId: uuid("user_id").notNull(),
      // References auth.users(id) in Supabase
      workoutId: uuid("workout_id").notNull(),
      // References workouts.id
      progressionState: jsonb("progression_state"),
      // JSONB nullable - tracks progression metrics
      performanceMetrics: jsonb("performance_metrics"),
      // RPE, completion %, etc.
      adaptations: jsonb("adaptations"),
      // Block modifications, intensity adjustments
      createdAt: timestamp("created_at").defaultNow()
    });
    insertProfileSchema = c(profiles).omit({
      createdAt: true
    });
    insertWorkoutSchema = c(workouts).omit({
      id: true,
      createdAt: true,
      startedAt: true
      // Set via API route when workout is started
    });
    insertPRSchema = c(prs).omit({
      id: true,
      createdAt: true
    }).extend({
      // Make optional fields truly optional
      repMax: z2.number().int().min(1).max(20).optional().nullable(),
      weightKg: z2.number().optional().nullable(),
      notes: z2.string().optional().nullable(),
      workoutId: z2.string().uuid().optional().nullable(),
      date: z2.string().optional()
      // Optional, defaults to current date
    });
    insertAchievementSchema = c(achievements).omit({
      id: true,
      updatedAt: true
    });
    insertWearableConnectionSchema = c(wearableConnections).omit({
      id: true
    });
    insertWearableTokenSchema = c(wearableTokens).omit({
      id: true,
      createdAt: true,
      updatedAt: true
    });
    insertHealthReportSchema = c(healthReports).omit({
      id: true
    });
    insertSuggestedWorkoutSchema = c(suggestedWorkouts).omit({
      id: true,
      createdAt: true
    });
    insertWorkoutEventSchema = c(workoutEvents).omit({
      id: true,
      createdAt: true
    });
    insertWorkoutFeedbackSchema = c(workoutFeedback).omit({
      id: true,
      createdAt: true
    });
    insertWorkoutsHistorySchema = c(workoutsHistory).omit({
      id: true,
      createdAt: true
    });
    insertDeviceTokenSchema = c(deviceTokens).omit({
      id: true,
      createdAt: true,
      lastSeen: true
    });
    insertNotificationPrefsSchema = c(notificationPrefs).omit({
      id: true,
      createdAt: true,
      updatedAt: true
    });
    insertNotificationTopicSchema = c(notificationTopics).omit({
      updatedAt: true
    });
    insertPushSubscriptionSchema = c(pushSubscriptions).omit({
      id: true,
      createdAt: true,
      lastUsed: true
    });
    insertNotificationSchema = c(notifications).omit({
      id: true,
      createdAt: true,
      sent_at: true
    });
    Category = /* @__PURE__ */ ((Category2) => {
      Category2["CROSSFIT"] = "CrossFit";
      Category2["STRENGTH"] = "Strength";
      Category2["HIIT"] = "HIIT";
      Category2["CARDIO"] = "Cardio";
      Category2["POWERLIFTING"] = "Powerlifting";
      Category2["OLYMPIC_LIFTING"] = "Olympic Lifting";
      return Category2;
    })(Category || {});
    workoutRequestSchema = z2.object({
      category: z2.nativeEnum(Category),
      duration: z2.number().min(5).max(120),
      intensity: z2.number().min(1).max(10)
    });
    workoutSetSchema = z2.object({
      id: z2.string(),
      exercise: z2.string(),
      weight: z2.number().optional(),
      reps: z2.number().optional(),
      duration: z2.number().optional(),
      distance: z2.number().optional(),
      calories: z2.number().optional(),
      // For cardio exercises (alternative to distance)
      restTime: z2.number().optional(),
      notes: z2.string().optional(),
      is_header: z2.boolean().optional(),
      // Wodify-style fields for header sets
      workoutTitle: z2.string().optional(),
      scoreType: z2.string().optional(),
      coachingCues: z2.string().optional()
    });
    generatedWorkoutSchema = z2.object({
      name: z2.string(),
      category: z2.nativeEnum(Category),
      description: z2.string(),
      duration: z2.number(),
      intensity: z2.number(),
      sets: z2.array(workoutSetSchema),
      seed: z2.string().optional()
    });
    legacyWorkoutFeedbackSchema = z2.object({
      difficulty: z2.number().min(1).max(10),
      satisfaction: z2.number().min(1).max(10),
      completedAt: z2.date()
    });
    insertGroupSchema = c(groups).omit({
      id: true,
      createdAt: true,
      ownerId: true
      // Server sets this from authenticated user
    });
    insertGroupMemberSchema = c(groupMembers).omit({
      joinedAt: true
    });
    insertPostSchema = c(posts).omit({
      id: true,
      createdAt: true
    });
    insertGroupPostSchema = c(groupPosts).omit({
      createdAt: true
    });
    insertGroupReactionSchema = c(groupReactions).omit({
      createdAt: true
    });
    insertGroupEventRsvpSchema = c(groupEventRsvps).omit({
      createdAt: true
    });
    insertGroupInviteSchema = c(groupInvites).omit({
      id: true,
      createdAt: true
    });
    insertReferralSchema = c(referrals).omit({
      id: true,
      createdAt: true
    });
    insertGroupAchievementSchema = c(groupAchievements).omit({
      id: true,
      updatedAt: true
    });
    reportMetricsSchema = z2.object({
      workoutStats: z2.object({
        totalWorkouts: z2.number(),
        totalMinutes: z2.number(),
        avgIntensity: z2.number().nullable(),
        completionRate: z2.number(),
        consistencyScore: z2.number(),
        categoriesBreakdown: z2.record(z2.string(), z2.number()).optional()
        // Category -> count
      }),
      prStats: z2.object({
        totalPRs: z2.number(),
        topPRs: z2.array(z2.object({
          movement: z2.string(),
          improvement: z2.string(),
          value: z2.string()
        })),
        categoriesImproved: z2.array(z2.string())
      }),
      healthStats: z2.object({
        avgHeartRate: z2.number().nullable(),
        recoveryScore: z2.number().nullable(),
        sleepHours: z2.number().nullable(),
        readiness: z2.number().nullable()
      }).optional(),
      trends: z2.object({
        workoutTrend: z2.enum(["up", "down", "stable"]),
        volumeTrend: z2.enum(["up", "down", "stable"]),
        intensityTrend: z2.enum(["up", "down", "stable"])
      }),
      // Visualization data for charts (capped to prevent massive payloads)
      visualizations: z2.object({
        workoutVolume: z2.array(z2.object({
          date: z2.string(),
          // ISO date string for the period (week start or day)
          totalMinutes: z2.number(),
          totalWorkouts: z2.number(),
          label: z2.string()
          // Human-readable label (e.g., "Week of Jan 1")
        })).max(26).optional(),
        // Cap at 26 weeks or days
        prTimeline: z2.array(z2.object({
          date: z2.string(),
          // ISO date string
          movement: z2.string(),
          value: z2.number(),
          unit: z2.string(),
          // "lbs", "kg", or "reps"
          delta: z2.number().nullable()
          // Improvement from previous PR
        })).max(50).optional(),
        // Cap at 50 most recent PRs
        consistencyHeatmap: z2.array(z2.object({
          date: z2.string(),
          // ISO date string (YYYY-MM-DD)
          value: z2.number(),
          // 0-1 intensity score based on workout count/duration
          workoutCount: z2.number()
        })).max(90).optional(),
        // Cap at ~3 months of daily data
        // NEW: Training Load Timeline - daily volume breakdown by category
        trainingLoad: z2.array(z2.object({
          date: z2.string(),
          // ISO date YYYY-MM-DD
          categories: z2.record(z2.string(), z2.number()),
          // Category -> minutes
          totalMinutes: z2.number(),
          avgIntensity: z2.number().nullable()
        })).max(31).optional(),
        // Cap at 31 days (monthly view)
        // NEW: Streak data for consistency features
        streakData: z2.object({
          currentStreak: z2.number(),
          longestStreak: z2.number(),
          totalActiveDays: z2.number(),
          totalRestDays: z2.number()
        }).optional(),
        // NEW: PR Sparklines - per-movement progression for top movements
        prSparklines: z2.array(z2.object({
          movement: z2.string(),
          category: z2.string(),
          timeline: z2.array(z2.object({
            date: z2.string(),
            value: z2.number(),
            unit: z2.string()
          })),
          latestValue: z2.number(),
          improvement: z2.string(),
          // Display string e.g., "+15 lbs" or "+12%"
          improvementDelta: z2.number(),
          // Numeric delta for comparisons
          improvementPercent: z2.number()
          // Percent improvement
        })).max(5).optional(),
        // Top 5 movements
        // NEW: Recovery Correlation - sleep/HRV vs performance
        recoveryCorrelation: z2.array(z2.object({
          date: z2.string(),
          sleepScore: z2.number().nullable(),
          hrvScore: z2.number().nullable(),
          workoutIntensity: z2.number().nullable(),
          workoutCompletion: z2.boolean(),
          workoutDuration: z2.number().nullable(),
          // Minutes for bubble size
          restingHR: z2.number().nullable()
        })).max(31).optional()
        // Cap at 31 days
      }).optional()
    }).passthrough();
    reportInsightsSchema = z2.object({
      headline: z2.string(),
      highlights: z2.array(z2.string()),
      recommendations: z2.array(z2.string()),
      funFacts: z2.array(z2.string()),
      badges: z2.array(z2.string()),
      mostProductiveDay: z2.string().optional(),
      favoriteMovement: z2.string().optional()
    }).passthrough();
    reportPreferencesSchema = z2.object({
      reportFrequency: z2.enum(["none", "weekly", "monthly", "both"]),
      reportWeeklyDay: z2.number().int().min(0).max(6).nullable().optional(),
      // 0=Sunday, 1=Monday, ..., 6=Saturday
      reportMonthlyDay: z2.number().int().min(1).max(31).nullable().optional(),
      // 1-31 day of month
      reportDeliveryTime: z2.string().regex(/^\d{2}:\d{2}(:\d{2})?$/).optional(),
      // HH:MM or HH:MM:SS
      enableNotifications: z2.boolean().optional(),
      enableEmail: z2.boolean().optional()
    }).refine((data) => {
      if (data.reportFrequency === "weekly" || data.reportFrequency === "both") {
        if (data.reportWeeklyDay === null || data.reportWeeklyDay === void 0) {
          return false;
        }
      }
      if (data.reportFrequency === "monthly" || data.reportFrequency === "both") {
        if (data.reportMonthlyDay === null || data.reportMonthlyDay === void 0) {
          return false;
        }
      }
      return true;
    }, {
      message: "Weekly reports require reportWeeklyDay (0-6), monthly reports require reportMonthlyDay (1-31), both require both fields"
    });
    insertAxleReportSchema = c(axleReports).omit({
      id: true,
      createdAt: true,
      viewedAt: true,
      deliveredAt: true
    }).extend({
      metrics: reportMetricsSchema,
      insights: reportInsightsSchema
    });
    users = profiles;
    personalRecords = prs;
  }
});

// server/ai/config/patternPacks.ts
var init_patternPacks = __esm({
  "server/ai/config/patternPacks.ts"() {
    "use strict";
  }
});

// server/ai/config/patternPackBuilders.ts
var init_patternPackBuilders = __esm({
  "server/ai/config/patternPackBuilders.ts"() {
    "use strict";
  }
});

// node_modules/seedrandom/lib/alea.js
var require_alea = __commonJS({
  "node_modules/seedrandom/lib/alea.js"(exports, module) {
    (function(global, module2, define2) {
      function Alea(seed) {
        var me = this, mash = Mash();
        me.next = function() {
          var t2 = 2091639 * me.s0 + me.c * 23283064365386963e-26;
          me.s0 = me.s1;
          me.s1 = me.s2;
          return me.s2 = t2 - (me.c = t2 | 0);
        };
        me.c = 1;
        me.s0 = mash(" ");
        me.s1 = mash(" ");
        me.s2 = mash(" ");
        me.s0 -= mash(seed);
        if (me.s0 < 0) {
          me.s0 += 1;
        }
        me.s1 -= mash(seed);
        if (me.s1 < 0) {
          me.s1 += 1;
        }
        me.s2 -= mash(seed);
        if (me.s2 < 0) {
          me.s2 += 1;
        }
        mash = null;
      }
      function copy(f2, t2) {
        t2.c = f2.c;
        t2.s0 = f2.s0;
        t2.s1 = f2.s1;
        t2.s2 = f2.s2;
        return t2;
      }
      function impl(seed, opts) {
        var xg = new Alea(seed), state = opts && opts.state, prng = xg.next;
        prng.int32 = function() {
          return xg.next() * 4294967296 | 0;
        };
        prng.double = function() {
          return prng() + (prng() * 2097152 | 0) * 11102230246251565e-32;
        };
        prng.quick = prng;
        if (state) {
          if (typeof state == "object") copy(state, xg);
          prng.state = function() {
            return copy(xg, {});
          };
        }
        return prng;
      }
      function Mash() {
        var n2 = 4022871197;
        var mash = function(data) {
          data = String(data);
          for (var i2 = 0; i2 < data.length; i2++) {
            n2 += data.charCodeAt(i2);
            var h = 0.02519603282416938 * n2;
            n2 = h >>> 0;
            h -= n2;
            h *= n2;
            n2 = h >>> 0;
            h -= n2;
            n2 += h * 4294967296;
          }
          return (n2 >>> 0) * 23283064365386963e-26;
        };
        return mash;
      }
      if (module2 && module2.exports) {
        module2.exports = impl;
      } else if (define2 && define2.amd) {
        define2(function() {
          return impl;
        });
      } else {
        this.alea = impl;
      }
    })(
      exports,
      typeof module == "object" && module,
      // present in node.js
      typeof define == "function" && define
      // present with an AMD loader
    );
  }
});

// node_modules/seedrandom/lib/xor128.js
var require_xor128 = __commonJS({
  "node_modules/seedrandom/lib/xor128.js"(exports, module) {
    (function(global, module2, define2) {
      function XorGen(seed) {
        var me = this, strseed = "";
        me.x = 0;
        me.y = 0;
        me.z = 0;
        me.w = 0;
        me.next = function() {
          var t2 = me.x ^ me.x << 11;
          me.x = me.y;
          me.y = me.z;
          me.z = me.w;
          return me.w ^= me.w >>> 19 ^ t2 ^ t2 >>> 8;
        };
        if (seed === (seed | 0)) {
          me.x = seed;
        } else {
          strseed += seed;
        }
        for (var k = 0; k < strseed.length + 64; k++) {
          me.x ^= strseed.charCodeAt(k) | 0;
          me.next();
        }
      }
      function copy(f2, t2) {
        t2.x = f2.x;
        t2.y = f2.y;
        t2.z = f2.z;
        t2.w = f2.w;
        return t2;
      }
      function impl(seed, opts) {
        var xg = new XorGen(seed), state = opts && opts.state, prng = function() {
          return (xg.next() >>> 0) / 4294967296;
        };
        prng.double = function() {
          do {
            var top = xg.next() >>> 11, bot = (xg.next() >>> 0) / 4294967296, result = (top + bot) / (1 << 21);
          } while (result === 0);
          return result;
        };
        prng.int32 = xg.next;
        prng.quick = prng;
        if (state) {
          if (typeof state == "object") copy(state, xg);
          prng.state = function() {
            return copy(xg, {});
          };
        }
        return prng;
      }
      if (module2 && module2.exports) {
        module2.exports = impl;
      } else if (define2 && define2.amd) {
        define2(function() {
          return impl;
        });
      } else {
        this.xor128 = impl;
      }
    })(
      exports,
      typeof module == "object" && module,
      // present in node.js
      typeof define == "function" && define
      // present with an AMD loader
    );
  }
});

// node_modules/seedrandom/lib/xorwow.js
var require_xorwow = __commonJS({
  "node_modules/seedrandom/lib/xorwow.js"(exports, module) {
    (function(global, module2, define2) {
      function XorGen(seed) {
        var me = this, strseed = "";
        me.next = function() {
          var t2 = me.x ^ me.x >>> 2;
          me.x = me.y;
          me.y = me.z;
          me.z = me.w;
          me.w = me.v;
          return (me.d = me.d + 362437 | 0) + (me.v = me.v ^ me.v << 4 ^ (t2 ^ t2 << 1)) | 0;
        };
        me.x = 0;
        me.y = 0;
        me.z = 0;
        me.w = 0;
        me.v = 0;
        if (seed === (seed | 0)) {
          me.x = seed;
        } else {
          strseed += seed;
        }
        for (var k = 0; k < strseed.length + 64; k++) {
          me.x ^= strseed.charCodeAt(k) | 0;
          if (k == strseed.length) {
            me.d = me.x << 10 ^ me.x >>> 4;
          }
          me.next();
        }
      }
      function copy(f2, t2) {
        t2.x = f2.x;
        t2.y = f2.y;
        t2.z = f2.z;
        t2.w = f2.w;
        t2.v = f2.v;
        t2.d = f2.d;
        return t2;
      }
      function impl(seed, opts) {
        var xg = new XorGen(seed), state = opts && opts.state, prng = function() {
          return (xg.next() >>> 0) / 4294967296;
        };
        prng.double = function() {
          do {
            var top = xg.next() >>> 11, bot = (xg.next() >>> 0) / 4294967296, result = (top + bot) / (1 << 21);
          } while (result === 0);
          return result;
        };
        prng.int32 = xg.next;
        prng.quick = prng;
        if (state) {
          if (typeof state == "object") copy(state, xg);
          prng.state = function() {
            return copy(xg, {});
          };
        }
        return prng;
      }
      if (module2 && module2.exports) {
        module2.exports = impl;
      } else if (define2 && define2.amd) {
        define2(function() {
          return impl;
        });
      } else {
        this.xorwow = impl;
      }
    })(
      exports,
      typeof module == "object" && module,
      // present in node.js
      typeof define == "function" && define
      // present with an AMD loader
    );
  }
});

// node_modules/seedrandom/lib/xorshift7.js
var require_xorshift7 = __commonJS({
  "node_modules/seedrandom/lib/xorshift7.js"(exports, module) {
    (function(global, module2, define2) {
      function XorGen(seed) {
        var me = this;
        me.next = function() {
          var X = me.x, i2 = me.i, t2, v, w;
          t2 = X[i2];
          t2 ^= t2 >>> 7;
          v = t2 ^ t2 << 24;
          t2 = X[i2 + 1 & 7];
          v ^= t2 ^ t2 >>> 10;
          t2 = X[i2 + 3 & 7];
          v ^= t2 ^ t2 >>> 3;
          t2 = X[i2 + 4 & 7];
          v ^= t2 ^ t2 << 7;
          t2 = X[i2 + 7 & 7];
          t2 = t2 ^ t2 << 13;
          v ^= t2 ^ t2 << 9;
          X[i2] = v;
          me.i = i2 + 1 & 7;
          return v;
        };
        function init2(me2, seed2) {
          var j, w, X = [];
          if (seed2 === (seed2 | 0)) {
            w = X[0] = seed2;
          } else {
            seed2 = "" + seed2;
            for (j = 0; j < seed2.length; ++j) {
              X[j & 7] = X[j & 7] << 15 ^ seed2.charCodeAt(j) + X[j + 1 & 7] << 13;
            }
          }
          while (X.length < 8) X.push(0);
          for (j = 0; j < 8 && X[j] === 0; ++j) ;
          if (j == 8) w = X[7] = -1;
          else w = X[j];
          me2.x = X;
          me2.i = 0;
          for (j = 256; j > 0; --j) {
            me2.next();
          }
        }
        init2(me, seed);
      }
      function copy(f2, t2) {
        t2.x = f2.x.slice();
        t2.i = f2.i;
        return t2;
      }
      function impl(seed, opts) {
        if (seed == null) seed = +/* @__PURE__ */ new Date();
        var xg = new XorGen(seed), state = opts && opts.state, prng = function() {
          return (xg.next() >>> 0) / 4294967296;
        };
        prng.double = function() {
          do {
            var top = xg.next() >>> 11, bot = (xg.next() >>> 0) / 4294967296, result = (top + bot) / (1 << 21);
          } while (result === 0);
          return result;
        };
        prng.int32 = xg.next;
        prng.quick = prng;
        if (state) {
          if (state.x) copy(state, xg);
          prng.state = function() {
            return copy(xg, {});
          };
        }
        return prng;
      }
      if (module2 && module2.exports) {
        module2.exports = impl;
      } else if (define2 && define2.amd) {
        define2(function() {
          return impl;
        });
      } else {
        this.xorshift7 = impl;
      }
    })(
      exports,
      typeof module == "object" && module,
      // present in node.js
      typeof define == "function" && define
      // present with an AMD loader
    );
  }
});

// node_modules/seedrandom/lib/xor4096.js
var require_xor4096 = __commonJS({
  "node_modules/seedrandom/lib/xor4096.js"(exports, module) {
    (function(global, module2, define2) {
      function XorGen(seed) {
        var me = this;
        me.next = function() {
          var w = me.w, X = me.X, i2 = me.i, t2, v;
          me.w = w = w + 1640531527 | 0;
          v = X[i2 + 34 & 127];
          t2 = X[i2 = i2 + 1 & 127];
          v ^= v << 13;
          t2 ^= t2 << 17;
          v ^= v >>> 15;
          t2 ^= t2 >>> 12;
          v = X[i2] = v ^ t2;
          me.i = i2;
          return v + (w ^ w >>> 16) | 0;
        };
        function init2(me2, seed2) {
          var t2, v, i2, j, w, X = [], limit = 128;
          if (seed2 === (seed2 | 0)) {
            v = seed2;
            seed2 = null;
          } else {
            seed2 = seed2 + "\0";
            v = 0;
            limit = Math.max(limit, seed2.length);
          }
          for (i2 = 0, j = -32; j < limit; ++j) {
            if (seed2) v ^= seed2.charCodeAt((j + 32) % seed2.length);
            if (j === 0) w = v;
            v ^= v << 10;
            v ^= v >>> 15;
            v ^= v << 4;
            v ^= v >>> 13;
            if (j >= 0) {
              w = w + 1640531527 | 0;
              t2 = X[j & 127] ^= v + w;
              i2 = 0 == t2 ? i2 + 1 : 0;
            }
          }
          if (i2 >= 128) {
            X[(seed2 && seed2.length || 0) & 127] = -1;
          }
          i2 = 127;
          for (j = 4 * 128; j > 0; --j) {
            v = X[i2 + 34 & 127];
            t2 = X[i2 = i2 + 1 & 127];
            v ^= v << 13;
            t2 ^= t2 << 17;
            v ^= v >>> 15;
            t2 ^= t2 >>> 12;
            X[i2] = v ^ t2;
          }
          me2.w = w;
          me2.X = X;
          me2.i = i2;
        }
        init2(me, seed);
      }
      function copy(f2, t2) {
        t2.i = f2.i;
        t2.w = f2.w;
        t2.X = f2.X.slice();
        return t2;
      }
      ;
      function impl(seed, opts) {
        if (seed == null) seed = +/* @__PURE__ */ new Date();
        var xg = new XorGen(seed), state = opts && opts.state, prng = function() {
          return (xg.next() >>> 0) / 4294967296;
        };
        prng.double = function() {
          do {
            var top = xg.next() >>> 11, bot = (xg.next() >>> 0) / 4294967296, result = (top + bot) / (1 << 21);
          } while (result === 0);
          return result;
        };
        prng.int32 = xg.next;
        prng.quick = prng;
        if (state) {
          if (state.X) copy(state, xg);
          prng.state = function() {
            return copy(xg, {});
          };
        }
        return prng;
      }
      if (module2 && module2.exports) {
        module2.exports = impl;
      } else if (define2 && define2.amd) {
        define2(function() {
          return impl;
        });
      } else {
        this.xor4096 = impl;
      }
    })(
      exports,
      // window object or global
      typeof module == "object" && module,
      // present in node.js
      typeof define == "function" && define
      // present with an AMD loader
    );
  }
});

// node_modules/seedrandom/lib/tychei.js
var require_tychei = __commonJS({
  "node_modules/seedrandom/lib/tychei.js"(exports, module) {
    (function(global, module2, define2) {
      function XorGen(seed) {
        var me = this, strseed = "";
        me.next = function() {
          var b = me.b, c2 = me.c, d = me.d, a2 = me.a;
          b = b << 25 ^ b >>> 7 ^ c2;
          c2 = c2 - d | 0;
          d = d << 24 ^ d >>> 8 ^ a2;
          a2 = a2 - b | 0;
          me.b = b = b << 20 ^ b >>> 12 ^ c2;
          me.c = c2 = c2 - d | 0;
          me.d = d << 16 ^ c2 >>> 16 ^ a2;
          return me.a = a2 - b | 0;
        };
        me.a = 0;
        me.b = 0;
        me.c = 2654435769 | 0;
        me.d = 1367130551;
        if (seed === Math.floor(seed)) {
          me.a = seed / 4294967296 | 0;
          me.b = seed | 0;
        } else {
          strseed += seed;
        }
        for (var k = 0; k < strseed.length + 20; k++) {
          me.b ^= strseed.charCodeAt(k) | 0;
          me.next();
        }
      }
      function copy(f2, t2) {
        t2.a = f2.a;
        t2.b = f2.b;
        t2.c = f2.c;
        t2.d = f2.d;
        return t2;
      }
      ;
      function impl(seed, opts) {
        var xg = new XorGen(seed), state = opts && opts.state, prng = function() {
          return (xg.next() >>> 0) / 4294967296;
        };
        prng.double = function() {
          do {
            var top = xg.next() >>> 11, bot = (xg.next() >>> 0) / 4294967296, result = (top + bot) / (1 << 21);
          } while (result === 0);
          return result;
        };
        prng.int32 = xg.next;
        prng.quick = prng;
        if (state) {
          if (typeof state == "object") copy(state, xg);
          prng.state = function() {
            return copy(xg, {});
          };
        }
        return prng;
      }
      if (module2 && module2.exports) {
        module2.exports = impl;
      } else if (define2 && define2.amd) {
        define2(function() {
          return impl;
        });
      } else {
        this.tychei = impl;
      }
    })(
      exports,
      typeof module == "object" && module,
      // present in node.js
      typeof define == "function" && define
      // present with an AMD loader
    );
  }
});

// node_modules/seedrandom/seedrandom.js
var require_seedrandom = __commonJS({
  "node_modules/seedrandom/seedrandom.js"(exports, module) {
    (function(global, pool3, math) {
      var width = 256, chunks = 6, digits = 52, rngname = "random", startdenom = math.pow(width, chunks), significance = math.pow(2, digits), overflow = significance * 2, mask2 = width - 1, nodecrypto;
      function seedrandom2(seed, options, callback) {
        var key = [];
        options = options == true ? { entropy: true } : options || {};
        var shortseed = mixkey(flatten(
          options.entropy ? [seed, tostring(pool3)] : seed == null ? autoseed() : seed,
          3
        ), key);
        var arc4 = new ARC4(key);
        var prng = function() {
          var n2 = arc4.g(chunks), d = startdenom, x = 0;
          while (n2 < significance) {
            n2 = (n2 + x) * width;
            d *= width;
            x = arc4.g(1);
          }
          while (n2 >= overflow) {
            n2 /= 2;
            d /= 2;
            x >>>= 1;
          }
          return (n2 + x) / d;
        };
        prng.int32 = function() {
          return arc4.g(4) | 0;
        };
        prng.quick = function() {
          return arc4.g(4) / 4294967296;
        };
        prng.double = prng;
        mixkey(tostring(arc4.S), pool3);
        return (options.pass || callback || function(prng2, seed2, is_math_call, state) {
          if (state) {
            if (state.S) {
              copy(state, arc4);
            }
            prng2.state = function() {
              return copy(arc4, {});
            };
          }
          if (is_math_call) {
            math[rngname] = prng2;
            return seed2;
          } else return prng2;
        })(
          prng,
          shortseed,
          "global" in options ? options.global : this == math,
          options.state
        );
      }
      function ARC4(key) {
        var t2, keylen = key.length, me = this, i2 = 0, j = me.i = me.j = 0, s2 = me.S = [];
        if (!keylen) {
          key = [keylen++];
        }
        while (i2 < width) {
          s2[i2] = i2++;
        }
        for (i2 = 0; i2 < width; i2++) {
          s2[i2] = s2[j = mask2 & j + key[i2 % keylen] + (t2 = s2[i2])];
          s2[j] = t2;
        }
        (me.g = function(count2) {
          var t3, r4 = 0, i3 = me.i, j2 = me.j, s3 = me.S;
          while (count2--) {
            t3 = s3[i3 = mask2 & i3 + 1];
            r4 = r4 * width + s3[mask2 & (s3[i3] = s3[j2 = mask2 & j2 + t3]) + (s3[j2] = t3)];
          }
          me.i = i3;
          me.j = j2;
          return r4;
        })(width);
      }
      function copy(f2, t2) {
        t2.i = f2.i;
        t2.j = f2.j;
        t2.S = f2.S.slice();
        return t2;
      }
      ;
      function flatten(obj, depth) {
        var result = [], typ = typeof obj, prop;
        if (depth && typ == "object") {
          for (prop in obj) {
            try {
              result.push(flatten(obj[prop], depth - 1));
            } catch (e2) {
            }
          }
        }
        return result.length ? result : typ == "string" ? obj : obj + "\0";
      }
      function mixkey(seed, key) {
        var stringseed = seed + "", smear, j = 0;
        while (j < stringseed.length) {
          key[mask2 & j] = mask2 & (smear ^= key[mask2 & j] * 19) + stringseed.charCodeAt(j++);
        }
        return tostring(key);
      }
      function autoseed() {
        try {
          var out;
          if (nodecrypto && (out = nodecrypto.randomBytes)) {
            out = out(width);
          } else {
            out = new Uint8Array(width);
            (global.crypto || global.msCrypto).getRandomValues(out);
          }
          return tostring(out);
        } catch (e2) {
          var browser = global.navigator, plugins = browser && browser.plugins;
          return [+/* @__PURE__ */ new Date(), global, plugins, global.screen, tostring(pool3)];
        }
      }
      function tostring(a2) {
        return String.fromCharCode.apply(0, a2);
      }
      mixkey(math.random(), pool3);
      if (typeof module == "object" && module.exports) {
        module.exports = seedrandom2;
        try {
          nodecrypto = __require("crypto");
        } catch (ex) {
        }
      } else if (typeof define == "function" && define.amd) {
        define(function() {
          return seedrandom2;
        });
      } else {
        math["seed" + rngname] = seedrandom2;
      }
    })(
      // global: `self` in browsers (including strict mode and web workers),
      // otherwise `this` in Node and other environments
      typeof self !== "undefined" ? self : exports,
      [],
      // pool: entropy pool starts empty
      Math
      // math: package containing random, pow, and seedrandom
    );
  }
});

// node_modules/seedrandom/index.js
var require_seedrandom2 = __commonJS({
  "node_modules/seedrandom/index.js"(exports, module) {
    var alea = require_alea();
    var xor128 = require_xor128();
    var xorwow = require_xorwow();
    var xorshift7 = require_xorshift7();
    var xor4096 = require_xor4096();
    var tychei = require_tychei();
    var sr = require_seedrandom();
    sr.alea = alea;
    sr.xor128 = xor128;
    sr.xorwow = xorwow;
    sr.xorshift7 = xorshift7;
    sr.xor4096 = xor4096;
    sr.tychei = tychei;
    module.exports = sr;
  }
});

// server/data/movements.registry.min.json
var movements_registry_min_default;
var init_movements_registry_min = __esm({
  "server/data/movements.registry.min.json"() {
    movements_registry_min_default = [{ id: "snatch", name: "Snatch", category: "olympic_weightlifting", patterns: ["olympic_snatch"], equipment: ["barbell"], modality: "skill", level: "advanced" }, { id: "clean-jerk", name: "Clean & Jerk", category: "olympic_weightlifting", patterns: ["olympic_cleanjerk"], equipment: ["barbell"], modality: "skill", level: "advanced" }, { id: "power-snatch", name: "Power Snatch", category: "olympic_weightlifting", patterns: ["olympic_snatch"], equipment: ["barbell"], modality: "skill", level: "advanced" }, { id: "squat-snatch", name: "Squat Snatch", category: "olympic_weightlifting", patterns: ["olympic_snatch", "squat"], equipment: ["barbell"], modality: "skill", level: "advanced" }, { id: "split-snatch", name: "Split Snatch", category: "olympic_weightlifting", patterns: ["olympic_snatch"], equipment: ["barbell"], modality: "skill", level: "advanced" }, { id: "muscle-snatch", name: "Muscle Snatch", category: "olympic_weightlifting", patterns: ["olympic_snatch"], equipment: ["barbell"], modality: "skill", level: "advanced" }, { id: "tall-snatch", name: "Tall Snatch", category: "olympic_weightlifting", patterns: ["olympic_snatch"], equipment: ["barbell"], modality: "skill", level: "advanced" }, { id: "high-hang-snatch", name: "High Hang Snatch", category: "olympic_weightlifting", patterns: ["olympic_snatch"], equipment: ["barbell"], modality: "skill", level: "advanced" }, { id: "hang-snatch", name: "Hang Snatch", category: "olympic_weightlifting", patterns: ["olympic_snatch"], equipment: ["barbell"], modality: "skill", level: "advanced" }, { id: "low-hang-snatch", name: "Low Hang Snatch", category: "olympic_weightlifting", patterns: ["olympic_snatch"], equipment: ["barbell"], modality: "skill", level: "advanced" }, { id: "floating-snatch", name: "Floating Snatch", category: "olympic_weightlifting", patterns: ["olympic_snatch"], equipment: ["barbell"], modality: "skill", level: "advanced" }, { id: "block-snatch", name: "Block Snatch", category: "olympic_weightlifting", patterns: ["olympic_snatch"], equipment: ["barbell"], modality: "skill", level: "advanced" }, { id: "snatch-from-floor", name: "Snatch from Floor", category: "olympic_weightlifting", patterns: ["olympic_snatch"], equipment: ["barbell"], modality: "skill", level: "advanced" }, { id: "hang-power-snatch", name: "Hang Power Snatch", category: "olympic_weightlifting", patterns: ["olympic_snatch"], equipment: ["barbell"], modality: "skill", level: "advanced" }, { id: "high-hang-power-snatch", name: "High Hang Power Snatch", category: "olympic_weightlifting", patterns: ["olympic_snatch"], equipment: ["barbell"], modality: "skill", level: "advanced" }, { id: "block-power-snatch", name: "Block Power Snatch", category: "olympic_weightlifting", patterns: ["olympic_snatch"], equipment: ["barbell"], modality: "skill", level: "advanced" }, { id: "hang-muscle-snatch", name: "Hang Muscle Snatch", category: "olympic_weightlifting", patterns: ["olympic_snatch"], equipment: ["barbell"], modality: "skill", level: "advanced" }, { id: "power-snatch-overhead-squat", name: "Power Snatch + Overhead Squat", category: "olympic_weightlifting", patterns: ["olympic_snatch", "squat"], equipment: ["barbell"], modality: "skill", level: "advanced" }, { id: "power-clean", name: "Power Clean", category: "olympic_weightlifting", patterns: ["general"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "squat-clean", name: "Squat Clean", category: "olympic_weightlifting", patterns: ["squat"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "split-clean", name: "Split Clean", category: "olympic_weightlifting", patterns: ["general"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "muscle-clean", name: "Muscle Clean", category: "olympic_weightlifting", patterns: ["general"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "tall-clean", name: "Tall Clean", category: "olympic_weightlifting", patterns: ["general"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "high-hang-clean", name: "High Hang Clean", category: "olympic_weightlifting", patterns: ["general"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "hang-clean", name: "Hang Clean", category: "olympic_weightlifting", patterns: ["general"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "low-hang-clean", name: "Low Hang Clean", category: "olympic_weightlifting", patterns: ["general"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "floating-clean", name: "Floating Clean", category: "olympic_weightlifting", patterns: ["general"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "block-clean", name: "Block Clean", category: "olympic_weightlifting", patterns: ["general"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "clean-from-floor", name: "Clean from Floor", category: "olympic_weightlifting", patterns: ["general"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "hang-power-clean", name: "Hang Power Clean", category: "olympic_weightlifting", patterns: ["general"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "high-hang-power-clean", name: "High Hang Power Clean", category: "olympic_weightlifting", patterns: ["general"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "block-power-clean", name: "Block Power Clean", category: "olympic_weightlifting", patterns: ["general"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "hang-muscle-clean", name: "Hang Muscle Clean", category: "olympic_weightlifting", patterns: ["general"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "power-clean-front-squat", name: "Power Clean + Front Squat", category: "olympic_weightlifting", patterns: ["squat"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "split-jerk", name: "Split Jerk", category: "olympic_weightlifting", patterns: ["general"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "power-jerkpush-jerk", name: "Power Jerk/Push Jerk", category: "olympic_weightlifting", patterns: ["press"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "squat-jerk", name: "Squat Jerk", category: "olympic_weightlifting", patterns: ["squat"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "push-press", name: "Push Press", category: "olympic_weightlifting", patterns: ["press"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "jerk-behind-the-neck", name: "Jerk behind the Neck", category: "olympic_weightlifting", patterns: ["general"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "jerk-balance", name: "Jerk Balance", category: "olympic_weightlifting", patterns: ["general"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "jerk-dip", name: "Jerk Dip", category: "olympic_weightlifting", patterns: ["press"], equipment: ["barbell", "bodyweight"], modality: "strength", level: "intermediate" }, { id: "jerk-drive", name: "Jerk Drive", category: "olympic_weightlifting", patterns: ["general"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "tall-jerk", name: "Tall Jerk", category: "olympic_weightlifting", patterns: ["general"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "jerk-recovery", name: "Jerk Recovery", category: "olympic_weightlifting", patterns: ["general"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "jerk-support", name: "Jerk Support", category: "olympic_weightlifting", patterns: ["general"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "back-squat", name: "Back Squat", category: "olympic_weightlifting", patterns: ["squat"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "front-squat", name: "Front Squat", category: "olympic_weightlifting", patterns: ["squat"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "overhead-squat", name: "Overhead Squat", category: "olympic_weightlifting", patterns: ["squat"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "pause-squat", name: "Pause Squat", category: "olympic_weightlifting", patterns: ["squat"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "tempo-squat", name: "Tempo Squat", category: "olympic_weightlifting", patterns: ["squat"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "box-squat", name: "Box Squat", category: "olympic_weightlifting", patterns: ["squat"], equipment: ["barbell"], modality: "strength", level: "beginner" }, { id: "safety-bar-squat", name: "Safety Bar Squat", category: "olympic_weightlifting", patterns: ["squat"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "snatch-pull", name: "Snatch Pull", category: "olympic_weightlifting", patterns: ["olympic_snatch", "pull"], equipment: ["barbell"], modality: "skill", level: "advanced" }, { id: "snatch-high-pull", name: "Snatch High Pull", category: "olympic_weightlifting", patterns: ["olympic_snatch", "pull"], equipment: ["barbell"], modality: "skill", level: "advanced" }, { id: "snatch-deadlift", name: "Snatch Deadlift", category: "olympic_weightlifting", patterns: ["olympic_snatch", "hinge"], equipment: ["barbell"], modality: "skill", level: "advanced" }, { id: "hang-snatch-pull", name: "Hang Snatch Pull", category: "olympic_weightlifting", patterns: ["olympic_snatch", "pull"], equipment: ["barbell"], modality: "skill", level: "advanced" }, { id: "block-snatch-pull", name: "Block Snatch Pull", category: "olympic_weightlifting", patterns: ["olympic_snatch", "pull"], equipment: ["barbell"], modality: "skill", level: "advanced" }, { id: "deficit-snatch-pull", name: "Deficit Snatch Pull", category: "olympic_weightlifting", patterns: ["olympic_snatch", "pull"], equipment: ["barbell"], modality: "skill", level: "advanced" }, { id: "pause-snatch-pull", name: "Pause Snatch Pull", category: "olympic_weightlifting", patterns: ["olympic_snatch", "pull"], equipment: ["barbell"], modality: "skill", level: "advanced" }, { id: "segment-snatch-pull", name: "Segment Snatch Pull", category: "olympic_weightlifting", patterns: ["olympic_snatch", "pull"], equipment: ["barbell"], modality: "skill", level: "advanced" }, { id: "halting-snatch-deadlift", name: "Halting Snatch Deadlift", category: "olympic_weightlifting", patterns: ["olympic_snatch", "hinge"], equipment: ["barbell"], modality: "skill", level: "advanced" }, { id: "clean-pull", name: "Clean Pull", category: "olympic_weightlifting", patterns: ["olympic_cleanjerk", "pull"], equipment: ["barbell"], modality: "skill", level: "intermediate" }, { id: "clean-high-pull", name: "Clean High Pull", category: "olympic_weightlifting", patterns: ["olympic_cleanjerk", "pull"], equipment: ["barbell"], modality: "skill", level: "intermediate" }, { id: "clean-deadlift", name: "Clean Deadlift", category: "olympic_weightlifting", patterns: ["hinge"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "hang-clean-pull", name: "Hang Clean Pull", category: "olympic_weightlifting", patterns: ["olympic_cleanjerk", "pull"], equipment: ["barbell"], modality: "skill", level: "intermediate" }, { id: "block-clean-pull", name: "Block Clean Pull", category: "olympic_weightlifting", patterns: ["olympic_cleanjerk", "pull"], equipment: ["barbell"], modality: "skill", level: "intermediate" }, { id: "deficit-clean-pull", name: "Deficit Clean Pull", category: "olympic_weightlifting", patterns: ["olympic_cleanjerk", "pull"], equipment: ["barbell"], modality: "skill", level: "advanced" }, { id: "pause-clean-pull", name: "Pause Clean Pull", category: "olympic_weightlifting", patterns: ["olympic_cleanjerk", "pull"], equipment: ["barbell"], modality: "skill", level: "intermediate" }, { id: "segment-clean-pull", name: "Segment Clean Pull", category: "olympic_weightlifting", patterns: ["olympic_cleanjerk", "pull"], equipment: ["barbell"], modality: "skill", level: "intermediate" }, { id: "halting-clean-deadlift", name: "Halting Clean Deadlift", category: "olympic_weightlifting", patterns: ["hinge"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "romanian-deadlift", name: "Romanian Deadlift", category: "olympic_weightlifting", patterns: ["hinge"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "stiff-legged-deadlift", name: "Stiff-Legged Deadlift", category: "olympic_weightlifting", patterns: ["hinge"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "trap-bar-deadlift", name: "Trap Bar Deadlift", category: "olympic_weightlifting", patterns: ["hinge"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "strict-press", name: "Strict Press", category: "olympic_weightlifting", patterns: ["press"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "military-press", name: "Military Press", category: "olympic_weightlifting", patterns: ["press"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "snatch-grip-push-press", name: "Snatch Grip Push Press", category: "olympic_weightlifting", patterns: ["olympic_snatch", "press"], equipment: ["barbell"], modality: "skill", level: "advanced" }, { id: "snatch-grip-press", name: "Snatch Grip Press", category: "olympic_weightlifting", patterns: ["olympic_snatch", "press"], equipment: ["barbell"], modality: "skill", level: "advanced" }, { id: "z-press", name: "Z-Press", category: "olympic_weightlifting", patterns: ["press"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "seated-press", name: "Seated Press", category: "olympic_weightlifting", patterns: ["press"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "single-arm-press", name: "Single Arm Press", category: "olympic_weightlifting", patterns: ["press"], equipment: ["barbell"], modality: "strength", level: "advanced" }, { id: "pressing-snatch-balance", name: "Pressing Snatch Balance", category: "olympic_weightlifting", patterns: ["olympic_snatch", "press"], equipment: ["barbell"], modality: "skill", level: "advanced" }, { id: "heaving-snatch-balance", name: "Heaving Snatch Balance", category: "olympic_weightlifting", patterns: ["olympic_snatch"], equipment: ["barbell"], modality: "skill", level: "advanced" }, { id: "snatch-balance", name: "Snatch Balance", category: "olympic_weightlifting", patterns: ["olympic_snatch"], equipment: ["barbell"], modality: "skill", level: "advanced" }, { id: "drop-snatch", name: "Drop Snatch", category: "olympic_weightlifting", patterns: ["olympic_snatch"], equipment: ["barbell"], modality: "skill", level: "advanced" }, { id: "snatch-push-press", name: "Snatch Push Press", category: "olympic_weightlifting", patterns: ["olympic_snatch", "press"], equipment: ["barbell"], modality: "skill", level: "advanced" }, { id: "sots-press", name: "Sots Press", category: "olympic_weightlifting", patterns: ["press"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "snatch-grip-behind-the-neck-press", name: "Snatch Grip Behind-the-Neck Press", category: "olympic_weightlifting", patterns: ["olympic_snatch", "press"], equipment: ["barbell"], modality: "skill", level: "advanced" }, { id: "snatch-pull-snatch", name: "Snatch Pull + Snatch", category: "olympic_weightlifting", patterns: ["olympic_snatch", "pull"], equipment: ["barbell"], modality: "skill", level: "advanced" }, { id: "snatch-overhead-squat", name: "Snatch + Overhead Squat", category: "olympic_weightlifting", patterns: ["olympic_snatch", "squat"], equipment: ["barbell"], modality: "skill", level: "advanced" }, { id: "power-snatch-snatch", name: "Power Snatch + Snatch", category: "olympic_weightlifting", patterns: ["olympic_snatch"], equipment: ["barbell"], modality: "skill", level: "advanced" }, { id: "hang-snatch-snatch", name: "Hang Snatch + Snatch", category: "olympic_weightlifting", patterns: ["olympic_snatch"], equipment: ["barbell"], modality: "skill", level: "advanced" }, { id: "2-snatch-pulls-1-snatch", name: "2 Snatch Pulls + 1 Snatch", category: "olympic_weightlifting", patterns: ["olympic_snatch", "pull"], equipment: ["barbell"], modality: "skill", level: "advanced" }, { id: "clean-pull-clean", name: "Clean Pull + Clean", category: "olympic_weightlifting", patterns: ["olympic_cleanjerk", "pull"], equipment: ["barbell"], modality: "skill", level: "intermediate" }, { id: "power-clean-clean", name: "Power Clean + Clean", category: "olympic_weightlifting", patterns: ["general"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "hang-clean-clean", name: "Hang Clean + Clean", category: "olympic_weightlifting", patterns: ["general"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "clean-front-squat", name: "Clean + Front Squat", category: "olympic_weightlifting", patterns: ["squat"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "hang-clean-clean-jerk", name: "Hang Clean + Clean + Jerk", category: "olympic_weightlifting", patterns: ["olympic_cleanjerk"], equipment: ["barbell"], modality: "skill", level: "advanced" }, { id: "pull-ups", name: "Pull-ups", category: "olympic_weightlifting", patterns: ["pull"], equipment: ["barbell", "bodyweight"], modality: "strength", level: "intermediate" }, { id: "chin-ups", name: "Chin-ups", category: "olympic_weightlifting", patterns: ["pull"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "rows", name: "Rows", category: "olympic_weightlifting", patterns: ["pull", "cardio"], equipment: ["bodyweight"], modality: "conditioning", level: "intermediate" }, { id: "lat-pulldowns", name: "Lat Pulldowns", category: "olympic_weightlifting", patterns: ["pull"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "face-pulls", name: "Face Pulls", category: "olympic_weightlifting", patterns: ["pull"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "band-pull-aparts", name: "Band Pull-Aparts", category: "olympic_weightlifting", patterns: ["pull"], equipment: ["band"], modality: "strength", level: "beginner" }, { id: "dips", name: "Dips", category: "olympic_weightlifting", patterns: ["press"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "bench-press", name: "Bench Press", category: "olympic_weightlifting", patterns: ["press"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "lunges", name: "Lunges", category: "olympic_weightlifting", patterns: ["squat", "lunge"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "bulgarian-split-squats", name: "Bulgarian Split Squats", category: "olympic_weightlifting", patterns: ["squat", "lunge"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "step-ups", name: "Step-ups", category: "olympic_weightlifting", patterns: ["squat"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "leg-press", name: "Leg Press", category: "olympic_weightlifting", patterns: ["press"], equipment: ["machine"], modality: "strength", level: "intermediate" }, { id: "good-mornings", name: "Good Mornings", category: "olympic_weightlifting", patterns: ["hinge"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "back-extensions", name: "Back Extensions", category: "olympic_weightlifting", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "glute-ham-raises", name: "Glute-Ham Raises", category: "olympic_weightlifting", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "nordic-curls", name: "Nordic Curls", category: "olympic_weightlifting", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "planks", name: "Planks", category: "olympic_weightlifting", patterns: ["core"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "ab-wheel-rollouts", name: "Ab Wheel Rollouts", category: "olympic_weightlifting", patterns: ["core"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "hanging-leg-raises", name: "Hanging Leg Raises", category: "olympic_weightlifting", patterns: ["core"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "russian-twists", name: "Russian Twists", category: "olympic_weightlifting", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "pallof-press", name: "Pallof Press", category: "olympic_weightlifting", patterns: ["press"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "weighted-sit-ups", name: "Weighted Sit-ups", category: "olympic_weightlifting", patterns: ["core"], equipment: ["bodyweight"], modality: "strength", level: "advanced" }, { id: "box-jumps", name: "Box Jumps", category: "olympic_weightlifting", patterns: ["squat", "jump"], equipment: ["bodyweight"], modality: "strength", level: "beginner" }, { id: "broad-jumps", name: "Broad Jumps", category: "olympic_weightlifting", patterns: ["jump"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "vertical-jumps", name: "Vertical Jumps", category: "olympic_weightlifting", patterns: ["jump"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "depth-jumps", name: "Depth Jumps", category: "olympic_weightlifting", patterns: ["jump"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "medicine-ball-throws", name: "Medicine Ball Throws", category: "olympic_weightlifting", patterns: ["pull", "cardio"], equipment: ["ball"], modality: "conditioning", level: "intermediate" }, { id: "", name: "---", category: "olympic_weightlifting", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "deadlift", name: "Deadlift", category: "powerlifting", patterns: ["hinge"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "high-bar-squat", name: "High Bar Squat", category: "powerlifting", patterns: ["squat"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "safety-squat-bar-squat", name: "Safety Squat Bar  Squat", category: "powerlifting", patterns: ["squat"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "zercher-squat", name: "Zercher Squat", category: "powerlifting", patterns: ["squat"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "giant-cambered-bar-squat", name: "Giant Cambered Bar Squat", category: "powerlifting", patterns: ["squat"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "bow-bar-squat", name: "Bow Bar Squat", category: "powerlifting", patterns: ["squat"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "low-pin-squatdead-squat", name: "Low Pin Squat/Dead Squat", category: "powerlifting", patterns: ["squat"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "anderson-squat", name: "Anderson Squat", category: "powerlifting", patterns: ["squat"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "pause-above-parallel", name: "Pause Above Parallel", category: "powerlifting", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "3-count-pause-squat", name: "3-Count Pause Squat", category: "powerlifting", patterns: ["squat"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "wide-stance-squat", name: "Wide Stance Squat", category: "powerlifting", patterns: ["squat"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "narrow-stance-squat", name: "Narrow Stance Squat", category: "powerlifting", patterns: ["squat", "pull", "cardio"], equipment: ["barbell"], modality: "conditioning", level: "intermediate" }, { id: "squat-vs-chains", name: "Squat vs. Chains", category: "powerlifting", patterns: ["squat"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "squat-vs-bands", name: "Squat vs. Bands", category: "powerlifting", patterns: ["squat"], equipment: ["band"], modality: "strength", level: "beginner" }, { id: "squat-with-weight-releasers", name: "Squat with Weight Releasers", category: "powerlifting", patterns: ["squat"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "close-grip-bench-press", name: "Close-Grip Bench Press", category: "powerlifting", patterns: ["press"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "wide-grip-bench-press", name: "Wide-Grip Bench Press", category: "powerlifting", patterns: ["press"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "medium-grip-bench-press", name: "Medium-Grip Bench Press", category: "powerlifting", patterns: ["press"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "incline-bench-press", name: "Incline Bench Press", category: "powerlifting", patterns: ["press"], equipment: ["barbell"], modality: "strength", level: "beginner" }, { id: "decline-bench-press", name: "Decline Bench Press", category: "powerlifting", patterns: ["press"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "floor-press", name: "Floor Press", category: "powerlifting", patterns: ["press"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "axle-bar-bench", name: "Axle Bar Bench", category: "powerlifting", patterns: ["press"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "swiss-barfootball-bar-press", name: "Swiss Bar/Football Bar Press", category: "powerlifting", patterns: ["press"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "dumbbell-bench-press", name: "Dumbbell Bench Press", category: "powerlifting", patterns: ["press"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "pause-bench-press", name: "Pause Bench Press", category: "powerlifting", patterns: ["press"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "3-count-pause-bench", name: "3-Count Pause Bench", category: "powerlifting", patterns: ["press"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "tempo-bench", name: "Tempo Bench", category: "powerlifting", patterns: ["press"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "spoto-press", name: "Spoto Press", category: "powerlifting", patterns: ["press"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "board-press", name: "Board Press", category: "powerlifting", patterns: ["press"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "pin-press", name: "Pin Press", category: "powerlifting", patterns: ["press"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "dead-bench", name: "Dead Bench", category: "powerlifting", patterns: ["press"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "feet-up-bench", name: "Feet-Up Bench", category: "powerlifting", patterns: ["press"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "slingshot-bench", name: "Slingshot Bench", category: "powerlifting", patterns: ["press"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "reverse-band-bench", name: "Reverse Band Bench", category: "powerlifting", patterns: ["press"], equipment: ["band"], modality: "strength", level: "beginner" }, { id: "conventional-deadlift", name: "Conventional Deadlift", category: "powerlifting", patterns: ["hinge"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "sumo-deadlift", name: "Sumo Deadlift", category: "powerlifting", patterns: ["hinge"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "semi-sumo-deadlift", name: "Semi-Sumo Deadlift", category: "powerlifting", patterns: ["hinge"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "deficit-deadlift", name: "Deficit Deadlift", category: "powerlifting", patterns: ["hinge"], equipment: ["barbell"], modality: "strength", level: "advanced" }, { id: "block-pullrack-pull", name: "Block Pull/Rack Pull", category: "powerlifting", patterns: ["pull"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "mat-deadlift", name: "Mat Deadlift", category: "powerlifting", patterns: ["hinge"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "pause-deadlift", name: "Pause Deadlift", category: "powerlifting", patterns: ["hinge"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "halting-deadlift", name: "Halting Deadlift", category: "powerlifting", patterns: ["hinge"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "tempo-deadlift", name: "Tempo Deadlift", category: "powerlifting", patterns: ["hinge"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "axle-bar-deadlift", name: "Axle Bar Deadlift", category: "powerlifting", patterns: ["hinge"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "snatch-grip-deadlift", name: "Snatch Grip Deadlift", category: "powerlifting", patterns: ["olympic_snatch", "hinge"], equipment: ["barbell"], modality: "skill", level: "advanced" }, { id: "stiff-leg-deadlift", name: "Stiff-Leg Deadlift", category: "powerlifting", patterns: ["hinge"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "box-deadlift", name: "Box Deadlift", category: "powerlifting", patterns: ["squat", "hinge"], equipment: ["barbell"], modality: "strength", level: "beginner" }, { id: "deadlift-vs-chains", name: "Deadlift vs. Chains", category: "powerlifting", patterns: ["hinge"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "deadlift-vs-bands", name: "Deadlift vs. Bands", category: "powerlifting", patterns: ["hinge"], equipment: ["band"], modality: "strength", level: "beginner" }, { id: "hack-squat", name: "Hack Squat", category: "powerlifting", patterns: ["squat"], equipment: ["machine"], modality: "strength", level: "intermediate" }, { id: "belt-squat", name: "Belt Squat", category: "powerlifting", patterns: ["squat"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "bulgarian-split-squat", name: "Bulgarian Split Squat", category: "powerlifting", patterns: ["squat", "lunge"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "walking-lunges", name: "Walking Lunges", category: "powerlifting", patterns: ["squat", "lunge", "carry"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "reverse-lunges", name: "Reverse Lunges", category: "powerlifting", patterns: ["squat", "lunge"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "static-lunges", name: "Static Lunges", category: "powerlifting", patterns: ["squat", "lunge"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "goblet-squat", name: "Goblet Squat", category: "powerlifting", patterns: ["squat"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "leg-extension", name: "Leg Extension", category: "powerlifting", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "leg-curl", name: "Leg Curl", category: "powerlifting", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "glute-ham-raise", name: "Glute-Ham Raise", category: "powerlifting", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "nordic-curl", name: "Nordic Curl", category: "powerlifting", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "inverse-curl", name: "Inverse Curl", category: "powerlifting", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "back-raise", name: "Back Raise", category: "powerlifting", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "dumbbell-fly", name: "Dumbbell Fly", category: "powerlifting", patterns: ["general"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "pec-deck", name: "Pec Deck", category: "powerlifting", patterns: ["general"], equipment: ["machine"], modality: "strength", level: "intermediate" }, { id: "cable-fly", name: "Cable Fly", category: "powerlifting", patterns: ["general"], equipment: ["cable"], modality: "strength", level: "intermediate" }, { id: "push-ups", name: "Push-Ups", category: "powerlifting", patterns: ["press"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "tricep-pushdown", name: "Tricep Pushdown", category: "powerlifting", patterns: ["press"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "weighted-dips", name: "Weighted Dips", category: "powerlifting", patterns: ["press"], equipment: ["bodyweight"], modality: "strength", level: "advanced" }, { id: "skullcrusher", name: "Skullcrusher", category: "powerlifting", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "rolling-db-tricep-extension", name: "Rolling DB Tricep Extension", category: "powerlifting", patterns: ["general"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "jm-press", name: "JM Press", category: "powerlifting", patterns: ["press"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "williams-extension", name: "Williams Extension", category: "powerlifting", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "overhead-tricep-extension", name: "Overhead Tricep Extension", category: "powerlifting", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "overhead-press", name: "Overhead Press", category: "powerlifting", patterns: ["press"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "good-mornings-straight-bar", name: "Good Mornings (Straight Bar", category: "powerlifting", patterns: ["hinge"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "ssb", name: "SSB", category: "powerlifting", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "cambered", name: "Cambered)", category: "powerlifting", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "dimel-deadlift", name: "Dimel Deadlift", category: "powerlifting", patterns: ["hinge"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "single-leg-rdl", name: "Single-Leg RDL", category: "powerlifting", patterns: ["hinge"], equipment: ["bodyweight"], modality: "strength", level: "advanced" }, { id: "hamstring-curl", name: "Hamstring Curl", category: "powerlifting", patterns: ["general"], equipment: ["ring"], modality: "strength", level: "intermediate" }, { id: "reverse-hyper", name: "Reverse Hyper", category: "powerlifting", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "hip-thrustglute-bridge", name: "Hip Thrust/Glute Bridge", category: "powerlifting", patterns: ["hinge"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "barbell-row", name: "Barbell Row", category: "powerlifting", patterns: ["pull", "cardio"], equipment: ["barbell"], modality: "conditioning", level: "intermediate" }, { id: "pendlay-row", name: "Pendlay Row", category: "powerlifting", patterns: ["pull", "cardio"], equipment: ["bodyweight"], modality: "conditioning", level: "intermediate" }, { id: "chest-supported-row", name: "Chest-Supported Row", category: "powerlifting", patterns: ["pull", "cardio"], equipment: ["bodyweight"], modality: "conditioning", level: "intermediate" }, { id: "seal-row", name: "Seal Row", category: "powerlifting", patterns: ["pull", "cardio"], equipment: ["bodyweight"], modality: "conditioning", level: "intermediate" }, { id: "one-arm-dumbbell-row", name: "One-Arm Dumbbell Row", category: "powerlifting", patterns: ["pull", "cardio"], equipment: ["dumbbell"], modality: "conditioning", level: "advanced" }, { id: "cable-row", name: "Cable Row", category: "powerlifting", patterns: ["pull", "cardio"], equipment: ["cable"], modality: "conditioning", level: "intermediate" }, { id: "t-bar-row", name: "T-Bar Row", category: "powerlifting", patterns: ["pull", "cardio"], equipment: ["bodyweight"], modality: "conditioning", level: "intermediate" }, { id: "lat-pulldown", name: "Lat Pulldown", category: "powerlifting", patterns: ["pull"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "v-bar-pulldown", name: "V-Bar Pulldown", category: "powerlifting", patterns: ["pull"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "rear-delt-fly", name: "Rear Delt Fly", category: "powerlifting", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "shrugs", name: "Shrugs", category: "powerlifting", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "overhead-dumbbell-press", name: "Overhead Dumbbell Press", category: "powerlifting", patterns: ["press"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "db-z-press", name: "DB Z Press", category: "powerlifting", patterns: ["press"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "db-lateral-raise", name: "DB Lateral Raise", category: "powerlifting", patterns: ["pull"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "db-front-raise", name: "DB Front Raise", category: "powerlifting", patterns: ["general"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "arnold-press", name: "Arnold Press", category: "powerlifting", patterns: ["press"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "barbell-curl", name: "Barbell Curl", category: "powerlifting", patterns: ["general"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "dumbbell-bicep-curl", name: "Dumbbell Bicep Curl", category: "powerlifting", patterns: ["general"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "hammer-curl", name: "Hammer Curl", category: "powerlifting", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "preacher-curl", name: "Preacher Curl", category: "powerlifting", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "cable-curl", name: "Cable Curl", category: "powerlifting", patterns: ["general"], equipment: ["cable"], modality: "strength", level: "intermediate" }, { id: "ab-wheel-roll-out", name: "Ab Wheel Roll-Out", category: "powerlifting", patterns: ["core"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "standing-abs", name: "Standing Abs", category: "powerlifting", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "ghd-sit-ups", name: "GHD Sit-Ups", category: "powerlifting", patterns: ["core"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "hanging-leg-raise", name: "Hanging Leg Raise", category: "powerlifting", patterns: ["core"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "russian-twist", name: "Russian Twist", category: "powerlifting", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "dead-bug", name: "Dead Bug", category: "powerlifting", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "cable-crunches", name: "Cable Crunches", category: "powerlifting", patterns: ["core", "cardio"], equipment: ["cable"], modality: "conditioning", level: "intermediate" }, { id: "sled-pullpush", name: "Sled Pull/Push", category: "powerlifting", patterns: ["press", "pull"], equipment: ["sled"], modality: "strength", level: "intermediate" }, { id: "farmers-carry", name: "Farmer's Carry", category: "powerlifting", patterns: ["carry"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "yoke-walk", name: "Yoke Walk", category: "powerlifting", patterns: ["carry"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "single-leg-press", name: "Single-Leg Press", category: "powerlifting", patterns: ["press"], equipment: ["machine"], modality: "strength", level: "advanced" }, { id: "hip-adductionabduction", name: "Hip Adduction/Abduction", category: "powerlifting", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "barbell-back-squat", name: "Barbell Back Squat", category: "bb_full_body", patterns: ["squat"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "barbell-front-squat", name: "Barbell Front Squat", category: "bb_full_body", patterns: ["squat"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "dumbbell-front-squat", name: "Dumbbell Front Squat", category: "bb_full_body", patterns: ["squat"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "double-kb-front-squat", name: "Double KB Front Squat", category: "bb_full_body", patterns: ["squat"], equipment: ["kettlebell"], modality: "strength", level: "intermediate" }, { id: "hack-squat-machine", name: "Hack Squat Machine", category: "bb_full_body", patterns: ["squat", "pull"], equipment: ["machine"], modality: "strength", level: "beginner" }, { id: "smith-machine-squat", name: "Smith Machine Squat", category: "bb_full_body", patterns: ["squat", "pull"], equipment: ["machine"], modality: "strength", level: "beginner" }, { id: "barbell-walking-lunges", name: "Barbell Walking Lunges", category: "bb_full_body", patterns: ["squat", "lunge", "carry"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "barbell-reverse-lunges", name: "Barbell Reverse Lunges", category: "bb_full_body", patterns: ["squat", "lunge"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "dumbbell-walking-lunges", name: "Dumbbell Walking Lunges", category: "bb_full_body", patterns: ["squat", "lunge", "carry"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "dumbbell-reverse-lunges", name: "Dumbbell Reverse Lunges", category: "bb_full_body", patterns: ["squat", "lunge"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "dumbbell-forward-lunges", name: "Dumbbell Forward Lunges", category: "bb_full_body", patterns: ["squat", "lunge"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "curtsy-lunge", name: "Curtsy Lunge", category: "bb_full_body", patterns: ["squat", "lunge"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "lateral-lunges", name: "Lateral Lunges", category: "bb_full_body", patterns: ["squat", "pull", "lunge"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "cossack-squat", name: "Cossack Squat", category: "bb_full_body", patterns: ["squat"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "leg-extensions", name: "Leg Extensions", category: "bb_full_body", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "cable-pull-through", name: "Cable Pull-Through", category: "bb_full_body", patterns: ["pull"], equipment: ["cable"], modality: "strength", level: "intermediate" }, { id: "barbell-hip-thrust", name: "Barbell Hip Thrust", category: "bb_full_body", patterns: ["hinge"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "dumbbell-hip-thrust", name: "Dumbbell Hip Thrust", category: "bb_full_body", patterns: ["hinge"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "single-leg-hip-thrust", name: "Single-Leg Hip Thrust", category: "bb_full_body", patterns: ["hinge"], equipment: ["bodyweight"], modality: "strength", level: "advanced" }, { id: "glute-bridge", name: "Glute Bridge", category: "bb_full_body", patterns: ["hinge"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "weighted-glute-bridge", name: "Weighted Glute Bridge", category: "bb_full_body", patterns: ["hinge"], equipment: ["bodyweight"], modality: "strength", level: "advanced" }, { id: "cable-glute-kickbacks", name: "Cable Glute Kickbacks", category: "bb_full_body", patterns: ["general"], equipment: ["cable"], modality: "strength", level: "intermediate" }, { id: "dumbbell-step-ups", name: "Dumbbell Step-Ups", category: "bb_full_body", patterns: ["squat"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "lying-leg-curls", name: "Lying Leg Curls", category: "bb_full_body", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "seated-leg-curls", name: "Seated Leg Curls", category: "bb_full_body", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "standing-leg-curls", name: "Standing Leg Curls", category: "bb_full_body", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "nordic-hamstring-curls", name: "Nordic Hamstring Curls", category: "bb_full_body", patterns: ["general"], equipment: ["ring"], modality: "strength", level: "intermediate" }, { id: "stability-ball-hamstring-curls", name: "Stability Ball Hamstring Curls", category: "bb_full_body", patterns: ["general"], equipment: ["ring"], modality: "strength", level: "intermediate" }, { id: "flat-barbell-bench-press", name: "Flat Barbell Bench Press", category: "bb_full_body", patterns: ["press", "pull"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "incline-barbell-bench", name: "Incline Barbell Bench", category: "bb_full_body", patterns: ["press"], equipment: ["barbell"], modality: "strength", level: "beginner" }, { id: "decline-barbell-bench", name: "Decline Barbell Bench", category: "bb_full_body", patterns: ["press"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "guillotine-press", name: "Guillotine Press", category: "bb_full_body", patterns: ["press"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "flat-db-bench-press", name: "Flat DB Bench Press", category: "bb_full_body", patterns: ["press", "pull"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "incline-db-press", name: "Incline DB Press", category: "bb_full_body", patterns: ["press"], equipment: ["dumbbell"], modality: "strength", level: "beginner" }, { id: "decline-db-press", name: "Decline DB Press", category: "bb_full_body", patterns: ["press"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "db-floor-press", name: "DB Floor Press", category: "bb_full_body", patterns: ["press"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "single-arm-db-press", name: "Single-Arm DB Press", category: "bb_full_body", patterns: ["press"], equipment: ["dumbbell"], modality: "strength", level: "advanced" }, { id: "smith-machine-bench", name: "Smith Machine Bench", category: "bb_full_body", patterns: ["press", "pull"], equipment: ["machine"], modality: "strength", level: "beginner" }, { id: "hammer-strength-chest-press", name: "Hammer Strength Chest Press", category: "bb_full_body", patterns: ["press"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "machine-chest-press", name: "Machine Chest Press", category: "bb_full_body", patterns: ["press", "pull"], equipment: ["machine"], modality: "strength", level: "beginner" }, { id: "push-ups-standard", name: "Push-Ups (Standard", category: "bb_full_body", patterns: ["press"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "wide", name: "Wide", category: "bb_full_body", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "close", name: "Close", category: "bb_full_body", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "decline", name: "Decline", category: "bb_full_body", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "incline", name: "Incline", category: "bb_full_body", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "beginner" }, { id: "pike", name: "Pike)", category: "bb_full_body", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "cable-flyes", name: "Cable Flyes", category: "bb_full_body", patterns: ["general"], equipment: ["cable"], modality: "strength", level: "intermediate" }, { id: "dumbbell-flyes", name: "Dumbbell Flyes", category: "bb_full_body", patterns: ["general"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "pec-deck-machine", name: "Pec Deck Machine", category: "bb_full_body", patterns: ["pull"], equipment: ["machine"], modality: "strength", level: "beginner" }, { id: "cable-crossovers-high-to-low", name: "Cable Crossovers (High to Low", category: "bb_full_body", patterns: ["general"], equipment: ["cable"], modality: "strength", level: "intermediate" }, { id: "low-to-high", name: "Low to High)", category: "bb_full_body", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "dumbbell-pullovers", name: "Dumbbell Pullovers", category: "bb_full_body", patterns: ["pull"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "pull-ups-wide", name: "Pull-Ups (Wide", category: "bb_full_body", patterns: ["pull"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "neutral", name: "Neutral)", category: "bb_full_body", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "assisted-pull-ups", name: "Assisted Pull-Ups", category: "bb_full_body", patterns: ["pull"], equipment: ["bodyweight"], modality: "strength", level: "beginner" }, { id: "lat-pulldown-wide", name: "Lat Pulldown (Wide", category: "bb_full_body", patterns: ["pull"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "reverse", name: "Reverse", category: "bb_full_body", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "single-arm", name: "Single-Arm)", category: "bb_full_body", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "advanced" }, { id: "straight-arm-pulldown", name: "Straight-Arm Pulldown", category: "bb_full_body", patterns: ["pull"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "barbell-bent-over-row", name: "Barbell Bent-Over Row", category: "bb_full_body", patterns: ["pull", "cardio"], equipment: ["barbell"], modality: "conditioning", level: "intermediate" }, { id: "landmine-row", name: "Landmine Row", category: "bb_full_body", patterns: ["pull", "cardio"], equipment: ["bodyweight"], modality: "conditioning", level: "intermediate" }, { id: "single-arm-db-row", name: "Single-Arm DB Row", category: "bb_full_body", patterns: ["pull", "cardio"], equipment: ["dumbbell"], modality: "conditioning", level: "advanced" }, { id: "seated-cable-row-v-handle", name: "Seated Cable Row (V-Handle", category: "bb_full_body", patterns: ["pull", "cardio"], equipment: ["cable"], modality: "conditioning", level: "intermediate" }, { id: "wide-grip", name: "Wide Grip)", category: "bb_full_body", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "inverted-row", name: "Inverted Row", category: "bb_full_body", patterns: ["pull", "cardio"], equipment: ["bodyweight"], modality: "conditioning", level: "intermediate" }, { id: "trx-row", name: "TRX Row", category: "bb_full_body", patterns: ["pull", "cardio"], equipment: ["bodyweight"], modality: "conditioning", level: "intermediate" }, { id: "machine-rows", name: "Machine Rows", category: "bb_full_body", patterns: ["pull", "cardio"], equipment: ["machine"], modality: "conditioning", level: "beginner" }, { id: "reverse-fly", name: "Reverse Fly", category: "bb_full_body", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "bent-over-reverse-fly", name: "Bent-Over Reverse Fly", category: "bb_full_body", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "cable-reverse-fly", name: "Cable Reverse Fly", category: "bb_full_body", patterns: ["general"], equipment: ["cable"], modality: "strength", level: "intermediate" }, { id: "rear-delt-row", name: "Rear Delt Row", category: "bb_full_body", patterns: ["pull", "cardio"], equipment: ["bodyweight"], modality: "conditioning", level: "intermediate" }, { id: "reverse-hyperextensions", name: "Reverse Hyperextensions", category: "bb_full_body", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "seated-barbell-shoulder-press", name: "Seated Barbell Shoulder Press", category: "bb_full_body", patterns: ["press"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "standingseated-db-shoulder-press", name: "Standing/Seated DB Shoulder Press", category: "bb_full_body", patterns: ["press"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "landmine-press", name: "Landmine Press", category: "bb_full_body", patterns: ["press"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "smith-machine-shoulder-press", name: "Smith Machine Shoulder Press", category: "bb_full_body", patterns: ["press", "pull"], equipment: ["machine"], modality: "strength", level: "beginner" }, { id: "pike-push-ups", name: "Pike Push-Ups", category: "bb_full_body", patterns: ["press"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "dumbbell-front-raise", name: "Dumbbell Front Raise", category: "bb_full_body", patterns: ["general"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "barbell-front-raise", name: "Barbell Front Raise", category: "bb_full_body", patterns: ["general"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "cable-front-raise", name: "Cable Front Raise", category: "bb_full_body", patterns: ["general"], equipment: ["cable"], modality: "strength", level: "intermediate" }, { id: "plate-front-raise", name: "Plate Front Raise", category: "bb_full_body", patterns: ["pull"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "dumbbell-lateral-raise", name: "Dumbbell Lateral Raise", category: "bb_full_body", patterns: ["pull"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "cable-lateral-raise", name: "Cable Lateral Raise", category: "bb_full_body", patterns: ["pull"], equipment: ["cable"], modality: "strength", level: "intermediate" }, { id: "machine-lateral-raise", name: "Machine Lateral Raise", category: "bb_full_body", patterns: ["pull"], equipment: ["machine"], modality: "strength", level: "beginner" }, { id: "seated-db-lateral-raise", name: "Seated DB Lateral Raise", category: "bb_full_body", patterns: ["pull"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "behind-the-body-cable-lateral-raise", name: "Behind-the-Body Cable Lateral Raise", category: "bb_full_body", patterns: ["pull"], equipment: ["cable"], modality: "strength", level: "intermediate" }, { id: "leaning-cable-lateral-raise", name: "Leaning Cable Lateral Raise", category: "bb_full_body", patterns: ["pull"], equipment: ["cable"], modality: "strength", level: "intermediate" }, { id: "reverse-pec-deck", name: "Reverse Pec Deck", category: "bb_full_body", patterns: ["general"], equipment: ["machine"], modality: "strength", level: "intermediate" }, { id: "bent-over-db-reverse-fly", name: "Bent-Over DB Reverse Fly", category: "bb_full_body", patterns: ["general"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "upright-row", name: "Upright Row", category: "bb_full_body", patterns: ["pull", "cardio"], equipment: ["bodyweight"], modality: "conditioning", level: "intermediate" }, { id: "db-clean-and-press", name: "DB Clean and Press", category: "bb_full_body", patterns: ["press"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "kb-clean-and-press", name: "KB Clean and Press", category: "bb_full_body", patterns: ["press"], equipment: ["kettlebell"], modality: "strength", level: "intermediate" }, { id: "standing-barbell-curl", name: "Standing Barbell Curl", category: "bb_full_body", patterns: ["general"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "ez-bar-curl", name: "EZ-Bar Curl", category: "bb_full_body", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "close-grip-ez-bar-curl", name: "Close-Grip EZ-Bar Curl", category: "bb_full_body", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "wide-grip-barbell-curl", name: "Wide-Grip Barbell Curl", category: "bb_full_body", patterns: ["general"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "reverse-grip-barbell-curl", name: "Reverse Grip Barbell Curl", category: "bb_full_body", patterns: ["general"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "standing-db-curl", name: "Standing DB Curl", category: "bb_full_body", patterns: ["general"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "alternating-db-curl", name: "Alternating DB Curl", category: "bb_full_body", patterns: ["general"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "incline-db-curl", name: "Incline DB Curl", category: "bb_full_body", patterns: ["general"], equipment: ["dumbbell"], modality: "strength", level: "beginner" }, { id: "concentration-curl", name: "Concentration Curl", category: "bb_full_body", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "seated-db-curl", name: "Seated DB Curl", category: "bb_full_body", patterns: ["general"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "waiter-curl", name: "Waiter Curl", category: "bb_full_body", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "cross-body-hammer-curl", name: "Cross-Body Hammer Curl", category: "bb_full_body", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "zottman-curl", name: "Zottman Curl", category: "bb_full_body", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "cable-curl-straight-bar", name: "Cable Curl (Straight Bar", category: "bb_full_body", patterns: ["general"], equipment: ["cable"], modality: "strength", level: "intermediate" }, { id: "ez-bar", name: "EZ-Bar)", category: "bb_full_body", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "cable-hammer-curl", name: "Cable Hammer Curl", category: "bb_full_body", patterns: ["general"], equipment: ["cable"], modality: "strength", level: "intermediate" }, { id: "behind-the-body-cable-curl", name: "Behind-the-Body Cable Curl", category: "bb_full_body", patterns: ["general"], equipment: ["cable"], modality: "strength", level: "intermediate" }, { id: "high-cable-curl", name: "High Cable Curl", category: "bb_full_body", patterns: ["general"], equipment: ["cable"], modality: "strength", level: "intermediate" }, { id: "single-arm-cable-curl", name: "Single-Arm Cable Curl", category: "bb_full_body", patterns: ["general"], equipment: ["cable"], modality: "strength", level: "advanced" }, { id: "machine-preacher-curl", name: "Machine Preacher Curl", category: "bb_full_body", patterns: ["pull"], equipment: ["machine"], modality: "strength", level: "beginner" }, { id: "dumbbell-preacher-curl", name: "Dumbbell Preacher Curl", category: "bb_full_body", patterns: ["general"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "barbell-preacher-curl", name: "Barbell Preacher Curl", category: "bb_full_body", patterns: ["general"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "diamond-push-ups", name: "Diamond Push-Ups", category: "bb_full_body", patterns: ["press"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "overhead-db-extension-two-arm", name: "Overhead DB Extension (Two-Arm", category: "bb_full_body", patterns: ["general"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "lying-db-tricep-extension", name: "Lying DB Tricep Extension", category: "bb_full_body", patterns: ["general"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "lying-barbell-extension", name: "Lying Barbell Extension", category: "bb_full_body", patterns: ["general"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "ez-bar-skull-crusher", name: "EZ-Bar Skull Crusher", category: "bb_full_body", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "overhead-cable-extension", name: "Overhead Cable Extension", category: "bb_full_body", patterns: ["general"], equipment: ["cable"], modality: "strength", level: "intermediate" }, { id: "cable-tricep-pushdown-straight-bar", name: "Cable Tricep Pushdown (Straight Bar", category: "bb_full_body", patterns: ["press"], equipment: ["cable"], modality: "strength", level: "intermediate" }, { id: "v-bar", name: "V-Bar", category: "bb_full_body", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "rope", name: "Rope)", category: "bb_full_body", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "single-arm-cable-extension", name: "Single-Arm Cable Extension", category: "bb_full_body", patterns: ["general"], equipment: ["cable"], modality: "strength", level: "advanced" }, { id: "db-tricep-kickback", name: "DB Tricep Kickback", category: "bb_full_body", patterns: ["general"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "cable-tricep-kickback", name: "Cable Tricep Kickback", category: "bb_full_body", patterns: ["general"], equipment: ["cable"], modality: "strength", level: "intermediate" }, { id: "machine-tricep-extension", name: "Machine Tricep Extension", category: "bb_full_body", patterns: ["pull"], equipment: ["machine"], modality: "strength", level: "beginner" }, { id: "front-plank", name: "Front Plank", category: "bb_full_body", patterns: ["core"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "feet-elevated-plank", name: "Feet-Elevated Plank", category: "bb_full_body", patterns: ["core"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "ab-wheel-rollout", name: "Ab Wheel Rollout", category: "bb_full_body", patterns: ["core"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "stability-ball-rollout", name: "Stability Ball Rollout", category: "bb_full_body", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "trx-rollout", name: "TRX Rollout", category: "bb_full_body", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "plank-with-reach", name: "Plank with Reach", category: "bb_full_body", patterns: ["core"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "single-leg-plank", name: "Single-Leg Plank", category: "bb_full_body", patterns: ["core"], equipment: ["bodyweight"], modality: "strength", level: "advanced" }, { id: "plank-row", name: "Plank Row", category: "bb_full_body", patterns: ["pull", "core", "cardio"], equipment: ["bodyweight"], modality: "conditioning", level: "intermediate" }, { id: "cable-chop", name: "Cable Chop", category: "bb_full_body", patterns: ["jump"], equipment: ["cable"], modality: "strength", level: "intermediate" }, { id: "cable-lift", name: "Cable Lift", category: "bb_full_body", patterns: ["general"], equipment: ["cable"], modality: "strength", level: "intermediate" }, { id: "side-plank", name: "Side Plank", category: "bb_full_body", patterns: ["core"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "side-plank-row", name: "Side Plank Row", category: "bb_full_body", patterns: ["pull", "core", "cardio"], equipment: ["bodyweight"], modality: "conditioning", level: "intermediate" }, { id: "suitcase-carry", name: "Suitcase Carry", category: "bb_full_body", patterns: ["carry"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "single-arm-farmers-walk", name: "Single-Arm Farmer's Walk", category: "bb_full_body", patterns: ["carry"], equipment: ["bodyweight"], modality: "strength", level: "advanced" }, { id: "crunches", name: "Crunches", category: "bb_full_body", patterns: ["core", "cardio"], equipment: ["bodyweight"], modality: "conditioning", level: "intermediate" }, { id: "reverse-crunches", name: "Reverse Crunches", category: "bb_full_body", patterns: ["core", "cardio"], equipment: ["bodyweight"], modality: "conditioning", level: "intermediate" }, { id: "bicycle-crunches", name: "Bicycle Crunches", category: "bb_full_body", patterns: ["core", "cardio"], equipment: ["bodyweight"], modality: "conditioning", level: "intermediate", banned_in_main_when_equipment: true }, { id: "v-ups", name: "V-Ups", category: "bb_full_body", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "sit-ups", name: "Sit-Ups", category: "bb_full_body", patterns: ["core"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "medicine-ball-slam", name: "Medicine Ball Slam", category: "bb_full_body", patterns: ["general"], equipment: ["ball"], modality: "strength", level: "intermediate" }, { id: "hanging-knee-raises", name: "Hanging Knee Raises", category: "bb_full_body", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "beginner" }, { id: "lying-leg-raises", name: "Lying Leg Raises", category: "bb_full_body", patterns: ["core"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "mountain-climbers", name: "Mountain Climbers", category: "bb_full_body", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "bird-dog", name: "Bird Dog", category: "bb_full_body", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "standing-calf-raise", name: "Standing Calf Raise", category: "bb_full_body", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "seated-calf-raise", name: "Seated Calf Raise", category: "bb_full_body", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "single-leg-calf-raise", name: "Single-Leg Calf Raise", category: "bb_full_body", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "advanced" }, { id: "barbell-calf-raise", name: "Barbell Calf Raise", category: "bb_full_body", patterns: ["general"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "jump-rope", name: "Jump Rope", category: "bb_full_body", patterns: ["jump", "cardio"], equipment: ["bodyweight"], modality: "conditioning", level: "intermediate" }, { id: "close-grip-bench", name: "Close-Grip Bench", category: "bb_upper", patterns: ["press"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "wide-grip-bench", name: "Wide-Grip Bench", category: "bb_upper", patterns: ["press"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "reverse-grip-bench", name: "Reverse Grip Bench", category: "bb_upper", patterns: ["press"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "alternating-db-press", name: "Alternating DB Press", category: "bb_upper", patterns: ["press"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "neutral-grip-db-press", name: "Neutral Grip DB Press", category: "bb_upper", patterns: ["press"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "seated-machine-chest-press", name: "Seated Machine Chest Press", category: "bb_upper", patterns: ["press", "pull"], equipment: ["machine"], modality: "strength", level: "beginner" }, { id: "flat-db-flyes", name: "Flat DB Flyes", category: "bb_upper", patterns: ["pull"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "incline-db-flyes", name: "Incline DB Flyes", category: "bb_upper", patterns: ["general"], equipment: ["dumbbell"], modality: "strength", level: "beginner" }, { id: "cable-crossover", name: "Cable Crossover", category: "bb_upper", patterns: ["general"], equipment: ["cable"], modality: "strength", level: "intermediate" }, { id: "horizontal-cable-flyes", name: "Horizontal Cable Flyes", category: "bb_upper", patterns: ["general"], equipment: ["cable"], modality: "strength", level: "intermediate" }, { id: "pec-deck-machine-flyes", name: "Pec Deck Machine Flyes", category: "bb_upper", patterns: ["pull"], equipment: ["machine"], modality: "strength", level: "beginner" }, { id: "low-to-high-cable-flyes", name: "Low-to-High Cable Flyes", category: "bb_upper", patterns: ["general"], equipment: ["cable"], modality: "strength", level: "intermediate" }, { id: "high-to-low-cable-flyes", name: "High-to-Low Cable Flyes", category: "bb_upper", patterns: ["general"], equipment: ["cable"], modality: "strength", level: "intermediate" }, { id: "explosive", name: "Explosive", category: "bb_upper", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "diamond", name: "Diamond", category: "bb_upper", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "archer", name: "Archer)", category: "bb_upper", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "chest-dips", name: "Chest Dips", category: "bb_upper", patterns: ["press"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "dumbbell-pullover", name: "Dumbbell Pullover", category: "bb_upper", patterns: ["pull"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "cable-pullover", name: "Cable Pullover", category: "bb_upper", patterns: ["pull"], equipment: ["cable"], modality: "strength", level: "intermediate" }, { id: "svend-press", name: "Svend Press", category: "bb_upper", patterns: ["press"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "wide-grip-lat-pulldown", name: "Wide Grip Lat Pulldown", category: "bb_upper", patterns: ["pull"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "close-grip-lat-pulldown", name: "Close Grip Lat Pulldown", category: "bb_upper", patterns: ["pull"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "neutral-grip-lat-pulldown", name: "Neutral Grip Lat Pulldown", category: "bb_upper", patterns: ["pull"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "underhand-lat-pulldown", name: "Underhand Lat Pulldown", category: "bb_upper", patterns: ["pull"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "single-arm-lat-pulldown", name: "Single-Arm Lat Pulldown", category: "bb_upper", patterns: ["pull"], equipment: ["bodyweight"], modality: "strength", level: "advanced" }, { id: "v-bar-lat-pulldown", name: "V-Bar Lat Pulldown", category: "bb_upper", patterns: ["pull"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "rope-pulldown", name: "Rope Pulldown", category: "bb_upper", patterns: ["pull"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "wide-grip-pull-ups", name: "Wide Grip Pull-Ups", category: "bb_upper", patterns: ["pull"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "close-grip-pull-ups", name: "Close Grip Pull-Ups", category: "bb_upper", patterns: ["pull"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "neutral-grip-pull-ups", name: "Neutral Grip Pull-Ups", category: "bb_upper", patterns: ["pull"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "weighted-pull-ups", name: "Weighted Pull-Ups", category: "bb_upper", patterns: ["pull"], equipment: ["bodyweight"], modality: "strength", level: "advanced" }, { id: "towel-pull-ups", name: "Towel Pull-Ups", category: "bb_upper", patterns: ["pull"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "archer-pull-ups", name: "Archer Pull-Ups", category: "bb_upper", patterns: ["pull"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "commando-pull-ups", name: "Commando Pull-Ups", category: "bb_upper", patterns: ["pull"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "bent-over-barbell-row", name: "Bent-Over Barbell Row", category: "bb_upper", patterns: ["pull", "cardio"], equipment: ["barbell"], modality: "conditioning", level: "intermediate" }, { id: "rack-pulls", name: "Rack Pulls", category: "bb_upper", patterns: ["pull"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "yates-row", name: "Yates Row", category: "bb_upper", patterns: ["pull", "cardio"], equipment: ["bodyweight"], modality: "conditioning", level: "intermediate" }, { id: "two-arm-db-row", name: "Two-Arm DB Row", category: "bb_upper", patterns: ["pull", "cardio"], equipment: ["dumbbell"], modality: "conditioning", level: "intermediate" }, { id: "chest-supported-db-row", name: "Chest-Supported DB Row", category: "bb_upper", patterns: ["pull", "cardio"], equipment: ["dumbbell"], modality: "conditioning", level: "intermediate" }, { id: "incline-bench-db-row", name: "Incline Bench DB Row", category: "bb_upper", patterns: ["press", "pull", "cardio"], equipment: ["dumbbell"], modality: "conditioning", level: "beginner" }, { id: "kroc-row", name: "Kroc Row", category: "bb_upper", patterns: ["pull", "cardio"], equipment: ["bodyweight"], modality: "conditioning", level: "intermediate" }, { id: "seated-cable-row", name: "Seated Cable Row", category: "bb_upper", patterns: ["pull", "cardio"], equipment: ["cable"], modality: "conditioning", level: "intermediate" }, { id: "single-arm-cable-row", name: "Single-Arm Cable Row", category: "bb_upper", patterns: ["pull", "cardio"], equipment: ["cable"], modality: "conditioning", level: "advanced" }, { id: "high-cable-row", name: "High Cable Row", category: "bb_upper", patterns: ["pull", "cardio"], equipment: ["cable"], modality: "conditioning", level: "intermediate" }, { id: "low-cable-row", name: "Low Cable Row", category: "bb_upper", patterns: ["pull", "cardio"], equipment: ["cable"], modality: "conditioning", level: "intermediate" }, { id: "machine-row", name: "Machine Row", category: "bb_upper", patterns: ["pull", "cardio"], equipment: ["machine"], modality: "conditioning", level: "beginner" }, { id: "hammer-strength-row", name: "Hammer Strength Row", category: "bb_upper", patterns: ["pull", "cardio"], equipment: ["bodyweight"], modality: "conditioning", level: "intermediate" }, { id: "chest-supported-machine-row", name: "Chest-Supported Machine Row", category: "bb_upper", patterns: ["pull", "cardio"], equipment: ["machine"], modality: "conditioning", level: "beginner" }, { id: "renegade-row", name: "Renegade Row", category: "bb_upper", patterns: ["pull", "cardio"], equipment: ["bodyweight"], modality: "conditioning", level: "intermediate" }, { id: "meadows-row", name: "Meadows Row", category: "bb_upper", patterns: ["pull", "cardio"], equipment: ["bodyweight"], modality: "conditioning", level: "intermediate" }, { id: "gorilla-row", name: "Gorilla Row", category: "bb_upper", patterns: ["pull", "cardio"], equipment: ["bodyweight"], modality: "conditioning", level: "intermediate" }, { id: "standing-military-press", name: "Standing Military Press", category: "bb_upper", patterns: ["press"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "seated-military-press", name: "Seated Military Press", category: "bb_upper", patterns: ["press"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "behind-the-neck-press", name: "Behind-the-Neck Press", category: "bb_upper", patterns: ["press"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "bradford-press", name: "Bradford Press", category: "bb_upper", patterns: ["press"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "standing-db-shoulder-press", name: "Standing DB Shoulder Press", category: "bb_upper", patterns: ["press"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "seated-db-shoulder-press", name: "Seated DB Shoulder Press", category: "bb_upper", patterns: ["press"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "machine-shoulder-press", name: "Machine Shoulder Press", category: "bb_upper", patterns: ["press", "pull"], equipment: ["machine"], modality: "strength", level: "beginner" }, { id: "hammer-strength-shoulder-press", name: "Hammer Strength Shoulder Press", category: "bb_upper", patterns: ["press"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "single-arm-lateral-raise", name: "Single-Arm Lateral Raise", category: "bb_upper", patterns: ["pull"], equipment: ["bodyweight"], modality: "strength", level: "advanced" }, { id: "leaning-lateral-raise", name: "Leaning Lateral Raise", category: "bb_upper", patterns: ["pull"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "wide-grip-upright-row", name: "Wide Grip Upright Row", category: "bb_upper", patterns: ["pull", "cardio"], equipment: ["bodyweight"], modality: "conditioning", level: "intermediate" }, { id: "front-raise", name: "Front Raise", category: "bb_upper", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "alternating-front-raise", name: "Alternating Front Raise", category: "bb_upper", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "machine-reverse-fly", name: "Machine Reverse Fly", category: "bb_upper", patterns: ["pull"], equipment: ["machine"], modality: "strength", level: "beginner" }, { id: "prone-db-reverse-fly", name: "Prone DB Reverse Fly", category: "bb_upper", patterns: ["general"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "bus-drivers", name: "Bus Drivers", category: "bb_upper", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "cuban-press", name: "Cuban Press", category: "bb_upper", patterns: ["press"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "viking-press", name: "Viking Press", category: "bb_upper", patterns: ["press"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "overhead-carry", name: "Overhead Carry", category: "bb_upper", patterns: ["carry"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "single-arm-landmine-press", name: "Single-Arm Landmine Press", category: "bb_upper", patterns: ["press"], equipment: ["bodyweight"], modality: "strength", level: "advanced" }, { id: "close-grip-barbell-curl", name: "Close Grip Barbell Curl", category: "bb_upper", patterns: ["general"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "reverse-barbell-curl", name: "Reverse Barbell Curl", category: "bb_upper", patterns: ["general"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "drag-curl", name: "Drag Curl", category: "bb_upper", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "cheat-curl", name: "Cheat Curl", category: "bb_upper", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "21s", name: "21s", category: "bb_upper", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "spider-curl", name: "Spider Curl", category: "bb_upper", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "cable-rope-hammer-curl", name: "Cable Rope Hammer Curl", category: "bb_upper", patterns: ["general"], equipment: ["cable"], modality: "strength", level: "intermediate" }, { id: "low-cable-curl", name: "Low Cable Curl", category: "bb_upper", patterns: ["general"], equipment: ["cable"], modality: "strength", level: "intermediate" }, { id: "ez-bar-preacher-curl", name: "EZ Bar Preacher Curl", category: "bb_upper", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "single-arm-preacher-curl", name: "Single-Arm Preacher Curl", category: "bb_upper", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "advanced" }, { id: "trx-bicep-curl", name: "TRX Bicep Curl", category: "bb_upper", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "resistance-band-curl", name: "Resistance Band Curl", category: "bb_upper", patterns: ["general"], equipment: ["band"], modality: "strength", level: "beginner" }, { id: "fat-grip-curls", name: "Fat Grip Curls", category: "bb_upper", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "cable-pushdown-straight-bar", name: "Cable Pushdown (Straight Bar", category: "bb_upper", patterns: ["press"], equipment: ["cable"], modality: "strength", level: "intermediate" }, { id: "reverse-grip-pushdown", name: "Reverse Grip Pushdown", category: "bb_upper", patterns: ["press"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "single-arm-pushdown", name: "Single-Arm Pushdown", category: "bb_upper", patterns: ["press"], equipment: ["bodyweight"], modality: "strength", level: "advanced" }, { id: "dumbbell-overhead-extension-two-arm", name: "Dumbbell Overhead Extension (Two-Arm", category: "bb_upper", patterns: ["general"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "barbell-overhead-extension", name: "Barbell Overhead Extension", category: "bb_upper", patterns: ["general"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "ez-bar-overhead-extension", name: "EZ Bar Overhead Extension", category: "bb_upper", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "seated-overhead-extension", name: "Seated Overhead Extension", category: "bb_upper", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "dumbbell-skull-crusher", name: "Dumbbell Skull Crusher", category: "bb_upper", patterns: ["general"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "cable-lying-extension", name: "Cable Lying Extension", category: "bb_upper", patterns: ["general"], equipment: ["cable"], modality: "strength", level: "intermediate" }, { id: "incline-skull-crusher", name: "Incline Skull Crusher", category: "bb_upper", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "beginner" }, { id: "dumbbell-tate-press", name: "Dumbbell Tate Press", category: "bb_upper", patterns: ["press"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "tricep-dips", name: "Tricep Dips", category: "bb_upper", patterns: ["press"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "weighted-tricep-dips", name: "Weighted Tricep Dips", category: "bb_upper", patterns: ["press"], equipment: ["bodyweight"], modality: "strength", level: "advanced" }, { id: "bench-dips", name: "Bench Dips", category: "bb_upper", patterns: ["press"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "close-grip-push-ups", name: "Close-Grip Push-Ups", category: "bb_upper", patterns: ["press"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "dumbbell-kickback", name: "Dumbbell Kickback", category: "bb_upper", patterns: ["general"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "cable-kickback", name: "Cable Kickback", category: "bb_upper", patterns: ["general"], equipment: ["cable"], modality: "strength", level: "intermediate" }, { id: "overhead-rope-extension", name: "Overhead Rope Extension", category: "bb_upper", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "barbell-shrug", name: "Barbell Shrug", category: "bb_upper", patterns: ["general"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "dumbbell-shrug", name: "Dumbbell Shrug", category: "bb_upper", patterns: ["general"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "behind-the-back-barbell-shrug", name: "Behind-the-Back Barbell Shrug", category: "bb_upper", patterns: ["general"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "trap-bar-shrug", name: "Trap Bar Shrug", category: "bb_upper", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "cable-shrug", name: "Cable Shrug", category: "bb_upper", patterns: ["general"], equipment: ["cable"], modality: "strength", level: "intermediate" }, { id: "smith-machine-shrug", name: "Smith Machine Shrug", category: "bb_upper", patterns: ["pull"], equipment: ["machine"], modality: "strength", level: "beginner" }, { id: "overhead-shrug", name: "Overhead Shrug", category: "bb_upper", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "face-pull", name: "Face Pull", category: "bb_upper", patterns: ["pull"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "snatch-grip-high-pull", name: "Snatch Grip High Pull", category: "bb_upper", patterns: ["olympic_snatch", "pull"], equipment: ["bodyweight"], modality: "skill", level: "advanced" }, { id: "rack-pull", name: "Rack Pull", category: "bb_upper", patterns: ["pull"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "farmers-walk", name: "Farmer's Walk", category: "bb_upper", patterns: ["carry"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "overhead-farmers-walk", name: "Overhead Farmer's Walk", category: "bb_upper", patterns: ["carry"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "shrug-on-incline-bench", name: "Shrug on Incline Bench", category: "bb_upper", patterns: ["press"], equipment: ["bodyweight"], modality: "strength", level: "beginner" }, { id: "barbell-wrist-curl", name: "Barbell Wrist Curl", category: "bb_upper", patterns: ["general"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "dumbbell-wrist-curl", name: "Dumbbell Wrist Curl", category: "bb_upper", patterns: ["general"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "cable-wrist-curl", name: "Cable Wrist Curl", category: "bb_upper", patterns: ["general"], equipment: ["cable"], modality: "strength", level: "intermediate" }, { id: "behind-the-back-wrist-curl", name: "Behind-the-Back Wrist Curl", category: "bb_upper", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "barbell-reverse-wrist-curl", name: "Barbell Reverse Wrist Curl", category: "bb_upper", patterns: ["general"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "dumbbell-reverse-wrist-curl", name: "Dumbbell Reverse Wrist Curl", category: "bb_upper", patterns: ["general"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "cable-reverse-wrist-curl", name: "Cable Reverse Wrist Curl", category: "bb_upper", patterns: ["general"], equipment: ["cable"], modality: "strength", level: "intermediate" }, { id: "plate-pinch-hold", name: "Plate Pinch Hold", category: "bb_upper", patterns: ["pull"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "dead-hang", name: "Dead Hang", category: "bb_upper", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "fat-grip-training", name: "Fat Grip Training", category: "bb_upper", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "wrist-roller", name: "Wrist Roller", category: "bb_upper", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "reverse-curl", name: "Reverse Curl", category: "bb_upper", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "fingertip-push-ups", name: "Fingertip Push-Ups", category: "bb_upper", patterns: ["press"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "hand-gripper-training", name: "Hand Gripper Training", category: "bb_upper", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "pronationsupination", name: "Pronation/Supination", category: "bb_upper", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "wrist-rotations", name: "Wrist Rotations", category: "bb_upper", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "dumbbell-squat", name: "Dumbbell Squat", category: "bb_lower", patterns: ["squat"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "kettlebell-front-squat", name: "Kettlebell Front Squat", category: "bb_lower", patterns: ["squat"], equipment: ["kettlebell"], modality: "strength", level: "intermediate" }, { id: "pin-squat", name: "Pin Squat", category: "bb_lower", patterns: ["squat"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "barbell-squat-with-bandschains", name: "Barbell Squat with Bands/Chains", category: "bb_lower", patterns: ["squat"], equipment: ["barbell", "band"], modality: "strength", level: "beginner" }, { id: "bodyweight-squat", name: "Bodyweight Squat", category: "bb_lower", patterns: ["squat"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "seated", name: "Seated", category: "bb_lower", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "vertical", name: "Vertical)", category: "bb_lower", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "narrow-stance-leg-press", name: "Narrow-Stance Leg Press", category: "bb_lower", patterns: ["press", "pull", "cardio"], equipment: ["machine"], modality: "conditioning", level: "intermediate" }, { id: "wide-stance-leg-press", name: "Wide-Stance Leg Press", category: "bb_lower", patterns: ["press"], equipment: ["machine"], modality: "strength", level: "intermediate" }, { id: "single-leg-leg-press", name: "Single-Leg Leg Press", category: "bb_lower", patterns: ["press"], equipment: ["machine"], modality: "strength", level: "advanced" }, { id: "high-foot-leg-press", name: "High-Foot Leg Press", category: "bb_lower", patterns: ["press"], equipment: ["machine"], modality: "strength", level: "intermediate" }, { id: "low-foot-leg-press", name: "Low-Foot Leg Press", category: "bb_lower", patterns: ["press"], equipment: ["machine"], modality: "strength", level: "intermediate" }, { id: "machine-hack-squat", name: "Machine Hack Squat", category: "bb_lower", patterns: ["squat", "pull"], equipment: ["machine"], modality: "strength", level: "beginner" }, { id: "single-leg-hack-squat", name: "Single-Leg Hack Squat", category: "bb_lower", patterns: ["squat"], equipment: ["machine"], modality: "strength", level: "advanced" }, { id: "narrow-stance-hack-squat", name: "Narrow-Stance Hack Squat", category: "bb_lower", patterns: ["squat", "pull", "cardio"], equipment: ["machine"], modality: "conditioning", level: "intermediate" }, { id: "reverse-hack-squat", name: "Reverse Hack Squat", category: "bb_lower", patterns: ["squat"], equipment: ["machine"], modality: "strength", level: "intermediate" }, { id: "single-leg-extension", name: "Single-Leg Extension", category: "bb_lower", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "advanced" }, { id: "sissy-squat", name: "Sissy Squat", category: "bb_lower", patterns: ["squat"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "spanish-squat", name: "Spanish Squat", category: "bb_lower", patterns: ["squat"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "partial-squat", name: "Partial Squat", category: "bb_lower", patterns: ["squat"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "terminal-knee-extension", name: "Terminal Knee Extension", category: "bb_lower", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "beginner" }, { id: "walking-lunge", name: "Walking Lunge", category: "bb_lower", patterns: ["squat", "lunge", "carry"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "forward-lunge", name: "Forward Lunge", category: "bb_lower", patterns: ["squat", "lunge"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "reverse-lunge", name: "Reverse Lunge", category: "bb_lower", patterns: ["squat", "lunge"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "lateral-lunge", name: "Lateral Lunge", category: "bb_lower", patterns: ["squat", "pull", "lunge"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "rear-foot-elevated-split-squat", name: "Rear-Foot-Elevated Split Squat", category: "bb_lower", patterns: ["squat", "lunge"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "split-squat", name: "Split Squat", category: "bb_lower", patterns: ["squat", "lunge"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "front-foot-elevated-split-squat", name: "Front-Foot-Elevated Split Squat", category: "bb_lower", patterns: ["squat", "lunge"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "stationary-split-squat", name: "Stationary Split Squat", category: "bb_lower", patterns: ["squat", "lunge"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "deficit-reverse-lunge", name: "Deficit Reverse Lunge", category: "bb_lower", patterns: ["squat", "lunge"], equipment: ["bodyweight"], modality: "strength", level: "advanced" }, { id: "pulse-lunge", name: "Pulse Lunge", category: "bb_lower", patterns: ["squat", "lunge"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "barbell-step-up", name: "Barbell Step-Up", category: "bb_lower", patterns: ["squat"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "dumbbell-step-up", name: "Dumbbell Step-Up", category: "bb_lower", patterns: ["squat"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "box-step-up", name: "Box Step-Up", category: "bb_lower", patterns: ["squat"], equipment: ["bodyweight"], modality: "strength", level: "beginner" }, { id: "lateral-step-up", name: "Lateral Step-Up", category: "bb_lower", patterns: ["squat", "pull"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "alternating-step-up", name: "Alternating Step-Up", category: "bb_lower", patterns: ["squat"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "single-leg-step-down", name: "Single-Leg Step-Down", category: "bb_lower", patterns: ["squat"], equipment: ["bodyweight"], modality: "strength", level: "advanced" }, { id: "banded-rdl", name: "Banded RDL", category: "bb_lower", patterns: ["hinge"], equipment: ["band"], modality: "strength", level: "beginner" }, { id: "seated-good-morning", name: "Seated Good Morning", category: "bb_lower", patterns: ["hinge"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "lying-leg-curl", name: "Lying Leg Curl", category: "bb_lower", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "seated-leg-curl", name: "Seated Leg Curl", category: "bb_lower", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "standing-leg-curl", name: "Standing Leg Curl", category: "bb_lower", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "single-leg-lying-curl", name: "Single-Leg Lying Curl", category: "bb_lower", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "advanced" }, { id: "single-leg-standing-curl", name: "Single-Leg Standing Curl", category: "bb_lower", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "advanced" }, { id: "nordic-hamstring-curl", name: "Nordic Hamstring Curl", category: "bb_lower", patterns: ["general"], equipment: ["ring"], modality: "strength", level: "intermediate" }, { id: "exercise-ball-leg-curl", name: "Exercise Ball Leg Curl", category: "bb_lower", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "slider-leg-curl", name: "Slider Leg Curl", category: "bb_lower", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "barbell-glute-bridge", name: "Barbell Glute Bridge", category: "bb_lower", patterns: ["hinge"], equipment: ["barbell"], modality: "strength", level: "intermediate" }, { id: "single-leg-glute-bridge", name: "Single-Leg Glute Bridge", category: "bb_lower", patterns: ["hinge"], equipment: ["bodyweight"], modality: "strength", level: "advanced" }, { id: "banded-hip-thrust", name: "Banded Hip Thrust", category: "bb_lower", patterns: ["hinge"], equipment: ["band"], modality: "strength", level: "beginner" }, { id: "elevated-glute-bridge", name: "Elevated Glute Bridge", category: "bb_lower", patterns: ["hinge"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "kas-glute-bridge", name: "Kas Glute Bridge", category: "bb_lower", patterns: ["hinge"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "b-stance-hip-thrust", name: "B-Stance Hip Thrust", category: "bb_lower", patterns: ["hinge"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "smith-machine-hip-thrust", name: "Smith Machine Hip Thrust", category: "bb_lower", patterns: ["hinge", "pull"], equipment: ["machine"], modality: "strength", level: "beginner" }, { id: "cable-glute-kickback", name: "Cable Glute Kickback", category: "bb_lower", patterns: ["general"], equipment: ["cable"], modality: "strength", level: "intermediate" }, { id: "donkey-kick", name: "Donkey Kick", category: "bb_lower", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "banded-kickback", name: "Banded Kickback", category: "bb_lower", patterns: ["general"], equipment: ["band"], modality: "strength", level: "beginner" }, { id: "machine-glute-kickback", name: "Machine Glute Kickback", category: "bb_lower", patterns: ["pull"], equipment: ["machine"], modality: "strength", level: "beginner" }, { id: "quadruped-hip-extension", name: "Quadruped Hip Extension", category: "bb_lower", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "fire-hydrant", name: "Fire Hydrant", category: "bb_lower", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "hyperextension", name: "Hyperextension", category: "bb_lower", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "back-extension", name: "Back Extension", category: "bb_lower", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "reverse-hyperextension", name: "Reverse Hyperextension", category: "bb_lower", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "dumbbell-deadlift", name: "Dumbbell Deadlift", category: "bb_lower", patterns: ["hinge"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "kettlebell-deadlift", name: "Kettlebell Deadlift", category: "bb_lower", patterns: ["hinge"], equipment: ["kettlebell"], modality: "strength", level: "intermediate" }, { id: "donkey-calf-raise", name: "Donkey Calf Raise", category: "bb_lower", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "single-leg-standing-calf-raise", name: "Single-Leg Standing Calf Raise", category: "bb_lower", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "advanced" }, { id: "single-leg-seated-calf-raise", name: "Single-Leg Seated Calf Raise", category: "bb_lower", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "advanced" }, { id: "leg-press-calf-raise", name: "Leg Press Calf Raise", category: "bb_lower", patterns: ["press"], equipment: ["machine"], modality: "strength", level: "intermediate" }, { id: "smith-machine-calf-raise", name: "Smith Machine Calf Raise", category: "bb_lower", patterns: ["pull"], equipment: ["machine"], modality: "strength", level: "beginner" }, { id: "dumbbell-standing-calf-raise", name: "Dumbbell Standing Calf Raise", category: "bb_lower", patterns: ["general"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "calf-raise-on-hack-squat-machine", name: "Calf Raise on Hack Squat Machine", category: "bb_lower", patterns: ["squat", "pull"], equipment: ["machine"], modality: "strength", level: "beginner" }, { id: "walking-calf-raise", name: "Walking Calf Raise", category: "bb_lower", patterns: ["carry"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "jump-calf-raise", name: "Jump Calf Raise", category: "bb_lower", patterns: ["jump"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "box-jump", name: "Box Jump", category: "bb_lower", patterns: ["squat", "jump"], equipment: ["bodyweight"], modality: "strength", level: "beginner" }, { id: "toe-touch-farmers-walk", name: "Toe Touch Farmer's Walk", category: "bb_lower", patterns: ["carry"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "1-1-calf-raise", name: "1-1/ Calf Raise", category: "bb_lower", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "hip-adduction-machine", name: "Hip Adduction Machine", category: "bb_lower", patterns: ["pull"], equipment: ["machine"], modality: "strength", level: "beginner" }, { id: "cable-hip-adduction", name: "Cable Hip Adduction", category: "bb_lower", patterns: ["general"], equipment: ["cable"], modality: "strength", level: "intermediate" }, { id: "copenhagen-adductor-exercise", name: "Copenhagen Adductor Exercise", category: "bb_lower", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "adductor-side-plank", name: "Adductor Side Plank", category: "bb_lower", patterns: ["core"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "side-lying-adduction", name: "Side-Lying Adduction", category: "bb_lower", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "banded-adduction", name: "Banded Adduction", category: "bb_lower", patterns: ["general"], equipment: ["band"], modality: "strength", level: "beginner" }, { id: "sumo-squat", name: "Sumo Squat", category: "bb_lower", patterns: ["squat"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "wide-stance-goblet-squat", name: "Wide-Stance Goblet Squat", category: "bb_lower", patterns: ["squat"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "hip-abduction-machine", name: "Hip Abduction Machine", category: "bb_lower", patterns: ["pull"], equipment: ["machine"], modality: "strength", level: "beginner" }, { id: "cable-hip-abduction", name: "Cable Hip Abduction", category: "bb_lower", patterns: ["general"], equipment: ["cable"], modality: "strength", level: "intermediate" }, { id: "banded-lateral-walk", name: "Banded Lateral Walk", category: "bb_lower", patterns: ["pull", "carry"], equipment: ["band"], modality: "strength", level: "beginner" }, { id: "banded-clamshell", name: "Banded Clamshell", category: "bb_lower", patterns: ["general"], equipment: ["band"], modality: "strength", level: "beginner" }, { id: "side-lying-hip-abduction", name: "Side-Lying Hip Abduction", category: "bb_lower", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "standing-hip-abduction", name: "Standing Hip Abduction", category: "bb_lower", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "side-plank-with-leg-raise", name: "Side Plank with Leg Raise", category: "bb_lower", patterns: ["core"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "x-band-walk", name: "X-Band Walk", category: "bb_lower", patterns: ["carry"], equipment: ["band"], modality: "strength", level: "beginner" }, { id: "monster-walk", name: "Monster Walk", category: "bb_lower", patterns: ["carry"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "wall-push-ups", name: "Wall Push-ups", category: "gymnastics", patterns: ["press", "gym_push"], equipment: ["bodyweight"], modality: "skill", level: "beginner" }, { id: "incline-push-ups", name: "Incline Push-ups", category: "gymnastics", patterns: ["press", "gym_push"], equipment: ["bodyweight"], modality: "skill", level: "beginner" }, { id: "knee-push-ups", name: "Knee Push-ups", category: "gymnastics", patterns: ["press", "gym_push"], equipment: ["bodyweight"], modality: "skill", level: "beginner" }, { id: "standard-push-ups", name: "Standard Push-ups", category: "gymnastics", patterns: ["press", "gym_push"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "wide-grip-push-ups", name: "Wide-Grip Push-ups", category: "gymnastics", patterns: ["press", "gym_push"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "diamondclose-grip-push-ups", name: "Diamond/Close-Grip Push-ups", category: "gymnastics", patterns: ["press", "gym_push"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "decline-push-ups", name: "Decline Push-ups", category: "gymnastics", patterns: ["press", "gym_push"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "deficit-push-ups", name: "Deficit Push-ups", category: "gymnastics", patterns: ["press", "gym_push"], equipment: ["bodyweight"], modality: "skill", level: "advanced" }, { id: "archer-push-ups", name: "Archer Push-ups", category: "gymnastics", patterns: ["press", "gym_push"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "uneven-push-ups", name: "Uneven Push-ups", category: "gymnastics", patterns: ["press", "gym_push"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "pseudo-planche-push-ups", name: "Pseudo-Planche Push-ups", category: "gymnastics", patterns: ["press", "gym_push"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "one-arm-push-ups", name: "One-Arm Push-ups", category: "gymnastics", patterns: ["press", "gym_push"], equipment: ["bodyweight"], modality: "skill", level: "advanced" }, { id: "clapping-push-ups", name: "Clapping Push-ups", category: "gymnastics", patterns: ["press", "gym_push"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "ring-push-ups", name: "Ring Push-ups", category: "gymnastics", patterns: ["press", "gym_push"], equipment: ["ring", "bodyweight"], modality: "skill", level: "intermediate" }, { id: "ring-rows", name: "Ring Rows", category: "gymnastics", patterns: ["pull", "cardio"], equipment: ["ring"], modality: "skill", level: "intermediate" }, { id: "banded-pull-ups", name: "Banded Pull-ups", category: "gymnastics", patterns: ["pull", "gym_pull"], equipment: ["band", "bodyweight"], modality: "skill", level: "beginner" }, { id: "jumping-pull-ups", name: "Jumping Pull-ups", category: "gymnastics", patterns: ["pull", "jump", "gym_pull"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "negative-pull-ups", name: "Negative Pull-ups", category: "gymnastics", patterns: ["pull", "gym_pull"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "strict-pull-ups", name: "Strict Pull-ups", category: "gymnastics", patterns: ["pull", "gym_pull"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "l-pull-ups", name: "L Pull-ups", category: "gymnastics", patterns: ["pull", "gym_pull"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "chest-to-bar-pull-ups", name: "Chest-to-Bar Pull-ups", category: "gymnastics", patterns: ["pull", "gym_pull"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "behind-the-neck-pull-ups", name: "Behind-the-Neck Pull-ups", category: "gymnastics", patterns: ["pull", "gym_pull"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "box-dips", name: "Box Dips", category: "gymnastics", patterns: ["squat", "press", "gym_push"], equipment: ["bodyweight"], modality: "skill", level: "beginner" }, { id: "parallel-bar-dips", name: "Parallel Bar Dips", category: "gymnastics", patterns: ["press", "gym_push"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "ring-dips", name: "Ring Dips", category: "gymnastics", patterns: ["press", "gym_push"], equipment: ["ring", "bodyweight"], modality: "skill", level: "intermediate" }, { id: "russian-dips", name: "Russian Dips", category: "gymnastics", patterns: ["press", "gym_push"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "bar-muscle-ups", name: "Bar Muscle-ups", category: "gymnastics", patterns: ["gym_pull"], equipment: ["bodyweight"], modality: "skill", level: "advanced" }, { id: "ring-muscle-ups", name: "Ring Muscle-ups", category: "gymnastics", patterns: ["gym_pull"], equipment: ["ring"], modality: "skill", level: "advanced" }, { id: "muscle-up-negatives", name: "Muscle-up Negatives", category: "gymnastics", patterns: ["gym_pull"], equipment: ["bodyweight"], modality: "skill", level: "advanced" }, { id: "high-pull-ups", name: "High Pull-ups", category: "gymnastics", patterns: ["pull", "gym_pull"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "low-dip-holds", name: "Low Dip Holds", category: "gymnastics", patterns: ["press", "gym_push"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "transition-drills", name: "Transition Drills", category: "gymnastics", patterns: ["general"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "kipping-pull-ups", name: "Kipping Pull-ups", category: "gymnastics", patterns: ["pull", "gym_pull"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "butterfly-pull-ups", name: "Butterfly Pull-ups", category: "gymnastics", patterns: ["pull", "gym_pull"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "kipping-chest-to-bar-pull-ups", name: "Kipping Chest-to-Bar Pull-ups", category: "gymnastics", patterns: ["pull", "gym_pull"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "butterfly-chest-to-bar", name: "Butterfly Chest-to-Bar", category: "gymnastics", patterns: ["general"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "rope-climbs", name: "Rope Climbs", category: "gymnastics", patterns: ["gym_pull"], equipment: ["rope"], modality: "skill", level: "intermediate" }, { id: "glide-kips", name: "Glide Kips", category: "gymnastics", patterns: ["general"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "bar-pull-overs", name: "Bar Pull-overs", category: "gymnastics", patterns: ["pull"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "wall-facing-handstand-hold", name: "Wall-Facing Handstand Hold", category: "gymnastics", patterns: ["gym_push"], equipment: ["bodyweight"], modality: "skill", level: "advanced" }, { id: "wall-handstand-hold", name: "Wall Handstand Hold", category: "gymnastics", patterns: ["gym_push"], equipment: ["bodyweight"], modality: "skill", level: "advanced" }, { id: "freestanding-handstand", name: "Freestanding Handstand", category: "gymnastics", patterns: ["gym_push"], equipment: ["bodyweight"], modality: "skill", level: "advanced" }, { id: "handstand-on-parallettes", name: "Handstand on Parallettes", category: "gymnastics", patterns: ["gym_push"], equipment: ["bodyweight"], modality: "skill", level: "advanced" }, { id: "ring-handstand", name: "Ring Handstand", category: "gymnastics", patterns: ["gym_push"], equipment: ["ring"], modality: "skill", level: "advanced" }, { id: "one-arm-handstand", name: "One-Arm Handstand", category: "gymnastics", patterns: ["gym_push"], equipment: ["bodyweight"], modality: "skill", level: "advanced" }, { id: "tuck-l-sit", name: "Tuck L-sit", category: "gymnastics", patterns: ["general"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "single-leg-l-sit", name: "Single-Leg L-sit", category: "gymnastics", patterns: ["general"], equipment: ["bodyweight"], modality: "skill", level: "advanced" }, { id: "straddle-l-sit", name: "Straddle L-sit", category: "gymnastics", patterns: ["general"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "full-l-sit", name: "Full L-sit", category: "gymnastics", patterns: ["general"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "hanging-l-sit", name: "Hanging L-sit", category: "gymnastics", patterns: ["general"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "l-sit-on-rings", name: "L-sit on Rings", category: "gymnastics", patterns: ["general"], equipment: ["ring"], modality: "skill", level: "intermediate" }, { id: "v-sit", name: "V-sit", category: "gymnastics", patterns: ["general"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "hollow-body-hold", name: "Hollow Body Hold", category: "gymnastics", patterns: ["core"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "arch-body-hold", name: "Arch Body Hold", category: "gymnastics", patterns: ["general"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "plank", name: "Plank", category: "gymnastics", patterns: ["core"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "elbow-plank", name: "Elbow Plank", category: "gymnastics", patterns: ["core"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "ring-support-hold", name: "Ring Support Hold", category: "gymnastics", patterns: ["general"], equipment: ["ring"], modality: "skill", level: "intermediate" }, { id: "top-of-push-up-hold", name: "Top of Push-up Hold", category: "gymnastics", patterns: ["press", "gym_push"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "front-lever", name: "Front Lever", category: "gymnastics", patterns: ["general"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "back-lever", name: "Back Lever", category: "gymnastics", patterns: ["general"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "iron-cross-progressions", name: "Iron Cross Progressions", category: "gymnastics", patterns: ["general"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "german-hang", name: "German Hang", category: "gymnastics", patterns: ["general"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "skin-the-cat", name: "Skin the Cat", category: "gymnastics", patterns: ["cardio"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "half-lever-holds", name: "Half Lever Holds", category: "gymnastics", patterns: ["general"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "beat-swingkip-swing", name: "Beat Swing/Kip Swing", category: "gymnastics", patterns: ["general"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "2-for-1-kipping-pull-ups", name: "2-for-1 Kipping Pull-ups", category: "gymnastics", patterns: ["pull", "gym_pull"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "kipping-handstand-push-ups", name: "Kipping Handstand Push-ups", category: "gymnastics", patterns: ["press", "gym_push"], equipment: ["bodyweight"], modality: "skill", level: "advanced" }, { id: "kipping-deficit-hspu", name: "Kipping Deficit HSPU", category: "gymnastics", patterns: ["general"], equipment: ["bodyweight"], modality: "skill", level: "advanced" }, { id: "kipping-toes-to-bar", name: "Kipping Toes-to-Bar", category: "gymnastics", patterns: ["core"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "hip-pop-drills", name: "Hip Pop Drills", category: "gymnastics", patterns: ["general"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "slow-closeopen-drills", name: "Slow Close/Open Drills", category: "gymnastics", patterns: ["general"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "hollow-rocks", name: "Hollow Rocks", category: "gymnastics", patterns: ["core"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "arch-rocks", name: "Arch Rocks", category: "gymnastics", patterns: ["general"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "alligator-drills", name: "Alligator Drills", category: "gymnastics", patterns: ["general"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "superman-rocks", name: "Superman Rocks", category: "gymnastics", patterns: ["general"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "strict-knees-to-elbows", name: "Strict Knees-to-Elbows", category: "gymnastics", patterns: ["core"], equipment: ["bodyweight"], modality: "skill", level: "beginner" }, { id: "kipping-knees-to-elbows", name: "Kipping Knees-to-Elbows", category: "gymnastics", patterns: ["core"], equipment: ["bodyweight"], modality: "skill", level: "beginner" }, { id: "strict-toes-to-bar", name: "Strict Toes-to-Bar", category: "gymnastics", patterns: ["core"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "strict-toes-to-rings", name: "Strict Toes-to-Rings", category: "gymnastics", patterns: ["general"], equipment: ["ring"], modality: "skill", level: "intermediate" }, { id: "around-the-world", name: "Around the World", category: "gymnastics", patterns: ["general"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "windshield-wipers", name: "Windshield Wipers", category: "gymnastics", patterns: ["general"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "hollow-sit-ups", name: "Hollow Sit-ups", category: "gymnastics", patterns: ["core"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "leg-lifts", name: "Leg Lifts", category: "gymnastics", patterns: ["general"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "flutter-kicks", name: "Flutter Kicks", category: "gymnastics", patterns: ["general"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "box-pike-push-ups", name: "Box Pike Push-ups", category: "gymnastics", patterns: ["squat", "press", "gym_push"], equipment: ["bodyweight"], modality: "skill", level: "beginner" }, { id: "wall-walks", name: "Wall Walks", category: "gymnastics", patterns: ["carry"], equipment: ["bodyweight"], modality: "skill", level: "beginner" }, { id: "handstand-holds-against-wall", name: "Handstand Holds Against Wall", category: "gymnastics", patterns: ["gym_push"], equipment: ["bodyweight"], modality: "skill", level: "advanced" }, { id: "partial-range-hspu", name: "Partial Range HSPU", category: "gymnastics", patterns: ["general"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "strict-handstand-push-ups", name: "Strict Handstand Push-ups", category: "gymnastics", patterns: ["press", "gym_push"], equipment: ["bodyweight"], modality: "skill", level: "advanced" }, { id: "deficit-handstand-push-ups", name: "Deficit Handstand Push-ups", category: "gymnastics", patterns: ["press", "gym_push"], equipment: ["bodyweight"], modality: "skill", level: "advanced" }, { id: "freestanding-hspu", name: "Freestanding HSPU", category: "gymnastics", patterns: ["general"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "straddle-press-to-handstand", name: "Straddle Press to Handstand", category: "gymnastics", patterns: ["press", "gym_push"], equipment: ["bodyweight"], modality: "skill", level: "advanced" }, { id: "headstands", name: "Headstands", category: "gymnastics", patterns: ["general"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "tripod-headstands", name: "Tripod Headstands", category: "gymnastics", patterns: ["general"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "kick-ups-to-handstand", name: "Kick-ups to Handstand", category: "gymnastics", patterns: ["gym_push"], equipment: ["bodyweight"], modality: "skill", level: "advanced" }, { id: "handstand-pirouettes", name: "Handstand Pirouettes", category: "gymnastics", patterns: ["gym_push"], equipment: ["bodyweight"], modality: "skill", level: "advanced" }, { id: "ring-support-holds", name: "Ring Support Holds", category: "gymnastics", patterns: ["general"], equipment: ["ring"], modality: "skill", level: "intermediate" }, { id: "single-arm-ring-extensions", name: "Single-Arm Ring Extensions", category: "gymnastics", patterns: ["general"], equipment: ["ring"], modality: "skill", level: "advanced" }, { id: "ring-flyes", name: "Ring Flyes", category: "gymnastics", patterns: ["general"], equipment: ["ring"], modality: "skill", level: "intermediate" }, { id: "ring-l-sits", name: "Ring L-sits", category: "gymnastics", patterns: ["general"], equipment: ["ring"], modality: "skill", level: "intermediate" }, { id: "l-sit-to-shoulder-stand-on-rings", name: "L-sit to Shoulder Stand on Rings", category: "gymnastics", patterns: ["general"], equipment: ["ring"], modality: "skill", level: "intermediate" }, { id: "ball-up-on-rings", name: "Ball-up on Rings", category: "gymnastics", patterns: ["general"], equipment: ["ring"], modality: "skill", level: "intermediate" }, { id: "pass-through-on-rings", name: "Pass-through on Rings", category: "gymnastics", patterns: ["general"], equipment: ["ring"], modality: "skill", level: "intermediate" }, { id: "front-lever-on-rings", name: "Front Lever on Rings", category: "gymnastics", patterns: ["general"], equipment: ["ring"], modality: "skill", level: "intermediate" }, { id: "back-lever-on-rings", name: "Back Lever on Rings", category: "gymnastics", patterns: ["general"], equipment: ["ring"], modality: "skill", level: "intermediate" }, { id: "swing-to-backward-roll", name: "Swing to Backward Roll", category: "gymnastics", patterns: ["general"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "shoot-through-on-rings", name: "Shoot-through on Rings", category: "gymnastics", patterns: ["general"], equipment: ["ring"], modality: "skill", level: "intermediate" }, { id: "ring-rollouts", name: "Ring Rollouts", category: "gymnastics", patterns: ["general"], equipment: ["ring"], modality: "skill", level: "intermediate" }, { id: "handstand-walks", name: "Handstand Walks", category: "gymnastics", patterns: ["carry", "gym_push"], equipment: ["bodyweight"], modality: "skill", level: "advanced" }, { id: "handstand-walk-intervals", name: "Handstand Walk Intervals", category: "gymnastics", patterns: ["carry", "gym_push"], equipment: ["bodyweight"], modality: "skill", level: "advanced" }, { id: "handstand-shoulder-taps", name: "Handstand Shoulder Taps", category: "gymnastics", patterns: ["gym_push"], equipment: ["bodyweight"], modality: "skill", level: "advanced" }, { id: "wall-facing-shoulder-taps", name: "Wall-Facing Shoulder Taps", category: "gymnastics", patterns: ["general"], equipment: ["bodyweight"], modality: "skill", level: "beginner" }, { id: "cargo-net-climbs", name: "Cargo Net Climbs", category: "gymnastics", patterns: ["general"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "pole-climbs", name: "Pole Climbs", category: "gymnastics", patterns: ["general"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "pegboard-climbs", name: "Pegboard Climbs", category: "gymnastics", patterns: ["general"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "pistol-squats", name: "Pistol Squats", category: "gymnastics", patterns: ["squat"], equipment: ["bodyweight"], modality: "skill", level: "advanced" }, { id: "pistol-progressions", name: "Pistol Progressions", category: "gymnastics", patterns: ["general"], equipment: ["bodyweight"], modality: "skill", level: "advanced" }, { id: "back-scales", name: "Back Scales", category: "gymnastics", patterns: ["general"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "arabesque-holds", name: "Arabesque Holds", category: "gymnastics", patterns: ["general"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "box-jump-overs", name: "Box Jump-overs", category: "gymnastics", patterns: ["squat", "jump"], equipment: ["bodyweight"], modality: "skill", level: "beginner" }, { id: "burpees", name: "Burpees", category: "gymnastics", patterns: ["cardio"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "burpee-box-jump-overs", name: "Burpee Box Jump-overs", category: "gymnastics", patterns: ["squat", "jump", "cardio"], equipment: ["bodyweight"], modality: "skill", level: "beginner" }, { id: "squat-jumps", name: "Squat Jumps", category: "gymnastics", patterns: ["squat", "jump"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "tuck-jumps", name: "Tuck Jumps", category: "gymnastics", patterns: ["jump"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "box-step-ups", name: "Box Step-ups", category: "gymnastics", patterns: ["squat"], equipment: ["bodyweight"], modality: "skill", level: "beginner" }, { id: "jump-overs", name: "Jump-overs", category: "gymnastics", patterns: ["jump"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "double-unders", name: "Double-unders", category: "gymnastics", patterns: ["general"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "single-unders", name: "Single-unders", category: "gymnastics", patterns: ["general"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "triple-unders", name: "Triple-unders", category: "gymnastics", patterns: ["general"], equipment: ["bodyweight"], modality: "skill", level: "intermediate" }, { id: "clean", name: "Clean", category: "crossfit", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "clean-and-jerk", name: "Clean and Jerk", category: "crossfit", patterns: ["olympic_cleanjerk"], equipment: ["bodyweight"], modality: "skill", level: "advanced" }, { id: "clean-and-push-jerk", name: "Clean and Push Jerk", category: "crossfit", patterns: ["olympic_cleanjerk", "press"], equipment: ["bodyweight"], modality: "skill", level: "advanced" }, { id: "power-clean-and-split-jerk", name: "Power Clean and Split Jerk", category: "crossfit", patterns: ["olympic_cleanjerk"], equipment: ["bodyweight"], modality: "skill", level: "advanced" }, { id: "hang-clean-and-push-jerk", name: "Hang Clean and Push Jerk", category: "crossfit", patterns: ["olympic_cleanjerk", "press"], equipment: ["bodyweight"], modality: "skill", level: "advanced" }, { id: "thruster", name: "Thruster", category: "crossfit", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "cluster", name: "Cluster", category: "crossfit", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "ground-to-overhead", name: "Ground-to-Overhead", category: "crossfit", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "shoulder-to-overhead", name: "Shoulder-to-Overhead", category: "crossfit", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "air-squat", name: "Air Squat", category: "crossfit", patterns: ["squat"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "shoulder-press", name: "Shoulder Press", category: "crossfit", patterns: ["press"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "push-jerk", name: "Push Jerk", category: "crossfit", patterns: ["press"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "sumo-deadlift-high-pull", name: "Sumo Deadlift High Pull", category: "crossfit", patterns: ["hinge", "pull"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "medicine-ball-clean", name: "Medicine Ball Clean", category: "crossfit", patterns: ["general"], equipment: ["ball"], modality: "strength", level: "intermediate" }, { id: "conventionalsumo-deadlift", name: "Conventional/Sumo Deadlift", category: "crossfit", patterns: ["hinge"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "good-morning", name: "Good Morning", category: "crossfit", patterns: ["hinge"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "high-pull", name: "High Pull", category: "crossfit", patterns: ["pull"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "backfront-rack-lunge", name: "Back/Front Rack Lunge", category: "crossfit", patterns: ["squat", "lunge"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "overhead-walking-lunge", name: "Overhead Walking Lunge", category: "crossfit", patterns: ["squat", "lunge", "carry"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "dumbbell-snatch", name: "Dumbbell Snatch", category: "crossfit", patterns: ["olympic_snatch"], equipment: ["dumbbell"], modality: "skill", level: "advanced" }, { id: "db-power-snatch", name: "DB Power Snatch", category: "crossfit", patterns: ["olympic_snatch"], equipment: ["dumbbell"], modality: "skill", level: "advanced" }, { id: "db-squat-snatch", name: "DB Squat Snatch", category: "crossfit", patterns: ["olympic_snatch", "squat"], equipment: ["dumbbell"], modality: "skill", level: "advanced" }, { id: "dumbbell-clean", name: "Dumbbell Clean", category: "crossfit", patterns: ["general"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "db-hang-clean", name: "DB Hang Clean", category: "crossfit", patterns: ["general"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "db-hang-power-clean", name: "DB Hang Power Clean", category: "crossfit", patterns: ["general"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "db-power-clean", name: "DB Power Clean", category: "crossfit", patterns: ["general"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "dumbbell-clean-and-jerk", name: "Dumbbell Clean and Jerk", category: "crossfit", patterns: ["olympic_cleanjerk"], equipment: ["dumbbell"], modality: "skill", level: "advanced" }, { id: "db-push-jerk", name: "DB Push Jerk", category: "crossfit", patterns: ["press"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "db-push-press", name: "DB Push Press", category: "crossfit", patterns: ["press"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "db-thruster", name: "DB Thruster", category: "crossfit", patterns: ["general"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "db-front-squat", name: "DB Front Squat", category: "crossfit", patterns: ["squat"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "db-overhead-squat", name: "DB Overhead Squat", category: "crossfit", patterns: ["squat"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "db-deadlift", name: "DB Deadlift", category: "crossfit", patterns: ["hinge"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "db-rdl", name: "DB RDL", category: "crossfit", patterns: ["hinge"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "db-front-rack-lunge", name: "DB Front Rack Lunge", category: "crossfit", patterns: ["squat", "lunge"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "db-overhead-walking-lunge", name: "DB Overhead Walking Lunge", category: "crossfit", patterns: ["squat", "lunge", "carry"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "db-box-step-ups", name: "DB Box Step-ups", category: "crossfit", patterns: ["squat"], equipment: ["dumbbell"], modality: "strength", level: "beginner" }, { id: "db-farmers-carry", name: "DB Farmers Carry", category: "crossfit", patterns: ["carry"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "db-overhead-press", name: "DB Overhead Press", category: "crossfit", patterns: ["press"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "db-man-maker", name: "DB Man Maker", category: "crossfit", patterns: ["general"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "db-turkish-get-up", name: "DB Turkish Get-up", category: "crossfit", patterns: ["general"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "db-renegade-row", name: "DB Renegade Row", category: "crossfit", patterns: ["pull", "cardio"], equipment: ["dumbbell"], modality: "conditioning", level: "intermediate" }, { id: "db-push-up-to-row", name: "DB Push-up to Row", category: "crossfit", patterns: ["press", "pull", "cardio"], equipment: ["dumbbell", "bodyweight"], modality: "conditioning", level: "intermediate" }, { id: "db-russian-twist", name: "DB Russian Twist", category: "crossfit", patterns: ["general"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "db-surrenders", name: "DB Surrenders", category: "crossfit", patterns: ["general"], equipment: ["dumbbell"], modality: "strength", level: "intermediate" }, { id: "kb-swing", name: "KB Swing", category: "crossfit", patterns: ["general"], equipment: ["kettlebell"], modality: "strength", level: "intermediate" }, { id: "kb-snatch", name: "KB Snatch", category: "crossfit", patterns: ["olympic_snatch"], equipment: ["kettlebell"], modality: "skill", level: "advanced" }, { id: "kb-clean", name: "KB Clean", category: "crossfit", patterns: ["general"], equipment: ["kettlebell"], modality: "strength", level: "intermediate" }, { id: "kb-clean-and-jerk", name: "KB Clean and Jerk", category: "crossfit", patterns: ["olympic_cleanjerk"], equipment: ["kettlebell"], modality: "skill", level: "advanced" }, { id: "kb-thruster", name: "KB Thruster", category: "crossfit", patterns: ["general"], equipment: ["kettlebell"], modality: "strength", level: "intermediate" }, { id: "kb-goblet-squat", name: "KB Goblet Squat", category: "crossfit", patterns: ["squat"], equipment: ["kettlebell"], modality: "strength", level: "intermediate" }, { id: "kb-front-squat", name: "KB Front Squat", category: "crossfit", patterns: ["squat"], equipment: ["kettlebell"], modality: "strength", level: "intermediate" }, { id: "kb-turkish-get-up", name: "KB Turkish Get-up", category: "crossfit", patterns: ["general"], equipment: ["kettlebell"], modality: "strength", level: "intermediate" }, { id: "kb-deadlift", name: "KB Deadlift", category: "crossfit", patterns: ["hinge"], equipment: ["kettlebell"], modality: "strength", level: "intermediate" }, { id: "kb-good-morning", name: "KB Good Morning", category: "crossfit", patterns: ["hinge"], equipment: ["kettlebell"], modality: "strength", level: "intermediate" }, { id: "kb-gorilla-row", name: "KB Gorilla Row", category: "crossfit", patterns: ["pull", "cardio"], equipment: ["kettlebell"], modality: "conditioning", level: "intermediate" }, { id: "kb-front-raise", name: "KB Front Raise", category: "crossfit", patterns: ["general"], equipment: ["kettlebell"], modality: "strength", level: "intermediate" }, { id: "kb-halo", name: "KB Halo", category: "crossfit", patterns: ["general"], equipment: ["kettlebell"], modality: "strength", level: "intermediate" }, { id: "kb-taters", name: "KB Taters", category: "crossfit", patterns: ["general"], equipment: ["kettlebell"], modality: "strength", level: "intermediate" }, { id: "kb-farmers-carry", name: "KB Farmers Carry", category: "crossfit", patterns: ["carry"], equipment: ["kettlebell"], modality: "strength", level: "intermediate" }, { id: "kb-windmill", name: "KB Windmill", category: "crossfit", patterns: ["general"], equipment: ["kettlebell"], modality: "strength", level: "intermediate" }, { id: "kb-box-step-ups", name: "KB Box Step-ups", category: "crossfit", patterns: ["squat"], equipment: ["kettlebell"], modality: "strength", level: "beginner" }, { id: "strict-pull-up", name: "Strict Pull-up", category: "crossfit", patterns: ["pull"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "kipping-pull-up", name: "Kipping Pull-up", category: "crossfit", patterns: ["pull"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "butterfly-pull-up", name: "Butterfly Pull-up", category: "crossfit", patterns: ["pull"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "chest-to-bar", name: "Chest-to-Bar", category: "crossfit", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "l-pull-up", name: "L Pull-up", category: "crossfit", patterns: ["pull"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "weighted-pull-up", name: "Weighted Pull-up", category: "crossfit", patterns: ["pull"], equipment: ["bodyweight"], modality: "strength", level: "advanced" }, { id: "jumping-pull-up", name: "Jumping Pull-up", category: "crossfit", patterns: ["pull", "jump"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "banded-pull-up", name: "Banded Pull-up", category: "crossfit", patterns: ["pull"], equipment: ["band", "bodyweight"], modality: "strength", level: "beginner" }, { id: "negative-pull-up", name: "Negative Pull-up", category: "crossfit", patterns: ["pull"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "chin-up", name: "Chin-up", category: "crossfit", patterns: ["pull"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "strictkipping-bar-muscle-up", name: "Strict/Kipping Bar Muscle-up", category: "crossfit", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "advanced" }, { id: "toes-to-bar", name: "Toes-to-Bar", category: "crossfit", patterns: ["core"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "knees-to-elbows", name: "Knees-to-Elbows", category: "crossfit", patterns: ["core"], equipment: ["bodyweight"], modality: "strength", level: "beginner" }, { id: "toes-to-rings", name: "Toes-to-Rings", category: "crossfit", patterns: ["general"], equipment: ["ring"], modality: "strength", level: "intermediate" }, { id: "hanging-windshield-wiper", name: "Hanging Windshield Wiper", category: "crossfit", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "strictkipping-ring-muscle-up", name: "Strict/Kipping Ring Muscle-up", category: "crossfit", patterns: ["general"], equipment: ["ring"], modality: "strength", level: "advanced" }, { id: "ring-dip", name: "Ring Dip", category: "crossfit", patterns: ["press"], equipment: ["ring", "bodyweight"], modality: "strength", level: "intermediate" }, { id: "ring-push-up", name: "Ring Push-up", category: "crossfit", patterns: ["press"], equipment: ["ring", "bodyweight"], modality: "strength", level: "intermediate" }, { id: "ring-row", name: "Ring Row", category: "crossfit", patterns: ["pull", "cardio"], equipment: ["ring"], modality: "conditioning", level: "intermediate" }, { id: "pull-over", name: "Pull-over", category: "crossfit", patterns: ["pull"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "shoot-through", name: "Shoot-through", category: "crossfit", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "l-sit-to-shoulder-stand", name: "L-sit to Shoulder Stand", category: "crossfit", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "handstand-hold", name: "Handstand Hold", category: "crossfit", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "advanced" }, { id: "handstand-walk", name: "Handstand Walk", category: "crossfit", patterns: ["carry"], equipment: ["bodyweight"], modality: "strength", level: "advanced" }, { id: "handstand-push-up", name: "Handstand Push-up", category: "crossfit", patterns: ["press"], equipment: ["bodyweight"], modality: "strength", level: "advanced" }, { id: "deficit-hspu", name: "Deficit HSPU", category: "crossfit", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "advanced" }, { id: "wall-facing-hspu", name: "Wall-Facing HSPU", category: "crossfit", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "beginner" }, { id: "handstand-pirouette", name: "Handstand Pirouette", category: "crossfit", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "advanced" }, { id: "push-up-standard", name: "Push-up (Standard", category: "crossfit", patterns: ["press"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "hand-release", name: "Hand-Release)", category: "crossfit", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "knee-push-up", name: "Knee Push-up", category: "crossfit", patterns: ["press"], equipment: ["bodyweight"], modality: "strength", level: "beginner" }, { id: "deficit-push-up", name: "Deficit Push-up", category: "crossfit", patterns: ["press"], equipment: ["bodyweight"], modality: "strength", level: "advanced" }, { id: "dip", name: "Dip", category: "crossfit", patterns: ["press"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "sit-up", name: "Sit-up", category: "crossfit", patterns: ["core"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "ghd-sit-up", name: "GHD Sit-up", category: "crossfit", patterns: ["core"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "v-up", name: "V-up", category: "crossfit", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "tuck-up", name: "Tuck-up", category: "crossfit", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "hollow-rock", name: "Hollow Rock", category: "crossfit", patterns: ["core"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "hollow-hold", name: "Hollow Hold", category: "crossfit", patterns: ["core"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "l-sit", name: "L-sit", category: "crossfit", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "leg-raises", name: "Leg Raises", category: "crossfit", patterns: ["core"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "mountain-climber", name: "Mountain Climber", category: "crossfit", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate", banned_in_main_when_equipment: true }, { id: "knee-to-opposite-elbow-mountain-climber", name: "Knee-to-Opposite-Elbow Mountain Climber", category: "crossfit", patterns: ["core"], equipment: ["bodyweight"], modality: "strength", level: "beginner" }, { id: "pistol", name: "Pistol", category: "crossfit", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "advanced" }, { id: "alternating-pistols", name: "Alternating Pistols", category: "crossfit", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "advanced" }, { id: "squat-jump", name: "Squat Jump", category: "crossfit", patterns: ["squat", "jump"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "burpee", name: "Burpee", category: "crossfit", patterns: ["cardio"], equipment: ["bodyweight"], modality: "conditioning", level: "intermediate" }, { id: "squat-thrust", name: "Squat Thrust", category: "crossfit", patterns: ["squat"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "bear-crawl", name: "Bear Crawl", category: "crossfit", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "crab-walk", name: "Crab Walk", category: "crossfit", patterns: ["carry"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "glide-kip", name: "Glide Kip", category: "crossfit", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "ghd-hip-extension", name: "GHD Hip Extension", category: "crossfit", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "ghd-back-extension", name: "GHD Back Extension", category: "crossfit", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "ghd-hip-and-back-extension", name: "GHD Hip and Back Extension", category: "crossfit", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "running", name: "Running", category: "crossfit", patterns: ["cardio"], equipment: ["bodyweight"], modality: "conditioning", level: "intermediate" }, { id: "sprinting", name: "Sprinting", category: "crossfit", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "shuttle-runs", name: "Shuttle Runs", category: "crossfit", patterns: ["cardio"], equipment: ["bodyweight"], modality: "conditioning", level: "intermediate" }, { id: "row", name: "Row", category: "crossfit", patterns: ["pull", "cardio"], equipment: ["bodyweight"], modality: "conditioning", level: "intermediate" }, { id: "calorie-row", name: "Calorie Row", category: "crossfit", patterns: ["pull", "cardio"], equipment: ["bodyweight"], modality: "conditioning", level: "intermediate" }, { id: "assault-bikeair-bike", name: "Assault Bike/Air Bike", category: "crossfit", patterns: ["cardio"], equipment: ["bike"], modality: "conditioning", level: "intermediate" }, { id: "echo-bike", name: "Echo Bike", category: "crossfit", patterns: ["cardio"], equipment: ["bike"], modality: "conditioning", level: "intermediate" }, { id: "stationary-bikeerg-bike", name: "Stationary Bike/Erg Bike", category: "crossfit", patterns: ["cardio"], equipment: ["bike"], modality: "conditioning", level: "intermediate" }, { id: "crossovers", name: "Crossovers", category: "crossfit", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "one-foot-singles", name: "One-foot Singles", category: "crossfit", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "penguin-taps", name: "Penguin Taps", category: "crossfit", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "ski-erg", name: "Ski Erg", category: "crossfit", patterns: ["cardio"], equipment: ["ski"], modality: "conditioning", level: "intermediate" }, { id: "swimming", name: "Swimming", category: "crossfit", patterns: ["cardio"], equipment: ["pool"], modality: "conditioning", level: "intermediate" }, { id: "box-jump-over", name: "Box Jump-over", category: "crossfit", patterns: ["squat", "jump"], equipment: ["bodyweight"], modality: "strength", level: "beginner" }, { id: "complete-box-jump-over", name: "Complete Box Jump-over", category: "crossfit", patterns: ["squat", "jump"], equipment: ["bodyweight"], modality: "strength", level: "beginner" }, { id: "burpee-box-jump", name: "Burpee Box Jump", category: "crossfit", patterns: ["squat", "jump", "cardio"], equipment: ["bodyweight"], modality: "conditioning", level: "beginner" }, { id: "burpee-box-jump-over", name: "Burpee Box Jump-over", category: "crossfit", patterns: ["squat", "jump", "cardio"], equipment: ["bodyweight"], modality: "conditioning", level: "beginner" }, { id: "bar-facing-burpee", name: "Bar-Facing Burpee", category: "crossfit", patterns: ["cardio"], equipment: ["bodyweight"], modality: "conditioning", level: "intermediate" }, { id: "box-facing-burpee", name: "Box-Facing Burpee", category: "crossfit", patterns: ["squat", "cardio"], equipment: ["bodyweight"], modality: "conditioning", level: "beginner" }, { id: "box-step-over", name: "Box Step-over", category: "crossfit", patterns: ["squat"], equipment: ["bodyweight"], modality: "strength", level: "beginner" }, { id: "depth-drop", name: "Depth Drop", category: "crossfit", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "seated-box-jump", name: "Seated Box Jump", category: "crossfit", patterns: ["squat", "jump"], equipment: ["bodyweight"], modality: "strength", level: "beginner" }, { id: "wall-ball", name: "Wall Ball", category: "crossfit", patterns: ["general"], equipment: ["ball"], modality: "strength", level: "beginner" }, { id: "wall-walk", name: "Wall Walk", category: "crossfit", patterns: ["carry"], equipment: ["bodyweight"], modality: "strength", level: "beginner" }, { id: "medicine-ball-toss", name: "Medicine Ball Toss", category: "crossfit", patterns: ["general"], equipment: ["ball"], modality: "strength", level: "intermediate" }, { id: "slam-ball", name: "Slam Ball", category: "crossfit", patterns: ["general"], equipment: ["ball"], modality: "strength", level: "intermediate" }, { id: "rope-climb", name: "Rope Climb", category: "crossfit", patterns: ["general"], equipment: ["rope"], modality: "strength", level: "intermediate" }, { id: "legless-rope-climb", name: "Legless Rope Climb", category: "crossfit", patterns: ["general"], equipment: ["rope"], modality: "strength", level: "intermediate" }, { id: "l-sit-rope-climb", name: "L-sit Rope Climb", category: "crossfit", patterns: ["general"], equipment: ["rope"], modality: "strength", level: "intermediate" }, { id: "sandbag-clean", name: "Sandbag Clean", category: "crossfit", patterns: ["general"], equipment: ["sandbag"], modality: "strength", level: "intermediate" }, { id: "sandbag-carry", name: "Sandbag Carry", category: "crossfit", patterns: ["carry"], equipment: ["sandbag"], modality: "strength", level: "intermediate" }, { id: "sandbag-throw", name: "Sandbag Throw", category: "crossfit", patterns: ["pull", "cardio"], equipment: ["sandbag"], modality: "conditioning", level: "intermediate" }, { id: "sandbag-squat", name: "Sandbag Squat", category: "crossfit", patterns: ["squat"], equipment: ["sandbag"], modality: "strength", level: "intermediate" }, { id: "sled-push", name: "Sled Push", category: "crossfit", patterns: ["press"], equipment: ["sled"], modality: "strength", level: "intermediate" }, { id: "sled-pulldrag", name: "Sled Pull/Drag", category: "crossfit", patterns: ["pull"], equipment: ["sled"], modality: "strength", level: "intermediate" }, { id: "d-ball-clean", name: "D-Ball Clean", category: "crossfit", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "d-ball-throw", name: "D-Ball Throw", category: "crossfit", patterns: ["pull", "cardio"], equipment: ["bodyweight"], modality: "conditioning", level: "intermediate" }, { id: "d-ball-carry", name: "D-Ball Carry", category: "crossfit", patterns: ["carry"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "dumbbellkettlebellheavy-object-carry", name: "Dumbbell/Kettlebell/Heavy Object Carry", category: "crossfit", patterns: ["carry"], equipment: ["dumbbell", "kettlebell"], modality: "strength", level: "intermediate" }, { id: "tire-flip", name: "Tire Flip", category: "crossfit", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "axle-lift", name: "Axle Lift", category: "crossfit", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "yoke-carry", name: "Yoke Carry", category: "crossfit", patterns: ["carry"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "stone-liftatlas-stone", name: "Stone Lift/Atlas Stone", category: "crossfit", patterns: ["general"], equipment: ["bodyweight"], modality: "strength", level: "intermediate" }, { id: "leg-swings-forwardbackward", name: "Leg Swings (Forward/Backward", category: "mobility", patterns: ["mobility_dynamic"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "side-to-side", name: "Side-to-Side)", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "walking-high-knees", name: "Walking High Knees", category: "mobility", patterns: ["carry", "mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "beginner" }, { id: "butt-kicks", name: "Butt Kicks", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "lunge-with-twist", name: "Lunge with Twist", category: "mobility", patterns: ["squat", "lunge", "mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "cossack-squats", name: "Cossack Squats", category: "mobility", patterns: ["squat", "mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "walking-quad-stretch", name: "Walking Quad Stretch", category: "mobility", patterns: ["carry", "mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "walking-hamstring-sweeps", name: "Walking Hamstring Sweeps", category: "mobility", patterns: ["carry", "mobility_static"], equipment: ["ring"], modality: "mobility", level: "intermediate" }, { id: "frankenstein-walks", name: "Frankenstein Walks", category: "mobility", patterns: ["carry", "mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "hip-circles", name: "Hip Circles", category: "mobility", patterns: ["mobility_dynamic"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "openclose-gate", name: "Open/Close Gate", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "leg-kicks", name: "Leg Kicks", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "dynamic-pigeon-stretch", name: "Dynamic Pigeon Stretch", category: "mobility", patterns: ["mobility_dynamic"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "ankle-rockers", name: "Ankle Rockers", category: "mobility", patterns: ["mobility_dynamic"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "ankle-pumps", name: "Ankle Pumps", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "scorpion-kicks", name: "Scorpion Kicks", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "standing-hamstring-stretch", name: "Standing Hamstring Stretch", category: "mobility", patterns: ["mobility_static"], equipment: ["ring"], modality: "mobility", level: "intermediate" }, { id: "seated-hamstring-stretch", name: "Seated Hamstring Stretch", category: "mobility", patterns: ["mobility_static"], equipment: ["ring"], modality: "mobility", level: "intermediate" }, { id: "supine-hamstring-stretch", name: "Supine Hamstring Stretch", category: "mobility", patterns: ["mobility_static"], equipment: ["ring"], modality: "mobility", level: "intermediate" }, { id: "lying-hamstring-stretch", name: "Lying Hamstring Stretch", category: "mobility", patterns: ["mobility_static"], equipment: ["ring"], modality: "mobility", level: "intermediate" }, { id: "standing-quad-stretch", name: "Standing Quad Stretch", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "kneeling-hip-flexor-stretch", name: "Kneeling Hip Flexor Stretch", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "beginner" }, { id: "low-lunge", name: "Low Lunge", category: "mobility", patterns: ["squat", "lunge", "mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "standing-calf-stretch", name: "Standing Calf Stretch", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "wall-calf-stretch", name: "Wall Calf Stretch", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "beginner" }, { id: "seated-calf-stretch", name: "Seated Calf Stretch", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "butterfly-stretch", name: "Butterfly Stretch", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "frog-stretch", name: "Frog Stretch", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "9090-hip-stretch", name: "90/90 Hip Stretch", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "figure-4-stretch", name: "Figure-4 Stretch", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "reclined-pigeon-pose", name: "Reclined Pigeon Pose", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "seated-forward-fold", name: "Seated Forward Fold", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "wide-legged-forward-fold", name: "Wide-Legged Forward Fold", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "lizard-pose", name: "Lizard Pose", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "dragon-pose", name: "Dragon Pose", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "happy-baby-pose", name: "Happy Baby Pose", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "supine-twist", name: "Supine Twist", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "it-band-stretch", name: "IT Band Stretch", category: "mobility", patterns: ["mobility_static"], equipment: ["band"], modality: "mobility", level: "beginner" }, { id: "adductor-stretch", name: "Adductor Stretch", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "hip-cars", name: "Hip CARs", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "9090-hip-rotation", name: "90/90 Hip Rotation", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "fire-hydrants", name: "Fire Hydrants", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "clamshells", name: "Clamshells", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "frog-rocks", name: "Frog Rocks", category: "mobility", patterns: ["mobility_dynamic"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "shin-box-transitions", name: "Shin Box Transitions", category: "mobility", patterns: ["squat", "mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "beginner" }, { id: "hip-airplanes", name: "Hip Airplanes", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "walking-hip-openers", name: "Walking Hip Openers", category: "mobility", patterns: ["carry", "mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "seated-hip-flexor-rocks", name: "Seated Hip Flexor Rocks", category: "mobility", patterns: ["mobility_dynamic"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "posterior-hip-capsule-stretch", name: "Posterior Hip Capsule Stretch", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "deep-squat-hold", name: "Deep Squat Hold", category: "mobility", patterns: ["squat", "mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "ankle-circles", name: "Ankle Circles", category: "mobility", patterns: ["mobility_dynamic"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "alphabet-ankles", name: "Alphabet Ankles", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "ankle-dorsiflexion-wall-stretch", name: "Ankle Dorsiflexion Wall Stretch", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "beginner" }, { id: "ankle-dorsiflexion", name: "Ankle Dorsiflexion", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "ankle-inversioneversion", name: "Ankle Inversion/Eversion", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "toe-raises", name: "Toe Raises", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "heel-walks", name: "Heel Walks", category: "mobility", patterns: ["carry", "mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "downward-dog-pedals", name: "Downward Dog Pedals", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "knee-flexionextension", name: "Knee Flexion/Extension", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "beginner" }, { id: "knee-circles", name: "Knee Circles", category: "mobility", patterns: ["mobility_dynamic"], equipment: ["bodyweight"], modality: "mobility", level: "beginner" }, { id: "quad-sets", name: "Quad Sets", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "arm-circles", name: "Arm Circles", category: "mobility", patterns: ["mobility_dynamic"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "arm-swings", name: "Arm Swings", category: "mobility", patterns: ["mobility_dynamic"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "shoulder-pass-throughs", name: "Shoulder Pass-Throughs", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "scapular-push-ups", name: "Scapular Push-Ups", category: "mobility", patterns: ["press", "mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "thread-the-needle", name: "Thread the Needle", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "quadruped-thoracic-rotations", name: "Quadruped Thoracic Rotations", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "trunk-rotations", name: "Trunk Rotations", category: "mobility", patterns: ["cardio", "mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "cross-arm-shoulder-stretch", name: "Cross-Arm Shoulder Stretch", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "overhead-tricep-stretch", name: "Overhead Tricep Stretch", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "behind-back-shoulder-stretch", name: "Behind-Back Shoulder Stretch", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "doorway-pec-stretch", name: "Doorway Pec Stretch", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "eagle-arms", name: "Eagle Arms", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "cow-face-arms", name: "Cow Face Arms", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "clasped-hands-behind-back", name: "Clasped Hands Behind Back", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "wall-angels", name: "Wall Angels", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "beginner" }, { id: "childs-pose", name: "Child's Pose", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "shoulder-cars", name: "Shoulder CARs", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "wall-slides", name: "Wall Slides", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "beginner" }, { id: "shoulder-dislocates", name: "Shoulder Dislocates", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "pendulum-swings", name: "Pendulum Swings", category: "mobility", patterns: ["mobility_dynamic"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "sleeper-stretch", name: "Sleeper Stretch", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "lat-stretch", name: "Lat Stretch", category: "mobility", patterns: ["pull", "mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "wrist-circles", name: "Wrist Circles", category: "mobility", patterns: ["mobility_dynamic"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "wrist-flexionextension-stretches", name: "Wrist Flexion/Extension Stretches", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "wrist-flexor-stretch", name: "Wrist Flexor Stretch", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "prayer-position-stretch", name: "Prayer Position Stretch", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "reverse-prayer-stretch", name: "Reverse Prayer Stretch", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "quadruped-wrist-mobilization", name: "Quadruped Wrist Mobilization", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "bicep-stretch", name: "Bicep Stretch", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "cat-cow-pose", name: "Cat-Cow Pose", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "thoracic-bridge", name: "Thoracic Bridge", category: "mobility", patterns: ["hinge", "mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "book-openers", name: "Book Openers", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "foam-roller-thoracic-extensions", name: "Foam Roller Thoracic Extensions", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "quadruped-thoracic-rotation", name: "Quadruped Thoracic Rotation", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "seated-thoracic-rotation", name: "Seated Thoracic Rotation", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "side-lying-thoracic-rotation", name: "Side-Lying Thoracic Rotation", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "neck-circles", name: "Neck Circles", category: "mobility", patterns: ["mobility_dynamic"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "neck-tilts", name: "Neck Tilts", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "neck-flexionextension", name: "Neck Flexion/Extension", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "chin-tucks", name: "Chin Tucks", category: "mobility", patterns: ["pull", "mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "neck-rotations", name: "Neck Rotations", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "levator-scapulae-stretch", name: "Levator Scapulae Stretch", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "knee-to-chest-stretch", name: "Knee-to-Chest Stretch", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "beginner" }, { id: "supine-spinal-twist", name: "Supine Spinal Twist", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "cobra-pose", name: "Cobra Pose", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "sphinx-pose", name: "Sphinx Pose", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "pelvic-tilts", name: "Pelvic Tilts", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "calves", name: "Calves", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "hamstrings", name: "Hamstrings", category: "mobility", patterns: ["mobility_static"], equipment: ["ring"], modality: "mobility", level: "intermediate" }, { id: "quadriceps", name: "Quadriceps", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "it-band", name: "IT Band", category: "mobility", patterns: ["mobility_static"], equipment: ["band"], modality: "mobility", level: "beginner" }, { id: "adductors", name: "Adductors", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "glutes", name: "Glutes", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "hip-flexors", name: "Hip Flexors", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "tfl", name: "TFL", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "upper-backrhomboids", name: "Upper Back/Rhomboids", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "lats", name: "Lats", category: "mobility", patterns: ["pull", "mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "thoracic-spine", name: "Thoracic Spine", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "shouldersdeltoids", name: "Shoulders/Deltoids", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "pecs", name: "Pecs", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "triceps", name: "Triceps", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "forearms", name: "Forearms", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "mid-back-roller", name: "Mid-Back Roller", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "lower-back", name: "Lower Back", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "neck", name: "Neck", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "hold-relax", name: "Hold-Relax", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "contract-relax-antagonist-contract", name: "Contract-Relax-Antagonist-Contract", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "hold-relax-swing", name: "Hold-Relax-Swing", category: "mobility", patterns: ["mobility_dynamic"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "hamstring-pnf-stretch", name: "Hamstring PNF Stretch", category: "mobility", patterns: ["mobility_static"], equipment: ["ring"], modality: "mobility", level: "intermediate" }, { id: "hip-flexor-pnf", name: "Hip Flexor PNF", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "shoulder-pnf", name: "Shoulder PNF", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "calf-pnf", name: "Calf PNF", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "quadriceps-pnf", name: "Quadriceps PNF", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "adductor-pnf", name: "Adductor PNF", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "shoulder-circles", name: "Shoulder Circles", category: "mobility", patterns: ["mobility_dynamic"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "elbow-circles", name: "Elbow Circles", category: "mobility", patterns: ["mobility_dynamic"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "neck-circlesrolls", name: "Neck Circles/Rolls", category: "mobility", patterns: ["mobility_dynamic"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "toe-circles", name: "Toe Circles", category: "mobility", patterns: ["mobility_dynamic"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "torso-circles", name: "Torso Circles", category: "mobility", patterns: ["mobility_dynamic"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "pelvic-circles", name: "Pelvic Circles", category: "mobility", patterns: ["mobility_dynamic"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "ribcage-circles", name: "Ribcage Circles", category: "mobility", patterns: ["mobility_dynamic"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "glute-bridges", name: "Glute Bridges", category: "mobility", patterns: ["hinge", "mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "banded-glute-bridge", name: "Banded Glute Bridge", category: "mobility", patterns: ["hinge", "mobility_static"], equipment: ["band"], modality: "mobility", level: "beginner" }, { id: "glute-bridge-with-abduction", name: "Glute Bridge with Abduction", category: "mobility", patterns: ["hinge", "mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "hip-thrusts", name: "Hip Thrusts", category: "mobility", patterns: ["hinge", "mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "donkey-kicks", name: "Donkey Kicks", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "monster-walks", name: "Monster Walks", category: "mobility", patterns: ["carry", "mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "lateral-band-walks", name: "Lateral Band Walks", category: "mobility", patterns: ["pull", "carry", "mobility_static"], equipment: ["band"], modality: "mobility", level: "beginner" }, { id: "frog-pumps", name: "Frog Pumps", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "scapular-wall-slides", name: "Scapular Wall Slides", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "beginner" }, { id: "ytwls", name: "YTWLs", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "prone-cobras", name: "Prone Cobras", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "superman-hold", name: "Superman Hold", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "blackburns", name: "Blackburns", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "dead-bugs", name: "Dead Bugs", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "bird-dogs", name: "Bird Dogs", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "plank-variations", name: "Plank Variations", category: "mobility", patterns: ["core", "mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "side-planks", name: "Side Planks", category: "mobility", patterns: ["core", "mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "lizard-crawl", name: "Lizard Crawl", category: "mobility", patterns: ["mobility_dynamic"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "spider-man-crawl", name: "Spider-Man Crawl", category: "mobility", patterns: ["mobility_dynamic"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "monkey-walks", name: "Monkey Walks", category: "mobility", patterns: ["carry", "mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "frogger", name: "Frogger", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "inchworm", name: "Inchworm", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "alligator-crawl", name: "Alligator Crawl", category: "mobility", patterns: ["mobility_dynamic"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "seal-slide", name: "Seal Slide", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "snake-slither", name: "Snake Slither", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "tiger-crawl", name: "Tiger Crawl", category: "mobility", patterns: ["mobility_dynamic"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "turtle-crawl", name: "Turtle Crawl", category: "mobility", patterns: ["mobility_dynamic"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "gorilla-walk", name: "Gorilla Walk", category: "mobility", patterns: ["carry", "mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "animal-flow-sequences", name: "Animal Flow Sequences", category: "mobility", patterns: ["mobility_dynamic"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "scorpion-reach", name: "Scorpion Reach", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "beast-wave", name: "Beast Wave", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "side-kickthrough", name: "Side Kickthrough", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "traveling-beast", name: "Traveling Beast", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "traveling-crab", name: "Traveling Crab", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "kangaroo-jumps", name: "Kangaroo Jumps", category: "mobility", patterns: ["jump", "mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "elephant-swings", name: "Elephant Swings", category: "mobility", patterns: ["mobility_dynamic"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "penguin-walk", name: "Penguin Walk", category: "mobility", patterns: ["carry", "mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "horse-rungalloping", name: "Horse Run/Galloping", category: "mobility", patterns: ["cardio", "mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "basic-belly-breathing", name: "Basic Belly Breathing", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "pursed-lip-breathing", name: "Pursed-Lip Breathing", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "9090-breathing", name: "90/90 Breathing", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "4-7-8-breathing", name: "4-7-8 Breathing", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "box-breathing", name: "Box Breathing", category: "mobility", patterns: ["squat", "mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "beginner" }, { id: "physiological-sigh", name: "Physiological Sigh", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "humming-breath", name: "Humming Breath", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "balloon-breathing", name: "Balloon Breathing", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "coordinated-breathing", name: "Coordinated Breathing", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "ribcage-breathing", name: "Ribcage Breathing", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "sun-salutation-a-b", name: "Sun Salutation A & B", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "worlds-greatest-stretch-sequence", name: "World's Greatest Stretch Sequence", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "spiderman-lunge-to-reach", name: "Spiderman Lunge to Reach", category: "mobility", patterns: ["squat", "lunge", "mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "inchworm-to-push-up", name: "Inchworm to Push-Up", category: "mobility", patterns: ["press", "mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "bear-crawl-to-downward-dog", name: "Bear Crawl to Downward Dog", category: "mobility", patterns: ["mobility_dynamic"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }, { id: "turkish-get-up", name: "Turkish Get-Up", category: "mobility", patterns: ["mobility_static"], equipment: ["bodyweight"], modality: "mobility", level: "intermediate" }];
  }
});

// server/ai/movementService.ts
function findMovement(exerciseName) {
  const normalized = exerciseName.toLowerCase().trim();
  let match2 = MOVES.find((m2) => m2.name.toLowerCase() === normalized);
  if (match2) return match2;
  match2 = MOVES.find(
    (m2) => m2.aliases?.some((alias) => alias.toLowerCase() === normalized)
  );
  if (match2) return match2;
  match2 = MOVES.find(
    (m2) => m2.name.toLowerCase().includes(normalized) || normalized.includes(m2.name.toLowerCase())
  );
  return match2;
}
var import_seedrandom, MOVES;
var init_movementService = __esm({
  "server/ai/movementService.ts"() {
    "use strict";
    import_seedrandom = __toESM(require_seedrandom2(), 1);
    init_movements_registry_min();
    MOVES = movements_registry_min_default;
  }
});

// server/data/movements.registry.json
var movements_registry_default;
var init_movements_registry = __esm({
  "server/data/movements.registry.json"() {
    movements_registry_default = [
      {
        id: "snatch",
        name: "Snatch",
        category: "olympic_weightlifting",
        patterns: [
          "olympic_snatch"
        ],
        equipment: [
          "barbell"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "clean-jerk",
        name: "Clean & Jerk",
        category: "olympic_weightlifting",
        patterns: [
          "olympic_cleanjerk"
        ],
        equipment: [
          "barbell"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "power-snatch",
        name: "Power Snatch",
        category: "olympic_weightlifting",
        patterns: [
          "olympic_snatch"
        ],
        equipment: [
          "barbell"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "squat-snatch",
        name: "Squat Snatch",
        category: "olympic_weightlifting",
        patterns: [
          "olympic_snatch",
          "squat"
        ],
        equipment: [
          "barbell"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "split-snatch",
        name: "Split Snatch",
        category: "olympic_weightlifting",
        patterns: [
          "olympic_snatch"
        ],
        equipment: [
          "barbell"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "muscle-snatch",
        name: "Muscle Snatch",
        category: "olympic_weightlifting",
        patterns: [
          "olympic_snatch"
        ],
        equipment: [
          "barbell"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "tall-snatch",
        name: "Tall Snatch",
        category: "olympic_weightlifting",
        patterns: [
          "olympic_snatch"
        ],
        equipment: [
          "barbell"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "high-hang-snatch",
        name: "High Hang Snatch",
        category: "olympic_weightlifting",
        patterns: [
          "olympic_snatch"
        ],
        equipment: [
          "barbell"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "hang-snatch",
        name: "Hang Snatch",
        category: "olympic_weightlifting",
        patterns: [
          "olympic_snatch"
        ],
        equipment: [
          "barbell"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "low-hang-snatch",
        name: "Low Hang Snatch",
        category: "olympic_weightlifting",
        patterns: [
          "olympic_snatch"
        ],
        equipment: [
          "barbell"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "floating-snatch",
        name: "Floating Snatch",
        category: "olympic_weightlifting",
        patterns: [
          "olympic_snatch"
        ],
        equipment: [
          "barbell"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "block-snatch",
        name: "Block Snatch",
        category: "olympic_weightlifting",
        patterns: [
          "olympic_snatch"
        ],
        equipment: [
          "barbell"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "snatch-from-floor",
        name: "Snatch from Floor",
        category: "olympic_weightlifting",
        patterns: [
          "olympic_snatch"
        ],
        equipment: [
          "barbell"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "hang-power-snatch",
        name: "Hang Power Snatch",
        category: "olympic_weightlifting",
        patterns: [
          "olympic_snatch"
        ],
        equipment: [
          "barbell"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "high-hang-power-snatch",
        name: "High Hang Power Snatch",
        category: "olympic_weightlifting",
        patterns: [
          "olympic_snatch"
        ],
        equipment: [
          "barbell"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "block-power-snatch",
        name: "Block Power Snatch",
        category: "olympic_weightlifting",
        patterns: [
          "olympic_snatch"
        ],
        equipment: [
          "barbell"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "hang-muscle-snatch",
        name: "Hang Muscle Snatch",
        category: "olympic_weightlifting",
        patterns: [
          "olympic_snatch"
        ],
        equipment: [
          "barbell"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "power-snatch-overhead-squat",
        name: "Power Snatch + Overhead Squat",
        category: "olympic_weightlifting",
        patterns: [
          "olympic_snatch",
          "squat"
        ],
        equipment: [
          "barbell"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "power-clean",
        name: "Power Clean",
        category: "olympic_weightlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "squat-clean",
        name: "Squat Clean",
        category: "olympic_weightlifting",
        patterns: [
          "squat"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "split-clean",
        name: "Split Clean",
        category: "olympic_weightlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "muscle-clean",
        name: "Muscle Clean",
        category: "olympic_weightlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "tall-clean",
        name: "Tall Clean",
        category: "olympic_weightlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "high-hang-clean",
        name: "High Hang Clean",
        category: "olympic_weightlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "hang-clean",
        name: "Hang Clean",
        category: "olympic_weightlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "low-hang-clean",
        name: "Low Hang Clean",
        category: "olympic_weightlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "floating-clean",
        name: "Floating Clean",
        category: "olympic_weightlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "block-clean",
        name: "Block Clean",
        category: "olympic_weightlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "clean-from-floor",
        name: "Clean from Floor",
        category: "olympic_weightlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "hang-power-clean",
        name: "Hang Power Clean",
        category: "olympic_weightlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "high-hang-power-clean",
        name: "High Hang Power Clean",
        category: "olympic_weightlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "block-power-clean",
        name: "Block Power Clean",
        category: "olympic_weightlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "hang-muscle-clean",
        name: "Hang Muscle Clean",
        category: "olympic_weightlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "power-clean-front-squat",
        name: "Power Clean + Front Squat",
        category: "olympic_weightlifting",
        patterns: [
          "squat"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "split-jerk",
        name: "Split Jerk",
        category: "olympic_weightlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "power-jerkpush-jerk",
        name: "Power Jerk/Push Jerk",
        category: "olympic_weightlifting",
        patterns: [
          "press"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "squat-jerk",
        name: "Squat Jerk",
        category: "olympic_weightlifting",
        patterns: [
          "squat"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "push-press",
        name: "Push Press",
        category: "olympic_weightlifting",
        patterns: [
          "press"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "jerk-behind-the-neck",
        name: "Jerk behind the Neck",
        category: "olympic_weightlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "jerk-balance",
        name: "Jerk Balance",
        category: "olympic_weightlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "jerk-dip",
        name: "Jerk Dip",
        category: "olympic_weightlifting",
        patterns: [
          "press"
        ],
        equipment: [
          "barbell",
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "jerk-drive",
        name: "Jerk Drive",
        category: "olympic_weightlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "tall-jerk",
        name: "Tall Jerk",
        category: "olympic_weightlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "jerk-recovery",
        name: "Jerk Recovery",
        category: "olympic_weightlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "jerk-support",
        name: "Jerk Support",
        category: "olympic_weightlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "back-squat",
        name: "Back Squat",
        category: "olympic_weightlifting",
        patterns: [
          "squat"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "front-squat",
        name: "Front Squat",
        category: "olympic_weightlifting",
        patterns: [
          "squat"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "overhead-squat",
        name: "Overhead Squat",
        category: "olympic_weightlifting",
        patterns: [
          "squat"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "pause-squat",
        name: "Pause Squat",
        category: "olympic_weightlifting",
        patterns: [
          "squat"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "tempo-squat",
        name: "Tempo Squat",
        category: "olympic_weightlifting",
        patterns: [
          "squat"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "box-squat",
        name: "Box Squat",
        category: "olympic_weightlifting",
        patterns: [
          "squat"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "safety-bar-squat",
        name: "Safety Bar Squat",
        category: "olympic_weightlifting",
        patterns: [
          "squat"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "snatch-pull",
        name: "Snatch Pull",
        category: "olympic_weightlifting",
        patterns: [
          "olympic_snatch",
          "pull"
        ],
        equipment: [
          "barbell"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "snatch-high-pull",
        name: "Snatch High Pull",
        category: "olympic_weightlifting",
        patterns: [
          "olympic_snatch",
          "pull"
        ],
        equipment: [
          "barbell"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "snatch-deadlift",
        name: "Snatch Deadlift",
        category: "olympic_weightlifting",
        patterns: [
          "olympic_snatch",
          "hinge"
        ],
        equipment: [
          "barbell"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "hang-snatch-pull",
        name: "Hang Snatch Pull",
        category: "olympic_weightlifting",
        patterns: [
          "olympic_snatch",
          "pull"
        ],
        equipment: [
          "barbell"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "block-snatch-pull",
        name: "Block Snatch Pull",
        category: "olympic_weightlifting",
        patterns: [
          "olympic_snatch",
          "pull"
        ],
        equipment: [
          "barbell"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "deficit-snatch-pull",
        name: "Deficit Snatch Pull",
        category: "olympic_weightlifting",
        patterns: [
          "olympic_snatch",
          "pull"
        ],
        equipment: [
          "barbell"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "pause-snatch-pull",
        name: "Pause Snatch Pull",
        category: "olympic_weightlifting",
        patterns: [
          "olympic_snatch",
          "pull"
        ],
        equipment: [
          "barbell"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "segment-snatch-pull",
        name: "Segment Snatch Pull",
        category: "olympic_weightlifting",
        patterns: [
          "olympic_snatch",
          "pull"
        ],
        equipment: [
          "barbell"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "halting-snatch-deadlift",
        name: "Halting Snatch Deadlift",
        category: "olympic_weightlifting",
        patterns: [
          "olympic_snatch",
          "hinge"
        ],
        equipment: [
          "barbell"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "clean-pull",
        name: "Clean Pull",
        category: "olympic_weightlifting",
        patterns: [
          "olympic_cleanjerk",
          "pull"
        ],
        equipment: [
          "barbell"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "clean-high-pull",
        name: "Clean High Pull",
        category: "olympic_weightlifting",
        patterns: [
          "olympic_cleanjerk",
          "pull"
        ],
        equipment: [
          "barbell"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "clean-deadlift",
        name: "Clean Deadlift",
        category: "olympic_weightlifting",
        patterns: [
          "hinge"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "hang-clean-pull",
        name: "Hang Clean Pull",
        category: "olympic_weightlifting",
        patterns: [
          "olympic_cleanjerk",
          "pull"
        ],
        equipment: [
          "barbell"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "block-clean-pull",
        name: "Block Clean Pull",
        category: "olympic_weightlifting",
        patterns: [
          "olympic_cleanjerk",
          "pull"
        ],
        equipment: [
          "barbell"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "deficit-clean-pull",
        name: "Deficit Clean Pull",
        category: "olympic_weightlifting",
        patterns: [
          "olympic_cleanjerk",
          "pull"
        ],
        equipment: [
          "barbell"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "pause-clean-pull",
        name: "Pause Clean Pull",
        category: "olympic_weightlifting",
        patterns: [
          "olympic_cleanjerk",
          "pull"
        ],
        equipment: [
          "barbell"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "segment-clean-pull",
        name: "Segment Clean Pull",
        category: "olympic_weightlifting",
        patterns: [
          "olympic_cleanjerk",
          "pull"
        ],
        equipment: [
          "barbell"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "halting-clean-deadlift",
        name: "Halting Clean Deadlift",
        category: "olympic_weightlifting",
        patterns: [
          "hinge"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "romanian-deadlift",
        name: "Romanian Deadlift",
        category: "olympic_weightlifting",
        patterns: [
          "hinge"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "stiff-legged-deadlift",
        name: "Stiff-Legged Deadlift",
        category: "olympic_weightlifting",
        patterns: [
          "hinge"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "trap-bar-deadlift",
        name: "Trap Bar Deadlift",
        category: "olympic_weightlifting",
        patterns: [
          "hinge"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "strict-press",
        name: "Strict Press",
        category: "olympic_weightlifting",
        patterns: [
          "press"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "military-press",
        name: "Military Press",
        category: "olympic_weightlifting",
        patterns: [
          "press"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "snatch-grip-push-press",
        name: "Snatch Grip Push Press",
        category: "olympic_weightlifting",
        patterns: [
          "olympic_snatch",
          "press"
        ],
        equipment: [
          "barbell"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "snatch-grip-press",
        name: "Snatch Grip Press",
        category: "olympic_weightlifting",
        patterns: [
          "olympic_snatch",
          "press"
        ],
        equipment: [
          "barbell"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "z-press",
        name: "Z-Press",
        category: "olympic_weightlifting",
        patterns: [
          "press"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "seated-press",
        name: "Seated Press",
        category: "olympic_weightlifting",
        patterns: [
          "press"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "single-arm-press",
        name: "Single Arm Press",
        category: "olympic_weightlifting",
        patterns: [
          "press"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "advanced"
      },
      {
        id: "pressing-snatch-balance",
        name: "Pressing Snatch Balance",
        category: "olympic_weightlifting",
        patterns: [
          "olympic_snatch",
          "press"
        ],
        equipment: [
          "barbell"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "heaving-snatch-balance",
        name: "Heaving Snatch Balance",
        category: "olympic_weightlifting",
        patterns: [
          "olympic_snatch"
        ],
        equipment: [
          "barbell"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "snatch-balance",
        name: "Snatch Balance",
        category: "olympic_weightlifting",
        patterns: [
          "olympic_snatch"
        ],
        equipment: [
          "barbell"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "drop-snatch",
        name: "Drop Snatch",
        category: "olympic_weightlifting",
        patterns: [
          "olympic_snatch"
        ],
        equipment: [
          "barbell"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "snatch-push-press",
        name: "Snatch Push Press",
        category: "olympic_weightlifting",
        patterns: [
          "olympic_snatch",
          "press"
        ],
        equipment: [
          "barbell"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "sots-press",
        name: "Sots Press",
        category: "olympic_weightlifting",
        patterns: [
          "press"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "snatch-grip-behind-the-neck-press",
        name: "Snatch Grip Behind-the-Neck Press",
        category: "olympic_weightlifting",
        patterns: [
          "olympic_snatch",
          "press"
        ],
        equipment: [
          "barbell"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "snatch-pull-snatch",
        name: "Snatch Pull + Snatch",
        category: "olympic_weightlifting",
        patterns: [
          "olympic_snatch",
          "pull"
        ],
        equipment: [
          "barbell"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "snatch-overhead-squat",
        name: "Snatch + Overhead Squat",
        category: "olympic_weightlifting",
        patterns: [
          "olympic_snatch",
          "squat"
        ],
        equipment: [
          "barbell"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "power-snatch-snatch",
        name: "Power Snatch + Snatch",
        category: "olympic_weightlifting",
        patterns: [
          "olympic_snatch"
        ],
        equipment: [
          "barbell"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "hang-snatch-snatch",
        name: "Hang Snatch + Snatch",
        category: "olympic_weightlifting",
        patterns: [
          "olympic_snatch"
        ],
        equipment: [
          "barbell"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "2-snatch-pulls-1-snatch",
        name: "2 Snatch Pulls + 1 Snatch",
        category: "olympic_weightlifting",
        patterns: [
          "olympic_snatch",
          "pull"
        ],
        equipment: [
          "barbell"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "clean-pull-clean",
        name: "Clean Pull + Clean",
        category: "olympic_weightlifting",
        patterns: [
          "olympic_cleanjerk",
          "pull"
        ],
        equipment: [
          "barbell"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "power-clean-clean",
        name: "Power Clean + Clean",
        category: "olympic_weightlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "hang-clean-clean",
        name: "Hang Clean + Clean",
        category: "olympic_weightlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "clean-front-squat",
        name: "Clean + Front Squat",
        category: "olympic_weightlifting",
        patterns: [
          "squat"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "hang-clean-clean-jerk",
        name: "Hang Clean + Clean + Jerk",
        category: "olympic_weightlifting",
        patterns: [
          "olympic_cleanjerk"
        ],
        equipment: [
          "barbell"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "pull-ups",
        name: "Pull-ups",
        category: "olympic_weightlifting",
        patterns: [
          "pull"
        ],
        equipment: [
          "barbell",
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "chin-ups",
        name: "Chin-ups",
        category: "olympic_weightlifting",
        patterns: [
          "pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "rows",
        name: "Rows",
        category: "olympic_weightlifting",
        patterns: [
          "pull",
          "cardio"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "lat-pulldowns",
        name: "Lat Pulldowns",
        category: "olympic_weightlifting",
        patterns: [
          "pull"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "face-pulls",
        name: "Face Pulls",
        category: "olympic_weightlifting",
        patterns: [
          "pull"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "band-pull-aparts",
        name: "Band Pull-Aparts",
        category: "olympic_weightlifting",
        patterns: [
          "pull"
        ],
        equipment: [
          "band"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "dips",
        name: "Dips",
        category: "olympic_weightlifting",
        patterns: [
          "press"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "bench-press",
        name: "Bench Press",
        category: "olympic_weightlifting",
        patterns: [
          "press"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "lunges",
        name: "Lunges",
        category: "olympic_weightlifting",
        patterns: [
          "squat",
          "lunge"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "bulgarian-split-squats",
        name: "Bulgarian Split Squats",
        category: "olympic_weightlifting",
        patterns: [
          "squat",
          "lunge"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "step-ups",
        name: "Step-ups",
        category: "olympic_weightlifting",
        patterns: [
          "squat"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "leg-press",
        name: "Leg Press",
        category: "olympic_weightlifting",
        patterns: [
          "press"
        ],
        equipment: [
          "machine"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "good-mornings",
        name: "Good Mornings",
        category: "olympic_weightlifting",
        patterns: [
          "hinge"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "back-extensions",
        name: "Back Extensions",
        category: "olympic_weightlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "glute-ham-raises",
        name: "Glute-Ham Raises",
        category: "olympic_weightlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "nordic-curls",
        name: "Nordic Curls",
        category: "olympic_weightlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "planks",
        name: "Planks",
        category: "olympic_weightlifting",
        patterns: [
          "core"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "ab-wheel-rollouts",
        name: "Ab Wheel Rollouts",
        category: "olympic_weightlifting",
        patterns: [
          "core"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "hanging-leg-raises",
        name: "Hanging Leg Raises",
        category: "olympic_weightlifting",
        patterns: [
          "core"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "russian-twists",
        name: "Russian Twists",
        category: "olympic_weightlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "pallof-press",
        name: "Pallof Press",
        category: "olympic_weightlifting",
        patterns: [
          "press"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "weighted-sit-ups",
        name: "Weighted Sit-ups",
        category: "olympic_weightlifting",
        patterns: [
          "core"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "advanced"
      },
      {
        id: "box-jumps",
        name: "Box Jumps",
        category: "olympic_weightlifting",
        patterns: [
          "squat",
          "jump"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "broad-jumps",
        name: "Broad Jumps",
        category: "olympic_weightlifting",
        patterns: [
          "jump"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "vertical-jumps",
        name: "Vertical Jumps",
        category: "olympic_weightlifting",
        patterns: [
          "jump"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "depth-jumps",
        name: "Depth Jumps",
        category: "olympic_weightlifting",
        patterns: [
          "jump"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "medicine-ball-throws",
        name: "Medicine Ball Throws",
        category: "olympic_weightlifting",
        patterns: [
          "pull",
          "cardio"
        ],
        equipment: [
          "ball"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "",
        name: "---",
        category: "olympic_weightlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "deadlift",
        name: "Deadlift",
        category: "powerlifting",
        patterns: [
          "hinge"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "high-bar-squat",
        name: "High Bar Squat",
        category: "powerlifting",
        patterns: [
          "squat"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "safety-squat-bar-squat",
        name: "Safety Squat Bar  Squat",
        category: "powerlifting",
        patterns: [
          "squat"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "zercher-squat",
        name: "Zercher Squat",
        category: "powerlifting",
        patterns: [
          "squat"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "giant-cambered-bar-squat",
        name: "Giant Cambered Bar Squat",
        category: "powerlifting",
        patterns: [
          "squat"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "bow-bar-squat",
        name: "Bow Bar Squat",
        category: "powerlifting",
        patterns: [
          "squat"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "low-pin-squatdead-squat",
        name: "Low Pin Squat/Dead Squat",
        category: "powerlifting",
        patterns: [
          "squat"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "anderson-squat",
        name: "Anderson Squat",
        category: "powerlifting",
        patterns: [
          "squat"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "pause-above-parallel",
        name: "Pause Above Parallel",
        category: "powerlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "3-count-pause-squat",
        name: "3-Count Pause Squat",
        category: "powerlifting",
        patterns: [
          "squat"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "wide-stance-squat",
        name: "Wide Stance Squat",
        category: "powerlifting",
        patterns: [
          "squat"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "narrow-stance-squat",
        name: "Narrow Stance Squat",
        category: "powerlifting",
        patterns: [
          "squat",
          "pull",
          "cardio"
        ],
        equipment: [
          "barbell"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "squat-vs-chains",
        name: "Squat vs. Chains",
        category: "powerlifting",
        patterns: [
          "squat"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "squat-vs-bands",
        name: "Squat vs. Bands",
        category: "powerlifting",
        patterns: [
          "squat"
        ],
        equipment: [
          "band"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "squat-with-weight-releasers",
        name: "Squat with Weight Releasers",
        category: "powerlifting",
        patterns: [
          "squat"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "close-grip-bench-press",
        name: "Close-Grip Bench Press",
        category: "powerlifting",
        patterns: [
          "press"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "wide-grip-bench-press",
        name: "Wide-Grip Bench Press",
        category: "powerlifting",
        patterns: [
          "press"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "medium-grip-bench-press",
        name: "Medium-Grip Bench Press",
        category: "powerlifting",
        patterns: [
          "press"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "incline-bench-press",
        name: "Incline Bench Press",
        category: "powerlifting",
        patterns: [
          "press"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "decline-bench-press",
        name: "Decline Bench Press",
        category: "powerlifting",
        patterns: [
          "press"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "floor-press",
        name: "Floor Press",
        category: "powerlifting",
        patterns: [
          "press"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "axle-bar-bench",
        name: "Axle Bar Bench",
        category: "powerlifting",
        patterns: [
          "press"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "swiss-barfootball-bar-press",
        name: "Swiss Bar/Football Bar Press",
        category: "powerlifting",
        patterns: [
          "press"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "dumbbell-bench-press",
        name: "Dumbbell Bench Press",
        category: "powerlifting",
        patterns: [
          "press"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "pause-bench-press",
        name: "Pause Bench Press",
        category: "powerlifting",
        patterns: [
          "press"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "3-count-pause-bench",
        name: "3-Count Pause Bench",
        category: "powerlifting",
        patterns: [
          "press"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "tempo-bench",
        name: "Tempo Bench",
        category: "powerlifting",
        patterns: [
          "press"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "spoto-press",
        name: "Spoto Press",
        category: "powerlifting",
        patterns: [
          "press"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "board-press",
        name: "Board Press",
        category: "powerlifting",
        patterns: [
          "press"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "pin-press",
        name: "Pin Press",
        category: "powerlifting",
        patterns: [
          "press"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "dead-bench",
        name: "Dead Bench",
        category: "powerlifting",
        patterns: [
          "press"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "feet-up-bench",
        name: "Feet-Up Bench",
        category: "powerlifting",
        patterns: [
          "press"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "slingshot-bench",
        name: "Slingshot Bench",
        category: "powerlifting",
        patterns: [
          "press"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "reverse-band-bench",
        name: "Reverse Band Bench",
        category: "powerlifting",
        patterns: [
          "press"
        ],
        equipment: [
          "band"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "conventional-deadlift",
        name: "Conventional Deadlift",
        category: "powerlifting",
        patterns: [
          "hinge"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "sumo-deadlift",
        name: "Sumo Deadlift",
        category: "powerlifting",
        patterns: [
          "hinge"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "semi-sumo-deadlift",
        name: "Semi-Sumo Deadlift",
        category: "powerlifting",
        patterns: [
          "hinge"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "deficit-deadlift",
        name: "Deficit Deadlift",
        category: "powerlifting",
        patterns: [
          "hinge"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "advanced"
      },
      {
        id: "block-pullrack-pull",
        name: "Block Pull/Rack Pull",
        category: "powerlifting",
        patterns: [
          "pull"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "mat-deadlift",
        name: "Mat Deadlift",
        category: "powerlifting",
        patterns: [
          "hinge"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "pause-deadlift",
        name: "Pause Deadlift",
        category: "powerlifting",
        patterns: [
          "hinge"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "halting-deadlift",
        name: "Halting Deadlift",
        category: "powerlifting",
        patterns: [
          "hinge"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "tempo-deadlift",
        name: "Tempo Deadlift",
        category: "powerlifting",
        patterns: [
          "hinge"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "axle-bar-deadlift",
        name: "Axle Bar Deadlift",
        category: "powerlifting",
        patterns: [
          "hinge"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "snatch-grip-deadlift",
        name: "Snatch Grip Deadlift",
        category: "powerlifting",
        patterns: [
          "olympic_snatch",
          "hinge"
        ],
        equipment: [
          "barbell"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "stiff-leg-deadlift",
        name: "Stiff-Leg Deadlift",
        category: "powerlifting",
        patterns: [
          "hinge"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "box-deadlift",
        name: "Box Deadlift",
        category: "powerlifting",
        patterns: [
          "squat",
          "hinge"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "deadlift-vs-chains",
        name: "Deadlift vs. Chains",
        category: "powerlifting",
        patterns: [
          "hinge"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "deadlift-vs-bands",
        name: "Deadlift vs. Bands",
        category: "powerlifting",
        patterns: [
          "hinge"
        ],
        equipment: [
          "band"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "hack-squat",
        name: "Hack Squat",
        category: "powerlifting",
        patterns: [
          "squat"
        ],
        equipment: [
          "machine"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "belt-squat",
        name: "Belt Squat",
        category: "powerlifting",
        patterns: [
          "squat"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "bulgarian-split-squat",
        name: "Bulgarian Split Squat",
        category: "powerlifting",
        patterns: [
          "squat",
          "lunge"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "walking-lunges",
        name: "Walking Lunges",
        category: "powerlifting",
        patterns: [
          "squat",
          "lunge",
          "carry"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "reverse-lunges",
        name: "Reverse Lunges",
        category: "powerlifting",
        patterns: [
          "squat",
          "lunge"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "static-lunges",
        name: "Static Lunges",
        category: "powerlifting",
        patterns: [
          "squat",
          "lunge"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "goblet-squat",
        name: "Goblet Squat",
        category: "powerlifting",
        patterns: [
          "squat"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "leg-extension",
        name: "Leg Extension",
        category: "powerlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "leg-curl",
        name: "Leg Curl",
        category: "powerlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "glute-ham-raise",
        name: "Glute-Ham Raise",
        category: "powerlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "nordic-curl",
        name: "Nordic Curl",
        category: "powerlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "inverse-curl",
        name: "Inverse Curl",
        category: "powerlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "back-raise",
        name: "Back Raise",
        category: "powerlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "dumbbell-fly",
        name: "Dumbbell Fly",
        category: "powerlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "pec-deck",
        name: "Pec Deck",
        category: "powerlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "machine"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "cable-fly",
        name: "Cable Fly",
        category: "powerlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "cable"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "push-ups",
        name: "Push-Ups",
        category: "powerlifting",
        patterns: [
          "press"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "tricep-pushdown",
        name: "Tricep Pushdown",
        category: "powerlifting",
        patterns: [
          "press"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "weighted-dips",
        name: "Weighted Dips",
        category: "powerlifting",
        patterns: [
          "press"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "advanced"
      },
      {
        id: "skullcrusher",
        name: "Skullcrusher",
        category: "powerlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "rolling-db-tricep-extension",
        name: "Rolling DB Tricep Extension",
        category: "powerlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "jm-press",
        name: "JM Press",
        category: "powerlifting",
        patterns: [
          "press"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "williams-extension",
        name: "Williams Extension",
        category: "powerlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "overhead-tricep-extension",
        name: "Overhead Tricep Extension",
        category: "powerlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "overhead-press",
        name: "Overhead Press",
        category: "powerlifting",
        patterns: [
          "press"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "good-mornings-straight-bar",
        name: "Good Mornings (Straight Bar",
        category: "powerlifting",
        patterns: [
          "hinge"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "ssb",
        name: "SSB",
        category: "powerlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "cambered",
        name: "Cambered)",
        category: "powerlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "dimel-deadlift",
        name: "Dimel Deadlift",
        category: "powerlifting",
        patterns: [
          "hinge"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "single-leg-rdl",
        name: "Single-Leg RDL",
        category: "powerlifting",
        patterns: [
          "hinge"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "advanced"
      },
      {
        id: "hamstring-curl",
        name: "Hamstring Curl",
        category: "powerlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "ring"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "reverse-hyper",
        name: "Reverse Hyper",
        category: "powerlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "hip-thrustglute-bridge",
        name: "Hip Thrust/Glute Bridge",
        category: "powerlifting",
        patterns: [
          "hinge"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "barbell-row",
        name: "Barbell Row",
        category: "powerlifting",
        patterns: [
          "pull",
          "cardio"
        ],
        equipment: [
          "barbell"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "pendlay-row",
        name: "Pendlay Row",
        category: "powerlifting",
        patterns: [
          "pull",
          "cardio"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "chest-supported-row",
        name: "Chest-Supported Row",
        category: "powerlifting",
        patterns: [
          "pull",
          "cardio"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "seal-row",
        name: "Seal Row",
        category: "powerlifting",
        patterns: [
          "pull",
          "cardio"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "one-arm-dumbbell-row",
        name: "One-Arm Dumbbell Row",
        category: "powerlifting",
        patterns: [
          "pull",
          "cardio"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "conditioning",
        level: "advanced"
      },
      {
        id: "cable-row",
        name: "Cable Row",
        category: "powerlifting",
        patterns: [
          "pull",
          "cardio"
        ],
        equipment: [
          "cable"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "t-bar-row",
        name: "T-Bar Row",
        category: "powerlifting",
        patterns: [
          "pull",
          "cardio"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "lat-pulldown",
        name: "Lat Pulldown",
        category: "powerlifting",
        patterns: [
          "pull"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "v-bar-pulldown",
        name: "V-Bar Pulldown",
        category: "powerlifting",
        patterns: [
          "pull"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "rear-delt-fly",
        name: "Rear Delt Fly",
        category: "powerlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "shrugs",
        name: "Shrugs",
        category: "powerlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "overhead-dumbbell-press",
        name: "Overhead Dumbbell Press",
        category: "powerlifting",
        patterns: [
          "press"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "db-z-press",
        name: "DB Z Press",
        category: "powerlifting",
        patterns: [
          "press"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "db-lateral-raise",
        name: "DB Lateral Raise",
        category: "powerlifting",
        patterns: [
          "pull"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "db-front-raise",
        name: "DB Front Raise",
        category: "powerlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "arnold-press",
        name: "Arnold Press",
        category: "powerlifting",
        patterns: [
          "press"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "barbell-curl",
        name: "Barbell Curl",
        category: "powerlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "dumbbell-bicep-curl",
        name: "Dumbbell Bicep Curl",
        category: "powerlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "hammer-curl",
        name: "Hammer Curl",
        category: "powerlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "preacher-curl",
        name: "Preacher Curl",
        category: "powerlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "cable-curl",
        name: "Cable Curl",
        category: "powerlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "cable"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "ab-wheel-roll-out",
        name: "Ab Wheel Roll-Out",
        category: "powerlifting",
        patterns: [
          "core"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "standing-abs",
        name: "Standing Abs",
        category: "powerlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "ghd-sit-ups",
        name: "GHD Sit-Ups",
        category: "powerlifting",
        patterns: [
          "core"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "hanging-leg-raise",
        name: "Hanging Leg Raise",
        category: "powerlifting",
        patterns: [
          "core"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "russian-twist",
        name: "Russian Twist",
        category: "powerlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "dead-bug",
        name: "Dead Bug",
        category: "powerlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "cable-crunches",
        name: "Cable Crunches",
        category: "powerlifting",
        patterns: [
          "core",
          "cardio"
        ],
        equipment: [
          "cable"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "sled-pullpush",
        name: "Sled Pull/Push",
        category: "powerlifting",
        patterns: [
          "press",
          "pull"
        ],
        equipment: [
          "sled"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "farmers-carry",
        name: "Farmer's Carry",
        category: "powerlifting",
        patterns: [
          "carry"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "yoke-walk",
        name: "Yoke Walk",
        category: "powerlifting",
        patterns: [
          "carry"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "single-leg-press",
        name: "Single-Leg Press",
        category: "powerlifting",
        patterns: [
          "press"
        ],
        equipment: [
          "machine"
        ],
        modality: "strength",
        level: "advanced"
      },
      {
        id: "hip-adductionabduction",
        name: "Hip Adduction/Abduction",
        category: "powerlifting",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "barbell-back-squat",
        name: "Barbell Back Squat",
        category: "bb_full_body",
        patterns: [
          "squat"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "barbell-front-squat",
        name: "Barbell Front Squat",
        category: "bb_full_body",
        patterns: [
          "squat"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "dumbbell-front-squat",
        name: "Dumbbell Front Squat",
        category: "bb_full_body",
        patterns: [
          "squat"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "double-kb-front-squat",
        name: "Double KB Front Squat",
        category: "bb_full_body",
        patterns: [
          "squat"
        ],
        equipment: [
          "kettlebell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "hack-squat-machine",
        name: "Hack Squat Machine",
        category: "bb_full_body",
        patterns: [
          "squat",
          "pull"
        ],
        equipment: [
          "machine"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "smith-machine-squat",
        name: "Smith Machine Squat",
        category: "bb_full_body",
        patterns: [
          "squat",
          "pull"
        ],
        equipment: [
          "machine"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "barbell-walking-lunges",
        name: "Barbell Walking Lunges",
        category: "bb_full_body",
        patterns: [
          "squat",
          "lunge",
          "carry"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "barbell-reverse-lunges",
        name: "Barbell Reverse Lunges",
        category: "bb_full_body",
        patterns: [
          "squat",
          "lunge"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "dumbbell-walking-lunges",
        name: "Dumbbell Walking Lunges",
        category: "bb_full_body",
        patterns: [
          "squat",
          "lunge",
          "carry"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "dumbbell-reverse-lunges",
        name: "Dumbbell Reverse Lunges",
        category: "bb_full_body",
        patterns: [
          "squat",
          "lunge"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "dumbbell-forward-lunges",
        name: "Dumbbell Forward Lunges",
        category: "bb_full_body",
        patterns: [
          "squat",
          "lunge"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "curtsy-lunge",
        name: "Curtsy Lunge",
        category: "bb_full_body",
        patterns: [
          "squat",
          "lunge"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "lateral-lunges",
        name: "Lateral Lunges",
        category: "bb_full_body",
        patterns: [
          "squat",
          "pull",
          "lunge"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "cossack-squat",
        name: "Cossack Squat",
        category: "bb_full_body",
        patterns: [
          "squat"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "leg-extensions",
        name: "Leg Extensions",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "cable-pull-through",
        name: "Cable Pull-Through",
        category: "bb_full_body",
        patterns: [
          "pull"
        ],
        equipment: [
          "cable"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "barbell-hip-thrust",
        name: "Barbell Hip Thrust",
        category: "bb_full_body",
        patterns: [
          "hinge"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "dumbbell-hip-thrust",
        name: "Dumbbell Hip Thrust",
        category: "bb_full_body",
        patterns: [
          "hinge"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "single-leg-hip-thrust",
        name: "Single-Leg Hip Thrust",
        category: "bb_full_body",
        patterns: [
          "hinge"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "advanced"
      },
      {
        id: "glute-bridge",
        name: "Glute Bridge",
        category: "bb_full_body",
        patterns: [
          "hinge"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "weighted-glute-bridge",
        name: "Weighted Glute Bridge",
        category: "bb_full_body",
        patterns: [
          "hinge"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "advanced"
      },
      {
        id: "cable-glute-kickbacks",
        name: "Cable Glute Kickbacks",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "cable"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "dumbbell-step-ups",
        name: "Dumbbell Step-Ups",
        category: "bb_full_body",
        patterns: [
          "squat"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "lying-leg-curls",
        name: "Lying Leg Curls",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "seated-leg-curls",
        name: "Seated Leg Curls",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "standing-leg-curls",
        name: "Standing Leg Curls",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "nordic-hamstring-curls",
        name: "Nordic Hamstring Curls",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "ring"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "stability-ball-hamstring-curls",
        name: "Stability Ball Hamstring Curls",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "ring"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "flat-barbell-bench-press",
        name: "Flat Barbell Bench Press",
        category: "bb_full_body",
        patterns: [
          "press",
          "pull"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "incline-barbell-bench",
        name: "Incline Barbell Bench",
        category: "bb_full_body",
        patterns: [
          "press"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "decline-barbell-bench",
        name: "Decline Barbell Bench",
        category: "bb_full_body",
        patterns: [
          "press"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "guillotine-press",
        name: "Guillotine Press",
        category: "bb_full_body",
        patterns: [
          "press"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "flat-db-bench-press",
        name: "Flat DB Bench Press",
        category: "bb_full_body",
        patterns: [
          "press",
          "pull"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "incline-db-press",
        name: "Incline DB Press",
        category: "bb_full_body",
        patterns: [
          "press"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "decline-db-press",
        name: "Decline DB Press",
        category: "bb_full_body",
        patterns: [
          "press"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "db-floor-press",
        name: "DB Floor Press",
        category: "bb_full_body",
        patterns: [
          "press"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "single-arm-db-press",
        name: "Single-Arm DB Press",
        category: "bb_full_body",
        patterns: [
          "press"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "advanced"
      },
      {
        id: "smith-machine-bench",
        name: "Smith Machine Bench",
        category: "bb_full_body",
        patterns: [
          "press",
          "pull"
        ],
        equipment: [
          "machine"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "hammer-strength-chest-press",
        name: "Hammer Strength Chest Press",
        category: "bb_full_body",
        patterns: [
          "press"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "machine-chest-press",
        name: "Machine Chest Press",
        category: "bb_full_body",
        patterns: [
          "press",
          "pull"
        ],
        equipment: [
          "machine"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "push-ups-standard",
        name: "Push-Ups (Standard",
        category: "bb_full_body",
        patterns: [
          "press"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "wide",
        name: "Wide",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "close",
        name: "Close",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "decline",
        name: "Decline",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "incline",
        name: "Incline",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "pike",
        name: "Pike)",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "cable-flyes",
        name: "Cable Flyes",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "cable"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "dumbbell-flyes",
        name: "Dumbbell Flyes",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "pec-deck-machine",
        name: "Pec Deck Machine",
        category: "bb_full_body",
        patterns: [
          "pull"
        ],
        equipment: [
          "machine"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "cable-crossovers-high-to-low",
        name: "Cable Crossovers (High to Low",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "cable"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "low-to-high",
        name: "Low to High)",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "dumbbell-pullovers",
        name: "Dumbbell Pullovers",
        category: "bb_full_body",
        patterns: [
          "pull"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "pull-ups-wide",
        name: "Pull-Ups (Wide",
        category: "bb_full_body",
        patterns: [
          "pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "neutral",
        name: "Neutral)",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "assisted-pull-ups",
        name: "Assisted Pull-Ups",
        category: "bb_full_body",
        patterns: [
          "pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "lat-pulldown-wide",
        name: "Lat Pulldown (Wide",
        category: "bb_full_body",
        patterns: [
          "pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "reverse",
        name: "Reverse",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "single-arm",
        name: "Single-Arm)",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "advanced"
      },
      {
        id: "straight-arm-pulldown",
        name: "Straight-Arm Pulldown",
        category: "bb_full_body",
        patterns: [
          "pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "barbell-bent-over-row",
        name: "Barbell Bent-Over Row",
        category: "bb_full_body",
        patterns: [
          "pull",
          "cardio"
        ],
        equipment: [
          "barbell"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "landmine-row",
        name: "Landmine Row",
        category: "bb_full_body",
        patterns: [
          "pull",
          "cardio"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "single-arm-db-row",
        name: "Single-Arm DB Row",
        category: "bb_full_body",
        patterns: [
          "pull",
          "cardio"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "conditioning",
        level: "advanced"
      },
      {
        id: "seated-cable-row-v-handle",
        name: "Seated Cable Row (V-Handle",
        category: "bb_full_body",
        patterns: [
          "pull",
          "cardio"
        ],
        equipment: [
          "cable"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "wide-grip",
        name: "Wide Grip)",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "inverted-row",
        name: "Inverted Row",
        category: "bb_full_body",
        patterns: [
          "pull",
          "cardio"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "trx-row",
        name: "TRX Row",
        category: "bb_full_body",
        patterns: [
          "pull",
          "cardio"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "machine-rows",
        name: "Machine Rows",
        category: "bb_full_body",
        patterns: [
          "pull",
          "cardio"
        ],
        equipment: [
          "machine"
        ],
        modality: "conditioning",
        level: "beginner"
      },
      {
        id: "reverse-fly",
        name: "Reverse Fly",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "bent-over-reverse-fly",
        name: "Bent-Over Reverse Fly",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "cable-reverse-fly",
        name: "Cable Reverse Fly",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "cable"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "rear-delt-row",
        name: "Rear Delt Row",
        category: "bb_full_body",
        patterns: [
          "pull",
          "cardio"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "reverse-hyperextensions",
        name: "Reverse Hyperextensions",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "seated-barbell-shoulder-press",
        name: "Seated Barbell Shoulder Press",
        category: "bb_full_body",
        patterns: [
          "press"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "standingseated-db-shoulder-press",
        name: "Standing/Seated DB Shoulder Press",
        category: "bb_full_body",
        patterns: [
          "press"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "landmine-press",
        name: "Landmine Press",
        category: "bb_full_body",
        patterns: [
          "press"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "smith-machine-shoulder-press",
        name: "Smith Machine Shoulder Press",
        category: "bb_full_body",
        patterns: [
          "press",
          "pull"
        ],
        equipment: [
          "machine"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "pike-push-ups",
        name: "Pike Push-Ups",
        category: "bb_full_body",
        patterns: [
          "press"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "dumbbell-front-raise",
        name: "Dumbbell Front Raise",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "barbell-front-raise",
        name: "Barbell Front Raise",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "cable-front-raise",
        name: "Cable Front Raise",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "cable"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "plate-front-raise",
        name: "Plate Front Raise",
        category: "bb_full_body",
        patterns: [
          "pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "dumbbell-lateral-raise",
        name: "Dumbbell Lateral Raise",
        category: "bb_full_body",
        patterns: [
          "pull"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "cable-lateral-raise",
        name: "Cable Lateral Raise",
        category: "bb_full_body",
        patterns: [
          "pull"
        ],
        equipment: [
          "cable"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "machine-lateral-raise",
        name: "Machine Lateral Raise",
        category: "bb_full_body",
        patterns: [
          "pull"
        ],
        equipment: [
          "machine"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "seated-db-lateral-raise",
        name: "Seated DB Lateral Raise",
        category: "bb_full_body",
        patterns: [
          "pull"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "behind-the-body-cable-lateral-raise",
        name: "Behind-the-Body Cable Lateral Raise",
        category: "bb_full_body",
        patterns: [
          "pull"
        ],
        equipment: [
          "cable"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "leaning-cable-lateral-raise",
        name: "Leaning Cable Lateral Raise",
        category: "bb_full_body",
        patterns: [
          "pull"
        ],
        equipment: [
          "cable"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "reverse-pec-deck",
        name: "Reverse Pec Deck",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "machine"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "bent-over-db-reverse-fly",
        name: "Bent-Over DB Reverse Fly",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "upright-row",
        name: "Upright Row",
        category: "bb_full_body",
        patterns: [
          "pull",
          "cardio"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "db-clean-and-press",
        name: "DB Clean and Press",
        category: "bb_full_body",
        patterns: [
          "press"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "kb-clean-and-press",
        name: "KB Clean and Press",
        category: "bb_full_body",
        patterns: [
          "press"
        ],
        equipment: [
          "kettlebell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "standing-barbell-curl",
        name: "Standing Barbell Curl",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "ez-bar-curl",
        name: "EZ-Bar Curl",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "close-grip-ez-bar-curl",
        name: "Close-Grip EZ-Bar Curl",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "wide-grip-barbell-curl",
        name: "Wide-Grip Barbell Curl",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "reverse-grip-barbell-curl",
        name: "Reverse Grip Barbell Curl",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "standing-db-curl",
        name: "Standing DB Curl",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "alternating-db-curl",
        name: "Alternating DB Curl",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "incline-db-curl",
        name: "Incline DB Curl",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "concentration-curl",
        name: "Concentration Curl",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "seated-db-curl",
        name: "Seated DB Curl",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "waiter-curl",
        name: "Waiter Curl",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "cross-body-hammer-curl",
        name: "Cross-Body Hammer Curl",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "zottman-curl",
        name: "Zottman Curl",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "cable-curl-straight-bar",
        name: "Cable Curl (Straight Bar",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "cable"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "ez-bar",
        name: "EZ-Bar)",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "cable-hammer-curl",
        name: "Cable Hammer Curl",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "cable"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "behind-the-body-cable-curl",
        name: "Behind-the-Body Cable Curl",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "cable"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "high-cable-curl",
        name: "High Cable Curl",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "cable"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "single-arm-cable-curl",
        name: "Single-Arm Cable Curl",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "cable"
        ],
        modality: "strength",
        level: "advanced"
      },
      {
        id: "machine-preacher-curl",
        name: "Machine Preacher Curl",
        category: "bb_full_body",
        patterns: [
          "pull"
        ],
        equipment: [
          "machine"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "dumbbell-preacher-curl",
        name: "Dumbbell Preacher Curl",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "barbell-preacher-curl",
        name: "Barbell Preacher Curl",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "diamond-push-ups",
        name: "Diamond Push-Ups",
        category: "bb_full_body",
        patterns: [
          "press"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "overhead-db-extension-two-arm",
        name: "Overhead DB Extension (Two-Arm",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "lying-db-tricep-extension",
        name: "Lying DB Tricep Extension",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "lying-barbell-extension",
        name: "Lying Barbell Extension",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "ez-bar-skull-crusher",
        name: "EZ-Bar Skull Crusher",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "overhead-cable-extension",
        name: "Overhead Cable Extension",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "cable"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "cable-tricep-pushdown-straight-bar",
        name: "Cable Tricep Pushdown (Straight Bar",
        category: "bb_full_body",
        patterns: [
          "press"
        ],
        equipment: [
          "cable"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "v-bar",
        name: "V-Bar",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "rope",
        name: "Rope)",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "single-arm-cable-extension",
        name: "Single-Arm Cable Extension",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "cable"
        ],
        modality: "strength",
        level: "advanced"
      },
      {
        id: "db-tricep-kickback",
        name: "DB Tricep Kickback",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "cable-tricep-kickback",
        name: "Cable Tricep Kickback",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "cable"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "machine-tricep-extension",
        name: "Machine Tricep Extension",
        category: "bb_full_body",
        patterns: [
          "pull"
        ],
        equipment: [
          "machine"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "front-plank",
        name: "Front Plank",
        category: "bb_full_body",
        patterns: [
          "core"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "feet-elevated-plank",
        name: "Feet-Elevated Plank",
        category: "bb_full_body",
        patterns: [
          "core"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "ab-wheel-rollout",
        name: "Ab Wheel Rollout",
        category: "bb_full_body",
        patterns: [
          "core"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "stability-ball-rollout",
        name: "Stability Ball Rollout",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "trx-rollout",
        name: "TRX Rollout",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "plank-with-reach",
        name: "Plank with Reach",
        category: "bb_full_body",
        patterns: [
          "core"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "single-leg-plank",
        name: "Single-Leg Plank",
        category: "bb_full_body",
        patterns: [
          "core"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "advanced"
      },
      {
        id: "plank-row",
        name: "Plank Row",
        category: "bb_full_body",
        patterns: [
          "pull",
          "core",
          "cardio"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "cable-chop",
        name: "Cable Chop",
        category: "bb_full_body",
        patterns: [
          "jump"
        ],
        equipment: [
          "cable"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "cable-lift",
        name: "Cable Lift",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "cable"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "side-plank",
        name: "Side Plank",
        category: "bb_full_body",
        patterns: [
          "core"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "side-plank-row",
        name: "Side Plank Row",
        category: "bb_full_body",
        patterns: [
          "pull",
          "core",
          "cardio"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "suitcase-carry",
        name: "Suitcase Carry",
        category: "bb_full_body",
        patterns: [
          "carry"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "single-arm-farmers-walk",
        name: "Single-Arm Farmer's Walk",
        category: "bb_full_body",
        patterns: [
          "carry"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "advanced"
      },
      {
        id: "crunches",
        name: "Crunches",
        category: "bb_full_body",
        patterns: [
          "core",
          "cardio"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "reverse-crunches",
        name: "Reverse Crunches",
        category: "bb_full_body",
        patterns: [
          "core",
          "cardio"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "bicycle-crunches",
        name: "Bicycle Crunches",
        category: "bb_full_body",
        patterns: [
          "core",
          "cardio"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "conditioning",
        level: "intermediate",
        banned_in_main_when_equipment: true
      },
      {
        id: "v-ups",
        name: "V-Ups",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "sit-ups",
        name: "Sit-Ups",
        category: "bb_full_body",
        patterns: [
          "core"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "medicine-ball-slam",
        name: "Medicine Ball Slam",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "ball"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "hanging-knee-raises",
        name: "Hanging Knee Raises",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "lying-leg-raises",
        name: "Lying Leg Raises",
        category: "bb_full_body",
        patterns: [
          "core"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "mountain-climbers",
        name: "Mountain Climbers",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "bird-dog",
        name: "Bird Dog",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "standing-calf-raise",
        name: "Standing Calf Raise",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "seated-calf-raise",
        name: "Seated Calf Raise",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "single-leg-calf-raise",
        name: "Single-Leg Calf Raise",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "advanced"
      },
      {
        id: "barbell-calf-raise",
        name: "Barbell Calf Raise",
        category: "bb_full_body",
        patterns: [
          "general"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "jump-rope",
        name: "Jump Rope",
        category: "bb_full_body",
        patterns: [
          "jump",
          "cardio"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "close-grip-bench",
        name: "Close-Grip Bench",
        category: "bb_upper",
        patterns: [
          "press"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "wide-grip-bench",
        name: "Wide-Grip Bench",
        category: "bb_upper",
        patterns: [
          "press"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "reverse-grip-bench",
        name: "Reverse Grip Bench",
        category: "bb_upper",
        patterns: [
          "press"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "alternating-db-press",
        name: "Alternating DB Press",
        category: "bb_upper",
        patterns: [
          "press"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "neutral-grip-db-press",
        name: "Neutral Grip DB Press",
        category: "bb_upper",
        patterns: [
          "press"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "seated-machine-chest-press",
        name: "Seated Machine Chest Press",
        category: "bb_upper",
        patterns: [
          "press",
          "pull"
        ],
        equipment: [
          "machine"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "flat-db-flyes",
        name: "Flat DB Flyes",
        category: "bb_upper",
        patterns: [
          "pull"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "incline-db-flyes",
        name: "Incline DB Flyes",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "cable-crossover",
        name: "Cable Crossover",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "cable"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "horizontal-cable-flyes",
        name: "Horizontal Cable Flyes",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "cable"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "pec-deck-machine-flyes",
        name: "Pec Deck Machine Flyes",
        category: "bb_upper",
        patterns: [
          "pull"
        ],
        equipment: [
          "machine"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "low-to-high-cable-flyes",
        name: "Low-to-High Cable Flyes",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "cable"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "high-to-low-cable-flyes",
        name: "High-to-Low Cable Flyes",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "cable"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "explosive",
        name: "Explosive",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "diamond",
        name: "Diamond",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "archer",
        name: "Archer)",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "chest-dips",
        name: "Chest Dips",
        category: "bb_upper",
        patterns: [
          "press"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "dumbbell-pullover",
        name: "Dumbbell Pullover",
        category: "bb_upper",
        patterns: [
          "pull"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "cable-pullover",
        name: "Cable Pullover",
        category: "bb_upper",
        patterns: [
          "pull"
        ],
        equipment: [
          "cable"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "svend-press",
        name: "Svend Press",
        category: "bb_upper",
        patterns: [
          "press"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "wide-grip-lat-pulldown",
        name: "Wide Grip Lat Pulldown",
        category: "bb_upper",
        patterns: [
          "pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "close-grip-lat-pulldown",
        name: "Close Grip Lat Pulldown",
        category: "bb_upper",
        patterns: [
          "pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "neutral-grip-lat-pulldown",
        name: "Neutral Grip Lat Pulldown",
        category: "bb_upper",
        patterns: [
          "pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "underhand-lat-pulldown",
        name: "Underhand Lat Pulldown",
        category: "bb_upper",
        patterns: [
          "pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "single-arm-lat-pulldown",
        name: "Single-Arm Lat Pulldown",
        category: "bb_upper",
        patterns: [
          "pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "advanced"
      },
      {
        id: "v-bar-lat-pulldown",
        name: "V-Bar Lat Pulldown",
        category: "bb_upper",
        patterns: [
          "pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "rope-pulldown",
        name: "Rope Pulldown",
        category: "bb_upper",
        patterns: [
          "pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "wide-grip-pull-ups",
        name: "Wide Grip Pull-Ups",
        category: "bb_upper",
        patterns: [
          "pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "close-grip-pull-ups",
        name: "Close Grip Pull-Ups",
        category: "bb_upper",
        patterns: [
          "pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "neutral-grip-pull-ups",
        name: "Neutral Grip Pull-Ups",
        category: "bb_upper",
        patterns: [
          "pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "weighted-pull-ups",
        name: "Weighted Pull-Ups",
        category: "bb_upper",
        patterns: [
          "pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "advanced"
      },
      {
        id: "towel-pull-ups",
        name: "Towel Pull-Ups",
        category: "bb_upper",
        patterns: [
          "pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "archer-pull-ups",
        name: "Archer Pull-Ups",
        category: "bb_upper",
        patterns: [
          "pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "commando-pull-ups",
        name: "Commando Pull-Ups",
        category: "bb_upper",
        patterns: [
          "pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "bent-over-barbell-row",
        name: "Bent-Over Barbell Row",
        category: "bb_upper",
        patterns: [
          "pull",
          "cardio"
        ],
        equipment: [
          "barbell"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "rack-pulls",
        name: "Rack Pulls",
        category: "bb_upper",
        patterns: [
          "pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "yates-row",
        name: "Yates Row",
        category: "bb_upper",
        patterns: [
          "pull",
          "cardio"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "two-arm-db-row",
        name: "Two-Arm DB Row",
        category: "bb_upper",
        patterns: [
          "pull",
          "cardio"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "chest-supported-db-row",
        name: "Chest-Supported DB Row",
        category: "bb_upper",
        patterns: [
          "pull",
          "cardio"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "incline-bench-db-row",
        name: "Incline Bench DB Row",
        category: "bb_upper",
        patterns: [
          "press",
          "pull",
          "cardio"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "conditioning",
        level: "beginner"
      },
      {
        id: "kroc-row",
        name: "Kroc Row",
        category: "bb_upper",
        patterns: [
          "pull",
          "cardio"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "seated-cable-row",
        name: "Seated Cable Row",
        category: "bb_upper",
        patterns: [
          "pull",
          "cardio"
        ],
        equipment: [
          "cable"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "single-arm-cable-row",
        name: "Single-Arm Cable Row",
        category: "bb_upper",
        patterns: [
          "pull",
          "cardio"
        ],
        equipment: [
          "cable"
        ],
        modality: "conditioning",
        level: "advanced"
      },
      {
        id: "high-cable-row",
        name: "High Cable Row",
        category: "bb_upper",
        patterns: [
          "pull",
          "cardio"
        ],
        equipment: [
          "cable"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "low-cable-row",
        name: "Low Cable Row",
        category: "bb_upper",
        patterns: [
          "pull",
          "cardio"
        ],
        equipment: [
          "cable"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "machine-row",
        name: "Machine Row",
        category: "bb_upper",
        patterns: [
          "pull",
          "cardio"
        ],
        equipment: [
          "machine"
        ],
        modality: "conditioning",
        level: "beginner"
      },
      {
        id: "hammer-strength-row",
        name: "Hammer Strength Row",
        category: "bb_upper",
        patterns: [
          "pull",
          "cardio"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "chest-supported-machine-row",
        name: "Chest-Supported Machine Row",
        category: "bb_upper",
        patterns: [
          "pull",
          "cardio"
        ],
        equipment: [
          "machine"
        ],
        modality: "conditioning",
        level: "beginner"
      },
      {
        id: "renegade-row",
        name: "Renegade Row",
        category: "bb_upper",
        patterns: [
          "pull",
          "cardio"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "meadows-row",
        name: "Meadows Row",
        category: "bb_upper",
        patterns: [
          "pull",
          "cardio"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "gorilla-row",
        name: "Gorilla Row",
        category: "bb_upper",
        patterns: [
          "pull",
          "cardio"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "standing-military-press",
        name: "Standing Military Press",
        category: "bb_upper",
        patterns: [
          "press"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "seated-military-press",
        name: "Seated Military Press",
        category: "bb_upper",
        patterns: [
          "press"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "behind-the-neck-press",
        name: "Behind-the-Neck Press",
        category: "bb_upper",
        patterns: [
          "press"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "bradford-press",
        name: "Bradford Press",
        category: "bb_upper",
        patterns: [
          "press"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "standing-db-shoulder-press",
        name: "Standing DB Shoulder Press",
        category: "bb_upper",
        patterns: [
          "press"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "seated-db-shoulder-press",
        name: "Seated DB Shoulder Press",
        category: "bb_upper",
        patterns: [
          "press"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "machine-shoulder-press",
        name: "Machine Shoulder Press",
        category: "bb_upper",
        patterns: [
          "press",
          "pull"
        ],
        equipment: [
          "machine"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "hammer-strength-shoulder-press",
        name: "Hammer Strength Shoulder Press",
        category: "bb_upper",
        patterns: [
          "press"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "single-arm-lateral-raise",
        name: "Single-Arm Lateral Raise",
        category: "bb_upper",
        patterns: [
          "pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "advanced"
      },
      {
        id: "leaning-lateral-raise",
        name: "Leaning Lateral Raise",
        category: "bb_upper",
        patterns: [
          "pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "wide-grip-upright-row",
        name: "Wide Grip Upright Row",
        category: "bb_upper",
        patterns: [
          "pull",
          "cardio"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "front-raise",
        name: "Front Raise",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "alternating-front-raise",
        name: "Alternating Front Raise",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "machine-reverse-fly",
        name: "Machine Reverse Fly",
        category: "bb_upper",
        patterns: [
          "pull"
        ],
        equipment: [
          "machine"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "prone-db-reverse-fly",
        name: "Prone DB Reverse Fly",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "bus-drivers",
        name: "Bus Drivers",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "cuban-press",
        name: "Cuban Press",
        category: "bb_upper",
        patterns: [
          "press"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "viking-press",
        name: "Viking Press",
        category: "bb_upper",
        patterns: [
          "press"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "overhead-carry",
        name: "Overhead Carry",
        category: "bb_upper",
        patterns: [
          "carry"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "single-arm-landmine-press",
        name: "Single-Arm Landmine Press",
        category: "bb_upper",
        patterns: [
          "press"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "advanced"
      },
      {
        id: "close-grip-barbell-curl",
        name: "Close Grip Barbell Curl",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "reverse-barbell-curl",
        name: "Reverse Barbell Curl",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "drag-curl",
        name: "Drag Curl",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "cheat-curl",
        name: "Cheat Curl",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "21s",
        name: "21s",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "spider-curl",
        name: "Spider Curl",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "cable-rope-hammer-curl",
        name: "Cable Rope Hammer Curl",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "cable"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "low-cable-curl",
        name: "Low Cable Curl",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "cable"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "ez-bar-preacher-curl",
        name: "EZ Bar Preacher Curl",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "single-arm-preacher-curl",
        name: "Single-Arm Preacher Curl",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "advanced"
      },
      {
        id: "trx-bicep-curl",
        name: "TRX Bicep Curl",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "resistance-band-curl",
        name: "Resistance Band Curl",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "band"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "fat-grip-curls",
        name: "Fat Grip Curls",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "cable-pushdown-straight-bar",
        name: "Cable Pushdown (Straight Bar",
        category: "bb_upper",
        patterns: [
          "press"
        ],
        equipment: [
          "cable"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "reverse-grip-pushdown",
        name: "Reverse Grip Pushdown",
        category: "bb_upper",
        patterns: [
          "press"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "single-arm-pushdown",
        name: "Single-Arm Pushdown",
        category: "bb_upper",
        patterns: [
          "press"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "advanced"
      },
      {
        id: "dumbbell-overhead-extension-two-arm",
        name: "Dumbbell Overhead Extension (Two-Arm",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "barbell-overhead-extension",
        name: "Barbell Overhead Extension",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "ez-bar-overhead-extension",
        name: "EZ Bar Overhead Extension",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "seated-overhead-extension",
        name: "Seated Overhead Extension",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "dumbbell-skull-crusher",
        name: "Dumbbell Skull Crusher",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "cable-lying-extension",
        name: "Cable Lying Extension",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "cable"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "incline-skull-crusher",
        name: "Incline Skull Crusher",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "dumbbell-tate-press",
        name: "Dumbbell Tate Press",
        category: "bb_upper",
        patterns: [
          "press"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "tricep-dips",
        name: "Tricep Dips",
        category: "bb_upper",
        patterns: [
          "press"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "weighted-tricep-dips",
        name: "Weighted Tricep Dips",
        category: "bb_upper",
        patterns: [
          "press"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "advanced"
      },
      {
        id: "bench-dips",
        name: "Bench Dips",
        category: "bb_upper",
        patterns: [
          "press"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "close-grip-push-ups",
        name: "Close-Grip Push-Ups",
        category: "bb_upper",
        patterns: [
          "press"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "dumbbell-kickback",
        name: "Dumbbell Kickback",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "cable-kickback",
        name: "Cable Kickback",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "cable"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "overhead-rope-extension",
        name: "Overhead Rope Extension",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "barbell-shrug",
        name: "Barbell Shrug",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "dumbbell-shrug",
        name: "Dumbbell Shrug",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "behind-the-back-barbell-shrug",
        name: "Behind-the-Back Barbell Shrug",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "trap-bar-shrug",
        name: "Trap Bar Shrug",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "cable-shrug",
        name: "Cable Shrug",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "cable"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "smith-machine-shrug",
        name: "Smith Machine Shrug",
        category: "bb_upper",
        patterns: [
          "pull"
        ],
        equipment: [
          "machine"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "overhead-shrug",
        name: "Overhead Shrug",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "face-pull",
        name: "Face Pull",
        category: "bb_upper",
        patterns: [
          "pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "snatch-grip-high-pull",
        name: "Snatch Grip High Pull",
        category: "bb_upper",
        patterns: [
          "olympic_snatch",
          "pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "rack-pull",
        name: "Rack Pull",
        category: "bb_upper",
        patterns: [
          "pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "farmers-walk",
        name: "Farmer's Walk",
        category: "bb_upper",
        patterns: [
          "carry"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "overhead-farmers-walk",
        name: "Overhead Farmer's Walk",
        category: "bb_upper",
        patterns: [
          "carry"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "shrug-on-incline-bench",
        name: "Shrug on Incline Bench",
        category: "bb_upper",
        patterns: [
          "press"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "barbell-wrist-curl",
        name: "Barbell Wrist Curl",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "dumbbell-wrist-curl",
        name: "Dumbbell Wrist Curl",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "cable-wrist-curl",
        name: "Cable Wrist Curl",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "cable"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "behind-the-back-wrist-curl",
        name: "Behind-the-Back Wrist Curl",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "barbell-reverse-wrist-curl",
        name: "Barbell Reverse Wrist Curl",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "dumbbell-reverse-wrist-curl",
        name: "Dumbbell Reverse Wrist Curl",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "cable-reverse-wrist-curl",
        name: "Cable Reverse Wrist Curl",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "cable"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "plate-pinch-hold",
        name: "Plate Pinch Hold",
        category: "bb_upper",
        patterns: [
          "pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "dead-hang",
        name: "Dead Hang",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "fat-grip-training",
        name: "Fat Grip Training",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "wrist-roller",
        name: "Wrist Roller",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "reverse-curl",
        name: "Reverse Curl",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "fingertip-push-ups",
        name: "Fingertip Push-Ups",
        category: "bb_upper",
        patterns: [
          "press"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "hand-gripper-training",
        name: "Hand Gripper Training",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "pronationsupination",
        name: "Pronation/Supination",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "wrist-rotations",
        name: "Wrist Rotations",
        category: "bb_upper",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "dumbbell-squat",
        name: "Dumbbell Squat",
        category: "bb_lower",
        patterns: [
          "squat"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "kettlebell-front-squat",
        name: "Kettlebell Front Squat",
        category: "bb_lower",
        patterns: [
          "squat"
        ],
        equipment: [
          "kettlebell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "pin-squat",
        name: "Pin Squat",
        category: "bb_lower",
        patterns: [
          "squat"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "barbell-squat-with-bandschains",
        name: "Barbell Squat with Bands/Chains",
        category: "bb_lower",
        patterns: [
          "squat"
        ],
        equipment: [
          "barbell",
          "band"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "bodyweight-squat",
        name: "Bodyweight Squat",
        category: "bb_lower",
        patterns: [
          "squat"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "seated",
        name: "Seated",
        category: "bb_lower",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "vertical",
        name: "Vertical)",
        category: "bb_lower",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "narrow-stance-leg-press",
        name: "Narrow-Stance Leg Press",
        category: "bb_lower",
        patterns: [
          "press",
          "pull",
          "cardio"
        ],
        equipment: [
          "machine"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "wide-stance-leg-press",
        name: "Wide-Stance Leg Press",
        category: "bb_lower",
        patterns: [
          "press"
        ],
        equipment: [
          "machine"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "single-leg-leg-press",
        name: "Single-Leg Leg Press",
        category: "bb_lower",
        patterns: [
          "press"
        ],
        equipment: [
          "machine"
        ],
        modality: "strength",
        level: "advanced"
      },
      {
        id: "high-foot-leg-press",
        name: "High-Foot Leg Press",
        category: "bb_lower",
        patterns: [
          "press"
        ],
        equipment: [
          "machine"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "low-foot-leg-press",
        name: "Low-Foot Leg Press",
        category: "bb_lower",
        patterns: [
          "press"
        ],
        equipment: [
          "machine"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "machine-hack-squat",
        name: "Machine Hack Squat",
        category: "bb_lower",
        patterns: [
          "squat",
          "pull"
        ],
        equipment: [
          "machine"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "single-leg-hack-squat",
        name: "Single-Leg Hack Squat",
        category: "bb_lower",
        patterns: [
          "squat"
        ],
        equipment: [
          "machine"
        ],
        modality: "strength",
        level: "advanced"
      },
      {
        id: "narrow-stance-hack-squat",
        name: "Narrow-Stance Hack Squat",
        category: "bb_lower",
        patterns: [
          "squat",
          "pull",
          "cardio"
        ],
        equipment: [
          "machine"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "reverse-hack-squat",
        name: "Reverse Hack Squat",
        category: "bb_lower",
        patterns: [
          "squat"
        ],
        equipment: [
          "machine"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "single-leg-extension",
        name: "Single-Leg Extension",
        category: "bb_lower",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "advanced"
      },
      {
        id: "sissy-squat",
        name: "Sissy Squat",
        category: "bb_lower",
        patterns: [
          "squat"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "spanish-squat",
        name: "Spanish Squat",
        category: "bb_lower",
        patterns: [
          "squat"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "partial-squat",
        name: "Partial Squat",
        category: "bb_lower",
        patterns: [
          "squat"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "terminal-knee-extension",
        name: "Terminal Knee Extension",
        category: "bb_lower",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "walking-lunge",
        name: "Walking Lunge",
        category: "bb_lower",
        patterns: [
          "squat",
          "lunge",
          "carry"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "forward-lunge",
        name: "Forward Lunge",
        category: "bb_lower",
        patterns: [
          "squat",
          "lunge"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "reverse-lunge",
        name: "Reverse Lunge",
        category: "bb_lower",
        patterns: [
          "squat",
          "lunge"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "lateral-lunge",
        name: "Lateral Lunge",
        category: "bb_lower",
        patterns: [
          "squat",
          "pull",
          "lunge"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "rear-foot-elevated-split-squat",
        name: "Rear-Foot-Elevated Split Squat",
        category: "bb_lower",
        patterns: [
          "squat",
          "lunge"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "split-squat",
        name: "Split Squat",
        category: "bb_lower",
        patterns: [
          "squat",
          "lunge"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "front-foot-elevated-split-squat",
        name: "Front-Foot-Elevated Split Squat",
        category: "bb_lower",
        patterns: [
          "squat",
          "lunge"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "stationary-split-squat",
        name: "Stationary Split Squat",
        category: "bb_lower",
        patterns: [
          "squat",
          "lunge"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "deficit-reverse-lunge",
        name: "Deficit Reverse Lunge",
        category: "bb_lower",
        patterns: [
          "squat",
          "lunge"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "advanced"
      },
      {
        id: "pulse-lunge",
        name: "Pulse Lunge",
        category: "bb_lower",
        patterns: [
          "squat",
          "lunge"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "barbell-step-up",
        name: "Barbell Step-Up",
        category: "bb_lower",
        patterns: [
          "squat"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "dumbbell-step-up",
        name: "Dumbbell Step-Up",
        category: "bb_lower",
        patterns: [
          "squat"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "box-step-up",
        name: "Box Step-Up",
        category: "bb_lower",
        patterns: [
          "squat"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "lateral-step-up",
        name: "Lateral Step-Up",
        category: "bb_lower",
        patterns: [
          "squat",
          "pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "alternating-step-up",
        name: "Alternating Step-Up",
        category: "bb_lower",
        patterns: [
          "squat"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "single-leg-step-down",
        name: "Single-Leg Step-Down",
        category: "bb_lower",
        patterns: [
          "squat"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "advanced"
      },
      {
        id: "banded-rdl",
        name: "Banded RDL",
        category: "bb_lower",
        patterns: [
          "hinge"
        ],
        equipment: [
          "band"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "seated-good-morning",
        name: "Seated Good Morning",
        category: "bb_lower",
        patterns: [
          "hinge"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "lying-leg-curl",
        name: "Lying Leg Curl",
        category: "bb_lower",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "seated-leg-curl",
        name: "Seated Leg Curl",
        category: "bb_lower",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "standing-leg-curl",
        name: "Standing Leg Curl",
        category: "bb_lower",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "single-leg-lying-curl",
        name: "Single-Leg Lying Curl",
        category: "bb_lower",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "advanced"
      },
      {
        id: "single-leg-standing-curl",
        name: "Single-Leg Standing Curl",
        category: "bb_lower",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "advanced"
      },
      {
        id: "nordic-hamstring-curl",
        name: "Nordic Hamstring Curl",
        category: "bb_lower",
        patterns: [
          "general"
        ],
        equipment: [
          "ring"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "exercise-ball-leg-curl",
        name: "Exercise Ball Leg Curl",
        category: "bb_lower",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "slider-leg-curl",
        name: "Slider Leg Curl",
        category: "bb_lower",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "barbell-glute-bridge",
        name: "Barbell Glute Bridge",
        category: "bb_lower",
        patterns: [
          "hinge"
        ],
        equipment: [
          "barbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "single-leg-glute-bridge",
        name: "Single-Leg Glute Bridge",
        category: "bb_lower",
        patterns: [
          "hinge"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "advanced"
      },
      {
        id: "banded-hip-thrust",
        name: "Banded Hip Thrust",
        category: "bb_lower",
        patterns: [
          "hinge"
        ],
        equipment: [
          "band"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "elevated-glute-bridge",
        name: "Elevated Glute Bridge",
        category: "bb_lower",
        patterns: [
          "hinge"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "kas-glute-bridge",
        name: "Kas Glute Bridge",
        category: "bb_lower",
        patterns: [
          "hinge"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "b-stance-hip-thrust",
        name: "B-Stance Hip Thrust",
        category: "bb_lower",
        patterns: [
          "hinge"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "smith-machine-hip-thrust",
        name: "Smith Machine Hip Thrust",
        category: "bb_lower",
        patterns: [
          "hinge",
          "pull"
        ],
        equipment: [
          "machine"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "cable-glute-kickback",
        name: "Cable Glute Kickback",
        category: "bb_lower",
        patterns: [
          "general"
        ],
        equipment: [
          "cable"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "donkey-kick",
        name: "Donkey Kick",
        category: "bb_lower",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "banded-kickback",
        name: "Banded Kickback",
        category: "bb_lower",
        patterns: [
          "general"
        ],
        equipment: [
          "band"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "machine-glute-kickback",
        name: "Machine Glute Kickback",
        category: "bb_lower",
        patterns: [
          "pull"
        ],
        equipment: [
          "machine"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "quadruped-hip-extension",
        name: "Quadruped Hip Extension",
        category: "bb_lower",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "fire-hydrant",
        name: "Fire Hydrant",
        category: "bb_lower",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "hyperextension",
        name: "Hyperextension",
        category: "bb_lower",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "back-extension",
        name: "Back Extension",
        category: "bb_lower",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "reverse-hyperextension",
        name: "Reverse Hyperextension",
        category: "bb_lower",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "dumbbell-deadlift",
        name: "Dumbbell Deadlift",
        category: "bb_lower",
        patterns: [
          "hinge"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "kettlebell-deadlift",
        name: "Kettlebell Deadlift",
        category: "bb_lower",
        patterns: [
          "hinge"
        ],
        equipment: [
          "kettlebell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "donkey-calf-raise",
        name: "Donkey Calf Raise",
        category: "bb_lower",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "single-leg-standing-calf-raise",
        name: "Single-Leg Standing Calf Raise",
        category: "bb_lower",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "advanced"
      },
      {
        id: "single-leg-seated-calf-raise",
        name: "Single-Leg Seated Calf Raise",
        category: "bb_lower",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "advanced"
      },
      {
        id: "leg-press-calf-raise",
        name: "Leg Press Calf Raise",
        category: "bb_lower",
        patterns: [
          "press"
        ],
        equipment: [
          "machine"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "smith-machine-calf-raise",
        name: "Smith Machine Calf Raise",
        category: "bb_lower",
        patterns: [
          "pull"
        ],
        equipment: [
          "machine"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "dumbbell-standing-calf-raise",
        name: "Dumbbell Standing Calf Raise",
        category: "bb_lower",
        patterns: [
          "general"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "calf-raise-on-hack-squat-machine",
        name: "Calf Raise on Hack Squat Machine",
        category: "bb_lower",
        patterns: [
          "squat",
          "pull"
        ],
        equipment: [
          "machine"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "walking-calf-raise",
        name: "Walking Calf Raise",
        category: "bb_lower",
        patterns: [
          "carry"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "jump-calf-raise",
        name: "Jump Calf Raise",
        category: "bb_lower",
        patterns: [
          "jump"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "box-jump",
        name: "Box Jump",
        category: "bb_lower",
        patterns: [
          "squat",
          "jump"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "toe-touch-farmers-walk",
        name: "Toe Touch Farmer's Walk",
        category: "bb_lower",
        patterns: [
          "carry"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "1-1-calf-raise",
        name: "1-1/ Calf Raise",
        category: "bb_lower",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "hip-adduction-machine",
        name: "Hip Adduction Machine",
        category: "bb_lower",
        patterns: [
          "pull"
        ],
        equipment: [
          "machine"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "cable-hip-adduction",
        name: "Cable Hip Adduction",
        category: "bb_lower",
        patterns: [
          "general"
        ],
        equipment: [
          "cable"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "copenhagen-adductor-exercise",
        name: "Copenhagen Adductor Exercise",
        category: "bb_lower",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "adductor-side-plank",
        name: "Adductor Side Plank",
        category: "bb_lower",
        patterns: [
          "core"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "side-lying-adduction",
        name: "Side-Lying Adduction",
        category: "bb_lower",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "banded-adduction",
        name: "Banded Adduction",
        category: "bb_lower",
        patterns: [
          "general"
        ],
        equipment: [
          "band"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "sumo-squat",
        name: "Sumo Squat",
        category: "bb_lower",
        patterns: [
          "squat"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "wide-stance-goblet-squat",
        name: "Wide-Stance Goblet Squat",
        category: "bb_lower",
        patterns: [
          "squat"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "hip-abduction-machine",
        name: "Hip Abduction Machine",
        category: "bb_lower",
        patterns: [
          "pull"
        ],
        equipment: [
          "machine"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "cable-hip-abduction",
        name: "Cable Hip Abduction",
        category: "bb_lower",
        patterns: [
          "general"
        ],
        equipment: [
          "cable"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "banded-lateral-walk",
        name: "Banded Lateral Walk",
        category: "bb_lower",
        patterns: [
          "pull",
          "carry"
        ],
        equipment: [
          "band"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "banded-clamshell",
        name: "Banded Clamshell",
        category: "bb_lower",
        patterns: [
          "general"
        ],
        equipment: [
          "band"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "side-lying-hip-abduction",
        name: "Side-Lying Hip Abduction",
        category: "bb_lower",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "standing-hip-abduction",
        name: "Standing Hip Abduction",
        category: "bb_lower",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "side-plank-with-leg-raise",
        name: "Side Plank with Leg Raise",
        category: "bb_lower",
        patterns: [
          "core"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "x-band-walk",
        name: "X-Band Walk",
        category: "bb_lower",
        patterns: [
          "carry"
        ],
        equipment: [
          "band"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "monster-walk",
        name: "Monster Walk",
        category: "bb_lower",
        patterns: [
          "carry"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "wall-push-ups",
        name: "Wall Push-ups",
        category: "gymnastics",
        patterns: [
          "press",
          "gym_push"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "beginner"
      },
      {
        id: "incline-push-ups",
        name: "Incline Push-ups",
        category: "gymnastics",
        patterns: [
          "press",
          "gym_push"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "beginner"
      },
      {
        id: "knee-push-ups",
        name: "Knee Push-ups",
        category: "gymnastics",
        patterns: [
          "press",
          "gym_push"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "beginner"
      },
      {
        id: "standard-push-ups",
        name: "Standard Push-ups",
        category: "gymnastics",
        patterns: [
          "press",
          "gym_push"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "wide-grip-push-ups",
        name: "Wide-Grip Push-ups",
        category: "gymnastics",
        patterns: [
          "press",
          "gym_push"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "diamondclose-grip-push-ups",
        name: "Diamond/Close-Grip Push-ups",
        category: "gymnastics",
        patterns: [
          "press",
          "gym_push"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "decline-push-ups",
        name: "Decline Push-ups",
        category: "gymnastics",
        patterns: [
          "press",
          "gym_push"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "deficit-push-ups",
        name: "Deficit Push-ups",
        category: "gymnastics",
        patterns: [
          "press",
          "gym_push"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "archer-push-ups",
        name: "Archer Push-ups",
        category: "gymnastics",
        patterns: [
          "press",
          "gym_push"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "uneven-push-ups",
        name: "Uneven Push-ups",
        category: "gymnastics",
        patterns: [
          "press",
          "gym_push"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "pseudo-planche-push-ups",
        name: "Pseudo-Planche Push-ups",
        category: "gymnastics",
        patterns: [
          "press",
          "gym_push"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "one-arm-push-ups",
        name: "One-Arm Push-ups",
        category: "gymnastics",
        patterns: [
          "press",
          "gym_push"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "clapping-push-ups",
        name: "Clapping Push-ups",
        category: "gymnastics",
        patterns: [
          "press",
          "gym_push"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "ring-push-ups",
        name: "Ring Push-ups",
        category: "gymnastics",
        patterns: [
          "press",
          "gym_push"
        ],
        equipment: [
          "ring",
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "ring-rows",
        name: "Ring Rows",
        category: "gymnastics",
        patterns: [
          "pull",
          "cardio"
        ],
        equipment: [
          "ring"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "banded-pull-ups",
        name: "Banded Pull-ups",
        category: "gymnastics",
        patterns: [
          "pull",
          "gym_pull"
        ],
        equipment: [
          "band",
          "bodyweight"
        ],
        modality: "skill",
        level: "beginner"
      },
      {
        id: "jumping-pull-ups",
        name: "Jumping Pull-ups",
        category: "gymnastics",
        patterns: [
          "pull",
          "jump",
          "gym_pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "negative-pull-ups",
        name: "Negative Pull-ups",
        category: "gymnastics",
        patterns: [
          "pull",
          "gym_pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "strict-pull-ups",
        name: "Strict Pull-ups",
        category: "gymnastics",
        patterns: [
          "pull",
          "gym_pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "l-pull-ups",
        name: "L Pull-ups",
        category: "gymnastics",
        patterns: [
          "pull",
          "gym_pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "chest-to-bar-pull-ups",
        name: "Chest-to-Bar Pull-ups",
        category: "gymnastics",
        patterns: [
          "pull",
          "gym_pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "behind-the-neck-pull-ups",
        name: "Behind-the-Neck Pull-ups",
        category: "gymnastics",
        patterns: [
          "pull",
          "gym_pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "box-dips",
        name: "Box Dips",
        category: "gymnastics",
        patterns: [
          "squat",
          "press",
          "gym_push"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "beginner"
      },
      {
        id: "parallel-bar-dips",
        name: "Parallel Bar Dips",
        category: "gymnastics",
        patterns: [
          "press",
          "gym_push"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "ring-dips",
        name: "Ring Dips",
        category: "gymnastics",
        patterns: [
          "press",
          "gym_push"
        ],
        equipment: [
          "ring",
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "russian-dips",
        name: "Russian Dips",
        category: "gymnastics",
        patterns: [
          "press",
          "gym_push"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "bar-muscle-ups",
        name: "Bar Muscle-ups",
        category: "gymnastics",
        patterns: [
          "gym_pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "ring-muscle-ups",
        name: "Ring Muscle-ups",
        category: "gymnastics",
        patterns: [
          "gym_pull"
        ],
        equipment: [
          "ring"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "muscle-up-negatives",
        name: "Muscle-up Negatives",
        category: "gymnastics",
        patterns: [
          "gym_pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "high-pull-ups",
        name: "High Pull-ups",
        category: "gymnastics",
        patterns: [
          "pull",
          "gym_pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "low-dip-holds",
        name: "Low Dip Holds",
        category: "gymnastics",
        patterns: [
          "press",
          "gym_push"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "transition-drills",
        name: "Transition Drills",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "kipping-pull-ups",
        name: "Kipping Pull-ups",
        category: "gymnastics",
        patterns: [
          "pull",
          "gym_pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "butterfly-pull-ups",
        name: "Butterfly Pull-ups",
        category: "gymnastics",
        patterns: [
          "pull",
          "gym_pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "kipping-chest-to-bar-pull-ups",
        name: "Kipping Chest-to-Bar Pull-ups",
        category: "gymnastics",
        patterns: [
          "pull",
          "gym_pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "butterfly-chest-to-bar",
        name: "Butterfly Chest-to-Bar",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "rope-climbs",
        name: "Rope Climbs",
        category: "gymnastics",
        patterns: [
          "gym_pull"
        ],
        equipment: [
          "rope"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "glide-kips",
        name: "Glide Kips",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "bar-pull-overs",
        name: "Bar Pull-overs",
        category: "gymnastics",
        patterns: [
          "pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "wall-facing-handstand-hold",
        name: "Wall-Facing Handstand Hold",
        category: "gymnastics",
        patterns: [
          "gym_push"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "wall-handstand-hold",
        name: "Wall Handstand Hold",
        category: "gymnastics",
        patterns: [
          "gym_push"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "freestanding-handstand",
        name: "Freestanding Handstand",
        category: "gymnastics",
        patterns: [
          "gym_push"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "handstand-on-parallettes",
        name: "Handstand on Parallettes",
        category: "gymnastics",
        patterns: [
          "gym_push"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "ring-handstand",
        name: "Ring Handstand",
        category: "gymnastics",
        patterns: [
          "gym_push"
        ],
        equipment: [
          "ring"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "one-arm-handstand",
        name: "One-Arm Handstand",
        category: "gymnastics",
        patterns: [
          "gym_push"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "tuck-l-sit",
        name: "Tuck L-sit",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "single-leg-l-sit",
        name: "Single-Leg L-sit",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "straddle-l-sit",
        name: "Straddle L-sit",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "full-l-sit",
        name: "Full L-sit",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "hanging-l-sit",
        name: "Hanging L-sit",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "l-sit-on-rings",
        name: "L-sit on Rings",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "ring"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "v-sit",
        name: "V-sit",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "hollow-body-hold",
        name: "Hollow Body Hold",
        category: "gymnastics",
        patterns: [
          "core"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "arch-body-hold",
        name: "Arch Body Hold",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "plank",
        name: "Plank",
        category: "gymnastics",
        patterns: [
          "core"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "elbow-plank",
        name: "Elbow Plank",
        category: "gymnastics",
        patterns: [
          "core"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "ring-support-hold",
        name: "Ring Support Hold",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "ring"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "top-of-push-up-hold",
        name: "Top of Push-up Hold",
        category: "gymnastics",
        patterns: [
          "press",
          "gym_push"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "front-lever",
        name: "Front Lever",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "back-lever",
        name: "Back Lever",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "iron-cross-progressions",
        name: "Iron Cross Progressions",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "german-hang",
        name: "German Hang",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "skin-the-cat",
        name: "Skin the Cat",
        category: "gymnastics",
        patterns: [
          "cardio"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "half-lever-holds",
        name: "Half Lever Holds",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "beat-swingkip-swing",
        name: "Beat Swing/Kip Swing",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "2-for-1-kipping-pull-ups",
        name: "2-for-1 Kipping Pull-ups",
        category: "gymnastics",
        patterns: [
          "pull",
          "gym_pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "kipping-handstand-push-ups",
        name: "Kipping Handstand Push-ups",
        category: "gymnastics",
        patterns: [
          "press",
          "gym_push"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "kipping-deficit-hspu",
        name: "Kipping Deficit HSPU",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "kipping-toes-to-bar",
        name: "Kipping Toes-to-Bar",
        category: "gymnastics",
        patterns: [
          "core"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "hip-pop-drills",
        name: "Hip Pop Drills",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "slow-closeopen-drills",
        name: "Slow Close/Open Drills",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "hollow-rocks",
        name: "Hollow Rocks",
        category: "gymnastics",
        patterns: [
          "core"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "arch-rocks",
        name: "Arch Rocks",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "alligator-drills",
        name: "Alligator Drills",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "superman-rocks",
        name: "Superman Rocks",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "strict-knees-to-elbows",
        name: "Strict Knees-to-Elbows",
        category: "gymnastics",
        patterns: [
          "core"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "beginner"
      },
      {
        id: "kipping-knees-to-elbows",
        name: "Kipping Knees-to-Elbows",
        category: "gymnastics",
        patterns: [
          "core"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "beginner"
      },
      {
        id: "strict-toes-to-bar",
        name: "Strict Toes-to-Bar",
        category: "gymnastics",
        patterns: [
          "core"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "strict-toes-to-rings",
        name: "Strict Toes-to-Rings",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "ring"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "around-the-world",
        name: "Around the World",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "windshield-wipers",
        name: "Windshield Wipers",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "hollow-sit-ups",
        name: "Hollow Sit-ups",
        category: "gymnastics",
        patterns: [
          "core"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "leg-lifts",
        name: "Leg Lifts",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "flutter-kicks",
        name: "Flutter Kicks",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "box-pike-push-ups",
        name: "Box Pike Push-ups",
        category: "gymnastics",
        patterns: [
          "squat",
          "press",
          "gym_push"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "beginner"
      },
      {
        id: "wall-walks",
        name: "Wall Walks",
        category: "gymnastics",
        patterns: [
          "carry"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "beginner"
      },
      {
        id: "handstand-holds-against-wall",
        name: "Handstand Holds Against Wall",
        category: "gymnastics",
        patterns: [
          "gym_push"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "partial-range-hspu",
        name: "Partial Range HSPU",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "strict-handstand-push-ups",
        name: "Strict Handstand Push-ups",
        category: "gymnastics",
        patterns: [
          "press",
          "gym_push"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "deficit-handstand-push-ups",
        name: "Deficit Handstand Push-ups",
        category: "gymnastics",
        patterns: [
          "press",
          "gym_push"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "freestanding-hspu",
        name: "Freestanding HSPU",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "straddle-press-to-handstand",
        name: "Straddle Press to Handstand",
        category: "gymnastics",
        patterns: [
          "press",
          "gym_push"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "headstands",
        name: "Headstands",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "tripod-headstands",
        name: "Tripod Headstands",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "kick-ups-to-handstand",
        name: "Kick-ups to Handstand",
        category: "gymnastics",
        patterns: [
          "gym_push"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "handstand-pirouettes",
        name: "Handstand Pirouettes",
        category: "gymnastics",
        patterns: [
          "gym_push"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "ring-support-holds",
        name: "Ring Support Holds",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "ring"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "single-arm-ring-extensions",
        name: "Single-Arm Ring Extensions",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "ring"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "ring-flyes",
        name: "Ring Flyes",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "ring"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "ring-l-sits",
        name: "Ring L-sits",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "ring"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "l-sit-to-shoulder-stand-on-rings",
        name: "L-sit to Shoulder Stand on Rings",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "ring"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "ball-up-on-rings",
        name: "Ball-up on Rings",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "ring"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "pass-through-on-rings",
        name: "Pass-through on Rings",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "ring"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "front-lever-on-rings",
        name: "Front Lever on Rings",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "ring"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "back-lever-on-rings",
        name: "Back Lever on Rings",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "ring"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "swing-to-backward-roll",
        name: "Swing to Backward Roll",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "shoot-through-on-rings",
        name: "Shoot-through on Rings",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "ring"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "ring-rollouts",
        name: "Ring Rollouts",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "ring"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "handstand-walks",
        name: "Handstand Walks",
        category: "gymnastics",
        patterns: [
          "carry",
          "gym_push"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "handstand-walk-intervals",
        name: "Handstand Walk Intervals",
        category: "gymnastics",
        patterns: [
          "carry",
          "gym_push"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "handstand-shoulder-taps",
        name: "Handstand Shoulder Taps",
        category: "gymnastics",
        patterns: [
          "gym_push"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "wall-facing-shoulder-taps",
        name: "Wall-Facing Shoulder Taps",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "beginner"
      },
      {
        id: "cargo-net-climbs",
        name: "Cargo Net Climbs",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "pole-climbs",
        name: "Pole Climbs",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "pegboard-climbs",
        name: "Pegboard Climbs",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "pistol-squats",
        name: "Pistol Squats",
        category: "gymnastics",
        patterns: [
          "squat"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "pistol-progressions",
        name: "Pistol Progressions",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "back-scales",
        name: "Back Scales",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "arabesque-holds",
        name: "Arabesque Holds",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "box-jump-overs",
        name: "Box Jump-overs",
        category: "gymnastics",
        patterns: [
          "squat",
          "jump"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "beginner"
      },
      {
        id: "burpees",
        name: "Burpees",
        category: "gymnastics",
        patterns: [
          "cardio"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "burpee-box-jump-overs",
        name: "Burpee Box Jump-overs",
        category: "gymnastics",
        patterns: [
          "squat",
          "jump",
          "cardio"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "beginner"
      },
      {
        id: "squat-jumps",
        name: "Squat Jumps",
        category: "gymnastics",
        patterns: [
          "squat",
          "jump"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "tuck-jumps",
        name: "Tuck Jumps",
        category: "gymnastics",
        patterns: [
          "jump"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "box-step-ups",
        name: "Box Step-ups",
        category: "gymnastics",
        patterns: [
          "squat"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "beginner"
      },
      {
        id: "jump-overs",
        name: "Jump-overs",
        category: "gymnastics",
        patterns: [
          "jump"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "double-unders",
        name: "Double-unders",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "single-unders",
        name: "Single-unders",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "triple-unders",
        name: "Triple-unders",
        category: "gymnastics",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "intermediate"
      },
      {
        id: "clean",
        name: "Clean",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "clean-and-jerk",
        name: "Clean and Jerk",
        category: "crossfit",
        patterns: [
          "olympic_cleanjerk"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "clean-and-push-jerk",
        name: "Clean and Push Jerk",
        category: "crossfit",
        patterns: [
          "olympic_cleanjerk",
          "press"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "power-clean-and-split-jerk",
        name: "Power Clean and Split Jerk",
        category: "crossfit",
        patterns: [
          "olympic_cleanjerk"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "hang-clean-and-push-jerk",
        name: "Hang Clean and Push Jerk",
        category: "crossfit",
        patterns: [
          "olympic_cleanjerk",
          "press"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "thruster",
        name: "Thruster",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "cluster",
        name: "Cluster",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "ground-to-overhead",
        name: "Ground-to-Overhead",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "shoulder-to-overhead",
        name: "Shoulder-to-Overhead",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "air-squat",
        name: "Air Squat",
        category: "crossfit",
        patterns: [
          "squat"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "shoulder-press",
        name: "Shoulder Press",
        category: "crossfit",
        patterns: [
          "press"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "push-jerk",
        name: "Push Jerk",
        category: "crossfit",
        patterns: [
          "press"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "sumo-deadlift-high-pull",
        name: "Sumo Deadlift High Pull",
        category: "crossfit",
        patterns: [
          "hinge",
          "pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "medicine-ball-clean",
        name: "Medicine Ball Clean",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "ball"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "conventionalsumo-deadlift",
        name: "Conventional/Sumo Deadlift",
        category: "crossfit",
        patterns: [
          "hinge"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "good-morning",
        name: "Good Morning",
        category: "crossfit",
        patterns: [
          "hinge"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "high-pull",
        name: "High Pull",
        category: "crossfit",
        patterns: [
          "pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "backfront-rack-lunge",
        name: "Back/Front Rack Lunge",
        category: "crossfit",
        patterns: [
          "squat",
          "lunge"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "overhead-walking-lunge",
        name: "Overhead Walking Lunge",
        category: "crossfit",
        patterns: [
          "squat",
          "lunge",
          "carry"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "dumbbell-snatch",
        name: "Dumbbell Snatch",
        category: "crossfit",
        patterns: [
          "olympic_snatch"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "db-power-snatch",
        name: "DB Power Snatch",
        category: "crossfit",
        patterns: [
          "olympic_snatch"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "db-squat-snatch",
        name: "DB Squat Snatch",
        category: "crossfit",
        patterns: [
          "olympic_snatch",
          "squat"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "dumbbell-clean",
        name: "Dumbbell Clean",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "db-hang-clean",
        name: "DB Hang Clean",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "db-hang-power-clean",
        name: "DB Hang Power Clean",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "db-power-clean",
        name: "DB Power Clean",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "dumbbell-clean-and-jerk",
        name: "Dumbbell Clean and Jerk",
        category: "crossfit",
        patterns: [
          "olympic_cleanjerk"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "db-push-jerk",
        name: "DB Push Jerk",
        category: "crossfit",
        patterns: [
          "press"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "db-push-press",
        name: "DB Push Press",
        category: "crossfit",
        patterns: [
          "press"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "db-thruster",
        name: "DB Thruster",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "db-front-squat",
        name: "DB Front Squat",
        category: "crossfit",
        patterns: [
          "squat"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "db-overhead-squat",
        name: "DB Overhead Squat",
        category: "crossfit",
        patterns: [
          "squat"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "db-deadlift",
        name: "DB Deadlift",
        category: "crossfit",
        patterns: [
          "hinge"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "db-rdl",
        name: "DB RDL",
        category: "crossfit",
        patterns: [
          "hinge"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "db-front-rack-lunge",
        name: "DB Front Rack Lunge",
        category: "crossfit",
        patterns: [
          "squat",
          "lunge"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "db-overhead-walking-lunge",
        name: "DB Overhead Walking Lunge",
        category: "crossfit",
        patterns: [
          "squat",
          "lunge",
          "carry"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "db-box-step-ups",
        name: "DB Box Step-ups",
        category: "crossfit",
        patterns: [
          "squat"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "db-farmers-carry",
        name: "DB Farmers Carry",
        category: "crossfit",
        patterns: [
          "carry"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "db-overhead-press",
        name: "DB Overhead Press",
        category: "crossfit",
        patterns: [
          "press"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "db-man-maker",
        name: "DB Man Maker",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "db-turkish-get-up",
        name: "DB Turkish Get-up",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "db-renegade-row",
        name: "DB Renegade Row",
        category: "crossfit",
        patterns: [
          "pull",
          "cardio"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "db-push-up-to-row",
        name: "DB Push-up to Row",
        category: "crossfit",
        patterns: [
          "press",
          "pull",
          "cardio"
        ],
        equipment: [
          "dumbbell",
          "bodyweight"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "db-russian-twist",
        name: "DB Russian Twist",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "db-surrenders",
        name: "DB Surrenders",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "dumbbell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "kb-swing",
        name: "KB Swing",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "kettlebell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "kb-snatch",
        name: "KB Snatch",
        category: "crossfit",
        patterns: [
          "olympic_snatch"
        ],
        equipment: [
          "kettlebell"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "kb-clean",
        name: "KB Clean",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "kettlebell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "kb-clean-and-jerk",
        name: "KB Clean and Jerk",
        category: "crossfit",
        patterns: [
          "olympic_cleanjerk"
        ],
        equipment: [
          "kettlebell"
        ],
        modality: "skill",
        level: "advanced"
      },
      {
        id: "kb-thruster",
        name: "KB Thruster",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "kettlebell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "kb-goblet-squat",
        name: "KB Goblet Squat",
        category: "crossfit",
        patterns: [
          "squat"
        ],
        equipment: [
          "kettlebell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "kb-front-squat",
        name: "KB Front Squat",
        category: "crossfit",
        patterns: [
          "squat"
        ],
        equipment: [
          "kettlebell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "kb-turkish-get-up",
        name: "KB Turkish Get-up",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "kettlebell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "kb-deadlift",
        name: "KB Deadlift",
        category: "crossfit",
        patterns: [
          "hinge"
        ],
        equipment: [
          "kettlebell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "kb-good-morning",
        name: "KB Good Morning",
        category: "crossfit",
        patterns: [
          "hinge"
        ],
        equipment: [
          "kettlebell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "kb-gorilla-row",
        name: "KB Gorilla Row",
        category: "crossfit",
        patterns: [
          "pull",
          "cardio"
        ],
        equipment: [
          "kettlebell"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "kb-front-raise",
        name: "KB Front Raise",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "kettlebell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "kb-halo",
        name: "KB Halo",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "kettlebell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "kb-taters",
        name: "KB Taters",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "kettlebell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "kb-farmers-carry",
        name: "KB Farmers Carry",
        category: "crossfit",
        patterns: [
          "carry"
        ],
        equipment: [
          "kettlebell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "kb-windmill",
        name: "KB Windmill",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "kettlebell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "kb-box-step-ups",
        name: "KB Box Step-ups",
        category: "crossfit",
        patterns: [
          "squat"
        ],
        equipment: [
          "kettlebell"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "strict-pull-up",
        name: "Strict Pull-up",
        category: "crossfit",
        patterns: [
          "pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "kipping-pull-up",
        name: "Kipping Pull-up",
        category: "crossfit",
        patterns: [
          "pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "butterfly-pull-up",
        name: "Butterfly Pull-up",
        category: "crossfit",
        patterns: [
          "pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "chest-to-bar",
        name: "Chest-to-Bar",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "l-pull-up",
        name: "L Pull-up",
        category: "crossfit",
        patterns: [
          "pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "weighted-pull-up",
        name: "Weighted Pull-up",
        category: "crossfit",
        patterns: [
          "pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "advanced"
      },
      {
        id: "jumping-pull-up",
        name: "Jumping Pull-up",
        category: "crossfit",
        patterns: [
          "pull",
          "jump"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "banded-pull-up",
        name: "Banded Pull-up",
        category: "crossfit",
        patterns: [
          "pull"
        ],
        equipment: [
          "band",
          "bodyweight"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "negative-pull-up",
        name: "Negative Pull-up",
        category: "crossfit",
        patterns: [
          "pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "chin-up",
        name: "Chin-up",
        category: "crossfit",
        patterns: [
          "pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "strictkipping-bar-muscle-up",
        name: "Strict/Kipping Bar Muscle-up",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "advanced"
      },
      {
        id: "toes-to-bar",
        name: "Toes-to-Bar",
        category: "crossfit",
        patterns: [
          "core"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "knees-to-elbows",
        name: "Knees-to-Elbows",
        category: "crossfit",
        patterns: [
          "core"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "toes-to-rings",
        name: "Toes-to-Rings",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "ring"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "hanging-windshield-wiper",
        name: "Hanging Windshield Wiper",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "strictkipping-ring-muscle-up",
        name: "Strict/Kipping Ring Muscle-up",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "ring"
        ],
        modality: "strength",
        level: "advanced"
      },
      {
        id: "ring-dip",
        name: "Ring Dip",
        category: "crossfit",
        patterns: [
          "press"
        ],
        equipment: [
          "ring",
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "ring-push-up",
        name: "Ring Push-up",
        category: "crossfit",
        patterns: [
          "press"
        ],
        equipment: [
          "ring",
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "ring-row",
        name: "Ring Row",
        category: "crossfit",
        patterns: [
          "pull",
          "cardio"
        ],
        equipment: [
          "ring"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "pull-over",
        name: "Pull-over",
        category: "crossfit",
        patterns: [
          "pull"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "shoot-through",
        name: "Shoot-through",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "l-sit-to-shoulder-stand",
        name: "L-sit to Shoulder Stand",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "handstand-hold",
        name: "Handstand Hold",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "advanced"
      },
      {
        id: "handstand-walk",
        name: "Handstand Walk",
        category: "crossfit",
        patterns: [
          "carry"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "advanced"
      },
      {
        id: "handstand-push-up",
        name: "Handstand Push-up",
        category: "crossfit",
        patterns: [
          "press"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "advanced"
      },
      {
        id: "deficit-hspu",
        name: "Deficit HSPU",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "advanced"
      },
      {
        id: "wall-facing-hspu",
        name: "Wall-Facing HSPU",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "handstand-pirouette",
        name: "Handstand Pirouette",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "advanced"
      },
      {
        id: "push-up-standard",
        name: "Push-up (Standard",
        category: "crossfit",
        patterns: [
          "press"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "hand-release",
        name: "Hand-Release)",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "knee-push-up",
        name: "Knee Push-up",
        category: "crossfit",
        patterns: [
          "press"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "deficit-push-up",
        name: "Deficit Push-up",
        category: "crossfit",
        patterns: [
          "press"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "advanced"
      },
      {
        id: "dip",
        name: "Dip",
        category: "crossfit",
        patterns: [
          "press"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "sit-up",
        name: "Sit-up",
        category: "crossfit",
        patterns: [
          "core"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "ghd-sit-up",
        name: "GHD Sit-up",
        category: "crossfit",
        patterns: [
          "core"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "v-up",
        name: "V-up",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "tuck-up",
        name: "Tuck-up",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "hollow-rock",
        name: "Hollow Rock",
        category: "crossfit",
        patterns: [
          "core"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "hollow-hold",
        name: "Hollow Hold",
        category: "crossfit",
        patterns: [
          "core"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "l-sit",
        name: "L-sit",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "leg-raises",
        name: "Leg Raises",
        category: "crossfit",
        patterns: [
          "core"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "mountain-climber",
        name: "Mountain Climber",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate",
        banned_in_main_when_equipment: true
      },
      {
        id: "knee-to-opposite-elbow-mountain-climber",
        name: "Knee-to-Opposite-Elbow Mountain Climber",
        category: "crossfit",
        patterns: [
          "core"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "pistol",
        name: "Pistol",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "advanced"
      },
      {
        id: "alternating-pistols",
        name: "Alternating Pistols",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "advanced"
      },
      {
        id: "squat-jump",
        name: "Squat Jump",
        category: "crossfit",
        patterns: [
          "squat",
          "jump"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "burpee",
        name: "Burpee",
        category: "crossfit",
        patterns: [
          "cardio"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "squat-thrust",
        name: "Squat Thrust",
        category: "crossfit",
        patterns: [
          "squat"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "bear-crawl",
        name: "Bear Crawl",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "crab-walk",
        name: "Crab Walk",
        category: "crossfit",
        patterns: [
          "carry"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "glide-kip",
        name: "Glide Kip",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "ghd-hip-extension",
        name: "GHD Hip Extension",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "ghd-back-extension",
        name: "GHD Back Extension",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "ghd-hip-and-back-extension",
        name: "GHD Hip and Back Extension",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "running",
        name: "Running",
        category: "crossfit",
        patterns: [
          "cardio"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "sprinting",
        name: "Sprinting",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "shuttle-runs",
        name: "Shuttle Runs",
        category: "crossfit",
        patterns: [
          "cardio"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "row",
        name: "Row",
        category: "crossfit",
        patterns: [
          "pull",
          "cardio"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "calorie-row",
        name: "Calorie Row",
        category: "crossfit",
        patterns: [
          "pull",
          "cardio"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "assault-bikeair-bike",
        name: "Assault Bike/Air Bike",
        category: "crossfit",
        patterns: [
          "cardio"
        ],
        equipment: [
          "bike"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "echo-bike",
        name: "Echo Bike",
        category: "crossfit",
        patterns: [
          "cardio"
        ],
        equipment: [
          "bike"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "stationary-bikeerg-bike",
        name: "Stationary Bike/Erg Bike",
        category: "crossfit",
        patterns: [
          "cardio"
        ],
        equipment: [
          "bike"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "crossovers",
        name: "Crossovers",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "one-foot-singles",
        name: "One-foot Singles",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "penguin-taps",
        name: "Penguin Taps",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "ski-erg",
        name: "Ski Erg",
        category: "crossfit",
        patterns: [
          "cardio"
        ],
        equipment: [
          "ski"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "swimming",
        name: "Swimming",
        category: "crossfit",
        patterns: [
          "cardio"
        ],
        equipment: [
          "pool"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "box-jump-over",
        name: "Box Jump-over",
        category: "crossfit",
        patterns: [
          "squat",
          "jump"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "complete-box-jump-over",
        name: "Complete Box Jump-over",
        category: "crossfit",
        patterns: [
          "squat",
          "jump"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "burpee-box-jump",
        name: "Burpee Box Jump",
        category: "crossfit",
        patterns: [
          "squat",
          "jump",
          "cardio"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "conditioning",
        level: "beginner"
      },
      {
        id: "burpee-box-jump-over",
        name: "Burpee Box Jump-over",
        category: "crossfit",
        patterns: [
          "squat",
          "jump",
          "cardio"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "conditioning",
        level: "beginner"
      },
      {
        id: "bar-facing-burpee",
        name: "Bar-Facing Burpee",
        category: "crossfit",
        patterns: [
          "cardio"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "box-facing-burpee",
        name: "Box-Facing Burpee",
        category: "crossfit",
        patterns: [
          "squat",
          "cardio"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "conditioning",
        level: "beginner"
      },
      {
        id: "box-step-over",
        name: "Box Step-over",
        category: "crossfit",
        patterns: [
          "squat"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "depth-drop",
        name: "Depth Drop",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "seated-box-jump",
        name: "Seated Box Jump",
        category: "crossfit",
        patterns: [
          "squat",
          "jump"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "wall-ball",
        name: "Wall Ball",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "ball"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "wall-walk",
        name: "Wall Walk",
        category: "crossfit",
        patterns: [
          "carry"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "beginner"
      },
      {
        id: "medicine-ball-toss",
        name: "Medicine Ball Toss",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "ball"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "slam-ball",
        name: "Slam Ball",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "ball"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "rope-climb",
        name: "Rope Climb",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "rope"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "legless-rope-climb",
        name: "Legless Rope Climb",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "rope"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "l-sit-rope-climb",
        name: "L-sit Rope Climb",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "rope"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "sandbag-clean",
        name: "Sandbag Clean",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "sandbag"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "sandbag-carry",
        name: "Sandbag Carry",
        category: "crossfit",
        patterns: [
          "carry"
        ],
        equipment: [
          "sandbag"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "sandbag-throw",
        name: "Sandbag Throw",
        category: "crossfit",
        patterns: [
          "pull",
          "cardio"
        ],
        equipment: [
          "sandbag"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "sandbag-squat",
        name: "Sandbag Squat",
        category: "crossfit",
        patterns: [
          "squat"
        ],
        equipment: [
          "sandbag"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "sled-push",
        name: "Sled Push",
        category: "crossfit",
        patterns: [
          "press"
        ],
        equipment: [
          "sled"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "sled-pulldrag",
        name: "Sled Pull/Drag",
        category: "crossfit",
        patterns: [
          "pull"
        ],
        equipment: [
          "sled"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "d-ball-clean",
        name: "D-Ball Clean",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "d-ball-throw",
        name: "D-Ball Throw",
        category: "crossfit",
        patterns: [
          "pull",
          "cardio"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "conditioning",
        level: "intermediate"
      },
      {
        id: "d-ball-carry",
        name: "D-Ball Carry",
        category: "crossfit",
        patterns: [
          "carry"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "dumbbellkettlebellheavy-object-carry",
        name: "Dumbbell/Kettlebell/Heavy Object Carry",
        category: "crossfit",
        patterns: [
          "carry"
        ],
        equipment: [
          "dumbbell",
          "kettlebell"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "tire-flip",
        name: "Tire Flip",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "axle-lift",
        name: "Axle Lift",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "yoke-carry",
        name: "Yoke Carry",
        category: "crossfit",
        patterns: [
          "carry"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "stone-liftatlas-stone",
        name: "Stone Lift/Atlas Stone",
        category: "crossfit",
        patterns: [
          "general"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "strength",
        level: "intermediate"
      },
      {
        id: "leg-swings-forwardbackward",
        name: "Leg Swings (Forward/Backward",
        category: "mobility",
        patterns: [
          "mobility_dynamic"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "side-to-side",
        name: "Side-to-Side)",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "walking-high-knees",
        name: "Walking High Knees",
        category: "mobility",
        patterns: [
          "carry",
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "beginner"
      },
      {
        id: "butt-kicks",
        name: "Butt Kicks",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "lunge-with-twist",
        name: "Lunge with Twist",
        category: "mobility",
        patterns: [
          "squat",
          "lunge",
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "cossack-squats",
        name: "Cossack Squats",
        category: "mobility",
        patterns: [
          "squat",
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "walking-quad-stretch",
        name: "Walking Quad Stretch",
        category: "mobility",
        patterns: [
          "carry",
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "walking-hamstring-sweeps",
        name: "Walking Hamstring Sweeps",
        category: "mobility",
        patterns: [
          "carry",
          "mobility_static"
        ],
        equipment: [
          "ring"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "frankenstein-walks",
        name: "Frankenstein Walks",
        category: "mobility",
        patterns: [
          "carry",
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "hip-circles",
        name: "Hip Circles",
        category: "mobility",
        patterns: [
          "mobility_dynamic"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "openclose-gate",
        name: "Open/Close Gate",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "leg-kicks",
        name: "Leg Kicks",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "dynamic-pigeon-stretch",
        name: "Dynamic Pigeon Stretch",
        category: "mobility",
        patterns: [
          "mobility_dynamic"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "ankle-rockers",
        name: "Ankle Rockers",
        category: "mobility",
        patterns: [
          "mobility_dynamic"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "ankle-pumps",
        name: "Ankle Pumps",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "scorpion-kicks",
        name: "Scorpion Kicks",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "standing-hamstring-stretch",
        name: "Standing Hamstring Stretch",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "ring"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "seated-hamstring-stretch",
        name: "Seated Hamstring Stretch",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "ring"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "supine-hamstring-stretch",
        name: "Supine Hamstring Stretch",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "ring"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "lying-hamstring-stretch",
        name: "Lying Hamstring Stretch",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "ring"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "standing-quad-stretch",
        name: "Standing Quad Stretch",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "kneeling-hip-flexor-stretch",
        name: "Kneeling Hip Flexor Stretch",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "beginner"
      },
      {
        id: "low-lunge",
        name: "Low Lunge",
        category: "mobility",
        patterns: [
          "squat",
          "lunge",
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "standing-calf-stretch",
        name: "Standing Calf Stretch",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "wall-calf-stretch",
        name: "Wall Calf Stretch",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "beginner"
      },
      {
        id: "seated-calf-stretch",
        name: "Seated Calf Stretch",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "butterfly-stretch",
        name: "Butterfly Stretch",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "frog-stretch",
        name: "Frog Stretch",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "9090-hip-stretch",
        name: "90/90 Hip Stretch",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "figure-4-stretch",
        name: "Figure-4 Stretch",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "reclined-pigeon-pose",
        name: "Reclined Pigeon Pose",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "seated-forward-fold",
        name: "Seated Forward Fold",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "wide-legged-forward-fold",
        name: "Wide-Legged Forward Fold",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "lizard-pose",
        name: "Lizard Pose",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "dragon-pose",
        name: "Dragon Pose",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "happy-baby-pose",
        name: "Happy Baby Pose",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "supine-twist",
        name: "Supine Twist",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "it-band-stretch",
        name: "IT Band Stretch",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "band"
        ],
        modality: "mobility",
        level: "beginner"
      },
      {
        id: "adductor-stretch",
        name: "Adductor Stretch",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "hip-cars",
        name: "Hip CARs",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "9090-hip-rotation",
        name: "90/90 Hip Rotation",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "fire-hydrants",
        name: "Fire Hydrants",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "clamshells",
        name: "Clamshells",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "frog-rocks",
        name: "Frog Rocks",
        category: "mobility",
        patterns: [
          "mobility_dynamic"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "shin-box-transitions",
        name: "Shin Box Transitions",
        category: "mobility",
        patterns: [
          "squat",
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "beginner"
      },
      {
        id: "hip-airplanes",
        name: "Hip Airplanes",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "walking-hip-openers",
        name: "Walking Hip Openers",
        category: "mobility",
        patterns: [
          "carry",
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "seated-hip-flexor-rocks",
        name: "Seated Hip Flexor Rocks",
        category: "mobility",
        patterns: [
          "mobility_dynamic"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "posterior-hip-capsule-stretch",
        name: "Posterior Hip Capsule Stretch",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "deep-squat-hold",
        name: "Deep Squat Hold",
        category: "mobility",
        patterns: [
          "squat",
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "ankle-circles",
        name: "Ankle Circles",
        category: "mobility",
        patterns: [
          "mobility_dynamic"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "alphabet-ankles",
        name: "Alphabet Ankles",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "ankle-dorsiflexion-wall-stretch",
        name: "Ankle Dorsiflexion Wall Stretch",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "beginner"
      },
      {
        id: "ankle-dorsiflexion",
        name: "Ankle Dorsiflexion",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "ankle-inversioneversion",
        name: "Ankle Inversion/Eversion",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "toe-raises",
        name: "Toe Raises",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "heel-walks",
        name: "Heel Walks",
        category: "mobility",
        patterns: [
          "carry",
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "downward-dog-pedals",
        name: "Downward Dog Pedals",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "knee-flexionextension",
        name: "Knee Flexion/Extension",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "beginner"
      },
      {
        id: "knee-circles",
        name: "Knee Circles",
        category: "mobility",
        patterns: [
          "mobility_dynamic"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "beginner"
      },
      {
        id: "quad-sets",
        name: "Quad Sets",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "arm-circles",
        name: "Arm Circles",
        category: "mobility",
        patterns: [
          "mobility_dynamic"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "arm-swings",
        name: "Arm Swings",
        category: "mobility",
        patterns: [
          "mobility_dynamic"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "shoulder-pass-throughs",
        name: "Shoulder Pass-Throughs",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "scapular-push-ups",
        name: "Scapular Push-Ups",
        category: "mobility",
        patterns: [
          "press",
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "thread-the-needle",
        name: "Thread the Needle",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "quadruped-thoracic-rotations",
        name: "Quadruped Thoracic Rotations",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "trunk-rotations",
        name: "Trunk Rotations",
        category: "mobility",
        patterns: [
          "cardio",
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "cross-arm-shoulder-stretch",
        name: "Cross-Arm Shoulder Stretch",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "overhead-tricep-stretch",
        name: "Overhead Tricep Stretch",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "behind-back-shoulder-stretch",
        name: "Behind-Back Shoulder Stretch",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "doorway-pec-stretch",
        name: "Doorway Pec Stretch",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "eagle-arms",
        name: "Eagle Arms",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "cow-face-arms",
        name: "Cow Face Arms",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "clasped-hands-behind-back",
        name: "Clasped Hands Behind Back",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "wall-angels",
        name: "Wall Angels",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "beginner"
      },
      {
        id: "childs-pose",
        name: "Child's Pose",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "shoulder-cars",
        name: "Shoulder CARs",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "wall-slides",
        name: "Wall Slides",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "beginner"
      },
      {
        id: "shoulder-dislocates",
        name: "Shoulder Dislocates",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "pendulum-swings",
        name: "Pendulum Swings",
        category: "mobility",
        patterns: [
          "mobility_dynamic"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "sleeper-stretch",
        name: "Sleeper Stretch",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "lat-stretch",
        name: "Lat Stretch",
        category: "mobility",
        patterns: [
          "pull",
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "wrist-circles",
        name: "Wrist Circles",
        category: "mobility",
        patterns: [
          "mobility_dynamic"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "wrist-flexionextension-stretches",
        name: "Wrist Flexion/Extension Stretches",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "wrist-flexor-stretch",
        name: "Wrist Flexor Stretch",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "prayer-position-stretch",
        name: "Prayer Position Stretch",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "reverse-prayer-stretch",
        name: "Reverse Prayer Stretch",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "quadruped-wrist-mobilization",
        name: "Quadruped Wrist Mobilization",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "bicep-stretch",
        name: "Bicep Stretch",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "cat-cow-pose",
        name: "Cat-Cow Pose",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "thoracic-bridge",
        name: "Thoracic Bridge",
        category: "mobility",
        patterns: [
          "hinge",
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "book-openers",
        name: "Book Openers",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "foam-roller-thoracic-extensions",
        name: "Foam Roller Thoracic Extensions",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "quadruped-thoracic-rotation",
        name: "Quadruped Thoracic Rotation",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "seated-thoracic-rotation",
        name: "Seated Thoracic Rotation",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "side-lying-thoracic-rotation",
        name: "Side-Lying Thoracic Rotation",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "neck-circles",
        name: "Neck Circles",
        category: "mobility",
        patterns: [
          "mobility_dynamic"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "neck-tilts",
        name: "Neck Tilts",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "neck-flexionextension",
        name: "Neck Flexion/Extension",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "chin-tucks",
        name: "Chin Tucks",
        category: "mobility",
        patterns: [
          "pull",
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "neck-rotations",
        name: "Neck Rotations",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "levator-scapulae-stretch",
        name: "Levator Scapulae Stretch",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "knee-to-chest-stretch",
        name: "Knee-to-Chest Stretch",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "beginner"
      },
      {
        id: "supine-spinal-twist",
        name: "Supine Spinal Twist",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "cobra-pose",
        name: "Cobra Pose",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "sphinx-pose",
        name: "Sphinx Pose",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "pelvic-tilts",
        name: "Pelvic Tilts",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "calves",
        name: "Calves",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "hamstrings",
        name: "Hamstrings",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "ring"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "quadriceps",
        name: "Quadriceps",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "it-band",
        name: "IT Band",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "band"
        ],
        modality: "mobility",
        level: "beginner"
      },
      {
        id: "adductors",
        name: "Adductors",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "glutes",
        name: "Glutes",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "hip-flexors",
        name: "Hip Flexors",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "tfl",
        name: "TFL",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "upper-backrhomboids",
        name: "Upper Back/Rhomboids",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "lats",
        name: "Lats",
        category: "mobility",
        patterns: [
          "pull",
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "thoracic-spine",
        name: "Thoracic Spine",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "shouldersdeltoids",
        name: "Shoulders/Deltoids",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "pecs",
        name: "Pecs",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "triceps",
        name: "Triceps",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "forearms",
        name: "Forearms",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "mid-back-roller",
        name: "Mid-Back Roller",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "lower-back",
        name: "Lower Back",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "neck",
        name: "Neck",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "hold-relax",
        name: "Hold-Relax",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "contract-relax-antagonist-contract",
        name: "Contract-Relax-Antagonist-Contract",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "hold-relax-swing",
        name: "Hold-Relax-Swing",
        category: "mobility",
        patterns: [
          "mobility_dynamic"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "hamstring-pnf-stretch",
        name: "Hamstring PNF Stretch",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "ring"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "hip-flexor-pnf",
        name: "Hip Flexor PNF",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "shoulder-pnf",
        name: "Shoulder PNF",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "calf-pnf",
        name: "Calf PNF",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "quadriceps-pnf",
        name: "Quadriceps PNF",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "adductor-pnf",
        name: "Adductor PNF",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "shoulder-circles",
        name: "Shoulder Circles",
        category: "mobility",
        patterns: [
          "mobility_dynamic"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "elbow-circles",
        name: "Elbow Circles",
        category: "mobility",
        patterns: [
          "mobility_dynamic"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "neck-circlesrolls",
        name: "Neck Circles/Rolls",
        category: "mobility",
        patterns: [
          "mobility_dynamic"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "toe-circles",
        name: "Toe Circles",
        category: "mobility",
        patterns: [
          "mobility_dynamic"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "torso-circles",
        name: "Torso Circles",
        category: "mobility",
        patterns: [
          "mobility_dynamic"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "pelvic-circles",
        name: "Pelvic Circles",
        category: "mobility",
        patterns: [
          "mobility_dynamic"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "ribcage-circles",
        name: "Ribcage Circles",
        category: "mobility",
        patterns: [
          "mobility_dynamic"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "glute-bridges",
        name: "Glute Bridges",
        category: "mobility",
        patterns: [
          "hinge",
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "banded-glute-bridge",
        name: "Banded Glute Bridge",
        category: "mobility",
        patterns: [
          "hinge",
          "mobility_static"
        ],
        equipment: [
          "band"
        ],
        modality: "mobility",
        level: "beginner"
      },
      {
        id: "glute-bridge-with-abduction",
        name: "Glute Bridge with Abduction",
        category: "mobility",
        patterns: [
          "hinge",
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "hip-thrusts",
        name: "Hip Thrusts",
        category: "mobility",
        patterns: [
          "hinge",
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "donkey-kicks",
        name: "Donkey Kicks",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "monster-walks",
        name: "Monster Walks",
        category: "mobility",
        patterns: [
          "carry",
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "lateral-band-walks",
        name: "Lateral Band Walks",
        category: "mobility",
        patterns: [
          "pull",
          "carry",
          "mobility_static"
        ],
        equipment: [
          "band"
        ],
        modality: "mobility",
        level: "beginner"
      },
      {
        id: "frog-pumps",
        name: "Frog Pumps",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "scapular-wall-slides",
        name: "Scapular Wall Slides",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "beginner"
      },
      {
        id: "ytwls",
        name: "YTWLs",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "prone-cobras",
        name: "Prone Cobras",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "superman-hold",
        name: "Superman Hold",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "blackburns",
        name: "Blackburns",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "dead-bugs",
        name: "Dead Bugs",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "bird-dogs",
        name: "Bird Dogs",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "plank-variations",
        name: "Plank Variations",
        category: "mobility",
        patterns: [
          "core",
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "side-planks",
        name: "Side Planks",
        category: "mobility",
        patterns: [
          "core",
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "lizard-crawl",
        name: "Lizard Crawl",
        category: "mobility",
        patterns: [
          "mobility_dynamic"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "spider-man-crawl",
        name: "Spider-Man Crawl",
        category: "mobility",
        patterns: [
          "mobility_dynamic"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "monkey-walks",
        name: "Monkey Walks",
        category: "mobility",
        patterns: [
          "carry",
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "frogger",
        name: "Frogger",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "inchworm",
        name: "Inchworm",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "alligator-crawl",
        name: "Alligator Crawl",
        category: "mobility",
        patterns: [
          "mobility_dynamic"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "seal-slide",
        name: "Seal Slide",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "snake-slither",
        name: "Snake Slither",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "tiger-crawl",
        name: "Tiger Crawl",
        category: "mobility",
        patterns: [
          "mobility_dynamic"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "turtle-crawl",
        name: "Turtle Crawl",
        category: "mobility",
        patterns: [
          "mobility_dynamic"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "gorilla-walk",
        name: "Gorilla Walk",
        category: "mobility",
        patterns: [
          "carry",
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "animal-flow-sequences",
        name: "Animal Flow Sequences",
        category: "mobility",
        patterns: [
          "mobility_dynamic"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "scorpion-reach",
        name: "Scorpion Reach",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "beast-wave",
        name: "Beast Wave",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "side-kickthrough",
        name: "Side Kickthrough",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "traveling-beast",
        name: "Traveling Beast",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "traveling-crab",
        name: "Traveling Crab",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "kangaroo-jumps",
        name: "Kangaroo Jumps",
        category: "mobility",
        patterns: [
          "jump",
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "elephant-swings",
        name: "Elephant Swings",
        category: "mobility",
        patterns: [
          "mobility_dynamic"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "penguin-walk",
        name: "Penguin Walk",
        category: "mobility",
        patterns: [
          "carry",
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "horse-rungalloping",
        name: "Horse Run/Galloping",
        category: "mobility",
        patterns: [
          "cardio",
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "basic-belly-breathing",
        name: "Basic Belly Breathing",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "pursed-lip-breathing",
        name: "Pursed-Lip Breathing",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "9090-breathing",
        name: "90/90 Breathing",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "4-7-8-breathing",
        name: "4-7-8 Breathing",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "box-breathing",
        name: "Box Breathing",
        category: "mobility",
        patterns: [
          "squat",
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "beginner"
      },
      {
        id: "physiological-sigh",
        name: "Physiological Sigh",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "humming-breath",
        name: "Humming Breath",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "balloon-breathing",
        name: "Balloon Breathing",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "coordinated-breathing",
        name: "Coordinated Breathing",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "ribcage-breathing",
        name: "Ribcage Breathing",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "sun-salutation-a-b",
        name: "Sun Salutation A & B",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "worlds-greatest-stretch-sequence",
        name: "World's Greatest Stretch Sequence",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "spiderman-lunge-to-reach",
        name: "Spiderman Lunge to Reach",
        category: "mobility",
        patterns: [
          "squat",
          "lunge",
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "inchworm-to-push-up",
        name: "Inchworm to Push-Up",
        category: "mobility",
        patterns: [
          "press",
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "bear-crawl-to-downward-dog",
        name: "Bear Crawl to Downward Dog",
        category: "mobility",
        patterns: [
          "mobility_dynamic"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      },
      {
        id: "turkish-get-up",
        name: "Turkish Get-Up",
        category: "mobility",
        patterns: [
          "mobility_static"
        ],
        equipment: [
          "bodyweight"
        ],
        modality: "mobility",
        level: "intermediate"
      }
    ];
  }
});

// server/ai/config/stylePolicies.ts
var init_stylePolicies = __esm({
  "server/ai/config/stylePolicies.ts"() {
    "use strict";
  }
});

// server/ai/config/styleSpecs.ts
var init_styleSpecs = __esm({
  "server/ai/config/styleSpecs.ts"() {
    "use strict";
  }
});

// server/lib/style.ts
function normalizeStyle(input) {
  const raw = String(input ?? "").trim().toLowerCase();
  const map = {
    crossfit: "crossfit",
    cf: "crossfit",
    oly: "olympic_weightlifting",
    olympic: "olympic_weightlifting",
    olympic_weightlifting: "olympic_weightlifting",
    powerlifting: "powerlifting",
    pl: "powerlifting",
    bb_full_body: "bb_full_body",
    "bb full body": "bb_full_body",
    bbfull: "bb_full_body",
    bb_upper: "bb_upper",
    bb_lower: "bb_lower",
    aerobic: "aerobic",
    conditioning: "conditioning",
    strength: "strength",
    endurance: "endurance",
    gymnastics: "gymnastics",
    mobility: "mobility",
    mixed: "mixed"
  };
  if (map[raw]) return map[raw];
  if (raw.includes("olympic")) return "olympic_weightlifting";
  if (raw.includes("bodybuilding")) return "bb_full_body";
  return "mixed";
}
var SUPPORTED_STYLES;
var init_style = __esm({
  "server/lib/style.ts"() {
    "use strict";
    SUPPORTED_STYLES = [
      "crossfit",
      "olympic_weightlifting",
      "powerlifting",
      "bb_full_body",
      "bb_upper",
      "bb_lower",
      "aerobic",
      "conditioning",
      "strength",
      "endurance",
      "gymnastics",
      "mobility",
      "mixed"
    ];
  }
});

// server/ai/generators/premium.ts
import OpenAI from "openai";
import { z as z3 } from "zod";
function isWarmupHeader(x) {
  return x.is_header && /warm-?up/i.test(x.exercise || x.title);
}
function isCooldownHeader(x) {
  return x.is_header && /cool-?down/i.test(x.exercise || x.title);
}
function isHeader(x) {
  return x && x.is_header === true;
}
function extractMains(sets) {
  const viaSource = sets.filter((s2) => s2._source === "main" || s2.source === "main");
  if (viaSource.length) return viaSource;
  const viaKind = sets.filter((s2) => s2.kind && !["warmup", "cooldown"].includes(s2.kind));
  if (viaKind.length) return viaKind;
  let mains = [];
  let inMain = false;
  for (const s2 of sets) {
    if (isWarmupHeader(s2)) {
      inMain = false;
      continue;
    }
    if (isCooldownHeader(s2)) {
      inMain = false;
      continue;
    }
    if (isHeader(s2) && !isWarmupHeader(s2) && !isCooldownHeader(s2)) {
      inMain = true;
      continue;
    }
    if (inMain && !isHeader(s2)) mains.push(s2);
  }
  return mains;
}
function computeHardness(workout, equipmentAvailable, pack, req) {
  let h = 0;
  const hasGear = (equipmentAvailable || []).length > 0;
  const hasBarbell = (equipmentAvailable || []).some((e2) => /barbell/i.test(e2));
  for (const b of workout.blocks) {
    if (/^Every\s*2:00/i.test(b.title)) h += 0.38;
    if (/^Every\s*2:30/i.test(b.title)) h += 0.34;
    if (/^EMOM\s+\d+/.test(b.title)) h += 0.3;
    if (/(Every\s+[34]:00|E[34]:00)/i.test(b.title)) h += 0.35;
    if (/AMRAP/i.test(b.title)) h += 0.3;
    if (/21-15-9/i.test(b.title)) h += 0.28;
    if (/Chipper/i.test(b.title)) h += 0.32;
    if (hasBarbell) h += 0.12;
    const isMainBlock = ["strength", "conditioning"].includes(b.kind);
    let hasExternalLoad = false;
    let hasOly = false;
    let hasHeavyCompound = false;
    let bodyweightCount = 0;
    for (const it of b.items || []) {
      const movement = findMovement(it.exercise);
      if (movement) {
        const hasLoad = movement.equipment.some(
          (e2) => ["barbell", "dumbbell", "kettlebell", "machine", "cable", "sandbag", "sled"].includes(e2)
        );
        if (hasLoad) hasExternalLoad = true;
        const isOly = movement.patterns.some((p2) => p2.startsWith("olympic_"));
        if (isOly) hasOly = true;
        const isHeavyCompound = movement.patterns.some(
          (p2) => ["squat", "hinge", "bench"].includes(p2)
        ) && hasLoad;
        if (isHeavyCompound) hasHeavyCompound = true;
        if (isMainBlock && movement.equipment.length === 1 && movement.equipment[0] === "bodyweight") {
          bodyweightCount++;
        }
      }
    }
    if (isMainBlock && hasExternalLoad) h += 0.1;
    if (hasOly) h += 0.08;
    if (hasHeavyCompound) h += 0.06;
    if (isMainBlock && hasGear && bodyweightCount >= 2) {
      h -= 0.1;
    }
  }
  const text2 = JSON.stringify(workout.blocks || []);
  const styleLower = (pack?.name || "").toLowerCase();
  if (styleLower.includes("endurance") || styleLower.includes("aerobic")) {
    const mains = extractMains(workout.blocks || []);
    const mainMinutes = mains.reduce((s2, x) => {
      const mins = x.time_min || (x.duration ? x.duration / 60 : 0);
      return s2 + mins;
    }, 0);
    const timeBonus = Math.min(0.35, mainMinutes * 0.02);
    h += timeBonus;
    let patternBonus = 0;
    if (/vo2/i.test(text2)) {
      h += 0.25;
      patternBonus += 0.25;
    }
    if (/cruise/i.test(text2)) {
      h += 0.18;
      patternBonus += 0.18;
    }
    if (/steady/i.test(text2)) {
      h += 0.12;
      patternBonus += 0.12;
    }
    const targetI = req?.intensity || workout.intensity || workout.meta?.intensity;
    let intensityBonus = 0;
    if (targetI >= 7) {
      h += 0.06;
      intensityBonus += 0.06;
    }
    if (targetI >= 8) {
      h += 0.1;
      intensityBonus += 0.1;
    }
    if (process.env.DEBUG_ENDURANCE_HARDNESS === "1") {
      console.log(`\u{1F3C3} Endurance hardness: time=${timeBonus.toFixed(2)} (${mainMinutes.toFixed(1)}min) pattern=${patternBonus.toFixed(2)} intensity=${intensityBonus.toFixed(2)} total=${h.toFixed(2)}`);
    }
  }
  return Math.min(1, Math.max(0, h));
}
var openai, REG, WorkoutItemSchema, WorkoutBlockSchema, AcceptanceFlagsSchema, SubstitutionSchema, SelectionTraceSchema, MetaSchema, PremiumWorkoutSchema;
var init_premium = __esm({
  "server/ai/generators/premium.ts"() {
    "use strict";
    init_patternPacks();
    init_patternPackBuilders();
    init_movementService();
    init_movements_registry();
    init_stylePolicies();
    init_styleSpecs();
    init_env();
    init_style();
    openai = new OpenAI({ apiKey: process.env.OPENAI_API_KEY });
    REG = new Map(movements_registry_default.map((m2) => [m2.id, m2]));
    WorkoutItemSchema = z3.object({
      exercise: z3.string(),
      target: z3.string(),
      notes: z3.string().optional()
    });
    WorkoutBlockSchema = z3.object({
      kind: z3.enum(["warmup", "strength", "conditioning", "skill", "core", "cooldown"]),
      title: z3.string(),
      time_min: z3.number(),
      items: z3.array(WorkoutItemSchema),
      notes: z3.string().optional()
    });
    AcceptanceFlagsSchema = z3.object({
      time_fit: z3.boolean(),
      has_warmup: z3.boolean(),
      has_cooldown: z3.boolean(),
      mixed_rule_ok: z3.boolean(),
      equipment_ok: z3.boolean(),
      injury_safe: z3.boolean(),
      readiness_mod_applied: z3.boolean(),
      hardness_ok: z3.boolean(),
      patterns_locked: z3.boolean()
    });
    SubstitutionSchema = z3.object({
      from: z3.string(),
      to: z3.string(),
      reason: z3.string()
    });
    SelectionTraceSchema = z3.object({
      blockTitle: z3.string(),
      movements: z3.array(z3.object({
        id: z3.string(),
        name: z3.string()
      })),
      filters: z3.object({
        categories: z3.array(z3.string()).optional(),
        patterns: z3.array(z3.string()).optional(),
        modality: z3.array(z3.string()).optional(),
        equipment: z3.array(z3.string()).optional(),
        excludeBannedMains: z3.boolean().optional()
      })
    });
    MetaSchema = z3.object({
      generator: z3.string(),
      style: z3.string(),
      seed: z3.string(),
      selectionTrace: z3.array(SelectionTraceSchema).optional()
    });
    PremiumWorkoutSchema = z3.object({
      title: z3.string(),
      duration_min: z3.number(),
      blocks: z3.array(WorkoutBlockSchema),
      substitutions: z3.array(SubstitutionSchema).optional(),
      acceptance_flags: AcceptanceFlagsSchema,
      variety_score: z3.number().optional(),
      meta: MetaSchema.optional()
    });
  }
});

// server/workouts/movements.ts
var MOVEMENTS;
var init_movements = __esm({
  "server/workouts/movements.ts"() {
    "use strict";
    MOVEMENTS = [
      // Bodyweight - Lower
      { id: "air-squat", name: "Air Squat", equipment: ["bodyweight"], tags: ["lower", "squat", "warmup"] },
      { id: "reverse-lunge", name: "Reverse Lunge", equipment: ["bodyweight"], tags: ["lower", "lunge"] },
      { id: "forward-lunge", name: "Forward Lunge", equipment: ["bodyweight"], tags: ["lower", "lunge"] },
      { id: "jump-squat", name: "Jump Squat", equipment: ["bodyweight"], tags: ["lower", "squat", "power", "conditioning"] },
      { id: "single-leg-glute-bridge", name: "Single-Leg Glute Bridge", equipment: ["bodyweight"], tags: ["lower", "hinge", "glute"] },
      { id: "wall-sit", name: "Wall Sit", equipment: ["bodyweight"], tags: ["lower", "squat", "iso"] },
      { id: "cossack-squat", name: "Cossack Squat", equipment: ["bodyweight"], tags: ["lower", "squat", "mobility"] },
      { id: "bulgarian-split-squat", name: "Bulgarian Split Squat", equipment: ["bodyweight"], tags: ["lower", "lunge", "unilateral"] },
      // Bodyweight - Upper
      { id: "pushup", name: "Push-up", equipment: ["bodyweight"], tags: ["upper", "push", "core"] },
      { id: "pike-pushup", name: "Pike Push-up", equipment: ["bodyweight"], tags: ["upper", "push", "shoulders"] },
      { id: "diamond-pushup", name: "Diamond Push-up", equipment: ["bodyweight"], tags: ["upper", "push", "triceps"] },
      { id: "wide-pushup", name: "Wide Push-up", equipment: ["bodyweight"], tags: ["upper", "push", "chest"] },
      { id: "decline-pushup", name: "Decline Push-up", equipment: ["bodyweight"], tags: ["upper", "push", "advanced"] },
      { id: "pullup", name: "Pull-up", equipment: ["bodyweight", "pullup-bar"], tags: ["upper", "pull", "back"] },
      { id: "chinup", name: "Chin-up", equipment: ["bodyweight", "pullup-bar"], tags: ["upper", "pull", "biceps"] },
      { id: "dip", name: "Dip", equipment: ["bodyweight", "dip-bar"], tags: ["upper", "push", "triceps"] },
      // Bodyweight - Core
      { id: "plank", name: "Plank", equipment: ["bodyweight"], tags: ["core", "iso", "warmup"] },
      { id: "side-plank", name: "Side Plank", equipment: ["bodyweight"], tags: ["core", "iso", "lateral"] },
      { id: "mountain-climber", name: "Mountain Climber", equipment: ["bodyweight"], tags: ["core", "conditioning", "full"] },
      { id: "bicycle-crunch", name: "Bicycle Crunch", equipment: ["bodyweight"], tags: ["core", "rotation"] },
      { id: "dead-bug", name: "Dead Bug", equipment: ["bodyweight"], tags: ["core", "stability", "warmup"] },
      { id: "bird-dog", name: "Bird Dog", equipment: ["bodyweight"], tags: ["core", "stability", "warmup"] },
      // Bodyweight - Full Body
      { id: "burpee", name: "Burpee", equipment: ["bodyweight"], tags: ["conditioning", "full", "power"] },
      { id: "bear-crawl", name: "Bear Crawl", equipment: ["bodyweight"], tags: ["full", "core", "conditioning"] },
      { id: "star-jump", name: "Star Jump", equipment: ["bodyweight"], tags: ["full", "conditioning", "power"] },
      { id: "inchworm", name: "Inchworm", equipment: ["bodyweight"], tags: ["full", "mobility", "warmup"] },
      // Dumbbell - Lower  
      { id: "db-goblet-squat", name: "Goblet Squat", equipment: ["dumbbell"], tags: ["squat", "lower", "strength"] },
      { id: "db-rdl", name: "DB RDL", equipment: ["dumbbell"], tags: ["hinge", "lower", "strength"] },
      { id: "db-lunge", name: "DB Lunge", equipment: ["dumbbell"], tags: ["lunge", "lower", "strength"] },
      { id: "db-step-up", name: "DB Step-up", equipment: ["dumbbell"], tags: ["lower", "unilateral", "strength"] },
      { id: "db-calf-raise", name: "DB Calf Raise", equipment: ["dumbbell"], tags: ["lower", "calf", "strength"] },
      { id: "db-sumo-squat", name: "DB Sumo Squat", equipment: ["dumbbell"], tags: ["squat", "lower", "strength"] },
      // Dumbbell - Upper
      { id: "db-bench", name: "DB Bench Press", equipment: ["dumbbell"], tags: ["upper", "push", "strength"] },
      { id: "db-row", name: "DB Row", equipment: ["dumbbell"], tags: ["upper", "pull", "strength"] },
      { id: "db-shoulder-press", name: "DB Shoulder Press", equipment: ["dumbbell"], tags: ["upper", "push", "shoulders", "strength"] },
      { id: "db-bicep-curl", name: "DB Bicep Curl", equipment: ["dumbbell"], tags: ["upper", "pull", "biceps"] },
      { id: "db-tricep-extension", name: "DB Tricep Extension", equipment: ["dumbbell"], tags: ["upper", "push", "triceps"] },
      { id: "db-lateral-raise", name: "DB Lateral Raise", equipment: ["dumbbell"], tags: ["upper", "shoulders", "isolation"] },
      { id: "db-chest-fly", name: "DB Chest Fly", equipment: ["dumbbell"], tags: ["upper", "push", "chest"] },
      { id: "db-reverse-fly", name: "DB Reverse Fly", equipment: ["dumbbell"], tags: ["upper", "pull", "rear-delt"] },
      // Dumbbell - Full Body
      { id: "db-thruster", name: "DB Thruster", equipment: ["dumbbell"], tags: ["full", "conditioning", "power"] },
      { id: "db-clean-press", name: "DB Clean & Press", equipment: ["dumbbell"], tags: ["full", "power", "strength"] },
      { id: "db-snatch", name: "DB Snatch", equipment: ["dumbbell"], tags: ["full", "power", "unilateral"] },
      { id: "db-man-maker", name: "DB Man Maker", equipment: ["dumbbell"], tags: ["full", "conditioning", "complex"] },
      // Kettlebell
      { id: "kb-swing", name: "KB Swing", equipment: ["kettlebell"], tags: ["hinge", "conditioning", "power"] },
      { id: "kb-clean", name: "KB Clean", equipment: ["kettlebell"], tags: ["pull", "power", "full"] },
      { id: "kb-front-squat", name: "KB Front Squat", equipment: ["kettlebell"], tags: ["squat", "lower", "strength"] },
      { id: "kb-push-press", name: "KB Push Press", equipment: ["kettlebell"], tags: ["push", "upper", "power"] },
      { id: "kb-snatch", name: "KB Snatch", equipment: ["kettlebell"], tags: ["full", "power", "conditioning"] },
      { id: "kb-windmill", name: "KB Windmill", equipment: ["kettlebell"], tags: ["core", "mobility", "stability"] },
      { id: "kb-turkish-getup", name: "Turkish Get-up", equipment: ["kettlebell"], tags: ["full", "stability", "strength"] },
      { id: "kb-goblet-squat", name: "KB Goblet Squat", equipment: ["kettlebell"], tags: ["squat", "lower", "strength"] },
      // Barbell
      { id: "bb-back-squat", name: "Back Squat", equipment: ["barbell"], tags: ["squat", "lower", "strength"] },
      { id: "bb-front-squat", name: "Front Squat", equipment: ["barbell"], tags: ["squat", "lower", "strength"] },
      { id: "bb-deadlift", name: "Deadlift", equipment: ["barbell"], tags: ["hinge", "lower", "strength"] },
      { id: "bb-bench", name: "Bench Press", equipment: ["barbell"], tags: ["push", "upper", "strength"] },
      { id: "bb-ohp", name: "Overhead Press", equipment: ["barbell"], tags: ["push", "upper", "strength"] },
      { id: "bb-row", name: "Barbell Row", equipment: ["barbell"], tags: ["pull", "upper", "strength"] },
      { id: "bb-clean", name: "Power Clean", equipment: ["barbell"], tags: ["full", "power", "strength"] },
      { id: "bb-thruster", name: "Thruster", equipment: ["barbell"], tags: ["full", "conditioning", "strength"] },
      // Resistance Band
      { id: "band-squat", name: "Band Squat", equipment: ["resistance_band"], tags: ["squat", "lower", "strength"] },
      { id: "band-row", name: "Band Row", equipment: ["resistance_band"], tags: ["pull", "upper", "strength"] },
      { id: "band-chest-press", name: "Band Chest Press", equipment: ["resistance_band"], tags: ["push", "upper", "strength"] },
      { id: "band-lateral-raise", name: "Band Lateral Raise", equipment: ["resistance_band"], tags: ["upper", "shoulders"] },
      { id: "band-pull-apart", name: "Band Pull Apart", equipment: ["resistance_band"], tags: ["pull", "upper", "warmup"] },
      // Medicine Ball
      { id: "med-ball-slam", name: "Medicine Ball Slam", equipment: ["medicine_ball"], tags: ["full", "power", "conditioning"] },
      { id: "med-ball-throw", name: "Medicine Ball Throw", equipment: ["medicine_ball"], tags: ["full", "power", "core"] },
      // Cardio Equipment
      { id: "row", name: "Row", equipment: ["bodyweight"], tags: ["cardio", "conditioning", "full"] },
      { id: "bike", name: "Bike", equipment: ["bodyweight"], tags: ["cardio", "conditioning", "lower"] },
      { id: "ski-erg", name: "Ski Erg", equipment: ["bodyweight"], tags: ["cardio", "conditioning", "full"] },
      { id: "run", name: "Run", equipment: ["bodyweight"], tags: ["cardio", "conditioning", "lower"] },
      { id: "assault-bike", name: "Assault Bike", equipment: ["bodyweight"], tags: ["cardio", "conditioning", "full"] },
      // Mobility/Warmup
      { id: "arm-circle", name: "Arm Circle", equipment: ["bodyweight"], tags: ["mobility", "warmup", "upper"] },
      { id: "leg-swing", name: "Leg Swing", equipment: ["bodyweight"], tags: ["mobility", "warmup", "lower"] },
      { id: "hip-circle", name: "Hip Circle", equipment: ["bodyweight"], tags: ["mobility", "warmup", "lower"] },
      { id: "cat-cow", name: "Cat-Cow", equipment: ["bodyweight"], tags: ["mobility", "warmup", "spine"] }
    ];
  }
});

// server/workoutGenerator.ts
var workoutGenerator_exports = {};
__export(workoutGenerator_exports, {
  GENERATOR_STAMP: () => GENERATOR_STAMP,
  convertPremiumToGenerated: () => convertPremiumToGenerated,
  generateMockWorkout: () => generateMockWorkout,
  generateWorkout: () => generateWorkout,
  upgradeIntensity: () => upgradeIntensity
});
import OpenAI2 from "openai";
function upgradeIntensity(workout, equipment, readiness) {
  const hasLoad = (equipment || []).some((e2) => /(barbell|dumbbell|kettlebell)/i.test(e2));
  let rot = 0;
  for (const b of workout.blocks) {
    if (["warmup", "cooldown"].includes(b.kind)) continue;
    if (hasLoad) {
      b.items = (b.items || []).map((it) => {
        const n2 = (it.exercise || "").trim();
        if (BANNED.has(n2)) {
          const sub = ROTATION[rot++ % ROTATION.length];
          workout.substitutions = (workout.substitutions || []).concat([{ from: n2, to: sub, reason: "upgrade_intensity" }]);
          return { ...it, exercise: sub, notes: ((it.notes || "") + " (auto-upgrade)").trim() };
        }
        return it;
      });
    }
    if (/(Every\s*3:00|E3:00)/i.test(b.title)) b.title = b.title.replace(/(Every\s*3:00|E3:00)/i, "E2:00");
    if (/EMOM\s*10\b/i.test(b.title)) b.title = b.title.replace(/EMOM\s*10\b/i, "EMOM 14");
    for (const it of b.items || []) {
      if (typeof it.scheme?.reps === "number") it.scheme.reps = Math.round(it.scheme.reps * 1.25);
      if (/RIR\s*2-3/i.test(it.scheme?.rpe || "")) it.scheme.rpe = "RIR 1\u20132";
    }
  }
  workout.variety_score = computeHardness(workout);
  const floor = readiness?.sleep_score && readiness.sleep_score < 60 ? 0.55 : 0.85;
  workout.acceptance_flags = { ...workout.acceptance_flags || {}, hardness_ok: workout.variety_score >= floor };
  return workout;
}
function secondsFromPattern(title, fallbackMin) {
  const em = title.match(/^EMOM\s+(\d+)/i);
  if (em) return parseInt(em[1], 10) * 60;
  const ev = title.match(/^Every\s*(\d):([0-5]0)\s*x\s*(\d+)/i);
  if (ev) {
    const m2 = +ev[1], s2 = +ev[2], n2 = +ev[3];
    return n2 * (m2 * 60 + s2);
  }
  return Math.round((fallbackMin ?? 12) * 60);
}
function addHeaderSet(sets, title, mins) {
  sets.push({
    id: `hdr-${Math.random().toString(36).slice(2, 8)}`,
    exercise: title,
    duration: secondsFromPattern(title, mins),
    notes: title,
    is_header: true
  });
}
function addItemFromMovement(sets, it, extraNote) {
  sets.push({
    id: `itm-${Math.random().toString(36).slice(2, 8)}`,
    exercise: it.name || it.exercise,
    registry_id: it.registry_id || it.id || null,
    reps: it.scheme?.reps ?? void 0,
    duration: void 0,
    distance_m: it.scheme?.distance_m ?? void 0,
    num_sets: it.scheme?.sets ?? void 0,
    notes: [it.notes, extraNote].filter(Boolean).join(" ").trim() || void 0,
    rest_s: it.scheme?.rest_s ?? void 0,
    percent_1rm: it.scheme?.percent_1rm ?? void 0,
    rpe: it.scheme?.rpe ?? void 0
  });
}
function convertPremiumToGenerated(premium) {
  const sets = [];
  const wu = premium.blocks.find((b) => b.kind === "warmup");
  if (wu) {
    addHeaderSet(sets, "Warm-up", wu.time_min || 6);
    (wu.items || []).forEach((it) => {
      addItemFromMovement(sets, it);
      const lastItem = sets[sets.length - 1];
      lastItem._source = "warmup";
      const rawDuration = (wu.time_min || 6) * 60 / Math.max(1, (wu.items || []).length);
      lastItem.duration = Math.max(30, Math.round(rawDuration / 30) * 30);
      if (!lastItem.notes) lastItem.notes = "For quality";
    });
  }
  for (const b of premium.blocks.filter((x) => !["warmup", "cooldown"].includes(x.kind))) {
    const title = String(b.title || "Main").trim();
    if (/^EMOM\s+(\d+)/i.test(title)) {
      const mins = Number(title.match(/^EMOM\s+(\d+)/i)?.[1] ?? b.time_min ?? 12);
      addHeaderSet(sets, `EMOM ${mins}`, mins);
      (b.items || []).forEach((it, idx) => {
        const tag = idx === 0 ? "(odd min)" : idx === 1 ? "(even min)" : "";
        addItemFromMovement(sets, it, tag);
      });
      continue;
    }
    if (/^Every\s*2:00/i.test(title) || /^Every\s*2:30/i.test(title) || /^Every\s*3:00/i.test(title)) {
      addHeaderSet(sets, title, b.time_min || 12);
      (b.items || []).forEach((it) => addItemFromMovement(sets, it));
      continue;
    }
    if (/^AMRAP/i.test(title) || /^For\s*Time/i.test(title) || /^Chipper/i.test(title)) {
      addHeaderSet(sets, title, b.time_min || 12);
      (b.items || []).forEach((it) => addItemFromMovement(sets, it));
      continue;
    }
    addHeaderSet(sets, title || "Main", b.time_min || 12);
    (b.items || []).forEach((it) => addItemFromMovement(sets, it));
  }
  const cd = premium.blocks.find((b) => b.kind === "cooldown");
  if (cd) {
    addHeaderSet(sets, "Cool-down", cd.time_min || 4);
    (cd.items || []).forEach((it) => {
      addItemFromMovement(sets, it);
      const lastItem = sets[sets.length - 1];
      lastItem._source = "cooldown";
      lastItem.duration = Math.round((cd.time_min || 4) * 60 / Math.max(1, (cd.items || []).length));
      if (!lastItem.notes) lastItem.notes = "Easy breathing";
    });
  }
  return {
    name: premium.title || premium.meta?.title || "Session",
    category: premium.meta?.style || premium.category || "Mixed",
    description: premium.description || "",
    duration: premium.total_min || premium.duration || 45,
    intensity: premium.intensity || 7,
    sets,
    meta: premium.meta || {}
  };
}
function normalizeEquipment(userEquipment) {
  const normalized = /* @__PURE__ */ new Set();
  for (const item of userEquipment) {
    const lower = item.toLowerCase().trim();
    let matched = false;
    for (const [canonical, synonyms] of Object.entries(EQUIPMENT_SYNONYMS)) {
      if (synonyms.some((syn) => lower.includes(syn))) {
        normalized.add(canonical);
        matched = true;
        break;
      }
    }
    if (!matched) {
      normalized.add(lower);
    }
  }
  return Array.from(normalized);
}
function normalizeCategoryToEnum(rawCategory) {
  const normalized = rawCategory.toLowerCase().trim();
  const categoryMap = {
    "crossfit": "CrossFit" /* CROSSFIT */,
    "strength": "Strength" /* STRENGTH */,
    "hiit": "HIIT" /* HIIT */,
    "cardio": "Cardio" /* CARDIO */,
    "powerlifting": "Powerlifting" /* POWERLIFTING */,
    "olympic lifting": "Olympic Lifting" /* OLYMPIC_LIFTING */,
    "olympic": "Olympic Lifting" /* OLYMPIC_LIFTING */,
    "oly": "Olympic Lifting" /* OLYMPIC_LIFTING */,
    "mixed": "CrossFit" /* CROSSFIT */
    // Default to CrossFit for mixed
  };
  return categoryMap[normalized] || "CrossFit" /* CROSSFIT */;
}
async function generateWithOpenAI(request) {
  const rawCategory = request.category || request.style || "mixed";
  const category = normalizeCategoryToEnum(rawCategory);
  const rawStyle = request.style || request.goal || request.focus || rawCategory;
  const style = normalizeStyle(rawStyle);
  const userEquipment = request.equipment || [];
  const normalizedEquipment = normalizeEquipment(userEquipment);
  let availableMovements = MOVEMENTS;
  if (normalizedEquipment.length > 0) {
    const filtered = MOVEMENTS.filter(
      (m2) => m2.equipment.some((e2) => normalizedEquipment.includes(e2)) || m2.equipment.includes("bodyweight")
    );
    if (filtered.length > 10) {
      availableMovements = filtered;
    } else {
      console.warn("[WG] Equipment filter too restrictive, using full library", {
        userEquipment,
        normalizedEquipment,
        filteredCount: filtered.length
      });
    }
  }
  const movementLibrary = availableMovements.map((m2) => `- ${m2.name} (${m2.equipment.join(", ")}) [${m2.tags.join(", ")}]`).join("\n");
  const styleGuidelines = {
    "crossfit": `
CROSSFIT WODIFY-STYLE STRUCTURE:
You MUST create a workout with this EXACT 3-section structure:

SECTION 1 - WARM-UP (no creative title):
- Title: "Warm-Up Flow" or "General Prep"
- Duration: 5-8 min
- MUST include 5-7 exercises: Cardio ramp + dynamic stretching + movement-specific priming
- Format: Start with cardio (200-400m), then dynamic movements that prepare for main workout
- Example: 300m Row, 10 Arm Circle, 10 Leg Swing each, 5 Inchworm, 5 Cat-Cow, 10 Air Squat, 5 Push-Up
- Coaching cues: Movement-specific notes about preparing joints and priming patterns for main work (e.g., "Gradually elevate heart rate and mobilize shoulders/hips for overhead work. Focus on opening hip flexors and warming shoulder rotation for the main WOD. Scale: Reduce rounds or substitute easier variations.")

SECTION 2 - MAIN WOD (MUST have creative title):
- Creative Title: Generate a fun, memorable name in ALL CAPS with quotes (examples: "FRUIT LOOPS IN MY ORANGE JUICE", "THE THREE WISE WITCHES", "HOT DOG TREASURE CHEST")
- Score Type: MUST be one of these formats:
  * "For Time" (with time cap like "13:00 time cap!")
  * "AMRAP" (e.g., "15:00 AMRAP", "4:00 AMRAP")
  * "EMOM" (e.g., "28:00 EMOM", "Every 2:00 x 6 Sets")
  * "Intervals" (e.g., "Every 5:00 for 4 rounds", "2:00 on 1:00 off for 5 rounds")
- Duration: 10-20 min (majority of workout time)
- CRITICAL: Main WOD should include 3-5 exercises (varies by format):
  * For Time chipper: 3-5 movements
  * AMRAP: 3-4 movements per round
  * EMOM: 1-3 movements per minute
- **MANDATORY**: ALL cardio MUST include distance/calories (e.g., "500m Row", "15 Cal Bike"), ALL weighted movements MUST include M/F weight (e.g., "@ 95/65lb", "@ 24/16kg")
- Coaching cues: Movement-specific physiological targets and technique focus based on exercises selected (e.g., "Focus on explosive hip drive in thrusters while maintaining upright torso and full lockout overhead. Target 70-80% max heart rate with smooth transitions between movements. Prioritize unbroken sets of wall balls in early rounds. Scale: Reduce barbell to 65/45lb, substitute ring rows for pull-ups, or break movements into smaller sets.")
- **INTERVAL FORMAT RULE**: If using "Intervals" score type, MUST specify complete work/rest structure (e.g., "Work 5:00 / Rest 2:00 x 5 rounds" or "3:00 on / 1:00 off for 6 rounds")
- Format examples:
  * For Time: "21-15-9\\nThrusters @ 95/65lb\\nPull-ups"
  * AMRAP 15: "19 Cal Row\\n19 Wall Ball @ 20/14lb\\n15 Push-ups"
  * EMOM: "minute 1: 3 Wall Walks\\nminute 2: 200m Run\\nminute 3: 15/12 Cal Row"
  * Intervals: "Work 5:00 / Rest 2:00 x 5 rounds\\n500m Row\\n15 Cal Bike\\n400m Run\\n10 Burpee"

SECTION 3 - COOL-DOWN (no creative title):
- Title: "Cool Down" or "Recovery"
- Duration: 3-5 min
- MUST include 3-5 exercises: Static stretches targeting worked muscles + breathing + light movement
- Example: Child's Pose 1 min, Pigeon Stretch 1 min each, Quad Stretch 1 min each, Cat-Cow 10 reps, Deep Breathing 1 min
- Coaching cues: Specific recovery targets based on workout (e.g., "Focus on hip flexor and shoulder mobility after overhead work. Hold static stretches for 60-90 seconds to improve flexibility. Use deep nasal breathing to activate parasympathetic recovery. Scale: Adjust stretch depth based on comfort, avoid pushing into pain.")

CRITICAL FORMATTING RULES:
- Main section MUST have creative title in quotes and capitals
- **MANDATORY**: ALL cardio MUST include distance in meters or calories (e.g., "500m Row", "15 Cal Bike", "800m Run")
- **MANDATORY**: ALL weighted movements MUST include M/F weight (e.g., "@ 95/65lb", "@ 24/16kg", "@ 20/14lb")
- Include time notation (12:35, 15:00, etc.) where relevant  
- Use @ symbol for weights (e.g., @ 95/65#, @ 50/35#)
- Specify "For Time", "AMRAP", "EMOM", or interval format clearly
- Keep coaching cues SHORT (1-2 sentences max)
- Embed scaling suggestions in coaching cues, not separate section`,
    "olympic_weightlifting": `
OLYMPIC LIFTING WODIFY-STYLE STRUCTURE:
You MUST create a workout with this EXACT 3-section structure:

SECTION 1 - WARM-UP (no creative title):
- Title: "Warm-Up" or "Movement Prep"
- Duration: 8-10 min
- MUST include 5-7 exercises: Joint mobility + light cardio + PVC work + empty bar technique
- Example: 500m Easy Row, PVC Pass Through 10 reps, Wrist Circles 20, Empty Bar Snatch Balance 8 reps, Overhead Squat 5 reps, Hang Muscle Snatch 5 reps, Front Squat 5 reps
- Coaching cues: Position-specific prep (e.g., "Mobilize wrists, shoulders, and ankles for deep receiving positions. Practice overhead stability with PVC pass-throughs and snatch balance. Rehearse pulling mechanics with empty bar to establish proper timing and positions. Scale: Use PVC pipe for all movements if shoulder mobility limited, add extra wrist prep if needed.")

SECTION 2 - MAIN LIFTS (MUST have creative title):
- Creative Title: Generate a fun, powerful name in ALL CAPS with quotes (examples: "IRON SUMMIT", "THE BARBELL SYMPHONY", "OLYMPIC DOMINATION")
- Score Type: "Score Weight" or "Heavy Single" or "Work Sets"
- Duration: 25-30 min (majority of workout time)
- CRITICAL: MUST include 5-7 exercises total with percentage-based programming:
  1. Primary Olympic lift (REQUIRED - e.g., "Power Snatch 4x1 @ 85% of 1RM" or "Snatch 5x1 @ 80%")
  2. Secondary Olympic lift or variation (REQUIRED - e.g., "Clean & Jerk 3x2 @ 80% of 3RM" or "Hang Clean 4x2 @ 75%")
  3. Squat variation (REQUIRED - e.g., "Back Squat 5RM @ RPE 8" or "Front Squat 4x3 @ 85%")
  4. Pulling movement (REQUIRED - e.g., "Clean Pull 3x3 @ 90%" or "Snatch Pull 4x2 @ 95%")
  5. Accessory movement 1 (REQUIRED - e.g., "BTN Jerk 3x2 @ 70% of 3RM" or "Overhead Squat 3x3")
  6. Accessory movement 2 (REQUIRED - e.g., "Rear Foot Elevated Split Squat 4x6 each" or "Bulgarian Split Squat 3x8 each")
  7. Optional core/stability work (e.g., "Hollow Hold 3x30 sec" or "Plank 3x45 sec")
- Format example with multiple exercises:
  * "Power Snatch 4x1 @ 85% of 1RM"
  * "Clean & Jerk 3x2 @ 80%"
  * "Back Squat 4x3 @ 85%"
  * "Snatch Pull 3x3 @ 95%"
  * "BTN Jerk 3x2 @ 70%"
  * "Walking Lunge 3x10 each"
  * "Hollow Hold 3x30 sec"
- Coaching cues: Technique-specific targets for Olympic lifts (e.g., "Focus on aggressive turnover in snatches with active pull under the bar. Maintain vertical torso in front squat receiving position. Emphasize speed through the power position on cleans with quick elbow rotation. Target bar speed over load on technique sets. Scale: Reduce percentages by 10-15% to prioritize positions and speed, use hang variations to practice timing, or substitute power variations for full lifts if mobility limited.")

SECTION 3 - COOL-DOWN (no creative title):
- Title: "Cool Down" or "Recovery"
- Duration: 3-5 min
- MUST include 3-5 exercises: Hip/shoulder-focused stretching + mobility + breathing
- Example: Couch Stretch 2 min each, Thoracic Rotations 10 each, Lat Stretch 1 min each, Child's Pose 1 min, Deep Breathing 2 min
- Coaching cues: Recovery for Olympic lifting demands (e.g., "Prioritize hip flexor and ankle mobility after deep squat receiving positions. Open thoracic spine and lats after overhead work. Hold stretches 90+ seconds for tissue adaptation. Use box breathing (4-4-4-4) to downregulate nervous system after heavy lifting. Scale: Add foam rolling for tight areas, extend stretch duration if needed.")

CRITICAL FORMATTING RULES:
- Main section MUST have creative title in quotes and capitals
- Main section MUST have 5-7 exercises minimum (mirror screenshot example!)
- Use percentage-based programming (e.g., "@ 85% of 1RM", "@ RPE 8", "5RM")
- Include Olympic lifts (Snatch, Clean, Jerk variations) + Squats + Accessories
- Score type is typically "Score Weight" for maximal efforts
- Keep coaching cues SHORT (1-2 sentences max)
- Embed scaling suggestions in coaching cues`,
    "powerlifting": `
POWERLIFTING WODIFY-STYLE STRUCTURE:
You MUST create a workout with this EXACT 3-section structure:

SECTION 1 - WARM-UP (no creative title):
- Title: "Warm-Up" or "Movement Prep"
- Duration: 5-8 min
- MUST include 5-7 exercises: Dynamic stretching + activation + movement-specific prep
- Example: 400m Easy Row, 10 Hip Circle each, 10 Air Squat, 10 Leg Swing each, Band Pull-Apart 15, Glute Bridge 15, Light Deadlift 5 reps
- Coaching cues: Lift-specific activation (e.g., "Activate glutes and hamstrings for posterior chain loading. Mobilize hips and ankles for deep squat positions. Prime spinal erectors and lats with light pulls. Practice bracing mechanics before heavy loading. Scale: Add extra hip mobility if limited range, use resistance bands for activation if needed.")

SECTION 2 - MAIN LIFT (MUST have creative title):
- Creative Title: Generate a powerful, strength-focused name in ALL CAPS with quotes (examples: "IRON THRONE", "THE BIG THREE GAUNTLET", "THE STEEL BEHEMOTH")
- Score Type: "Score Weight" or "Heavy Set" or "Max Effort"
- Duration: 20-25 min (majority of workout time)
- CRITICAL: MUST include 4-6 exercises total:
  1. Primary lift from big three with sets/reps (REQUIRED - e.g., "Back Squat 5x5 @ 75%" or "Build to Heavy 3 Rep Back Squat")
  2. Secondary compound movement with sets/reps (REQUIRED - e.g., "Romanian Deadlift 3x8" or "Front Squat 4x6")
  3. Accessory movement 1 (REQUIRED - e.g., "Walking Lunge 3x10 each" or "Leg Press 3x12")
  4. Accessory movement 2 (REQUIRED - e.g., "GHD Back Extension 3x12" or "Plank Hold 3x45 sec")
  5-6. Optional additional accessories (e.g., "Hamstring Curl 3x10", "Core Work 3 sets")
- Format example with multiple exercises:
  * "Back Squat 5x3 @ 80%"
  * "Romanian Deadlift 3x8"
  * "Bulgarian Split Squat 3x10 each"
  * "GHD Back Extension 3x12"
  * "Plank 3x45 sec"
- Coaching cues: Powerlifting-specific technique and loading (e.g., "Maintain rigid torso bracing throughout all compound lifts. Focus on driving through full foot on squats with vertical bar path. Emphasize lats and leg drive on bench variations. Build to RPE 8-9 on primary lift while keeping 1-2 reps in reserve. Scale: Reduce percentages by 10% to prioritize bar speed, substitute box squats for full squats if depth limited, or reduce volume to 3x3 instead of 5x5.")

SECTION 3 - COOL-DOWN (no creative title):
- Title: "Cool Down" or "Recovery"
- Duration: 3-5 min
- MUST include 3-5 exercises: Static stretching + foam rolling + breathing
- Example: Foam Roll Quads 2 min, Foam Roll IT Band 1 min each, Pigeon Stretch 1 min each, Hip Flexor Stretch 1 min each, Child's Pose 1 min
- Coaching cues: Powerlifting recovery focus (e.g., "Target hip flexors, quads, and IT band after heavy squatting and deadlifting. Use foam rolling to release fascial restrictions. Hold stretches 90-120 seconds for improved range of motion. Practice 4-7-8 breathing to reduce cortisol after maximal efforts. Scale: Extend foam rolling if tissue feels dense, add lacrosse ball for trigger points.")

CRITICAL FORMATTING RULES:
- Main section MUST have creative title in quotes and capitals
- Main section MUST have 4-6 exercises minimum (not just 1!)
- Score type is typically "Score Weight" for max efforts
- Each exercise needs sets x reps format (e.g., "5x3", "3x8", "4x10 each")
- Emphasize progressive overload and percentage-based programming
- Keep coaching cues SHORT (1-2 sentences max)`,
    "endurance": `
HYROX-STYLE ENDURANCE TRAINING WODIFY STRUCTURE:
**CRITICAL**: Generate this workout like a HYROX training session - combining running/cardio with functional fitness movements in a circuit format.

You MUST create a workout with this EXACT 3-section structure:

SECTION 1 - WARM-UP (no creative title):
- Title: "Warm-Up" or "Movement Prep"
- Duration: 5-8 min
- MUST include 5-7 exercises: Easy cardio + dynamic mobility + movement priming
- Example: 500m Easy Row, 10 Leg Swing each, 10 Arm Circle, 5 Inchworm, 10 Walking Lunge, 10 Jumping Jack, 5 Burpee
- Coaching cues: Endurance-specific prep (e.g., "Gradually elevate heart rate to Zone 2 (60-70% max HR) to prepare aerobic system. Open hip flexors and mobilize ankles for running mechanics. Practice breathing rhythm and pace control. Prime movement patterns that mirror main circuit. Scale: Reduce cardio distance to 300m or slow pace if breathing labored.")

SECTION 2 - MAIN CIRCUIT (MUST have creative title):
- Creative Title: Generate a HYROX/endurance-focused name in ALL CAPS with quotes (examples: "THE MARATHON GRIND", "HYROX SIMULATOR", "ENDURANCE ODYSSEY")
- Score Type: "For Time" or "Score Rounds" or "Total Distance"
- Duration: 20-30 min (majority of workout time)
- CRITICAL: MUST include 4-6 stations alternating cardio + functional movements in HYROX style:
  1. Station 1: Distance-based cardio (REQUIRED - MUST include meters OR calories: "1000m Row" or "15 Cal Bike" or "800m Run")
  2. Station 2: Functional movement with weight if applicable (REQUIRED - e.g., "20 Burpees" or "25 KB Swing @ 24/16kg")
  3. Station 3: Different cardio modality (REQUIRED - MUST include meters OR calories: "1000m Ski" or "15 Cal Row" or "1500m Bike" or "400m Run")
  4. Station 4: Different functional movement with weight (REQUIRED - e.g., "30 Wall Ball @ 20/14lb" or "20 Box Jump @ 24/20in")
  5-6. Optional additional cardio/functional pairs (ALWAYS include distance OR calories for cardio, weight for weighted movements)
- **CARDIO RULES**: ALL cardio (Row/Run/Bike/Ski) MUST include distance in meters OR calories (e.g., "1000m Row", "15 Cal Bike", "800m Run", "20 Cal Row")
- **WEIGHT RULES**: ALL weighted movements MUST include male/female weight specs (e.g., "KB Swing @ 24/16kg", "Wall Ball @ 20/14lb", "DB @ 50/35lb")
- Format: Alternating cardio + functional stations like HYROX competition
- Coaching cues: Endurance pacing and fueling strategy (e.g., "Target 75-80% max heart rate during cardio stations with quick transitions under 10 seconds. Maintain consistent stroke rate 24-28 spm on rowing. Focus on sustainable pace you can repeat across all rounds like HYROX race simulation. Control breathing through functional movements to avoid spiking heart rate. Scale: Reduce cardio distances by 30% or extend transition rest to 30 seconds between stations, substitute ski erg for running if impact sensitive.")

SECTION 3 - COOL-DOWN (no creative title):
- Title: "Cool Down" or "Active Recovery"
- Duration: 3-5 min
- MUST include 3-5 exercises: Active recovery + static stretching + breathing
- Example: Easy Walk 2 min, Quad Stretch 1 min each, Hip Flexor Stretch 1 min each, Calf Stretch 1 min each, Deep Breathing 2 min
- Coaching cues: Endurance recovery protocol (e.g., "Walk or move easy for 2 min to clear lactate and bring heart rate below 100 bpm. Target hip flexors, quads, and calves after high-volume running. Use nasal breathing only to enhance parasympathetic recovery. Consider light nutrition within 30 min post-workout. Scale: Extend easy movement if heart rate elevated, add foam rolling for calves and IT band.")

CRITICAL FORMATTING RULES:
- Main section MUST have creative title in quotes and capitals
- Main section MUST have 4-6 stations minimum
- **MANDATORY**: ALL cardio exercises MUST include distance in meters OR calories (e.g., "1000m Row", "15 Cal Bike", "800m Run", "20 Cal Row")
- **MANDATORY**: ALL weighted movements MUST include weight in M/F format (e.g., "@ 24/16kg", "@ 50/35lb")
- Vary cardio modalities across stations (Row, Run, Bike, Ski)
- Program like HYROX: alternating cardio + functional fitness
- Keep coaching cues SHORT (1-2 sentences max)`,
    "strength": `
STRENGTH TRAINING WODIFY-STYLE STRUCTURE:
You MUST create a workout with this EXACT 3-section structure:

SECTION 1 - WARM-UP (no creative title):
- Title: "Warm-Up" or "Movement Prep"
- Duration: 5-8 min
- MUST include 5-7 exercises: Cardio + activation + dynamic prep + movement rehearsal
- Example: 400m Easy Row, 10 Hip Circle each, 10 Air Squat, 10 Arm Circle, Band Pull-Apart 15, Glute Bridge 15, Light KB Swing 10
- Coaching cues: Strength-specific activation (e.g., "Activate posterior chain with glute bridges and hip circles for compound lift readiness. Mobilize thoracic spine and shoulders for pressing movements. Rehearse movement patterns with light loads to establish motor patterns. Practice breathing and bracing mechanics. Scale: Add extra mobility work if range limited, use lighter activation loads if needed.")

SECTION 2 - MAIN LIFT (MUST have creative title):
- Creative Title: Generate a strength-focused name in ALL CAPS with quotes (examples: "THE IRON GAUNTLET", "STRENGTH FORTRESS", "POWER BUILDER")
- Score Type: "Score Weight" or "Heavy Sets" or "Total Volume"
- Duration: 20-25 min (majority of workout time)
- CRITICAL: MUST include 4-6 exercises total:
  1. Primary compound lift (REQUIRED - e.g., "Back Squat 5x5 @ 75%" or "Deadlift 4x6 @ 80%")
  2. Secondary compound (REQUIRED - e.g., "Front Squat 3x8" or "Romanian Deadlift 3x8")
  3. Accessory movement 1 (REQUIRED - e.g., "Walking Lunge 3x10 each" or "Leg Press 3x12")
  4. Accessory movement 2 (REQUIRED - e.g., "Core Work 3 sets" or "Plank 3x45 sec")
  5-6. Optional additional accessories
- Format example with multiple exercises:
  * "Back Squat 5x5 @ 75%"
  * "Romanian Deadlift 3x8"
  * "Walking Lunge 3x10 each"
  * "Leg Press 3x12"
  * "Plank 3x45 sec"
- Coaching cues: Strength-specific technique and loading targets (e.g., "Maintain 3-second eccentric tempo on all compound lifts for time under tension. Focus on full range of motion with controlled bar path. Build to RPE 7-8 on main lift, leaving 2-3 reps in reserve. Rest 2-3 min between heavy sets for neurological recovery. Target progressive overload by adding 2.5-5lb per session. Scale: Reduce load to prioritize tempo and form, substitute goblet squats for barbell if mobility limited, or reduce sets to 3 instead of 5.")

SECTION 3 - COOL-DOWN (no creative title):
- Title: "Cool Down" or "Recovery"
- Duration: 3-5 min
- MUST include 3-5 exercises: Foam rolling + static stretching + breathing
- Example: Foam Roll Quads/IT Band 2 min, Hip Flexor Stretch 1 min each, Hip Stretch 1 min each, Lat Stretch 1 min, Deep Breathing 2 min
- Coaching cues: Strength recovery protocol (e.g., "Use foam rolling to release myofascial tension in primary movers. Hold static stretches 90+ seconds to improve flexibility and reduce soreness. Target hip flexors and thoracic spine after compound lifts. Practice box breathing (4-4-4-4) to enhance recovery. Scale: Extend foam rolling to 5 min if tissue feels dense, add lacrosse ball for trigger points.")

CRITICAL FORMATTING RULES:
- Main section MUST have creative title in quotes and capitals
- Main section MUST have 4-6 exercises minimum
- Focus on load progression and proper rest intervals (2-3 min for main lifts)
- Keep coaching cues SHORT (1-2 sentences max)`,
    "bb_upper": `
BODYBUILDING UPPER BODY WODIFY-STYLE STRUCTURE:
You MUST create a workout with this EXACT 3-section structure:

SECTION 1 - WARM-UP (no creative title):
- Title: "Warm-Up" or "Movement Prep"
- Duration: 5 min
- MUST include 5-7 exercises: Cardio + shoulder/scapular activation + dynamic stretching
- Example: 400m Easy Row, Arm Circles 20 reps, Band Pull-Aparts 15 reps, Push-Up 10 reps, Scap Pull-Ups 8 reps, Cat-Cow 10 reps, Light DB Press 10 reps
- Coaching cues: Upper body activation (e.g., "Activate rotator cuff and scapular stabilizers with band work and scap pull-ups. Increase blood flow to chest, back, and shoulders with light cardio and dynamic movements. Prime pressing and pulling patterns with bodyweight and light loads. Scale: Use lighter bands if shoulder mobility limited, substitute wall push-ups for floor push-ups.")

SECTION 2 - MAIN WORK (MUST have creative title):
- Creative Title: Generate a bodybuilding-focused name in ALL CAPS with quotes (examples: "THE UPPER BODY SCULPTOR", "CHEST & BACK BUILDER", "PUSH PULL PERFECTION")
- Score Type: "Total Volume" or "Score Reps" or "For Quality"
- Duration: 25-30 min (majority of workout time)
- CRITICAL: MUST include 4-6 exercises total with detailed set/rep schemes (MIRROR SCREENSHOT EXAMPLE):
  1. Primary compound push (REQUIRED - e.g., "DB Bench Press 4x8 Each Side - Heavy" or "DB Shoulder Press 3x10-12")
  2. Primary compound pull (REQUIRED - e.g., "Single Arm DB Row 4x8 Each Side - Heavy" or "Pull Ups 3x10-12")
  3. Secondary push or accessory (REQUIRED - e.g., "DB Fly 3x12" or "Cable Chest Fly 3x15")
  4. Secondary pull or accessory (REQUIRED - e.g., "Cable Row (Pronated Grip) 3x8" or "Lat Pull Down 3x10")
  5. Isolation work 1 (REQUIRED - e.g., "GHD Back Extension 3x Max Hold" or "Lateral Raise 3x15")
  6. Isolation work 2 (optional - e.g., "Bicep Curl 3x12" or "Tricep Extension 3x12")
- Format example with multiple exercises:
  * "DB Bench Press 4x8 Each Side - Heavy"
  * "Single Arm DB Row 4x8 Each Side - Heavy"
  * "GHD Back Extension 3x Max Hold"
  * "Pull Ups 3x10-12"
  * "Cable Row (Pronated Grip) 3x8"
  * "Lateral Raise 3x15"
- Coaching cues: Bodybuilding-specific hypertrophy targets (e.g., "Emphasize mind-muscle connection with 3-second eccentric and 1-second peak contraction on all movements. Target 8-12 rep range for hypertrophy with last 2 reps approaching failure. Rest 60-90 sec between accessory sets, 90-120 sec on compounds. Focus on muscle stretch and squeeze, not moving weight. Scale: Reduce load by 20% to maintain 3-sec eccentrics and full ROM, use resistance bands for peak contractions, or reduce volume to 3 sets if recovery limited.")

SECTION 3 - COOL-DOWN (no creative title):
- Title: "Cool Down" or "Recovery"
- Duration: 3-5 min
- MUST include 3-5 exercises: Upper body stretching + foam rolling + breathing
- Example: Doorway Pec Stretch 1 min each, Lat Stretch 1 min each, Tricep Stretch 1 min each, Foam Roll Upper Back 2 min, Deep Breathing 1 min
- Coaching cues: Upper body recovery (e.g., "Target chest, lats, and triceps with static stretches held 90+ seconds to enhance flexibility. Use foam roller on upper back and lats to release fascial restrictions. Focus on deep breathing to enhance blood flow and nutrient delivery to worked muscles. Scale: Add lacrosse ball for pec and lat trigger points, extend stretches if tissue feels tight.")

CRITICAL FORMATTING RULES:
- Main section MUST have creative title in quotes and capitals
- Main section MUST have 4-6 exercises minimum (mirror screenshot example!)
- Each exercise needs detailed format: "4x8 Each Side - Heavy" or "3x10-12"
- Include both compound movements AND accessories
- Balance push/pull exercises
- Emphasize muscle-mind connection, time under tension
- Keep coaching cues SHORT (1-2 sentences max)`,
    "bb_lower": `
BODYBUILDING LOWER BODY WODIFY-STYLE STRUCTURE:
You MUST create a workout with this EXACT 3-section structure:

SECTION 1 - WARM-UP (no creative title):
- Title: "Warm-Up" or "Movement Prep"
- Duration: 5 min
- MUST include 5-7 exercises: Cardio + hip/ankle mobility + glute activation + movement prep
- Example: 400m Easy Row, Leg Swing 10 each, Hip Circle 10 each, Air Squat 15 reps, Glute Bridge 15 reps, Walking Lunge 10 each, Calf Raise 15 reps
- Coaching cues: Lower body activation (e.g., "Activate glutes with bridges and hip circles to prep for compound loading. Mobilize ankles and hips for deep squat positions. Increase blood flow with light cardio and bodyweight movements. Prime quad, hamstring, and glute patterns. Scale: Add extra ankle mobility if depth limited, use box squats if flexibility restricted.")

SECTION 2 - MAIN WORK (MUST have creative title):
- Creative Title: Generate a leg-focused name in ALL CAPS with quotes (examples: "THE LEG DAY DESTROYER", "GLUTE & QUAD FORGE", "LOWER BODY DOMINATION")
- Score Type: "Total Volume" or "Score Reps" or "For Quality"
- Duration: 25-30 min (majority of workout time)
- CRITICAL: MUST include 4-6 exercises total with detailed set/rep schemes:
  1. Primary compound (REQUIRED - e.g., "Goblet Squat 4x10 - Heavy" or "DB RDL 4x8-10")
  2. Secondary compound (REQUIRED - e.g., "DB Walking Lunge 3x10 each" or "Bulgarian Split Squat 3x8 each")
  3. Quad-focused movement (REQUIRED - e.g., "Leg Extension 3x12" or "Goblet Squat Pause 3x8")
  4. Hamstring-focused movement (REQUIRED - e.g., "DB RDL 3x10" or "Leg Curl 3x12")
  5. Glute/accessory work 1 (REQUIRED - e.g., "Hip Thrust 3x12" or "Glute Bridge 3x15")
  6. Calf/core work (optional - e.g., "Calf Raise 3x15" or "Plank 3x45 sec")
- Format example with multiple exercises:
  * "Goblet Squat 4x10 - Heavy"
  * "DB RDL 4x8-10"
  * "Walking Lunge 3x10 each"
  * "Leg Curl 3x12"
  * "Hip Thrust 3x12"
  * "Calf Raise 3x15"
- Coaching cues: Hypertrophy-specific lower body targets (e.g., "Emphasize deep stretch and peak contraction with 3-second eccentric tempo on all movements. Target 8-12 rep range with last 2 reps approaching failure for quad and hamstring hypertrophy. Focus on glute activation throughout full range. Rest 90-120 sec between compound sets. Pause at bottom of squats and top of hip thrusts for peak tension. Scale: Reduce load by 20% to maintain tempo and full ROM, use elevated surface for split squats if balance limited, reduce volume to 3 sets if recovery compromised.")

SECTION 3 - COOL-DOWN (no creative title):
- Title: "Cool Down" or "Recovery"
- Duration: 3-5 min
- MUST include 3-5 exercises: Lower body stretching + foam rolling + breathing
- Example: Foam Roll Quads 2 min, Foam Roll IT Band 1 min each, Pigeon Stretch 1 min each, Hamstring Stretch 1 min each, Deep Breathing 1 min
- Coaching cues: Lower body recovery protocol (e.g., "Target quads, hip flexors, and IT band with foam rolling to reduce DOMS. Hold static stretches 90+ seconds to enhance flexibility after high-volume leg training. Focus on hip and ankle mobility. Use nasal breathing to enhance recovery and nutrient delivery. Scale: Extend foam rolling to 5 min if soreness high, add lacrosse ball for glute trigger points.")

CRITICAL FORMATTING RULES:
- Main section MUST have creative title in quotes and capitals
- Main section MUST have 4-6 exercises minimum
- Each exercise needs detailed format: "4x10 - Heavy" or "3x8-10"
- Focus on full ROM, controlled eccentrics, balanced quad/hamstring/glute work
- Keep coaching cues SHORT (1-2 sentences max)`,
    "bb_full_body": `
BODYBUILDING FULL BODY WODIFY-STYLE STRUCTURE:
You MUST create a workout with this EXACT 3-section structure:

SECTION 1 - WARM-UP (no creative title):
- Title: "Warm-Up" or "Movement Prep"
- Duration: 5 min
- MUST include 5-7 exercises: Cardio + dynamic mobility + full body activation
- Example: 400m Easy Row, Arm Circles 20 reps, Leg Swings 10 each, Air Squat 10 reps, Push-Up 8 reps, Jumping Jack 20 reps, Cat-Cow 10 reps
- Coaching cues: Full body activation (e.g., "Activate all major muscle groups with dynamic movements and light cardio. Mobilize shoulders, hips, and spine for compound lifts. Prime both upper and lower body movement patterns. Elevate core temperature and heart rate. Scale: Reduce cardio distance if conditioning limited, modify push-ups to wall variation if strength limited.")

SECTION 2 - MAIN WORK (MUST have creative title):
- Creative Title: Generate a full-body name in ALL CAPS with quotes (examples: "THE TOTAL BODY TRANSFORMATION", "HEAD TO TOE GAINS", "COMPLETE PHYSIQUE")
- Score Type: "Total Volume" or "Score Reps" or "For Quality"
- Duration: 25-30 min (majority of workout time)
- CRITICAL: MUST include 5-6 exercises total with balanced upper/lower and push/pull:
  1. Upper push compound (REQUIRED - e.g., "DB Bench Press 4x8" or "DB Shoulder Press 3x10")
  2. Lower compound (REQUIRED - e.g., "Goblet Squat 4x10" or "DB RDL 3x10")
  3. Upper pull compound (REQUIRED - e.g., "DB Row 4x8 each" or "Pull Ups 3x8-10")
  4. Lower accessory (REQUIRED - e.g., "Walking Lunge 3x10 each" or "Bulgarian Split Squat 3x8 each")
  5. Upper accessory (REQUIRED - e.g., "DB Curl 3x12" or "Tricep Extension 3x12")
  6. Core work (optional - e.g., "Plank 3x45 sec" or "Dead Bug 3x10 each")
- Format: Upper Push \u2192 Lower \u2192 Upper Pull \u2192 Lower Accessory \u2192 Upper Accessory \u2192 Core
- Coaching cues: Full body hypertrophy protocol (e.g., "Balance push/pull and upper/lower movements for complete development. Use 3-second eccentric tempo on compounds, 2-second on accessories. Target 8-12 reps approaching failure on all movements. Rest 90-120 sec between compound sets, 60-90 sec on accessories. Alternate upper and lower exercises to manage fatigue. Scale: Reduce load by 20% to maintain tempo and ROM, substitute machine variations for free weight if stability limited, reduce to 3 sets if recovery compromised.")

SECTION 3 - COOL-DOWN (no creative title):
- Title: "Cool Down"
- Duration: 3-5 min
- MUST include 3-5 exercises: Full body stretching + foam rolling + breathing
- Example: Cat-Cow 10 reps, Child's Pose 1 min, Foam Roll Back 2 min, Hip Flexor Stretch 1 min each, Pec Stretch 1 min
- Coaching cues: Full body recovery (e.g., "Target all major muscle groups with combination of stretching and foam rolling. Hold stretches 90+ seconds for flexibility gains. Focus on hip flexors, chest, and lats after compound movements. Use diaphragmatic breathing for recovery. Scale: Prioritize most worked areas, extend duration if soreness high.")

CRITICAL FORMATTING RULES:
- Main section MUST have creative title in quotes and capitals
- Main section MUST have 5-6 exercises minimum
- Balance upper/lower and push/pull movements
- Each exercise needs format: "4x8" or "3x10-12"
- Keep coaching cues SHORT (1-2 sentences max)`,
    "mobility": `
MOBILITY & RECOVERY WODIFY-STYLE STRUCTURE:
You MUST create a workout with this EXACT 3-section structure:

SECTION 1 - WARM-UP (no creative title):
- Title: "Centering" or "Breathing Prep"
- Duration: 3-5 min
- MUST include 5-7 exercises: Breathing + body scan + gentle joint circles
- Example: Box Breathing 2 min, Body Scan 1 min, Gentle Neck Circles 10 each, Shoulder Rolls 10, Wrist Circles 20, Hip Circles 10 each, Ankle Circles 10 each
- Coaching cues: Mindful preparation (e.g., "Center nervous system with box breathing (4-4-4-4 pattern). Perform body scan to identify areas of tension. Gently mobilize all major joints without force. Set intention for quality movement and recovery. Scale: Extend breathing to 3 min if stress high, reduce range on circles if pain present.")

SECTION 2 - MAIN MOBILITY (MUST have creative title):
- Creative Title: Generate a mobility-focused name in ALL CAPS with quotes (examples: "THE FLEXIBILITY FLOW", "MOBILITY MASTERY", "MOVEMENT MEDICINE")
- Score Type: "For Quality" or "Time-Based Flow"
- Duration: 20-25 min (majority of workout time)
- CRITICAL: MUST include 5-8 movements with progression (dynamic \u2192 active \u2192 static):
  1-2. Dynamic mobility (REQUIRED - e.g., "Hip Circles 10 each direction", "Arm Circles 10 each")
  3-4. Active stretching (REQUIRED - e.g., "Cat-Cow 10 reps", "90/90 Hip Rotation 5 each")
  5-6. Static holds (REQUIRED - e.g., "Pigeon Pose 1 min each", "Child's Pose 2 min")
  7-8. Additional gentle stretches (optional - e.g., "Couch Stretch 1 min each", "Spinal Twist 1 min each")
- Format: Joint circles, full ROM movements, gentle holds (30-60s each)
- Coaching cues: Mobility-specific progression (e.g., "Progress from dynamic to active to static stretching. Never force range - work within 70-80% of max stretch. Hold static positions 60-90 seconds for tissue adaptation. Breathe deeply into stretches to enhance relaxation. Focus on areas of restriction identified in warm-up. Scale: Reduce hold times to 30-45 sec if new to stretching, use props (blocks, straps) for support, avoid painful end ranges.")

SECTION 3 - COOL-DOWN (no creative title):
- Title: "Relaxation" or "Recovery"
- Duration: 3-5 min
- MUST include 3-5 exercises: Gentle breathing + relaxation + meditation
- Example: Savasana 3 min, Deep Breathing 2 min, Body Scan 1 min, Gentle Spinal Twist 1 min each
- Coaching cues: Deep recovery integration (e.g., "Allow body to fully relax in savasana to integrate mobility work. Use 4-7-8 breathing to activate parasympathetic response. Perform final body scan noting changes from session start. Practice gratitude for body's movement capacity. Scale: Extend savasana if stress high, use blanket for comfort.")

CRITICAL FORMATTING RULES:
- Main section MUST have creative title in quotes and capitals
- Main section MUST have 5-8 movements
- No forced or ballistic stretching
- Keep coaching cues SHORT (1-2 sentences max)`,
    "mixed": `
MIXED/GENERAL FITNESS WODIFY-STYLE STRUCTURE:
You MUST create a workout with this EXACT 3-section structure:

SECTION 1 - WARM-UP (no creative title):
- Title: "Warm-Up" or "Movement Prep"
- Duration: 5-8 min
- MUST include 5-7 exercises: Cardio + dynamic mobility + varied movement prep
- Example: 300m Easy Row, Inchworm 5, Leg Swing 10 each, Arm Circle 10, Air Squat 10, Push-Up 5, Jumping Jack 20
- Coaching cues: General fitness prep (e.g., "Prepare for varied modalities with full-body warm-up. Elevate heart rate with cardio, mobilize all major joints, prime both strength and conditioning patterns. Balance upper, lower, and core activation. Scale: Reduce cardio distance or modify movements based on fitness level.")

SECTION 2 - MAIN WORKOUT (MUST have creative title):
- Creative Title: Generate a fitness-focused name in ALL CAPS with quotes (examples: "THE FITNESS FUSION", "MIXED MODALITIES", "TOTAL FITNESS")
- Score Type: "For Time" or "AMRAP" or "Score Rounds" or "Total Volume"
- Duration: 20-25 min (majority of workout time)
- CRITICAL: MUST include 4-6 movements with variety:
  1-2. Strength block (REQUIRED - e.g., "Back Squat 3x8" or "DB Bench Press 3x10 @ 50/35lb")
  3-4. Conditioning circuit (REQUIRED - e.g., "500m Row" or "20 Burpees")
  5-6. Accessory/Skill work (optional - e.g., "Pull-Ups 3x8" or "Plank 3x30 sec")
- **MANDATORY**: ALL cardio MUST include distance/calories (e.g., "500m Row", "400m Run"), ALL weighted movements MUST include M/F weight where applicable (e.g., "@ 50/35lb", "@ 24/16kg")
- Format: Variety across strength, cardio, and functional movements
- Coaching cues: Mixed modality strategy (e.g., "Balance strength and conditioning throughout session. Maintain form quality on strength work while managing heart rate on cardio. Target RPE 7-8 on strength blocks, 75-85% max HR on conditioning. Transition efficiently between modalities. Scale: Reduce loads by 15-20% to prioritize movement quality, decrease cardio distances by 25%, or substitute lower-impact movements as needed.")

SECTION 3 - COOL-DOWN (no creative title):
- Title: "Cool Down"
- Duration: 3-5 min
- MUST include 3-5 exercises: Active recovery + stretching + breathing
- Example: Easy Walk 2 min, Cat-Cow 10, Child's Pose 1 min, Hip Flexor Stretch 1 min each, Deep Breathing 1 min
- Coaching cues: General recovery protocol (e.g., "Bring heart rate below 100 bpm with easy movement. Target major muscle groups worked with static stretches held 60-90 seconds. Use deep nasal breathing to enhance parasympathetic recovery. Hydrate and consider light nutrition. Scale: Extend cool-down if heart rate elevated or extend stretches if areas feel tight.")

CRITICAL FORMATTING RULES:
- Main section MUST have creative title in quotes and capitals
- Main section MUST have 4-6 movements
- **MANDATORY**: ALL cardio MUST include distance/calories (e.g., "500m Row", "400m Run", "15 Cal Bike")
- **MANDATORY**: ALL weighted movements MUST include M/F weight where applicable (e.g., "@ 50/35lb", "@ 24/16kg")
- Provide variety across strength, cardio, and functional movements
- Keep coaching cues SHORT (1-2 sentences max)`,
    "aerobic": `
AEROBIC/CARDIO WODIFY-STYLE STRUCTURE:
You MUST create a workout with this EXACT 3-section structure:

SECTION 1 - WARM-UP (no creative title):
- Title: "Warm-Up" or "Easy Start"
- Duration: 5 min
- MUST include 5-7 exercises: Easy cardio + dynamic mobility + breathing prep
- Example: 400m Easy Row, Leg Swing 10 each, Arm Circle 10, Inchworm 5, Hip Circle 10, Jumping Jack 15, Deep Breathing 1 min
- Coaching cues: Aerobic preparation (e.g., "Gradually elevate heart rate to Zone 1-2 (50-70% max HR) with easy cardio. Mobilize hips and ankles for sustained movement. Practice nasal breathing rhythm for aerobic efficiency. Prime cardiovascular system without spiking heart rate. Scale: Reduce cardio distance to 200m if deconditioned, slow pace to conversational.")

SECTION 2 - MAIN CARDIO (MUST have creative title):
- Creative Title: Generate a cardio-focused name in ALL CAPS with quotes (examples: "THE AEROBIC ENGINE", "ZONE 2 JOURNEY", "CARDIO FOUNDATION")
- Score Type: "Total Distance" or "For Time" or "Sustained Effort"
- Duration: 25-30 min (majority of workout time)
- CRITICAL: MUST include 3-5 cardio blocks/intervals:
  1. Primary cardio block (REQUIRED - e.g., "2000m Row @ Zone 2" or "3000m Bike @ conversational pace")
  2. Secondary cardio or interval (REQUIRED - e.g., "1500m Ski @ Zone 2" or "1600m Run @ steady pace")
  3. Additional cardio variation (optional - e.g., "1000m Row" or "2000m Bike")
  4-5. Optional interval work or mixed cardio
- Focus: Zone 2 (60-70% max HR) steady-state or intervals
- Format: Sustained cardio (Row, Bike, Ski, Run) with distance in meters (2000-5000m)
- Coaching cues: Aerobic pacing and development (e.g., "Maintain Zone 2 (60-70% max HR) conversational pace for aerobic base building. Focus on nasal-only breathing if possible to enhance mitochondrial adaptation. Target steady, sustainable effort you can maintain for extended duration. Monitor stroke rate 20-24 spm on rowing, cadence 80-90 rpm on biking. Scale: Reduce total distance by 30%, slow pace to ensure nasal breathing possible, or break into intervals with 1-2 min rest.")

SECTION 3 - COOL-DOWN (no creative title):
- Title: "Cool Down" or "Active Recovery"
- Duration: 3-5 min
- MUST include 3-5 exercises: Easy movement + stretching + breathing
- Example: Easy Walk 2 min, Quad Stretch 1 min each, Calf Stretch 1 min each, Deep Breathing 2 min
- Coaching cues: Aerobic recovery protocol (e.g., "Walk or move easy for 2 min to gradually lower heart rate below 100 bpm. Target hip flexors, quads, and calves with static stretches. Use 4-7-8 breathing to enhance recovery. Consider light carbohydrate within 30 min for glycogen replenishment. Scale: Extend easy movement if heart rate elevated, foam roll calves if tight.")

CRITICAL FORMATTING RULES:
- Main section MUST have creative title in quotes and capitals
- Main section MUST have 3-5 cardio blocks/intervals
- Focus on maintaining conversational pace
- Keep coaching cues SHORT (1-2 sentences max)`,
    "conditioning": `
CONDITIONING/METCON WODIFY-STYLE STRUCTURE:
You MUST create a workout with this EXACT 3-section structure:

SECTION 1 - WARM-UP (no creative title):
- Title: "Warm-Up" or "Movement Prep"
- Duration: 5-8 min
- MUST include 5-7 exercises: Cardio ramp + dynamic stretching + movement priming
- Example: 300m Easy Row, 10 Arm Circle, 10 Leg Swing each, 5 Inchworm, 10 Jumping Jack, 10 High Knees, 10 Butt Kicks
- Coaching cues: Movement-specific prep notes (e.g., "Gradually elevate heart rate to prepare cardiovascular system for high-intensity intervals. Focus on hip and shoulder mobility to support explosive movements. Prime movement patterns with bodyweight versions of main exercises. Scale: Reduce pace or rounds if breathing becomes labored.")

SECTION 2 - MAIN CONDITIONING (MUST have creative title):
- Creative Title: Generate a high-intensity name in ALL CAPS with quotes (examples: "THE METABOLIC INFERNO", "HEART RATE HAVOC", "CONDITIONING CHAOS", "CARDIO CRUCIBLE")
- Score Type: "For Time" or "AMRAP" or "Intervals" or "Score Rounds"
- Duration: 20-25 min (majority of workout time)
- CRITICAL: MUST include 3-5 movements (varies by format):
  * HIIT Intervals: 3-4 movements with work:rest (30:30, 40:20, Tabata 20:10)
  * Circuit: 4-5 movements, 3-4 rounds for time
  * AMRAP: 3-4 movements, maximum rounds in set time
  * Mix cardio + functional movements (Burpees, KB Swings, Box Jumps, Row, Bike)
- **MANDATORY**: ALL cardio MUST include distance/calories (e.g., "500m Row", "400m Run", "15 Cal Bike"), ALL weighted movements MUST include M/F weight (e.g., "KB Swing @ 24/16kg", "Wall Ball @ 20/14lb")
- **INTERVAL FORMAT RULE**: If using "Intervals" score type, MUST specify complete work/rest structure (e.g., "Work 5:00 / Rest 2:00 x 5 rounds" or "3:00 on / 1:00 off for 6 rounds" or "Tabata 8 rounds: Work 0:20 / Rest 0:10")
- Format example:
  * "AMRAP 20: 15 Burpees, 20 KB Swing @ 24/16kg, 25 Box Jump @ 24/20in, 30 Air Squats"
  * "4 Rounds For Time: 400m Run, 20 Burpees, 30 Wall Ball @ 20/14lb"
  * "Intervals - Work 5:00 / Rest 2:00 x 5 rounds: 500m Row, 15 Cal Bike, 400m Run, 10 Burpee"
- Coaching cues: Movement-specific intensity and pacing strategy (e.g., "Target 85-90% max heart rate during work intervals with full recovery to 65-70% during rest. Focus on maintaining power output in rowing stroke and explosive hip extension in burpees. Break movements strategically to sustain pace across all rounds. Scale: Reduce work periods to 3:00 or extend rest to 3:00, substitute step-ups for box jumps, or reduce KB weight to 16/12kg.")

SECTION 3 - COOL-DOWN (no creative title):
- Title: "Cool Down" or "Active Recovery"
- Duration: 5 min
- MUST include 3-5 exercises: Easy movement + static stretching + breathing work
- Example: Easy Walk 2 min, Cat-Cow 10 reps, Child's Pose 1 min, Quad Stretch 1 min each, Deep Breathing 2 min
- Coaching cues: Specific recovery guidance (e.g., "Bring heart rate below 100 bpm gradually through easy movement. Focus on hip flexor and quad stretches after high-volume running and jumping. Use diaphragmatic breathing to activate parasympathetic recovery. Scale: Extend cool-down duration if heart rate remains elevated, reduce stretch intensity based on comfort.")

CRITICAL FORMATTING RULES:
- Main section MUST have creative title in quotes and capitals
- Main section MUST have 3-5 movements
- **MANDATORY**: ALL cardio MUST include distance in meters or calories (e.g., "500m Row", "400m Run", "15 Cal Bike")
- **MANDATORY**: ALL weighted movements MUST include M/F weight (e.g., "@ 24/16kg", "@ 20/14lb", "@ 50/35lb")
- Emphasize work capacity and high heart rate
- Keep coaching cues SHORT (1-2 sentences max)`,
    "gymnastics": `
GYMNASTICS/BODYWEIGHT WODIFY-STYLE STRUCTURE:
You MUST create a workout with this EXACT 3-section structure:

SECTION 1 - WARM-UP (no creative title):
- Title: "Warm-Up" or "Movement Prep"
- Duration: 8-10 min
- MUST include 5-7 exercises: Joint prep + wrist/shoulder activation + hollow/arch work
- Example: Wrist Circles 20, Wrist Push-Ups 10, Scap Pull-Up 10, Hollow Hold 30 sec, Arch Hold 30 sec, Cat-Cow 10 reps, Light Plank Hold 30 sec
- Coaching cues: Gymnastics-specific preparation (e.g., "Prepare wrists for load-bearing with circles and push-ups. Activate scapular stabilizers and practice hollow/arch positions for core control. Mobilize shoulders for overhead and hanging work. Build wrist, shoulder, and core strength progressively. Scale: Use knees for plank if core weak, reduce hollow/arch hold times to 15 sec, add extra wrist prep if sensitive.")

SECTION 2 - MAIN SKILL WORK (MUST have creative title):
- Creative Title: Generate a skill-focused name in ALL CAPS with quotes (examples: "THE CALISTHENICS CHALLENGE", "BODYWEIGHT MASTERY", "GYMNAST'S CRUCIBLE")
- Score Type: "For Quality" or "EMOM" or "AMRAP" or "Score Rounds"
- Duration: 15-20 min (majority of workout time)
- CRITICAL: MUST include 3-5 movements:
  1. Pull movement (REQUIRED - e.g., "Pull-Ups 5x5" or "Ring Rows 4x8")
  2. Push movement (REQUIRED - e.g., "Push-Ups 5x10" or "Dips 4x6")
  3. Core/Hold (REQUIRED - e.g., "Hollow Hold 4x30 sec" or "Plank 4x45 sec")
  4. Skill work (optional - e.g., "Handstand Hold Practice 5x15 sec" or "L-Sit 4x10 sec")
  5. Additional movement (optional - e.g., "Pike Push-Up 3x8")
- Format: Quality reps, short sets with full recovery OR EMOM/AMRAP with gymnastics movements
- Coaching cues: Gymnastics skill and quality emphasis (e.g., "Prioritize strict form and controlled tempo over volume or speed. Focus on full range of motion with active shoulders in pulls and locked-out elbows in pushes. Maintain hollow body position in all core work. Rest fully between sets for neurological recovery and movement quality. Target RPE 7-8 with 2-3 reps in reserve on skill work. Scale: Use resistance bands for pull assistance, perform negatives if can't do full reps, elevate hands for push-ups, or reduce hold times while maintaining position quality.")

SECTION 3 - COOL-DOWN (no creative title):
- Title: "Cool Down" or "Recovery"
- Duration: 5 min
- MUST include 3-5 exercises: Stretching + mobility + relaxation
- Example: Shoulder Stretch 1 min each, Pike Stretch 2 min, Wrist Stretch 1 min, Lat Stretch 1 min each, Deep Breathing 1 min
- Coaching cues: Gymnastics recovery focus (e.g., "Target shoulders, wrists, and lats after bodyweight loading. Hold stretches 90+ seconds to improve flexibility for gymnastics movements. Gently mobilize wrists in all directions after compression. Focus on pike and shoulder flexibility for skill development. Use deep breathing to calm nervous system. Scale: Add foam rolling for lats and upper back, extend wrist stretches if sensitive.")

CRITICAL FORMATTING RULES:
- Main section MUST have creative title in quotes and capitals
- Main section MUST have 3-5 movements
- Prioritize movement quality and control over volume
- Include progressions and regressions in coaching cues
- Keep coaching cues SHORT (1-2 sentences max)`
  };
  const styleGuide = styleGuidelines[style.toLowerCase()] || styleGuidelines["crossfit"];
  const prompt = `You are AXLE, an expert fitness trainer specializing in ${style} workouts.

WORKOUT REQUEST:
- Category/Style: ${style}
- Duration: ${request.duration} minutes
- Intensity: ${request.intensity}/10
- Equipment Available: ${normalizedEquipment.length > 0 ? normalizedEquipment.join(", ") : "All equipment"}

MOVEMENT LIBRARY (choose from these ${availableMovements.length} movements):
${movementLibrary}

${styleGuide}

GENERAL INSTRUCTIONS:
1. Uses ONLY movements from the library above - match names EXACTLY
2. Follow the ${style} structure guidelines above
3. Scale difficulty to ${request.intensity}/10 intensity
4. Fit within ${request.duration} minutes total
5. Provide VARIETY - don't repeat the same movements

CRITICAL: Return ONLY valid JSON matching this EXACT structure (no markdown, no extra text):

EXAMPLE OUTPUT FOR CROSSFIT:
{
  "title": "CrossFit High-Intensity Workout",
  "notes": "A challenging bodyweight CrossFit session focusing on cardio and strength",
  "sets": [
    {
      "id": "unique-id-1",
      "exercise": "Warm-Up",
      "is_header": true
    },
    { "id": "unique-id-2", "exercise": "Inchworm", "reps": 5 },
    { "id": "unique-id-3", "exercise": "Arm Circle", "reps": 10 },
    {
      "id": "unique-id-4",
      "exercise": "Main - AMRAP 15",
      "is_header": true,
      "workoutTitle": "\\"THE RELENTLESS CRUSHER\\"",
      "scoreType": "15:00 AMRAP",
      "coachingCues": "Maintain steady pacing throughout all 15 minutes. Scale: reduce reps to 15-20-25 or substitute knee push-ups for standard push-ups."
    },
    { "id": "unique-id-5", "exercise": "Push-up", "reps": 20 },
    { "id": "unique-id-6", "exercise": "Air Squat", "reps": 30 },
    { "id": "unique-id-7", "exercise": "Burpee", "reps": 40 },
    {
      "id": "unique-id-8",
      "exercise": "Cool Down",
      "is_header": true
    },
    { "id": "unique-id-9", "exercise": "Cat-Cow", "reps": 10 }
  ]
}

YOUR RESPONSE MUST:
1. Include 3 headers with is_header:true (Warm-Up, Main, Cool Down)
2. ONLY the MAIN header gets workoutTitle, scoreType, and coachingCues
3. Creative title in workoutTitle must be ALL CAPS with quotes (e.g., "\\"THE RELENTLESS CRUSHER\\"")
4. Exercise names must EXACTLY match the movement library above (e.g., "Row", "Run", "Bike" - NOT "1000m Row" or "15 Cal Bike")
5. **CRITICAL**: For cardio exercises, put distance in meters in the distance_m field (e.g., {"exercise": "Row", "distance_m": 1000}) OR calories in the calories field (e.g., {"exercise": "Bike", "calories": 15})
6. **CRITICAL**: For weighted movements, include weight specifications in the notes field (e.g., {"exercise": "KB Swing", "notes": "@ 24/16kg"})
7. Keep coaching cues to 1-2 sentences max with embedded scaling suggestions`;
  if (!openai2) {
    throw new Error("OpenAI client not initialized");
  }
  const workoutSchema = {
    name: "workout_structure",
    strict: true,
    schema: {
      type: "object",
      properties: {
        title: { type: "string" },
        notes: { type: "string" },
        sets: {
          type: "array",
          items: {
            type: "object",
            properties: {
              id: { type: "string" },
              exercise: { type: "string" },
              is_header: { type: "boolean" },
              reps: {
                anyOf: [
                  { type: "number" },
                  { type: "null" }
                ]
              },
              duration: {
                anyOf: [
                  { type: "number" },
                  { type: "null" }
                ]
              },
              distance_m: {
                anyOf: [
                  { type: "number" },
                  { type: "null" }
                ]
              },
              calories: {
                anyOf: [
                  { type: "number" },
                  { type: "null" }
                ]
              },
              num_sets: {
                anyOf: [
                  { type: "number" },
                  { type: "null" }
                ]
              },
              rest_s: {
                anyOf: [
                  { type: "number" },
                  { type: "null" }
                ]
              },
              notes: {
                anyOf: [
                  { type: "string" },
                  { type: "null" }
                ]
              },
              workoutTitle: {
                anyOf: [
                  { type: "string" },
                  { type: "null" }
                ]
              },
              scoreType: {
                anyOf: [
                  { type: "string" },
                  { type: "null" }
                ]
              },
              coachingCues: {
                anyOf: [
                  { type: "string" },
                  { type: "null" }
                ]
              }
            },
            required: ["id", "exercise", "is_header", "reps", "duration", "distance_m", "calories", "num_sets", "rest_s", "notes", "workoutTitle", "scoreType", "coachingCues"],
            additionalProperties: false
          }
        }
      },
      required: ["title", "notes", "sets"],
      additionalProperties: false
    }
  };
  const timeoutMs = 6e4;
  const timeoutPromise = new Promise((_, reject) => {
    setTimeout(() => reject(new Error("OpenAI request timed out after 60s")), timeoutMs);
  });
  console.log("[WG] Calling OpenAI API", {
    model: "gpt-4o-mini",
    category,
    style,
    movementCount: availableMovements.length,
    timeoutMs
  });
  let response;
  try {
    const startTime = Date.now();
    response = await Promise.race([
      openai2.chat.completions.create({
        model: "gpt-4o-mini",
        messages: [
          {
            role: "system",
            content: "You are AXLE, an expert fitness trainer creating Wodify-style workouts. Follow the JSON schema EXACTLY - especially workoutTitle, scoreType, and coachingCues for the MAIN section header."
          },
          {
            role: "user",
            content: prompt
          }
        ],
        response_format: {
          type: "json_schema",
          json_schema: workoutSchema
        },
        max_tokens: 2e3,
        temperature: 0.9
        // Higher temperature for more variety
      }),
      timeoutPromise
    ]);
    const duration = Date.now() - startTime;
    console.log("[WG] OpenAI API success", {
      duration: `${duration}ms`,
      tokenUsage: response.usage
    });
  } catch (err) {
    console.error("[WG] OpenAI API call failed", {
      error: err?.message || String(err),
      code: err?.code,
      status: err?.status,
      type: err?.type,
      stack: err?.stack,
      fullError: JSON.stringify(err, null, 2)
    });
    throw new Error(`OpenAI API failed: ${err?.message || "Unknown error"}`);
  }
  if (!response?.choices?.[0]?.message?.content) {
    throw new Error("OpenAI returned empty response");
  }
  let aiResponse;
  try {
    aiResponse = JSON.parse(response.choices[0].message.content);
    const headers = aiResponse.sets?.filter((s2) => s2.is_header) || [];
    console.log("[WG] OpenAI response parsed successfully", {
      title: aiResponse.title,
      setsCount: aiResponse.sets?.length,
      headersCount: headers.length,
      allHeaders: headers.map((h) => ({
        exercise: h.exercise,
        workoutTitle: h.workoutTitle,
        scoreType: h.scoreType,
        coachingCues: h.coachingCues
      }))
    });
    const cardioNames = ["run", "row", "bike", "ski", "assault"];
    const cardioSets = aiResponse.sets?.filter((s2) => {
      const name = (s2.exercise || "").toLowerCase();
      return cardioNames.some((c2) => name.includes(c2));
    }) || [];
    if (cardioSets.length > 0) {
      console.log("[WG] DEBUG: Cardio exercises from OpenAI:", cardioSets.slice(0, 5).map((s2) => ({
        exercise: s2.exercise,
        distance_m: s2.distance_m,
        calories: s2.calories,
        duration: s2.duration,
        reps: s2.reps
      })));
    }
  } catch (err) {
    console.error("[WG] Failed to parse OpenAI JSON response", {
      content: response.choices[0].message.content?.slice(0, 200)
    });
    throw new Error("OpenAI returned invalid JSON");
  }
  const validMovementNames = new Set(
    availableMovements.map((m2) => m2.name.toLowerCase())
  );
  const validatedSets = (aiResponse.sets || []).map((set, index2) => {
    if (set.is_header) {
      return {
        id: set.id || `header-${Date.now()}-${index2}`,
        exercise: set.exercise,
        notes: set.notes || void 0,
        is_header: true,
        // Preserve Wodify fields for main section
        workoutTitle: set.workoutTitle || void 0,
        scoreType: set.scoreType || void 0,
        coachingCues: set.coachingCues || void 0
      };
    }
    const exerciseLower = (set.exercise || "").toLowerCase().trim();
    if (!exerciseLower || exerciseLower.length < 3) {
      console.error("[WG] Invalid exercise: empty or too short", {
        exercise: set.exercise
      });
      return null;
    }
    const exactMatch = availableMovements.find((m2) => m2.name.toLowerCase() === exerciseLower);
    if (exactMatch) {
      return {
        id: set.id || `set-${Date.now()}-${index2}`,
        exercise: exactMatch.name,
        // Use canonical name from library
        num_sets: set.num_sets || void 0,
        // CRITICAL: Capture number of sets for bodybuilding/strength workouts
        reps: set.reps || void 0,
        duration: set.duration || void 0,
        distance: set.distance_m || void 0,
        // Map distance_m -> distance
        calories: set.calories || void 0,
        // Map calories field
        rest_s: set.rest_s || void 0,
        // Keep original field name for transformation
        notes: set.notes || void 0
      };
    }
    if (exerciseLower.length >= 4) {
      const fuzzyMatch = availableMovements.find(
        (m2) => m2.name.toLowerCase().includes(exerciseLower) || exerciseLower.includes(m2.name.toLowerCase())
      );
      if (fuzzyMatch) {
        console.warn("[WG] Fuzzy matched exercise", {
          aiGenerated: set.exercise,
          matched: fuzzyMatch.name
        });
        return {
          id: set.id || `set-${Date.now()}-${index2}`,
          exercise: fuzzyMatch.name,
          // Use canonical name from library
          num_sets: set.num_sets || void 0,
          // CRITICAL: Capture number of sets for bodybuilding/strength workouts
          reps: set.reps || void 0,
          duration: set.duration || void 0,
          distance: set.distance_m || void 0,
          // Map distance_m -> distance
          calories: set.calories || void 0,
          // Map calories field
          rest_s: set.rest_s || void 0,
          // Keep original field name for transformation
          notes: set.notes || void 0
        };
      }
    }
    console.error("[WG] Invalid exercise generated by AI (not in library)", {
      exercise: set.exercise,
      exerciseLower,
      availableCount: availableMovements.length
    });
    return null;
  }).filter(Boolean);
  const nonHeaderSets = validatedSets.filter((s2) => !s2.is_header);
  if (nonHeaderSets.length === 0) {
    throw new Error("OpenAI generated no valid non-header exercises from the movement library");
  }
  const workoutData = {
    name: aiResponse.title || `${style} Workout`,
    category,
    description: aiResponse.notes || `A ${request.intensity}/10 intensity ${style} workout`,
    duration: request.duration,
    intensity: request.intensity,
    sets: validatedSets
  };
  const validation = generatedWorkoutSchema.safeParse(workoutData);
  if (!validation.success) {
    console.error("[WG] Validation failed", validation.error);
    throw new Error("OpenAI response validation failed");
  }
  return validation.data;
}
async function generateWorkout(request) {
  const rawCategory = request.category || "mixed";
  const category = normalizeCategoryToEnum(rawCategory);
  const style = request.style || rawCategory;
  console.warn("[WG] OpenAI-first generation", {
    stamp: GENERATOR_STAMP,
    category,
    rawCategory,
    style,
    duration: request.duration,
    intensity: request.intensity,
    hasApiKey: !!openai2
  });
  if (!openai2) {
    console.warn("[WG] No OpenAI API key configured, using fallback", { stamp: GENERATOR_STAMP, category });
    if (!DISABLE_MOCK) {
      console.warn("[WG] \u2192 mock_fallback (no API key)", { stamp: GENERATOR_STAMP, category });
      return generateMockWorkout(request, "no-api-key");
    }
    throw new Error("Workout generation requires OPENAI_API_KEY environment variable. Please configure it in your deployment settings.");
  }
  try {
    const result = await generateWithOpenAI(request);
    console.warn("[WG] OpenAI success", { stamp: GENERATOR_STAMP, category, style });
    return result;
  } catch (err) {
    console.error("[WG] OpenAI failed", { stamp: GENERATOR_STAMP, category, err: String(err?.message || err) });
    if (!DISABLE_MOCK) {
      console.warn("[WG] \u2192 mock_fallback (OpenAI error)", { stamp: GENERATOR_STAMP, category });
      return generateMockWorkout(request, err?.message || "openai-error");
    }
    throw err;
  }
}
function generateMockWorkout(request, reason) {
  const workoutTemplates = {
    ["CrossFit" /* CROSSFIT */]: {
      name: '"THE MOCK HERO CHALLENGE"',
      description: `Warm up
2:00 cardio machine, increasing speed every :30
then, 2 rounds of
5 inchworms
10 air squats
7 push ups
5 jumping pull-ups

Metcon
"THE MOCK HERO CHALLENGE"

Rx+
21-15-9
Double Dumbbell Thrusters @ 50/35#
Chest-to-Bar Pull-ups
Double Unders x 30 each round
10:00 time cap!

Rx
21-15-9
Double Dumbbell Thrusters @ 35/25#
Pull-ups
Single Unders x 30 each round
12:00 time cap!`,
      exercises: [
        { exercise: "Warm-up", duration: 120, restTime: 0, notes: "2:00 cardio machine, increasing speed every :30" },
        { exercise: "Dynamic Movements", reps: 2, restTime: 60, notes: "2 rounds of: 5 inchworms, 10 air squats, 7 push ups, 5 jumping pull-ups" },
        { exercise: "Metcon (Rx+)", reps: 6, duration: 600, restTime: 0, notes: 'Metcon: "THE MOCK HERO CHALLENGE"\n\nRx+\n21-15-9\nDouble Dumbbell Thrusters @ 50/35#\nChest-to-Bar Pull-ups\nDouble Unders x 30 each round\n10:00 time cap!' },
        { exercise: "Metcon (Rx)", reps: 6, duration: 720, restTime: 0, notes: "Rx\n21-15-9\nDouble Dumbbell Thrusters @ 35/25#\nPull-ups\nSingle Unders x 30 each round\n12:00 time cap!" }
      ]
    },
    ["Strength" /* STRENGTH */]: {
      name: "Strength Builder",
      description: "Progressive strength training session",
      exercises: [
        { exercise: "Bench Press", weight: 135, reps: 8, restTime: 90 },
        { exercise: "Squats", weight: 155, reps: 8, restTime: 90 },
        { exercise: "Deadlift", weight: 185, reps: 6, restTime: 120 },
        { exercise: "Overhead Press", weight: 85, reps: 8, restTime: 75 },
        { exercise: "Barbell Rows", weight: 115, reps: 10, restTime: 75 }
      ]
    },
    ["HIIT" /* HIIT */]: {
      name: "HIIT Cardio Blast",
      description: "High-intensity interval training",
      exercises: [
        { exercise: "Jumping Jacks", duration: 45, restTime: 15 },
        { exercise: "Burpees", reps: 12, restTime: 30 },
        { exercise: "High Knees", duration: 30, restTime: 15 },
        { exercise: "Plank Hold", duration: 45, restTime: 30 },
        { exercise: "Jump Squats", reps: 15, restTime: 30 }
      ]
    },
    ["Cardio" /* CARDIO */]: {
      name: "Cardio Endurance",
      description: "Steady-state and interval cardio",
      exercises: [
        { exercise: "Running", distance: 800, duration: 240, restTime: 60 },
        { exercise: "Cycling", duration: 300, restTime: 60 },
        { exercise: "Jumping Rope", duration: 120, restTime: 45 },
        { exercise: "Rowing Machine", distance: 500, duration: 120, restTime: 60 }
      ]
    }
  };
  const template = workoutTemplates[request.category] || workoutTemplates["Strength" /* STRENGTH */];
  return {
    name: template.name,
    category: request.category,
    description: template.description,
    duration: request.duration,
    intensity: request.intensity,
    sets: template.exercises.map((exercise, index2) => ({
      id: `mock-set-${Date.now()}-${index2}`,
      exercise: exercise.exercise,
      weight: exercise.weight || void 0,
      reps: exercise.reps || void 0,
      duration: exercise.duration || void 0,
      distance: exercise.distance || void 0,
      restTime: exercise.restTime || void 0,
      notes: `Intensity level ${request.intensity}/10`
    })),
    meta: {
      generator: "mock",
      acceptance: {},
      reason: reason || "no-api-key"
    }
  };
}
var GENERATOR_STAMP, apiKey, openai2, ROTATION, BANNED, EQUIPMENT_SYNONYMS;
var init_workoutGenerator = __esm({
  "server/workoutGenerator.ts"() {
    "use strict";
    init_schema();
    init_schema();
    init_premium();
    init_env();
    init_style();
    init_movements();
    GENERATOR_STAMP = "WG-ORCH@1.0.5";
    apiKey = process.env.OPENAI_API_KEY || process.env.MODEL_API_KEY;
    openai2 = apiKey ? new OpenAI2({
      apiKey,
      timeout: 6e4,
      // 60 second timeout for complex workout generation
      maxRetries: 2
    }) : null;
    ROTATION = ["DB Box Step-Overs", "KB Swings", "Wall Balls", "Burpees"];
    BANNED = /* @__PURE__ */ new Set(["Wall Sit", "Mountain Climber", "Star Jump", "High Knees", "Jumping Jacks", "Bicycle Crunch"]);
    EQUIPMENT_SYNONYMS = {
      "pullup-bar": ["pull-up bar", "pullup bar", "pull up bar", "pullupbar"],
      "dip-bar": ["dip bar", "dipbar", "dip bars"],
      "barbell": ["bar", "barbell", "bb"],
      "dumbbell": ["dumbbells", "dumbbell", "db", "dbs"],
      "kettlebell": ["kettlebells", "kettlebell", "kb", "kbs"],
      "resistance_band": ["resistance band", "resistance bands", "band", "bands"],
      "medicine_ball": ["medicine ball", "med ball", "medball", "wall ball", "wallball"],
      "bodyweight": ["bodyweight", "bw", "body weight"],
      "bike": ["bike", "assault bike", "air bike", "airbike", "stationary bike"],
      "rower": ["rower", "rowing machine", "erg", "c2", "concept2"],
      "ski": ["ski", "ski erg", "skierg", "skier"],
      "treadmill": ["treadmill", "tread", "running"]
    };
  }
});

// server/lib/supabaseAdmin.ts
var supabaseAdmin_exports = {};
__export(supabaseAdmin_exports, {
  supabaseAdmin: () => supabaseAdmin
});
import { createClient } from "@supabase/supabase-js";
var supabaseAdmin;
var init_supabaseAdmin = __esm({
  "server/lib/supabaseAdmin.ts"() {
    "use strict";
    supabaseAdmin = createClient(
      process.env.SUPABASE_URL,
      process.env.SUPABASE_SERVICE_ROLE_KEY,
      { auth: { persistSession: false } }
    );
  }
});

// server/db.ts
var db_exports = {};
__export(db_exports, {
  db: () => db,
  pool: () => pool2
});
import { Pool, neonConfig } from "@neondatabase/serverless";
import { drizzle } from "drizzle-orm/neon-serverless";
import ws from "ws";
var pool2, db;
var init_db = __esm({
  "server/db.ts"() {
    "use strict";
    init_schema();
    neonConfig.webSocketConstructor = ws;
    if (!process.env.DATABASE_URL) {
      throw new Error("DATABASE_URL environment variable is required");
    }
    pool2 = new Pool({
      connectionString: process.env.DATABASE_URL,
      ssl: process.env.NODE_ENV === "production" ? { rejectUnauthorized: false } : void 0,
      // Connection pooling configuration for serverless
      max: 10,
      // Maximum number of clients in the pool
      idleTimeoutMillis: 3e4,
      // Close idle clients after 30 seconds
      connectionTimeoutMillis: 1e4
      // Timeout after 10 seconds when acquiring a client
    });
    db = drizzle({ client: pool2, schema: schema_exports });
  }
});

// server/logic/suggestions.ts
var suggestions_exports = {};
__export(suggestions_exports, {
  computeFatigue: () => computeFatigue,
  computeSuggestion: () => computeSuggestion,
  fetchLatestHealthReport: () => fetchLatestHealthReport,
  fetchWorkoutData: () => fetchWorkoutData
});
import { eq, desc, gte, and } from "drizzle-orm";
async function fetchWorkoutData(userId, today) {
  const yesterday = new Date(today);
  yesterday.setDate(yesterday.getDate() - 1);
  const sevenDaysAgo = new Date(today);
  sevenDaysAgo.setDate(sevenDaysAgo.getDate() - 7);
  const twentyEightDaysAgo = new Date(today);
  twentyEightDaysAgo.setDate(twentyEightDaysAgo.getDate() - 28);
  const fourteenDaysAgo = new Date(today);
  fourteenDaysAgo.setDate(fourteenDaysAgo.getDate() - 14);
  const allWorkouts = await db.select().from(workouts).where(and(
    eq(workouts.userId, userId),
    gte(workouts.createdAt, twentyEightDaysAgo)
  )).orderBy(desc(workouts.createdAt));
  const last1 = allWorkouts.filter((w) => w.createdAt && w.createdAt >= yesterday);
  const last7 = allWorkouts.filter((w) => w.createdAt && w.createdAt >= sevenDaysAgo);
  const last14 = allWorkouts.filter((w) => w.createdAt && w.createdAt >= fourteenDaysAgo);
  const last28 = allWorkouts;
  return { last1, last7, last14, last28 };
}
async function fetchLatestHealthReport(userId) {
  const reports = await db.select().from(healthReports).where(eq(healthReports.userId, userId)).orderBy(desc(healthReports.date)).limit(1);
  return reports[0] || null;
}
function computeCategoryCounts(workouts3) {
  const counts = Object.fromEntries(ALL_CATEGORIES.map((cat) => [cat, 0]));
  workouts3.forEach((workout) => {
    if (workout.request && typeof workout.request === "object" && "category" in workout.request) {
      const category = workout.request.category;
      if (category in counts) {
        counts[category]++;
      }
    }
  });
  return counts;
}
function getWorkoutCategory(workout) {
  if (workout.request && typeof workout.request === "object" && "category" in workout.request) {
    return workout.request.category;
  }
  return void 0;
}
function getWorkoutIntensity(workout) {
  if (workout.request && typeof workout.request === "object" && "intensity" in workout.request) {
    return workout.request.intensity;
  }
  return void 0;
}
function getWorkoutDuration(workout) {
  if (workout.request && typeof workout.request === "object" && "duration" in workout.request) {
    return workout.request.duration;
  }
  return void 0;
}
function complementCategory(lastCat, weeklyCounts) {
  const sortedByCount = ALL_CATEGORIES.map((cat) => ({ category: cat, count: weeklyCounts[cat] })).sort((a2, b) => a2.count - b.count);
  if (lastCat && LEG_HEAVY.includes(lastCat)) {
    const skillEngineOptions = [...SKILL, ...ENGINE];
    const availableOptions = skillEngineOptions.filter((cat) => weeklyCounts[cat] <= Math.min(...skillEngineOptions.map((c2) => weeklyCounts[c2])));
    if (availableOptions.length > 0) {
      return availableOptions[0];
    }
  }
  if (lastCat && ENGINE.includes(lastCat)) {
    const strengthOptions = [...LEG_HEAVY, ...SKILL];
    const availableOptions = strengthOptions.filter((cat) => weeklyCounts[cat] <= Math.min(...strengthOptions.map((c2) => weeklyCounts[c2])));
    if (availableOptions.length > 0) {
      return availableOptions[0];
    }
  }
  return sortedByCount[0].category;
}
function computeFatigue(health, last14Workouts, rulesApplied) {
  let fatigue = 0.5;
  if (health?.metrics && typeof health.metrics === "object") {
    const metrics = health.metrics;
    const hrvValues = last14Workouts.map((w) => {
      if (w.feedback && typeof w.feedback === "object" && "hrv" in w.feedback) {
        return w.feedback.hrv;
      }
      return null;
    }).filter(Boolean);
    const restingHRValues = last14Workouts.map((w) => {
      if (w.feedback && typeof w.feedback === "object" && "restingHR" in w.feedback) {
        return w.feedback.restingHR;
      }
      return null;
    }).filter(Boolean);
    if (typeof metrics.sleepScore === "number") {
      if (metrics.sleepScore < 60) {
        fatigue += 0.15;
        rulesApplied.push(`Poor sleep (${metrics.sleepScore}%) \u2192 increase fatigue by 0.15`);
      } else if (metrics.sleepScore >= 85) {
        fatigue -= 0.1;
        rulesApplied.push(`Excellent sleep (${metrics.sleepScore}%) \u2192 reduce fatigue by 0.10`);
      } else {
        fatigue += 0.05;
        rulesApplied.push(`Moderate sleep (${metrics.sleepScore}%) \u2192 slight fatigue increase`);
      }
    }
    if (metrics.restingHR && restingHRValues.length > 2) {
      const meanHR = restingHRValues.reduce((a2, b) => a2 + b, 0) / restingHRValues.length;
      const stdHR = Math.sqrt(restingHRValues.reduce((sum, val) => sum + Math.pow(val - meanHR, 2), 0) / restingHRValues.length);
      if (metrics.restingHR > meanHR + stdHR) {
        fatigue += 0.15;
        rulesApplied.push(`Elevated resting HR (${metrics.restingHR} vs baseline ${Math.round(meanHR)}) \u2192 increase fatigue`);
      }
    }
    if (metrics.hrv && hrvValues.length > 2) {
      const meanHRV = hrvValues.reduce((a2, b) => a2 + b, 0) / hrvValues.length;
      const stdHRV = Math.sqrt(hrvValues.reduce((sum, val) => sum + Math.pow(val - meanHRV, 2), 0) / hrvValues.length);
      if (metrics.hrv < meanHRV - stdHRV) {
        fatigue += 0.25;
        rulesApplied.push(`Low HRV vs baseline \u2192 cap intensity at 5`);
      }
    }
    if (typeof metrics.stress === "number") {
      if (metrics.stress >= 7) {
        fatigue += 0.2;
        rulesApplied.push(`High stress (${metrics.stress}/10) \u2192 reduce intensity`);
      } else if (metrics.stress >= 4) {
        fatigue += 0.1;
        rulesApplied.push(`Moderate stress (${metrics.stress}/10) \u2192 slight intensity reduction`);
      } else {
        fatigue -= 0.05;
        rulesApplied.push(`Low stress (${metrics.stress}/10) \u2192 allow higher intensity`);
      }
    }
  }
  return Math.max(0, Math.min(1, fatigue));
}
function computeMedianDuration(workouts3) {
  const durations = workouts3.map(getWorkoutDuration).filter(Boolean);
  if (durations.length === 0) return 30;
  durations.sort((a2, b) => a2 - b);
  const mid = Math.floor(durations.length / 2);
  if (durations.length % 2 === 0) {
    return (durations[mid - 1] + durations[mid]) / 2;
  } else {
    return durations[mid];
  }
}
function computeAverageIntensity(workouts3) {
  const intensities = workouts3.map(getWorkoutIntensity).filter(Boolean);
  if (intensities.length === 0) return 5;
  return intensities.reduce((sum, intensity) => sum + intensity, 0) / intensities.length;
}
function hasRepeatedIntensity(workouts3, targetIntensity) {
  const recentIntensities = workouts3.slice(0, 2).map(getWorkoutIntensity);
  return recentIntensities.length === 2 && recentIntensities.every((intensity) => intensity === targetIntensity);
}
function getUnderrepresentedCategory(weeklyCounts) {
  const categories = Object.values(Category);
  let minCategory = "Strength" /* STRENGTH */;
  let minCount = weeklyCounts[minCategory] || 0;
  for (const category of categories) {
    const count2 = weeklyCounts[category] || 0;
    if (count2 < minCount) {
      minCount = count2;
      minCategory = category;
    }
  }
  return minCategory;
}
async function computeSuggestion(userId, today = /* @__PURE__ */ new Date()) {
  const uuidRegex = /^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;
  if (!uuidRegex.test(userId)) {
    throw new Error(`Invalid userId format: must be a valid UUID`);
  }
  const { last1, last7, last14, last28 } = await fetchWorkoutData(userId, today);
  const latestHealth = await fetchLatestHealthReport(userId);
  const healthMetrics = latestHealth?.metrics;
  const performancePotential = healthMetrics?.performancePotentialScore ?? null;
  const vitality = healthMetrics?.vitalityScore ?? null;
  const energyBalance = healthMetrics?.energyBalanceScore ?? null;
  const circadian = healthMetrics?.circadianScore ?? null;
  const environment = healthMetrics?.environment || null;
  const uvMax = environment?.weather?.uvIndex ?? null;
  console.log(`\u{1F3AF} Suggestion metrics: performance=${performancePotential}, vitality=${vitality}, energy=${energyBalance}, circadian=${circadian}, uvMax=${uvMax}`);
  const weeklyCounts = computeCategoryCounts(last7);
  const monthlyCounts = computeCategoryCounts(last28);
  const lastWorkout = last28[0] || null;
  const lastCategory = lastWorkout ? getWorkoutCategory(lastWorkout) : void 0;
  const rulesApplied = [];
  const fatigue = computeFatigue(latestHealth, last14, rulesApplied);
  let category;
  let customSuggestions = [];
  if (performancePotential !== null && performancePotential < 55) {
    category = "Cardio" /* CARDIO */;
    rulesApplied.push(`Low performance potential (${performancePotential}) \u2192 recommending Zone 2 cardio + mobility work`);
    customSuggestions.push("Focus on Zone 2 heart rate training (conversational pace)");
    customSuggestions.push("Include 10-15 minutes of mobility/stretching work");
  } else if (performancePotential !== null && performancePotential > 75 && energyBalance !== null && energyBalance < 50) {
    const underrepresentedCategory = getUnderrepresentedCategory(weeklyCounts);
    category = underrepresentedCategory;
    rulesApplied.push(`High performance (${performancePotential}) but low energy balance (${energyBalance}) \u2192 suggesting underrepresented zone: ${category}`);
    customSuggestions.push("Your body is ready for intensity, but energy balance suggests targeting underrepresented training zones");
  } else if (last28.length === 0) {
    const dayOfMonth = today.getDate();
    category = dayOfMonth % 2 === 0 ? "Cardio" /* CARDIO */ : "HIIT" /* HIIT */;
    rulesApplied.push(`No workout history, alternating between Cardio and HIIT based on date parity`);
  } else {
    category = complementCategory(lastCategory, weeklyCounts);
    if (lastCategory) {
      rulesApplied.push(`Last workout was ${lastCategory}, suggesting ${category} for balance`);
    } else {
      rulesApplied.push(`Suggesting ${category} based on weekly activity balance`);
    }
  }
  if (uvMax !== null && uvMax >= 3 && circadian !== null && circadian < 65) {
    customSuggestions.push("Add a 10-20 minute daylight walk within 90 minutes of waking to improve circadian rhythm");
    rulesApplied.push(`UV index ${uvMax} \u2265 3 and circadian score ${circadian} < 65 \u2192 recommending morning daylight exposure`);
  }
  const medianDuration = computeMedianDuration(last14);
  let duration = medianDuration;
  if (fatigue >= 0.7) {
    duration = Math.max(15, duration * 0.75);
    rulesApplied.push(`High fatigue (${fatigue.toFixed(2)}) \u2192 shorten duration 25%`);
  } else if (fatigue <= 0.3) {
    duration = Math.min(60, duration * 1.2);
    rulesApplied.push(`Low fatigue (${fatigue.toFixed(2)}) \u2192 extend duration 20%`);
  }
  if (latestHealth?.metrics && typeof latestHealth.metrics === "object") {
    const metrics = latestHealth.metrics;
    if (typeof metrics.sleepScore === "number" && metrics.sleepScore < 60) {
      duration = Math.max(15, duration * 0.75);
      rulesApplied.push(`Poor sleep (${metrics.sleepScore}) \u2192 shorten duration 25%`);
    }
  }
  duration = Math.round(duration);
  const avgIntensity = computeAverageIntensity(last7);
  let intensity = Math.round(avgIntensity);
  if (fatigue >= 0.8) {
    intensity = Math.max(3, Math.min(5, intensity));
    rulesApplied.push(`Very high fatigue (${fatigue.toFixed(2)}), clamping intensity to 3-5 range`);
  } else if (fatigue >= 0.6) {
    intensity = Math.max(4, Math.min(6, intensity));
    rulesApplied.push(`High fatigue (${fatigue.toFixed(2)}), clamping intensity to 4-6 range`);
  } else if (fatigue >= 0.3) {
    intensity = Math.max(5, Math.min(7, intensity));
  } else {
    intensity = Math.max(6, Math.min(8, intensity));
    rulesApplied.push(`Low fatigue (${fatigue.toFixed(2)}), allowing higher intensity 6-8 range`);
  }
  if (hasRepeatedIntensity(last7, intensity)) {
    const adjustment = Math.random() < 0.5 ? -1 : 1;
    const newIntensity = Math.max(1, Math.min(10, intensity + adjustment));
    rulesApplied.push(`Avoiding repeated intensity ${intensity} for 3 days, adjusting to ${newIntensity}`);
    intensity = newIntensity;
  }
  const rationale = {
    rulesApplied,
    scores: {
      recency: last1.length > 0 ? 1 : 0,
      // 1 if worked out yesterday, 0 otherwise
      weeklyBalance: Math.max(0, 1 - weeklyCounts[category] / Math.max(1, last7.length)),
      monthlyBalance: Math.max(0, 1 - monthlyCounts[category] / Math.max(1, last28.length)),
      fatigue,
      novelty: weeklyCounts[category] === 0 ? 1 : Math.max(0, 1 - weeklyCounts[category] / 7)
    },
    sources: {
      lastWorkout,
      weeklyCounts,
      monthlyCounts,
      health: latestHealth?.metrics ? {
        hrv: latestHealth.metrics.hrv || null,
        sleepScore: latestHealth.metrics.sleepScore || null,
        restingHR: latestHealth.metrics.restingHR || null,
        stress: latestHealth.metrics.stress || null,
        performancePotential,
        vitality,
        energyBalance,
        circadian,
        uvMax
      } : void 0
    }
  };
  const request = {
    category,
    duration,
    intensity
  };
  const dateStr = today.toISOString().split("T")[0];
  return {
    date: dateStr,
    request,
    rationale,
    customSuggestions
  };
}
var LEG_HEAVY, UPPER_HEAVY, FULL_BODY, SKILL, ENGINE, ALL_CATEGORIES;
var init_suggestions = __esm({
  "server/logic/suggestions.ts"() {
    "use strict";
    init_db();
    init_schema();
    init_schema();
    LEG_HEAVY = ["Powerlifting" /* POWERLIFTING */, "Strength" /* STRENGTH */];
    UPPER_HEAVY = ["Strength" /* STRENGTH */];
    FULL_BODY = ["CrossFit" /* CROSSFIT */, "HIIT" /* HIIT */];
    SKILL = ["HIIT" /* HIIT */];
    ENGINE = ["Cardio" /* CARDIO */];
    ALL_CATEGORIES = ["CrossFit" /* CROSSFIT */, "Strength" /* STRENGTH */, "HIIT" /* HIIT */, "Cardio" /* CARDIO */, "Powerlifting" /* POWERLIFTING */];
  }
});

// server/lib/generator/movementTaxonomy.ts
function filterByEquipment(movements, availableEquipment) {
  return movements.filter(
    (movement) => movement.equipment.some((eq17) => availableEquipment.includes(eq17))
  );
}
function avoidConstraints(movements, constraints) {
  const constraintMap = {
    "no_weights": (m2) => m2.equipment.every((eq17) => eq17 === "bodyweight" || eq17 === "floor" || eq17 === "pull_up_bar"),
    "no_barbell": (m2) => !m2.equipment.includes("barbell"),
    "no_floor": (m2) => !m2.equipment.includes("floor"),
    "low_impact": (m2) => !["burpee", "mountain_climber", "box_jump"].includes(m2.id),
    "upper_only": (m2) => ["push", "pull", "core"].includes(m2.pattern),
    "lower_only": (m2) => ["squat", "hinge", "mono", "carry"].includes(m2.pattern)
  };
  return movements.filter(
    (movement) => constraints.every((constraint) => {
      const filter = constraintMap[constraint];
      return !filter || filter(movement);
    })
  );
}
function createSeededRandom(seed) {
  let hash = 0;
  for (let i2 = 0; i2 < seed.length; i2++) {
    const char = seed.charCodeAt(i2);
    hash = (hash << 5) - hash + char;
    hash = hash & hash;
  }
  let state = Math.abs(hash);
  return function() {
    state = (state * 1664525 + 1013904223) % Math.pow(2, 32);
    return state / Math.pow(2, 32);
  };
}
function sampleBalanced(pool3, count2, rng2, options = {}) {
  const { preferredPatterns = [], maxPerPattern = 2, ensureCompound = true } = options;
  if (pool3.length === 0 || count2 <= 0) return [];
  const selected = [];
  const patternCounts = {
    hinge: 0,
    squat: 0,
    push: 0,
    pull: 0,
    core: 0,
    mono: 0,
    carry: 0,
    rotation: 0
  };
  const patterns2 = [
    ...preferredPatterns,
    ...Object.keys(patternCounts).filter((p2) => !preferredPatterns.includes(p2))
  ];
  let availablePool = ensureCompound && selected.length === 0 ? pool3.filter((m2) => m2.compound) : pool3;
  for (let i2 = 0; i2 < count2 && availablePool.length > 0; i2++) {
    let candidates = availablePool.filter(
      (m2) => patternCounts[m2.pattern] < maxPerPattern && !selected.some((s2) => s2.id === m2.id)
    );
    if (candidates.length === 0) {
      candidates = availablePool.filter((m2) => !selected.some((s2) => s2.id === m2.id));
    }
    if (candidates.length === 0) break;
    const randomIndex = Math.floor(rng2() * candidates.length);
    const selectedMovement = candidates[randomIndex];
    selected.push(selectedMovement);
    patternCounts[selectedMovement.pattern]++;
    if (ensureCompound && selected.length === 1) {
      availablePool = pool3;
    }
  }
  return selected;
}
var MOVEMENT_LIBRARY;
var init_movementTaxonomy = __esm({
  "server/lib/generator/movementTaxonomy.ts"() {
    "use strict";
    MOVEMENT_LIBRARY = [
      // HINGE PATTERN
      {
        id: "deadlift",
        name: "Deadlift",
        pattern: "hinge",
        equipment: ["barbell"],
        plane: "sagittal",
        energySystem: "alactic",
        loadability: "high",
        complexity: 3,
        compound: true
      },
      {
        id: "kb_swing",
        name: "Kettlebell Swing",
        pattern: "hinge",
        equipment: ["kettlebell"],
        plane: "sagittal",
        energySystem: "mixed",
        loadability: "medium",
        complexity: 2,
        compound: true
      },
      {
        id: "good_morning",
        name: "Good Morning",
        pattern: "hinge",
        equipment: ["barbell"],
        plane: "sagittal",
        energySystem: "alactic",
        loadability: "medium",
        complexity: 3,
        compound: true
      },
      {
        id: "single_leg_rdl",
        name: "Single Leg RDL",
        pattern: "hinge",
        equipment: ["dumbbell", "kettlebell", "bodyweight"],
        plane: "sagittal",
        energySystem: "alactic",
        loadability: "medium",
        complexity: 4,
        unilateral: true,
        compound: true
      },
      // SQUAT PATTERN
      {
        id: "back_squat",
        name: "Back Squat",
        pattern: "squat",
        equipment: ["barbell"],
        plane: "sagittal",
        energySystem: "alactic",
        loadability: "high",
        complexity: 3,
        compound: true
      },
      {
        id: "front_squat",
        name: "Front Squat",
        pattern: "squat",
        equipment: ["barbell"],
        plane: "sagittal",
        energySystem: "alactic",
        loadability: "high",
        complexity: 4,
        compound: true
      },
      {
        id: "goblet_squat",
        name: "Goblet Squat",
        pattern: "squat",
        equipment: ["dumbbell", "kettlebell"],
        plane: "sagittal",
        energySystem: "alactic",
        loadability: "medium",
        complexity: 2,
        compound: true
      },
      {
        id: "air_squat",
        name: "Air Squat",
        pattern: "squat",
        equipment: ["bodyweight"],
        plane: "sagittal",
        energySystem: "mixed",
        loadability: "low",
        complexity: 1,
        compound: true
      },
      {
        id: "bulgarian_split_squat",
        name: "Bulgarian Split Squat",
        pattern: "squat",
        equipment: ["dumbbell", "bodyweight", "box"],
        plane: "sagittal",
        energySystem: "alactic",
        loadability: "medium",
        complexity: 3,
        unilateral: true,
        compound: true
      },
      // PUSH PATTERN
      {
        id: "bench_press",
        name: "Bench Press",
        pattern: "push",
        equipment: ["barbell"],
        plane: "transverse",
        energySystem: "alactic",
        loadability: "high",
        complexity: 3,
        compound: true
      },
      {
        id: "overhead_press",
        name: "Overhead Press",
        pattern: "push",
        equipment: ["barbell"],
        plane: "frontal",
        energySystem: "alactic",
        loadability: "high",
        complexity: 3,
        compound: true
      },
      {
        id: "dumbbell_press",
        name: "Dumbbell Press",
        pattern: "push",
        equipment: ["dumbbell"],
        plane: "transverse",
        energySystem: "alactic",
        loadability: "medium",
        complexity: 2,
        compound: true
      },
      {
        id: "push_up",
        name: "Push-up",
        pattern: "push",
        equipment: ["bodyweight", "floor"],
        plane: "transverse",
        energySystem: "mixed",
        loadability: "low",
        complexity: 2,
        compound: true
      },
      {
        id: "handstand_push_up",
        name: "Handstand Push-up",
        pattern: "push",
        equipment: ["bodyweight"],
        plane: "frontal",
        energySystem: "alactic",
        loadability: "low",
        complexity: 5,
        compound: true
      },
      // PULL PATTERN
      {
        id: "pull_up",
        name: "Pull-up",
        pattern: "pull",
        equipment: ["pull_up_bar"],
        plane: "frontal",
        energySystem: "alactic",
        loadability: "medium",
        complexity: 3,
        compound: true
      },
      {
        id: "chin_up",
        name: "Chin-up",
        pattern: "pull",
        equipment: ["pull_up_bar"],
        plane: "frontal",
        energySystem: "alactic",
        loadability: "medium",
        complexity: 3,
        compound: true
      },
      {
        id: "bent_over_row",
        name: "Bent Over Row",
        pattern: "pull",
        equipment: ["barbell"],
        plane: "transverse",
        energySystem: "alactic",
        loadability: "high",
        complexity: 3,
        compound: true
      },
      {
        id: "dumbbell_row",
        name: "Dumbbell Row",
        pattern: "pull",
        equipment: ["dumbbell"],
        plane: "transverse",
        energySystem: "alactic",
        loadability: "medium",
        complexity: 2,
        compound: true
      },
      // CORE PATTERN
      {
        id: "plank",
        name: "Plank",
        pattern: "core",
        equipment: ["bodyweight", "floor"],
        plane: "sagittal",
        energySystem: "alactic",
        loadability: "low",
        complexity: 1,
        compound: false
      },
      {
        id: "dead_bug",
        name: "Dead Bug",
        pattern: "core",
        equipment: ["bodyweight", "floor"],
        plane: "sagittal",
        energySystem: "alactic",
        loadability: "low",
        complexity: 2,
        compound: false
      },
      {
        id: "hollow_rock",
        name: "Hollow Rock",
        pattern: "core",
        equipment: ["bodyweight", "floor"],
        plane: "sagittal",
        energySystem: "glycolytic",
        loadability: "low",
        complexity: 2,
        compound: false
      },
      // MONO/UNILATERAL PATTERN
      {
        id: "single_arm_farmer_walk",
        name: "Single Arm Farmer Walk",
        pattern: "mono",
        equipment: ["dumbbell", "kettlebell"],
        plane: "multi",
        energySystem: "mixed",
        loadability: "medium",
        complexity: 2,
        unilateral: true,
        compound: true
      },
      {
        id: "walking_lunge",
        name: "Walking Lunge",
        pattern: "mono",
        equipment: ["dumbbell", "bodyweight"],
        plane: "sagittal",
        energySystem: "mixed",
        loadability: "medium",
        complexity: 2,
        unilateral: true,
        compound: true
      },
      // CARRY PATTERN
      {
        id: "farmer_walk",
        name: "Farmer Walk",
        pattern: "carry",
        equipment: ["dumbbell", "kettlebell"],
        plane: "sagittal",
        energySystem: "mixed",
        loadability: "medium",
        complexity: 1,
        compound: true
      },
      // CONDITIONING MOVEMENTS
      {
        id: "burpee",
        name: "Burpee",
        pattern: "squat",
        equipment: ["bodyweight", "floor"],
        plane: "multi",
        energySystem: "glycolytic",
        loadability: "low",
        complexity: 2,
        compound: true
      },
      {
        id: "mountain_climber",
        name: "Mountain Climber",
        pattern: "core",
        equipment: ["bodyweight", "floor"],
        plane: "sagittal",
        energySystem: "glycolytic",
        loadability: "low",
        complexity: 1,
        compound: true
      },
      {
        id: "bike_erg",
        name: "Bike Erg",
        pattern: "squat",
        equipment: ["bike"],
        plane: "sagittal",
        energySystem: "aerobic",
        loadability: "low",
        complexity: 1,
        compound: true
      },
      {
        id: "row_erg",
        name: "Rowing Erg",
        pattern: "pull",
        equipment: ["rower"],
        plane: "sagittal",
        energySystem: "aerobic",
        loadability: "low",
        complexity: 2,
        compound: true
      }
    ];
  }
});

// server/lib/generator/templates.ts
function selectTemplate(archetype, minutes, targetIntensity, rng2) {
  let candidates = WORKOUT_TEMPLATES.filter(
    (t2) => t2.archetype === archetype && minutes >= t2.minMinutes && minutes <= t2.maxMinutes
  );
  if (candidates.length === 0) {
    if (archetype === "conditioning") {
      candidates = WORKOUT_TEMPLATES.filter(
        (t2) => (t2.archetype === "mixed" || t2.archetype === "endurance") && minutes >= t2.minMinutes && minutes <= t2.maxMinutes
      );
    }
  }
  const intensityMatches = candidates.filter(
    (t2) => targetIntensity >= t2.targetIntensityRange[0] && targetIntensity <= t2.targetIntensityRange[1]
  );
  const finalCandidates = intensityMatches.length > 0 ? intensityMatches : candidates;
  if (finalCandidates.length === 0) {
    const allTemplates = WORKOUT_TEMPLATES.filter((t2) => t2.archetype === archetype);
    if (allTemplates.length > 0) {
      const closest = allTemplates.reduce((prev, curr) => {
        const prevDiff = Math.abs((prev.minMinutes + prev.maxMinutes) / 2 - minutes);
        const currDiff = Math.abs((curr.minMinutes + curr.maxMinutes) / 2 - minutes);
        return currDiff < prevDiff ? curr : prev;
      });
      return closest;
    }
    return void 0;
  }
  const index2 = Math.floor(rng2() * finalCandidates.length);
  return finalCandidates[index2];
}
var STRENGTH_TEMPLATES, QUICK_STRENGTH_TEMPLATES, MIXED_TEMPLATES, ENDURANCE_TEMPLATES, WORKOUT_TEMPLATES;
var init_templates = __esm({
  "server/lib/generator/templates.ts"() {
    "use strict";
    STRENGTH_TEMPLATES = [
      {
        id: "strength-fullbody-3x3",
        name: "Full Body Strength 3x3",
        archetype: "strength",
        minMinutes: 45,
        maxMinutes: 75,
        targetIntensityRange: [7, 9],
        blocks: [
          {
            id: "warmup",
            type: "warmup",
            structure: "straight",
            time: 10,
            movements: [
              { role: "mobility", patterns: ["hinge", "squat"], count: 2 }
            ]
          },
          {
            id: "main-compound",
            type: "main",
            structure: "straight",
            sets: 3,
            reps: "3-5",
            rest: 180,
            load: "80-90%",
            movements: [
              { role: "primary", patterns: ["squat", "hinge"], count: 1, compound: true },
              { role: "primary", patterns: ["push", "pull"], count: 1, compound: true }
            ]
          },
          {
            id: "accessory",
            type: "accessory",
            structure: "superset",
            sets: 3,
            reps: "8-12",
            rest: 90,
            load: "65-75%",
            movements: [
              { role: "accessory", patterns: ["push", "pull"], count: 1 },
              { role: "accessory", patterns: ["core"], count: 1 }
            ]
          }
        ]
      },
      {
        id: "strength-upper-lower-4x5",
        name: "Upper/Lower Strength 4x5",
        archetype: "strength",
        minMinutes: 50,
        maxMinutes: 80,
        targetIntensityRange: [6, 8],
        blocks: [
          {
            id: "warmup",
            type: "warmup",
            structure: "straight",
            time: 8,
            movements: [
              { role: "mobility", patterns: ["push", "pull"], count: 2 }
            ]
          },
          {
            id: "main-upper",
            type: "main",
            structure: "straight",
            sets: 4,
            reps: "5-6",
            rest: 150,
            load: "75-85%",
            movements: [
              { role: "primary", patterns: ["push"], count: 1, compound: true },
              { role: "primary", patterns: ["pull"], count: 1, compound: true }
            ]
          },
          {
            id: "accessory-upper",
            type: "accessory",
            structure: "circuit",
            sets: 3,
            reps: "10-15",
            rest: 60,
            movements: [
              { role: "accessory", patterns: ["push"], count: 1 },
              { role: "accessory", patterns: ["pull"], count: 1 },
              { role: "accessory", patterns: ["core"], count: 1 }
            ]
          }
        ]
      }
    ];
    QUICK_STRENGTH_TEMPLATES = [
      {
        id: "strength-quick-20min",
        name: "Quick Strength 20min",
        archetype: "strength",
        minMinutes: 15,
        maxMinutes: 25,
        targetIntensityRange: [5, 8],
        blocks: [
          {
            id: "warmup",
            type: "warmup",
            structure: "straight",
            time: 5,
            movements: [
              { role: "mobility", patterns: ["squat", "hinge"], count: 2 }
            ]
          },
          {
            id: "main-quick",
            type: "main",
            structure: "superset",
            sets: 3,
            reps: "6-8",
            rest: 90,
            load: "70-80%",
            movements: [
              { role: "primary", patterns: ["squat", "hinge"], count: 1, compound: true },
              { role: "primary", patterns: ["push", "pull"], count: 1, compound: true }
            ]
          }
        ]
      }
    ];
    MIXED_TEMPLATES = [
      {
        id: "mixed-emom-18",
        name: "Mixed EMOM 18",
        archetype: "mixed",
        minMinutes: 25,
        maxMinutes: 35,
        targetIntensityRange: [6, 8],
        blocks: [
          {
            id: "warmup",
            type: "warmup",
            structure: "straight",
            time: 8,
            movements: [
              { role: "mobility", patterns: ["squat", "hinge", "push"], count: 3 }
            ]
          },
          {
            id: "emom-main",
            type: "main",
            structure: "emom",
            time: 18,
            movements: [
              { role: "strength", patterns: ["squat", "hinge"], count: 1, compound: true },
              { role: "conditioning", patterns: ["push", "pull"], count: 1, energySystem: "glycolytic" },
              { role: "metabolic", patterns: ["squat"], count: 1, energySystem: "glycolytic" }
            ],
            notes: "Minute 1: Strength, Minute 2: Upper conditioning, Minute 3: Metabolic, repeat"
          }
        ]
      },
      {
        id: "mixed-amrap-15",
        name: "Mixed AMRAP 15",
        archetype: "mixed",
        minMinutes: 25,
        maxMinutes: 35,
        targetIntensityRange: [7, 9],
        blocks: [
          {
            id: "warmup",
            type: "warmup",
            structure: "straight",
            time: 8,
            movements: [
              { role: "mobility", patterns: ["squat", "push", "pull"], count: 3 }
            ]
          },
          {
            id: "amrap-main",
            type: "main",
            structure: "amrap",
            time: 15,
            movements: [
              { role: "strength", patterns: ["hinge"], count: 1 },
              { role: "gymnastics", patterns: ["push", "pull"], count: 1 },
              { role: "metabolic", patterns: ["squat"], count: 1, energySystem: "glycolytic" }
            ]
          },
          {
            id: "cooldown",
            type: "cooldown",
            structure: "straight",
            time: 5,
            movements: [
              { role: "recovery", patterns: ["core"], count: 1 }
            ]
          }
        ]
      },
      {
        id: "mixed-complex-45min",
        name: "Mixed Complex 45min",
        archetype: "mixed",
        minMinutes: 40,
        maxMinutes: 50,
        targetIntensityRange: [6, 8],
        blocks: [
          {
            id: "warmup",
            type: "warmup",
            structure: "straight",
            time: 10,
            movements: [
              { role: "mobility", patterns: ["squat", "hinge", "push"], count: 3 }
            ]
          },
          {
            id: "strength-block",
            type: "main",
            structure: "straight",
            sets: 4,
            reps: "5-8",
            rest: 120,
            load: "75-85%",
            movements: [
              { role: "primary", patterns: ["squat", "hinge"], count: 1, compound: true }
            ]
          },
          {
            id: "conditioning-block",
            type: "conditioning",
            structure: "circuit",
            sets: 3,
            time: 8,
            rest: 90,
            movements: [
              { role: "power", patterns: ["squat"], count: 1, energySystem: "glycolytic" },
              { role: "gymnastics", patterns: ["push", "pull"], count: 1 },
              { role: "metabolic", patterns: ["carry"], count: 1 }
            ]
          }
        ]
      }
    ];
    ENDURANCE_TEMPLATES = [
      {
        id: "endurance-intervals-8x1min",
        name: "Endurance Intervals 8x1min",
        archetype: "endurance",
        minMinutes: 30,
        maxMinutes: 45,
        targetIntensityRange: [5, 7],
        blocks: [
          {
            id: "warmup",
            type: "warmup",
            structure: "straight",
            time: 10,
            movements: [
              { role: "mobility", patterns: ["squat", "hinge"], count: 2 }
            ]
          },
          {
            id: "intervals",
            type: "conditioning",
            structure: "intervals",
            sets: 8,
            time: 1,
            rest: 90,
            movements: [
              { role: "cardio", patterns: ["squat", "pull"], count: 1, energySystem: "aerobic" }
            ]
          },
          {
            id: "cooldown",
            type: "cooldown",
            structure: "straight",
            time: 8,
            movements: [
              { role: "recovery", patterns: ["core"], count: 1 }
            ]
          }
        ]
      },
      {
        id: "endurance-steady-30min",
        name: "Steady State Endurance 30min",
        archetype: "endurance",
        minMinutes: 35,
        maxMinutes: 50,
        targetIntensityRange: [4, 6],
        blocks: [
          {
            id: "warmup",
            type: "warmup",
            structure: "straight",
            time: 5,
            movements: [
              { role: "mobility", patterns: ["squat"], count: 1 }
            ]
          },
          {
            id: "steady-state",
            type: "conditioning",
            structure: "straight",
            time: 30,
            movements: [
              { role: "cardio", patterns: ["squat", "pull"], count: 1, energySystem: "aerobic" }
            ],
            notes: "Maintain steady conversational pace"
          },
          {
            id: "cooldown",
            type: "cooldown",
            structure: "straight",
            time: 10,
            movements: [
              { role: "recovery", patterns: ["core"], count: 1 }
            ]
          }
        ]
      }
    ];
    WORKOUT_TEMPLATES = [
      ...STRENGTH_TEMPLATES,
      ...QUICK_STRENGTH_TEMPLATES,
      ...MIXED_TEMPLATES,
      ...ENDURANCE_TEMPLATES
    ];
  }
});

// server/lib/generator/intensity.ts
function applyHealthCaps(targetIntensity, axleMetrics) {
  let cappedIntensity = targetIntensity;
  if (axleMetrics.vitality && axleMetrics.vitality < 40 || axleMetrics.axleScore && axleMetrics.axleScore < 40) {
    cappedIntensity = Math.min(cappedIntensity, 6);
  }
  if (axleMetrics.performancePotential && axleMetrics.performancePotential < 35) {
    cappedIntensity = Math.min(cappedIntensity, 5);
  }
  if (axleMetrics.stress && axleMetrics.stress > 7) {
    cappedIntensity = Math.min(cappedIntensity, 4);
  }
  if (axleMetrics.recovery && axleMetrics.recovery < 30) {
    cappedIntensity = Math.min(cappedIntensity, 5);
  }
  return Math.max(1, cappedIntensity);
}
function adjustVolumeForPerformance(baseParameters, axleMetrics) {
  const adjusted = { ...baseParameters };
  if (axleMetrics.performancePotential && axleMetrics.performancePotential < 35) {
    adjusted.volumeMultiplier *= 0.8;
    adjusted.totalSets = Math.max(6, Math.floor(adjusted.totalSets * 0.8));
  }
  if (axleMetrics.performancePotential && axleMetrics.performancePotential < 35) {
    adjusted.avgRestSeconds = Math.min(90, adjusted.avgRestSeconds);
    adjusted.loadPercentage = [
      Math.max(40, adjusted.loadPercentage[0] - 10),
      Math.max(60, adjusted.loadPercentage[1] - 10)
    ];
  }
  return adjusted;
}
function getIntensityParameters(targetIntensity, axleMetrics = {}) {
  const cappedIntensity = applyHealthCaps(targetIntensity, axleMetrics);
  const baseParameters = INTENSITY_MAP[cappedIntensity] || INTENSITY_MAP[5];
  return adjustVolumeForPerformance(baseParameters, axleMetrics);
}
var INTENSITY_MAP;
var init_intensity = __esm({
  "server/lib/generator/intensity.ts"() {
    "use strict";
    INTENSITY_MAP = {
      1: {
        totalSets: 8,
        avgRestSeconds: 60,
        timeUnderTension: 20,
        loadPercentage: [40, 55],
        complexityLimit: 2,
        volumeMultiplier: 0.7
      },
      2: {
        totalSets: 10,
        avgRestSeconds: 75,
        timeUnderTension: 25,
        loadPercentage: [45, 60],
        complexityLimit: 2,
        volumeMultiplier: 0.8
      },
      3: {
        totalSets: 12,
        avgRestSeconds: 90,
        timeUnderTension: 30,
        loadPercentage: [50, 65],
        complexityLimit: 3,
        volumeMultiplier: 0.9
      },
      4: {
        totalSets: 14,
        avgRestSeconds: 105,
        timeUnderTension: 35,
        loadPercentage: [55, 70],
        complexityLimit: 3,
        volumeMultiplier: 1
      },
      5: {
        totalSets: 16,
        avgRestSeconds: 120,
        timeUnderTension: 40,
        loadPercentage: [60, 75],
        complexityLimit: 3,
        volumeMultiplier: 1
      },
      6: {
        totalSets: 18,
        avgRestSeconds: 135,
        timeUnderTension: 45,
        loadPercentage: [65, 80],
        complexityLimit: 4,
        volumeMultiplier: 1.1
      },
      7: {
        totalSets: 20,
        avgRestSeconds: 150,
        timeUnderTension: 50,
        loadPercentage: [70, 85],
        complexityLimit: 4,
        volumeMultiplier: 1.1
      },
      8: {
        totalSets: 22,
        avgRestSeconds: 165,
        timeUnderTension: 55,
        loadPercentage: [75, 90],
        complexityLimit: 4,
        volumeMultiplier: 1.2
      },
      9: {
        totalSets: 24,
        avgRestSeconds: 180,
        timeUnderTension: 60,
        loadPercentage: [80, 95],
        complexityLimit: 5,
        volumeMultiplier: 1.2
      },
      10: {
        totalSets: 26,
        avgRestSeconds: 200,
        timeUnderTension: 65,
        loadPercentage: [85, 100],
        complexityLimit: 5,
        volumeMultiplier: 1.3
      }
    };
  }
});

// server/dal/workouts.ts
var workouts_exports = {};
__export(workouts_exports, {
  deleteWorkout: () => deleteWorkout,
  getRecentRPE: () => getRecentRPE,
  getRecentRPEs: () => getRecentRPEs,
  getStrain: () => getStrain,
  getUserRecentWorkouts: () => getUserRecentWorkouts,
  getWorkout: () => getWorkout,
  getZoneMinutes14d: () => getZoneMinutes14d,
  insertWorkout: () => insertWorkout,
  insertWorkoutFeedback: () => insertWorkoutFeedback,
  listWorkouts: () => listWorkouts,
  mapWorkoutToFrontend: () => mapWorkoutToFrontend,
  startWorkoutAtomic: () => startWorkoutAtomic,
  updateWorkout: () => updateWorkout
});
function mapWorkoutToFrontend(workout) {
  if (!workout) return null;
  return {
    id: workout.id,
    userId: workout.user_id,
    title: workout.title,
    request: workout.request,
    sets: workout.sets,
    notes: workout.notes,
    completed: workout.completed,
    feedback: workout.feedback,
    startedAt: workout.started_at,
    createdAt: workout.created_at,
    totalActiveMinutes: workout.total_active_minutes,
    intensity: workout.intensity,
    energySystem: workout.energy_system,
    generationId: workout.generation_id
  };
}
async function insertWorkout({ userId, workout }) {
  const { data, error } = await supabaseAdmin.from("workouts").insert({
    user_id: userId,
    title: workout.title,
    request: workout.request,
    sets: workout.sets,
    notes: workout.notes,
    completed: workout.completed || false,
    feedback: workout.feedback
  }).select().single();
  if (error) {
    throw new Error(`Failed to insert workout: ${error.message}`);
  }
  return mapWorkoutToFrontend(data);
}
async function listWorkouts(userId, options = {}) {
  const { limit = 50 } = options;
  const { data, error } = await supabaseAdmin.from("workouts").select("*").eq("user_id", userId).order("created_at", { ascending: false }).limit(limit);
  if (error) {
    throw new Error(`Failed to list workouts: ${error.message}`);
  }
  return (data || []).map(mapWorkoutToFrontend);
}
async function getWorkout(userId, id) {
  const { data, error } = await supabaseAdmin.from("workouts").select("*").eq("user_id", userId).eq("id", id).single();
  if (error) {
    if (error.code === "PGRST116") {
      return null;
    }
    throw new Error(`Failed to get workout: ${error.message}`);
  }
  return mapWorkoutToFrontend(data);
}
async function updateWorkout(userId, id, patch) {
  const { data, error } = await supabaseAdmin.from("workouts").update(patch).eq("user_id", userId).eq("id", id).select().single();
  if (error) {
    if (error.code === "PGRST116") {
      return null;
    }
    throw new Error(`Failed to update workout: ${error.message}`);
  }
  return mapWorkoutToFrontend(data);
}
async function deleteWorkout(userId, id) {
  const { error } = await supabaseAdmin.from("workouts").delete().eq("user_id", userId).eq("id", id);
  if (error) {
    throw new Error(`Failed to delete workout: ${error.message}`);
  }
  return { success: true };
}
async function startWorkoutAtomic(userId, id) {
  const startedAt = (/* @__PURE__ */ new Date()).toISOString();
  const { data, error } = await supabaseAdmin.from("workouts").update({
    started_at: startedAt,
    completed: false
  }).eq("user_id", userId).eq("id", id).is("started_at", null).select().single();
  if (error) {
    if (error.code === "PGRST116") {
      const existing = await getWorkout(userId, id);
      if (!existing) {
        return null;
      }
      return {
        workout: existing,
        wasAlreadyStarted: true
      };
    }
    throw new Error(`Failed to start workout: ${error.message}`);
  }
  return {
    workout: mapWorkoutToFrontend(data),
    wasAlreadyStarted: false
  };
}
async function getRecentRPE(userId, hours = 24) {
  const cutoffDate = /* @__PURE__ */ new Date();
  cutoffDate.setHours(cutoffDate.getHours() - hours);
  const { data, error } = await supabaseAdmin.from("workouts").select("feedback").eq("user_id", userId).eq("completed", true).gte("created_at", cutoffDate.toISOString()).not("feedback", "is", null);
  if (error) {
    throw new Error(`Failed to get recent RPE: ${error.message}`);
  }
  if (!data || data.length === 0) {
    return null;
  }
  const difficultyScores = [];
  for (const workout of data) {
    const feedback = workout.feedback;
    if (feedback && typeof feedback.difficulty === "number") {
      difficultyScores.push(feedback.difficulty);
    }
  }
  if (difficultyScores.length === 0) {
    return null;
  }
  const sum = difficultyScores.reduce((acc, score) => acc + score, 0);
  return Math.round(sum / difficultyScores.length * 10) / 10;
}
async function getZoneMinutes14d(userId) {
  const cutoffDate = /* @__PURE__ */ new Date();
  cutoffDate.setDate(cutoffDate.getDate() - 14);
  const { data, error } = await supabaseAdmin.from("workouts").select("sets, request").eq("user_id", userId).eq("completed", true).gte("created_at", cutoffDate.toISOString());
  if (error) {
    throw new Error(`Failed to get zone minutes: ${error.message}`);
  }
  if (!data || data.length === 0) {
    return null;
  }
  const zoneMinutes = {
    "zone1": 0,
    // Recovery (50-60% max HR)
    "zone2": 0,
    // Aerobic Base (60-70% max HR)
    "zone3": 0,
    // Aerobic (70-80% max HR)
    "zone4": 0,
    // Lactate Threshold (80-90% max HR)
    "zone5": 0
    // Neuromuscular Power (90-100% max HR)
  };
  for (const workout of data) {
    const sets = workout.sets;
    const request = workout.request;
    if (!sets || !Array.isArray(sets)) continue;
    const workoutIntensity = request?.intensity || 5;
    let zone;
    if (workoutIntensity <= 2) zone = "zone1";
    else if (workoutIntensity <= 4) zone = "zone2";
    else if (workoutIntensity <= 6) zone = "zone3";
    else if (workoutIntensity <= 8) zone = "zone4";
    else zone = "zone5";
    let totalMinutes = 0;
    for (const set of sets) {
      if (typeof set.duration === "number") {
        totalMinutes += set.duration / 60;
      }
    }
    if (totalMinutes === 0 && sets.length > 0) {
      totalMinutes = sets.length * 1.5;
    }
    zoneMinutes[zone] += totalMinutes;
  }
  Object.keys(zoneMinutes).forEach((zone) => {
    zoneMinutes[zone] = Math.round(zoneMinutes[zone]);
  });
  return zoneMinutes;
}
async function getStrain(userId, hours) {
  const cutoffDate = /* @__PURE__ */ new Date();
  cutoffDate.setHours(cutoffDate.getHours() - hours);
  const { data, error } = await supabaseAdmin.from("workouts").select("sets, request, feedback").eq("user_id", userId).eq("completed", true).gte("created_at", cutoffDate.toISOString());
  if (error) {
    throw new Error(`Failed to get strain: ${error.message}`);
  }
  if (!data || data.length === 0) {
    return null;
  }
  let totalStrain = 0;
  for (const workout of data) {
    const sets = workout.sets;
    const request = workout.request;
    const feedback = workout.feedback;
    let intensityFactor = 1;
    if (feedback?.difficulty) {
      intensityFactor = feedback.difficulty / 10;
    } else if (request?.intensity) {
      intensityFactor = request.intensity / 10;
    }
    let durationMinutes = 0;
    if (sets && Array.isArray(sets)) {
      for (const set of sets) {
        if (typeof set.duration === "number") {
          durationMinutes += set.duration / 60;
        }
      }
      if (durationMinutes === 0) {
        durationMinutes = sets.length * 1.5;
      }
    }
    if (durationMinutes === 0 && request?.duration) {
      durationMinutes = request.duration;
    }
    const workoutStrain = durationMinutes * intensityFactor;
    totalStrain += workoutStrain;
  }
  const maxStrain = 60 * 1;
  const scaledStrain = Math.min(100, totalStrain / maxStrain * 100);
  return Math.round(scaledStrain);
}
async function insertWorkoutFeedback({ workoutId, userId, perceivedIntensity, notes }) {
  const { data, error } = await supabaseAdmin.from("workout_feedback").insert({
    workout_id: workoutId,
    user_id: userId,
    perceived_intensity: perceivedIntensity,
    notes: notes || null
  }).select().single();
  if (error) {
    if (error.code === "23505") {
      throw new Error("Feedback already submitted for this workout");
    }
    throw new Error(`Failed to insert workout feedback: ${error.message}`);
  }
  return data;
}
async function getRecentRPEs(userId, limit = 10) {
  const { data, error } = await supabaseAdmin.from("workout_feedback").select("workout_id, perceived_intensity, created_at").eq("user_id", userId).order("created_at", { ascending: false }).limit(limit);
  if (error) {
    throw new Error(`Failed to get recent RPEs: ${error.message}`);
  }
  return data || [];
}
async function getUserRecentWorkouts(userId, options) {
  const cutoffDate = /* @__PURE__ */ new Date();
  cutoffDate.setDate(cutoffDate.getDate() - options.days);
  const { data, error } = await supabaseAdmin.from("workouts").select("*").eq("user_id", userId).eq("completed", true).gte("created_at", cutoffDate.toISOString()).order("created_at", { ascending: false });
  if (error) {
    throw new Error(`Failed to get recent workouts: ${error.message}`);
  }
  return (data || []).map((workout) => ({
    ...workout,
    total_active_minutes: workout.sets && Array.isArray(workout.sets) ? workout.sets.reduce((total, set) => {
      return total + (set.duration ? set.duration / 60 : 1.5);
    }, 0) : 0,
    intensity: workout.request?.intensity ?? 5,
    energy_system: workout.request?.energy_system ?? "aerobic"
  }));
}
var init_workouts = __esm({
  "server/dal/workouts.ts"() {
    "use strict";
    init_supabaseAdmin();
  }
});

// server/lib/generator/progression.ts
async function enrichWorkoutHistoryWithRPE(userId, workouts3) {
  try {
    const { getRecentRPEs: getRecentRPEs2 } = await Promise.resolve().then(() => (init_workouts(), workouts_exports));
    const rpeData = await getRecentRPEs2(userId, 20);
    const rpeMap = /* @__PURE__ */ new Map();
    rpeData.forEach((rpe) => {
      rpeMap.set(rpe.workout_id, rpe.perceived_intensity);
    });
    return workouts3.map((workout) => ({
      ...workout,
      rpe: rpeMap.get(workout.id) || workout.rpe
    }));
  } catch (error) {
    console.warn("Failed to enrich workout history with RPE data:", error);
    return workouts3;
  }
}
function analyzeWorkoutHistory(workouts3, targetArchetype) {
  const sortedWorkouts = [...workouts3].sort((a2, b) => b.date.getTime() - a2.date.getTime());
  const fourWeeksAgo = /* @__PURE__ */ new Date();
  fourWeeksAgo.setDate(fourWeeksAgo.getDate() - 28);
  const recentWorkouts = sortedWorkouts.filter((w) => w.date >= fourWeeksAgo);
  const lastSameArchetype = recentWorkouts.find((w) => w.archetype === targetArchetype);
  const daysSinceLastSameArchetype = lastSameArchetype ? Math.floor((Date.now() - lastSameArchetype.date.getTime()) / (1e3 * 60 * 60 * 24)) : 14;
  let consecutiveHighIntensity = 0;
  for (const workout of recentWorkouts) {
    if ((workout.actualIntensity || workout.targetIntensity) >= 7) {
      consecutiveHighIntensity++;
    } else {
      break;
    }
  }
  const workoutsWithFeedback = recentWorkouts.filter((w) => w.feedback);
  const avgRecoveryScore = workoutsWithFeedback.length > 0 ? workoutsWithFeedback.reduce((sum, w) => sum + (10 - w.feedback.difficulty), 0) / workoutsWithFeedback.length : 7;
  const trainingPhase = determineTrainingPhase(recentWorkouts, consecutiveHighIntensity);
  return {
    recentWorkouts,
    daysSinceLastSameArchetype,
    consecutiveHighIntensity,
    avgRecoveryScore,
    trainingPhase
  };
}
function determineTrainingPhase(recentWorkouts, consecutiveHighIntensity) {
  if (consecutiveHighIntensity >= 4) return "deload";
  const last2Weeks = recentWorkouts.filter((w) => {
    const twoWeeksAgo = /* @__PURE__ */ new Date();
    twoWeeksAgo.setDate(twoWeeksAgo.getDate() - 14);
    return w.date >= twoWeeksAgo;
  });
  const avgIntensity = last2Weeks.length > 0 ? last2Weeks.reduce((sum, w) => sum + (w.actualIntensity || w.targetIntensity), 0) / last2Weeks.length : 5;
  const avgVolume = last2Weeks.length > 0 ? last2Weeks.reduce((sum, w) => sum + w.volume, 0) / last2Weeks.length : 15;
  if (avgIntensity >= 7.5) return "realization";
  if (avgIntensity >= 6) return "intensification";
  return "accumulation";
}
function generateStrengthProgression(context, targetArchetype) {
  const sameArchetypeWorkouts = context.recentWorkouts.filter((w) => w.archetype === targetArchetype).slice(0, 4);
  if (context.consecutiveHighIntensity >= 4 || context.avgRecoveryScore < 4 || context.trainingPhase === "deload") {
    return {
      loadAdjustment: 0.8,
      volumeAdjustment: 0.7,
      intensityAdjustment: -2,
      deloadRecommended: true,
      progressionType: "deload",
      reasoning: "Deload recommended due to accumulated fatigue"
    };
  }
  if (sameArchetypeWorkouts.length === 0) {
    return {
      loadAdjustment: 0.9,
      volumeAdjustment: 0.9,
      intensityAdjustment: 0,
      deloadRecommended: false,
      progressionType: "load",
      reasoning: "Conservative start due to no recent history"
    };
  }
  const lastWorkout = sameArchetypeWorkouts[0];
  const lastRPE = lastWorkout.rpe || lastWorkout.feedback?.difficulty || 5;
  if (lastRPE < 7 && context.avgRecoveryScore > 6) {
    return {
      loadAdjustment: 1.05,
      // 5% load increase
      volumeAdjustment: 1,
      intensityAdjustment: 0,
      deloadRecommended: false,
      progressionType: "load",
      reasoning: "Increasing load due to low perceived exertion"
    };
  } else if (lastRPE >= 9 || context.avgRecoveryScore < 5) {
    return {
      loadAdjustment: 0.95,
      volumeAdjustment: 1,
      intensityAdjustment: -1,
      deloadRecommended: false,
      progressionType: "deload",
      reasoning: "Reducing load due to high fatigue indicators"
    };
  } else {
    return {
      loadAdjustment: 1,
      volumeAdjustment: 1.1,
      // Add one set
      intensityAdjustment: 0,
      deloadRecommended: false,
      progressionType: "volume",
      reasoning: "Adding volume while maintaining load"
    };
  }
}
function generateConditioningProgression(context, targetArchetype) {
  const sameArchetypeWorkouts = context.recentWorkouts.filter((w) => w.archetype === targetArchetype).slice(0, 4);
  const needsDeload = sameArchetypeWorkouts.length >= 4 || context.consecutiveHighIntensity >= 3 || context.avgRecoveryScore < 5;
  if (needsDeload) {
    return {
      loadAdjustment: 0.9,
      volumeAdjustment: 0.8,
      intensityAdjustment: -1,
      deloadRecommended: true,
      progressionType: "deload",
      reasoning: "Deload recommended for conditioning recovery"
    };
  }
  const exposureCount = Math.min(sameArchetypeWorkouts.length, 3);
  if (exposureCount >= 2 && context.avgRecoveryScore > 6) {
    const progressionChoice = Math.random() > 0.5 ? "volume" : "density";
    if (progressionChoice === "volume") {
      return {
        loadAdjustment: 1,
        volumeAdjustment: 1.1,
        // 10% more volume
        intensityAdjustment: 0,
        deloadRecommended: false,
        progressionType: "volume",
        reasoning: "Increasing volume for conditioning adaptation"
      };
    } else {
      return {
        loadAdjustment: 1,
        volumeAdjustment: 1,
        intensityAdjustment: 1,
        deloadRecommended: false,
        progressionType: "density",
        reasoning: "Increasing density for conditioning adaptation"
      };
    }
  }
  return {
    loadAdjustment: 1,
    volumeAdjustment: 1,
    intensityAdjustment: 0,
    deloadRecommended: false,
    progressionType: "skill",
    reasoning: "Maintaining current level for adaptation"
  };
}
function generateEnduranceProgression(context) {
  if (context.avgRecoveryScore > 7) {
    return {
      loadAdjustment: 1,
      volumeAdjustment: 1.05,
      // Small volume increase
      intensityAdjustment: 0,
      deloadRecommended: false,
      progressionType: "volume",
      reasoning: "Gradual volume increase for endurance base"
    };
  }
  return {
    loadAdjustment: 1,
    volumeAdjustment: 1,
    intensityAdjustment: 0,
    deloadRecommended: false,
    progressionType: "skill",
    reasoning: "Maintaining endurance base"
  };
}
async function generateProgressionDirectives(userId, workoutHistory, targetArchetype) {
  const enrichedHistory = await enrichWorkoutHistoryWithRPE(userId, workoutHistory);
  const context = analyzeWorkoutHistory(enrichedHistory, targetArchetype);
  switch (targetArchetype) {
    case "strength":
      return generateStrengthProgression(context, targetArchetype);
    case "conditioning":
    case "mixed":
      return generateConditioningProgression(context, targetArchetype);
    case "endurance":
      return generateEnduranceProgression(context);
    default:
      return {
        loadAdjustment: 1,
        volumeAdjustment: 1,
        intensityAdjustment: 0,
        deloadRecommended: false,
        progressionType: "skill",
        reasoning: "Unknown archetype - maintaining current level"
      };
  }
}
var init_progression = __esm({
  "server/lib/generator/progression.ts"() {
    "use strict";
  }
});

// server/lib/generator/warmupCooldown.ts
function generateWarmup(mainWorkoutPatterns, availableEquipment, targetMinutes, rngSeed) {
  const rng2 = createSeededRandom(rngSeed + "_warmup");
  const exercises = [];
  const availableWarmups = filterByEquipment(WARMUP_MOVEMENTS, availableEquipment);
  const generalMobility = availableWarmups.filter(
    (m2) => ["cat_cow", "hip_circle", "arm_circle"].includes(m2.id)
  );
  if (generalMobility.length > 0) {
    const selected = generalMobility[Math.floor(rng2() * generalMobility.length)];
    exercises.push({
      movement: selected,
      sets: 1,
      reps: "8-10",
      intensity: "light",
      purpose: "mobility"
    });
  }
  const patternPriority = Array.from(new Set(mainWorkoutPatterns));
  for (const pattern of patternPriority.slice(0, 3)) {
    const patternWarmups = availableWarmups.filter(
      (m2) => m2.pattern === pattern && !exercises.some((e2) => e2.movement.id === m2.id)
    );
    if (patternWarmups.length > 0) {
      const selected = patternWarmups[Math.floor(rng2() * patternWarmups.length)];
      exercises.push({
        movement: selected,
        sets: 1,
        reps: pattern === "core" ? "30-45s" : "5-8",
        duration: pattern === "core" ? 40 : void 0,
        intensity: "light",
        purpose: "preparation"
      });
    }
  }
  if (targetMinutes >= 8) {
    const activationMoves = availableWarmups.filter(
      (m2) => ["glute_bridge", "scap_pushup", "band_pull_apart"].includes(m2.id) && !exercises.some((e2) => e2.movement.id === m2.id)
    );
    if (activationMoves.length > 0) {
      const selected = activationMoves[Math.floor(rng2() * activationMoves.length)];
      exercises.push({
        movement: selected,
        sets: 2,
        reps: "8-12",
        intensity: "moderate",
        purpose: "activation"
      });
    }
  }
  if (targetMinutes >= 10) {
    const dynamicMoves = availableWarmups.filter(
      (m2) => ["inchworm", "world_greatest_stretch"].includes(m2.id) && !exercises.some((e2) => e2.movement.id === m2.id)
    );
    if (dynamicMoves.length > 0) {
      const selected = dynamicMoves[Math.floor(rng2() * dynamicMoves.length)];
      exercises.push({
        movement: selected,
        sets: 1,
        reps: "5-8",
        intensity: "moderate",
        purpose: "preparation"
      });
    }
  }
  const estimatedMinutes = exercises.reduce((total, ex) => {
    const baseTime = ex.sets * (ex.duration || 30);
    return total + baseTime / 60;
  }, 0);
  return {
    exercises,
    totalMinutes: Math.max(5, Math.min(targetMinutes, estimatedMinutes)),
    description: generateWarmupDescription(mainWorkoutPatterns, exercises.length)
  };
}
function generateCooldown(workoutIntensity, mainWorkoutPatterns, availableEquipment, rngSeed) {
  const rng2 = createSeededRandom(rngSeed + "_cooldown");
  const exercises = [];
  const baseMinutes = workoutIntensity >= 7 ? 8 : 5;
  const availableCooldowns = filterByEquipment(COOLDOWN_MOVEMENTS, availableEquipment);
  if (workoutIntensity >= 7) {
    const breathingEx = availableCooldowns.find((m2) => m2.id === "box_breathing");
    if (breathingEx) {
      exercises.push({
        movement: breathingEx,
        sets: 1,
        duration: 180,
        // 3 minutes
        purpose: "breathing"
      });
    }
  }
  const stretchPatterns = getRelevantStretchPatterns(mainWorkoutPatterns);
  for (const pattern of stretchPatterns.slice(0, 2)) {
    const patternStretches = availableCooldowns.filter(
      (m2) => (m2.pattern === pattern || pattern === "hinge" && m2.pattern === "rotation") && !exercises.some((e2) => e2.movement.id === m2.id)
    );
    if (patternStretches.length > 0) {
      const selected = patternStretches[Math.floor(rng2() * patternStretches.length)];
      exercises.push({
        movement: selected,
        sets: 1,
        duration: 60,
        // 1 minute hold
        purpose: "recovery"
      });
    }
  }
  const restorativeMoves = availableCooldowns.filter(
    (m2) => ["childs_pose", "legs_up_wall", "savasana"].includes(m2.id) && !exercises.some((e2) => e2.movement.id === m2.id)
  );
  if (restorativeMoves.length > 0) {
    const selected = restorativeMoves[Math.floor(rng2() * restorativeMoves.length)];
    exercises.push({
      movement: selected,
      sets: 1,
      duration: 120,
      // 2 minutes
      purpose: "restoration"
    });
  }
  const totalSeconds = exercises.reduce((total, ex) => total + (ex.duration || 60), 0);
  const actualMinutes = Math.ceil(totalSeconds / 60);
  return {
    exercises,
    totalMinutes: Math.max(baseMinutes, actualMinutes),
    description: generateCooldownDescription(workoutIntensity, exercises.length)
  };
}
function getRelevantStretchPatterns(mainPatterns) {
  const stretchMap = {
    "squat": ["hinge", "core"],
    "hinge": ["hinge", "rotation"],
    "push": ["core", "rotation"],
    "pull": ["core", "rotation"],
    "core": ["core", "rotation"],
    "mono": ["hinge", "core"],
    "carry": ["core", "hinge"],
    "rotation": ["rotation", "core"]
  };
  const relevantStretches = [];
  for (const pattern of mainPatterns) {
    const stretches = stretchMap[pattern] || ["core"];
    relevantStretches.push(...stretches);
  }
  return Array.from(new Set(relevantStretches)).slice(0, 3);
}
function generateWarmupDescription(patterns2, exerciseCount) {
  const patternText = patterns2.slice(0, 2).join(" and ");
  return `Dynamic warm-up targeting ${patternText} patterns with ${exerciseCount} preparatory exercises`;
}
function generateCooldownDescription(intensity, exerciseCount) {
  if (intensity >= 7) {
    return `Extended recovery sequence with breathing work and ${exerciseCount} restorative exercises`;
  }
  return `Recovery cool-down with ${exerciseCount} gentle stretches and relaxation`;
}
function getRecommendedWarmupDuration(workoutIntensity, workoutType) {
  const baseMinutes = {
    "strength": 8,
    "conditioning": 6,
    "endurance": 5,
    "mixed": 7
  }[workoutType];
  const intensityBonus = workoutIntensity >= 7 ? 2 : 0;
  return baseMinutes + intensityBonus;
}
function needsExtendedCooldown(workoutIntensity) {
  return workoutIntensity >= 7;
}
var WARMUP_MOVEMENTS, COOLDOWN_MOVEMENTS;
var init_warmupCooldown = __esm({
  "server/lib/generator/warmupCooldown.ts"() {
    "use strict";
    init_movementTaxonomy();
    WARMUP_MOVEMENTS = [
      // Dynamic warm-up movements
      {
        id: "cat_cow",
        name: "Cat-Cow Stretch",
        pattern: "hinge",
        equipment: ["bodyweight", "floor"],
        plane: "sagittal",
        energySystem: "alactic",
        loadability: "low",
        complexity: 1
      },
      {
        id: "hip_circle",
        name: "Hip Circles",
        pattern: "hinge",
        equipment: ["bodyweight"],
        plane: "multi",
        energySystem: "alactic",
        loadability: "low",
        complexity: 1
      },
      {
        id: "arm_circle",
        name: "Arm Circles",
        pattern: "push",
        equipment: ["bodyweight"],
        plane: "multi",
        energySystem: "alactic",
        loadability: "low",
        complexity: 1
      },
      {
        id: "leg_swing",
        name: "Leg Swings",
        pattern: "squat",
        equipment: ["bodyweight"],
        plane: "multi",
        energySystem: "alactic",
        loadability: "low",
        complexity: 1
      },
      {
        id: "bodyweight_squat",
        name: "Bodyweight Squat",
        pattern: "squat",
        equipment: ["bodyweight"],
        plane: "sagittal",
        energySystem: "alactic",
        loadability: "low",
        complexity: 1
      },
      {
        id: "glute_bridge",
        name: "Glute Bridge",
        pattern: "hinge",
        equipment: ["bodyweight", "floor"],
        plane: "sagittal",
        energySystem: "alactic",
        loadability: "low",
        complexity: 1
      },
      {
        id: "band_pull_apart",
        name: "Band Pull Aparts",
        pattern: "pull",
        equipment: ["bodyweight"],
        plane: "transverse",
        energySystem: "alactic",
        loadability: "low",
        complexity: 1
      },
      {
        id: "scap_pushup",
        name: "Scapular Push-ups",
        pattern: "push",
        equipment: ["bodyweight", "floor"],
        plane: "transverse",
        energySystem: "alactic",
        loadability: "low",
        complexity: 2
      },
      {
        id: "world_greatest_stretch",
        name: "World's Greatest Stretch",
        pattern: "mono",
        equipment: ["bodyweight", "floor"],
        plane: "multi",
        energySystem: "alactic",
        loadability: "low",
        complexity: 2
      },
      {
        id: "inchworm",
        name: "Inchworm",
        pattern: "push",
        equipment: ["bodyweight", "floor"],
        plane: "sagittal",
        energySystem: "alactic",
        loadability: "low",
        complexity: 2
      }
    ];
    COOLDOWN_MOVEMENTS = [
      {
        id: "childs_pose",
        name: "Child's Pose",
        pattern: "core",
        equipment: ["bodyweight", "floor"],
        plane: "sagittal",
        energySystem: "alactic",
        loadability: "low",
        complexity: 1
      },
      {
        id: "supine_spinal_twist",
        name: "Supine Spinal Twist",
        pattern: "rotation",
        equipment: ["bodyweight", "floor"],
        plane: "transverse",
        energySystem: "alactic",
        loadability: "low",
        complexity: 1
      },
      {
        id: "seated_forward_fold",
        name: "Seated Forward Fold",
        pattern: "hinge",
        equipment: ["bodyweight", "floor"],
        plane: "sagittal",
        energySystem: "alactic",
        loadability: "low",
        complexity: 1
      },
      {
        id: "pigeon_pose",
        name: "Pigeon Pose",
        pattern: "hinge",
        equipment: ["bodyweight", "floor"],
        plane: "sagittal",
        energySystem: "alactic",
        loadability: "low",
        complexity: 2
      },
      {
        id: "legs_up_wall",
        name: "Legs Up Wall",
        pattern: "core",
        equipment: ["bodyweight", "floor"],
        plane: "sagittal",
        energySystem: "alactic",
        loadability: "low",
        complexity: 1
      },
      {
        id: "box_breathing",
        name: "Box Breathing",
        pattern: "core",
        equipment: ["bodyweight"],
        plane: "sagittal",
        energySystem: "alactic",
        loadability: "low",
        complexity: 1
      },
      {
        id: "savasana",
        name: "Savasana (Rest Pose)",
        pattern: "core",
        equipment: ["bodyweight", "floor"],
        plane: "sagittal",
        energySystem: "alactic",
        loadability: "low",
        complexity: 1
      }
    ];
  }
});

// server/lib/generator/generateWorkout.ts
async function generateWorkout2(seed, workoutHistory = []) {
  const rng2 = createSeededRandom(seed.rngSeed);
  const choices = {
    templateId: "",
    movementPoolIds: [],
    schemeId: "default"
  };
  const originalIntensity = seed.inputs.targetIntensity;
  const cappedIntensity = applyHealthCaps(originalIntensity, seed.context.healthModifiers || {});
  const intensityCapped = cappedIntensity !== originalIntensity;
  const progressionDirectives = await generateProgressionDirectives(seed.context.userId, workoutHistory, seed.inputs.archetype);
  choices.schemeId = progressionDirectives.progressionType;
  const adjustedIntensity = Math.max(1, Math.min(
    10,
    cappedIntensity + progressionDirectives.intensityAdjustment
  ));
  const template = selectTemplate(
    seed.inputs.archetype,
    seed.inputs.minutes,
    adjustedIntensity,
    rng2
  );
  if (!template) {
    throw new Error(`No suitable template found for ${seed.inputs.archetype} workout of ${seed.inputs.minutes} minutes`);
  }
  choices.templateId = template.id;
  const intensityParams = getIntensityParameters(adjustedIntensity, seed.context.healthModifiers);
  const availableMovements = filterMovementPool(
    MOVEMENT_LIBRARY,
    seed.inputs.equipment,
    seed.inputs.constraints || [],
    intensityParams.complexityLimit
  );
  const blocks = [];
  const warmupMinutes = getRecommendedWarmupDuration(adjustedIntensity, seed.inputs.archetype);
  const mainPatterns = extractMainPatterns(template);
  const warmupPlan = generateWarmup(
    mainPatterns,
    seed.inputs.equipment,
    warmupMinutes,
    seed.rngSeed
  );
  choices.movementPoolIds.push(...warmupPlan.exercises.map((e2) => e2.movement.id));
  blocks.push({
    id: "warmup",
    name: "Warm-up",
    type: "warmup",
    structure: "sequence",
    exercises: warmupPlan.exercises.map((ex) => ({
      id: ex.movement.id,
      name: ex.movement.name,
      movement: ex.movement,
      sets: ex.sets,
      reps: ex.reps,
      duration: ex.duration,
      notes: `${ex.purpose} - ${ex.intensity} intensity`
    })),
    notes: warmupPlan.description
  });
  for (const templateBlock of template.blocks.filter((b) => b.type !== "warmup" && b.type !== "cooldown")) {
    const workoutBlock = await generateWorkoutBlock(
      templateBlock,
      availableMovements,
      intensityParams,
      progressionDirectives,
      rng2
    );
    choices.movementPoolIds.push(...workoutBlock.exercises.map((e2) => e2.movement.id));
    blocks.push(workoutBlock);
  }
  if (needsExtendedCooldown(adjustedIntensity)) {
    const cooldownPlan = generateCooldown(
      adjustedIntensity,
      mainPatterns,
      seed.inputs.equipment,
      seed.rngSeed
    );
    choices.movementPoolIds.push(...cooldownPlan.exercises.map((e2) => e2.movement.id));
    blocks.push({
      id: "cooldown",
      name: "Cool-down",
      type: "cooldown",
      structure: "sequence",
      exercises: cooldownPlan.exercises.map((ex) => ({
        id: ex.movement.id,
        name: ex.movement.name,
        movement: ex.movement,
        sets: ex.sets,
        reps: ex.reps || "hold",
        duration: ex.duration,
        notes: `${ex.purpose} - gentle recovery`
      })),
      notes: cooldownPlan.description
    });
  }
  const actualTotalMinutes = blocks.reduce((total, block) => {
    if (block.type === "warmup" || block.type === "cooldown") {
      const planMinutes = block.type === "warmup" ? warmupMinutes : needsExtendedCooldown(adjustedIntensity) ? 8 : 5;
      return total + planMinutes;
    }
    if (block.sets && block.rest_seconds) {
      const workTime = block.sets * 1.5;
      const restTime = (block.sets - 1) * (block.rest_seconds / 60);
      return total + workTime + restTime;
    }
    return total + 15;
  }, 0);
  const workout = {
    id: `workout-${seed.rngSeed}`,
    name: generateWorkoutName(template, seed.inputs.archetype, adjustedIntensity),
    description: generateWorkoutDescription(template, progressionDirectives, intensityCapped),
    totalMinutes: Math.round(actualTotalMinutes),
    estimatedIntensity: adjustedIntensity,
    blocks,
    coaching_notes: generateCoachingNotes(progressionDirectives, intensityCapped, seed.context),
    metadata: {
      template: template.id,
      patterns: mainPatterns,
      equipment: seed.inputs.equipment,
      progression: progressionDirectives.reasoning
    }
  };
  validateWorkoutStructure(workout);
  const result = {
    workout,
    choices,
    metadata: {
      templateUsed: template.id,
      progressionApplied: progressionDirectives.progressionType,
      intensityCapped,
      totalMovements: choices.movementPoolIds.length
    }
  };
  return result;
}
function filterMovementPool(movements, equipment, constraints, maxComplexity) {
  let filtered = filterByEquipment(movements, equipment);
  filtered = avoidConstraints(filtered, constraints);
  filtered = filtered.filter((m2) => m2.complexity <= maxComplexity);
  return filtered;
}
function extractMainPatterns(template) {
  const patterns2 = [];
  for (const block of template.blocks) {
    for (const slot of block.movements) {
      patterns2.push(...slot.patterns);
    }
  }
  return Array.from(new Set(patterns2));
}
async function generateWorkoutBlock(templateBlock, availableMovements, intensityParams, progressionDirectives, rng2) {
  const exercises = [];
  for (const slot of templateBlock.movements) {
    let slotMovements = availableMovements.filter(
      (m2) => slot.patterns.includes(m2.pattern)
    );
    if (slot.compound !== void 0) {
      slotMovements = slotMovements.filter((m2) => m2.compound === slot.compound);
    }
    if (slot.unilateral !== void 0) {
      slotMovements = slotMovements.filter((m2) => m2.unilateral === slot.unilateral);
    }
    if (slot.energySystem) {
      slotMovements = slotMovements.filter((m2) => m2.energySystem === slot.energySystem);
    }
    const selectedMovements = sampleBalanced(slotMovements, slot.count, rng2, {
      preferredPatterns: slot.patterns,
      ensureCompound: slot.compound
    });
    if (selectedMovements.length === 0) {
      console.warn(`No movements found for slot with patterns: ${slot.patterns.join(", ")}`);
      const fallbackMovements = availableMovements.filter(
        (m2) => slot.patterns.includes(m2.pattern)
      );
      if (fallbackMovements.length > 0) {
        const fallbackSelected = sampleBalanced(fallbackMovements, Math.min(slot.count, fallbackMovements.length), rng2);
        for (const movement of fallbackSelected) {
          const exercise = createExerciseFromMovement(
            movement,
            templateBlock,
            intensityParams,
            progressionDirectives,
            slot.role
          );
          exercises.push(exercise);
        }
      }
    } else {
      for (const movement of selectedMovements) {
        const exercise = createExerciseFromMovement(
          movement,
          templateBlock,
          intensityParams,
          progressionDirectives,
          slot.role
        );
        exercises.push(exercise);
      }
    }
  }
  return {
    id: templateBlock.id,
    name: templateBlock.id.charAt(0).toUpperCase() + templateBlock.id.slice(1),
    type: templateBlock.type,
    structure: templateBlock.structure,
    exercises,
    sets: templateBlock.sets,
    rest_seconds: templateBlock.rest,
    notes: templateBlock.notes
  };
}
function createExerciseFromMovement(movement, templateBlock, intensityParams, progressionDirectives, role) {
  let sets = templateBlock.sets || 3;
  let reps = templateBlock.reps || "8-12";
  let load = templateBlock.load || "moderate";
  if (progressionDirectives.volumeAdjustment !== 1) {
    sets = Math.max(1, Math.round(sets * progressionDirectives.volumeAdjustment));
  }
  if (progressionDirectives.loadAdjustment !== 1 && templateBlock.load) {
    if (templateBlock.load.includes("%")) {
      const percentages = templateBlock.load.match(/\d+/g);
      if (percentages && percentages.length >= 2) {
        const min = Math.round(parseInt(percentages[0]) * progressionDirectives.loadAdjustment);
        const max = Math.round(parseInt(percentages[1]) * progressionDirectives.loadAdjustment);
        load = `${min}-${max}%`;
      }
    }
  }
  return {
    id: movement.id,
    name: movement.name,
    movement,
    sets,
    reps,
    load,
    duration: templateBlock.time ? templateBlock.time * 60 : void 0,
    notes: generateExerciseNotes(movement, role, progressionDirectives)
  };
}
function generateWorkoutName(template, archetype, intensity) {
  const intensityLabels = {
    1: "Recovery",
    2: "Easy",
    3: "Light",
    4: "Moderate",
    5: "Steady",
    6: "Challenging",
    7: "Hard",
    8: "Intense",
    9: "Very Hard",
    10: "Maximum"
  };
  const intensityLabel = intensityLabels[intensity] || "Moderate";
  return `${intensityLabel} ${archetype.charAt(0).toUpperCase() + archetype.slice(1)} Workout`;
}
function generateWorkoutDescription(template, progressionDirectives, intensityCapped) {
  let description = template.description || `${template.archetype} workout using ${template.name} template`;
  if (intensityCapped) {
    description += " (intensity adjusted based on recovery metrics)";
  }
  if (progressionDirectives.progressionType !== "skill") {
    description += ` with ${progressionDirectives.progressionType} progression`;
  }
  return description;
}
function generateCoachingNotes(progressionDirectives, intensityCapped, context) {
  const notes = [];
  if (intensityCapped) {
    notes.push("Workout intensity has been adjusted based on your current recovery metrics.");
  }
  if (progressionDirectives.deloadRecommended) {
    notes.push("This is a deload session - focus on movement quality and recovery.");
  } else if (progressionDirectives.progressionType === "load") {
    notes.push("Progressive overload: aim to increase load from your last session.");
  } else if (progressionDirectives.progressionType === "volume") {
    notes.push("Volume progression: additional sets/reps from previous workout.");
  }
  notes.push(progressionDirectives.reasoning);
  if (context.healthModifiers) {
    const health = context.healthModifiers;
    if (health.axleScore && health.axleScore < 40) {
      notes.push("Low AXLE score detected - prioritize recovery and lighter loads today.");
    }
    if (health.vitality && health.vitality < 35) {
      notes.push("Consider reducing intensity if energy levels remain low.");
    }
  }
  if (notes.length === 0) {
    notes.push("Focus on proper form and controlled movement throughout the workout.");
  }
  return notes.join(" ");
}
function generateExerciseNotes(movement, role, progressionDirectives) {
  const notes = [];
  if (movement.complexity >= 4) {
    notes.push("Focus on technique - complex movement");
  }
  if (role === "primary" && progressionDirectives.progressionType === "load") {
    notes.push("Aim for slight load increase from last session");
  }
  if (movement.unilateral) {
    notes.push("Perform each side");
  }
  return notes.join(". ");
}
function validateWorkoutStructure(workout) {
  if (!workout.id) throw new Error("Workout missing required field: id");
  if (!workout.name) throw new Error("Workout missing required field: name");
  if (!workout.description) throw new Error("Workout missing required field: description");
  if (!workout.totalMinutes || workout.totalMinutes <= 0) throw new Error("Workout missing valid totalMinutes");
  if (!workout.estimatedIntensity || workout.estimatedIntensity <= 0) throw new Error("Workout missing valid estimatedIntensity");
  if (!workout.blocks || workout.blocks.length === 0) throw new Error("Workout missing blocks");
  if (!workout.coaching_notes) throw new Error("Workout missing coaching_notes");
  if (!workout.metadata) throw new Error("Workout missing metadata");
  workout.blocks.forEach((block, index2) => {
    if (!block.id) throw new Error(`Block ${index2} missing required field: id`);
    if (!block.name) throw new Error(`Block ${index2} missing required field: name`);
    if (!block.type) throw new Error(`Block ${index2} missing required field: type`);
    if (!block.exercises || block.exercises.length === 0) throw new Error(`Block ${index2} missing exercises`);
    block.exercises.forEach((exercise, exerciseIndex) => {
      if (!exercise.id) throw new Error(`Block ${index2} exercise ${exerciseIndex} missing required field: id`);
      if (!exercise.name) throw new Error(`Block ${index2} exercise ${exerciseIndex} missing required field: name`);
      if (!exercise.movement) throw new Error(`Block ${index2} exercise ${exerciseIndex} missing required field: movement`);
      if (!exercise.sets || exercise.sets <= 0) throw new Error(`Block ${index2} exercise ${exerciseIndex} missing valid sets`);
      if (!exercise.reps) throw new Error(`Block ${index2} exercise ${exerciseIndex} missing required field: reps`);
    });
  });
}
var init_generateWorkout = __esm({
  "server/lib/generator/generateWorkout.ts"() {
    "use strict";
    init_movementTaxonomy();
    init_templates();
    init_intensity();
    init_progression();
    init_warmupCooldown();
  }
});

// server/lib/generator/v03/generateWorkout.ts
var init_generateWorkout2 = __esm({
  "server/lib/generator/v03/generateWorkout.ts"() {
    "use strict";
    init_generateWorkout();
  }
});

// server/lib/generator/v03/index.ts
var init_v03 = __esm({
  "server/lib/generator/v03/index.ts"() {
    "use strict";
    init_generateWorkout2();
  }
});

// server/lib/generator/v02/generateWorkout.ts
async function generateWorkout3(seed, opts) {
  const legacyRequest = {
    category: seed.inputs?.archetype || "Strength",
    duration: seed.inputs?.minutes || 30,
    intensity: seed.inputs?.targetIntensity || 6,
    equipment: seed.inputs?.equipment || [],
    constraints: seed.inputs?.constraints || [],
    // Add any context if available
    recentPRs: opts?.recentPRs || [],
    lastWorkouts: opts?.lastWorkouts || [],
    todaysReport: opts?.todaysReport
  };
  const workout = await generateWorkout(legacyRequest);
  return {
    workout: {
      id: `workout-${seed.rngSeed || Date.now()}`,
      name: workout.name,
      description: workout.description || `${workout.category} workout`,
      totalMinutes: workout.duration,
      estimatedIntensity: workout.intensity,
      blocks: workout.sets?.map((set, index2) => ({
        id: `block-${index2}`,
        name: set.exercise || `Exercise ${index2 + 1}`,
        type: index2 === 0 ? "warmup" : index2 === workout.sets.length - 1 ? "cooldown" : "main",
        structure: "sequence",
        exercises: [{
          id: set.id || `ex-${index2}`,
          name: set.exercise,
          movement: { id: `mov-${index2}`, name: set.exercise },
          sets: set.sets || 1,
          reps: set.reps || "8-12",
          load: set.weight ? `${set.weight}` : void 0,
          duration: set.duration,
          notes: set.notes || ""
        }],
        notes: set.notes || ""
      })) || [],
      coaching_notes: workout.description || "Focus on proper form and controlled movement.",
      metadata: {
        template: "legacy",
        patterns: [],
        equipment: legacyRequest.equipment,
        progression: "legacy"
      }
    },
    choices: {
      templateId: "legacy",
      movementPoolIds: [],
      schemeId: "default"
    }
  };
}
var init_generateWorkout3 = __esm({
  "server/lib/generator/v02/generateWorkout.ts"() {
    "use strict";
    init_workoutGenerator();
  }
});

// server/lib/generator/v02/index.ts
var init_v02 = __esm({
  "server/lib/generator/v02/index.ts"() {
    "use strict";
    init_generateWorkout3();
  }
});

// server/lib/generator/generate.ts
var generate_exports = {};
__export(generate_exports, {
  generateWithFallback: () => generateWithFallback
});
import * as Sentry2 from "@sentry/node";
async function generateWithFallback(seed, opts) {
  let usedVersion = GENERATOR_VERSION_DEFAULT;
  try {
    if (GENERATOR_VERSION_DEFAULT === "v0.2.5") {
      return await generateWorkout3(seed, opts);
    }
    return await generateWorkout2(seed, opts);
  } catch (err) {
    if (GENERATOR_ALLOW_FALLBACK) {
      console.log(`Generator ${GENERATOR_VERSION_DEFAULT} failed, falling back to ${GENERATOR_FALLBACK}`);
      Sentry2.captureException(err, {
        tags: {
          generator: GENERATOR_VERSION_DEFAULT,
          fallback: GENERATOR_FALLBACK
        },
        level: "warning"
      });
      const legacySeed = normalizeSeedForV02(seed, GENERATOR_FALLBACK);
      usedVersion = GENERATOR_FALLBACK;
      if (GENERATOR_FALLBACK === "v0.2.5") {
        return await generateWorkout3(legacySeed, opts);
      } else {
        return await generateWorkout2(legacySeed, opts);
      }
    }
    throw err;
  }
}
function normalizeSeedForV02(seed, version2) {
  if (seed && typeof seed === "object" && "inputs" in seed) {
    return { ...seed, generatorVersion: version2 };
  }
  return {
    inputs: seed,
    generatorVersion: version2
  };
}
var GENERATOR_VERSION_DEFAULT, GENERATOR_FALLBACK, GENERATOR_ALLOW_FALLBACK;
var init_generate = __esm({
  "server/lib/generator/generate.ts"() {
    "use strict";
    init_v03();
    init_v02();
    GENERATOR_VERSION_DEFAULT = process.env.GENERATOR_VERSION_DEFAULT || "v0.3.0";
    GENERATOR_FALLBACK = process.env.GENERATOR_FALLBACK || "v0.2.5";
    GENERATOR_ALLOW_FALLBACK = process.env.GENERATOR_ALLOW_FALLBACK !== "false";
  }
});

// server/dal/reports.ts
var reports_exports = {};
__export(reports_exports, {
  createReport: () => createReport,
  deleteReport: () => deleteReport,
  get7DaySleepSummary: () => get7DaySleepSummary,
  getRHRTrend: () => getRHRTrend,
  getReportById: () => getReportById,
  getReportPreferences: () => getReportPreferences,
  getReportsByUserId: () => getReportsByUserId,
  insertReport: () => insertReport,
  listReports: () => listReports,
  markReportAsDelivered: () => markReportAsDelivered,
  markReportAsViewed: () => markReportAsViewed,
  reportExists: () => reportExists,
  updateReportPreferences: () => updateReportPreferences,
  updateReportStatus: () => updateReportStatus,
  upsertDailyReport: () => upsertDailyReport
});
import { eq as eq2, and as and2, desc as desc2, gte as gte2, lte, isNull } from "drizzle-orm";
async function insertReport(params) {
  const { data, error } = await supabaseAdmin.from("health_reports").insert({
    user_id: params.userId,
    date: params.date,
    summary: params.summary,
    metrics: params.metrics,
    suggestions: params.suggestions,
    fatigue_score: params.fatigueScore
  }).select().single();
  if (error) {
    throw new Error(`Failed to insert report: ${error.message}`);
  }
  return data;
}
async function listReports(userId, options = {}) {
  const { days = 30 } = options;
  const cutoffDate = /* @__PURE__ */ new Date();
  cutoffDate.setDate(cutoffDate.getDate() - days);
  const { data, error } = await supabaseAdmin.from("health_reports").select("*").eq("user_id", userId).gte("date", cutoffDate.toISOString().split("T")[0]).order("date", { ascending: false });
  if (error) {
    throw new Error(`Failed to list reports: ${error.message}`);
  }
  return data || [];
}
async function upsertDailyReport(userId, date2, metrics) {
  const { data, error } = await supabaseAdmin.from("health_reports").upsert({
    user_id: userId,
    date: date2,
    metrics,
    suggestions: [],
    summary: null
  }).select().single();
  if (error) {
    throw new Error(`Failed to upsert daily report: ${error.message}`);
  }
  return data;
}
async function get7DaySleepSummary(userId) {
  const cutoffDate = /* @__PURE__ */ new Date();
  cutoffDate.setDate(cutoffDate.getDate() - 7);
  const { data, error } = await supabaseAdmin.from("health_reports").select("metrics").eq("user_id", userId).gte("date", cutoffDate.toISOString().split("T")[0]).order("date", { ascending: false });
  if (error) {
    console.warn("Failed to get 7-day sleep summary:", error);
    return 0;
  }
  if (!data || data.length === 0) {
    return 0;
  }
  const sleepScores = data.map((report) => report.metrics?.provider?.sleep_score || report.metrics?.sleepScore).filter((score) => typeof score === "number");
  if (sleepScores.length === 0) {
    return 0;
  }
  return sleepScores.reduce((sum, score) => sum + score, 0) / sleepScores.length;
}
async function getRHRTrend(userId, days) {
  const cutoffDate = /* @__PURE__ */ new Date();
  cutoffDate.setDate(cutoffDate.getDate() - days);
  const { data, error } = await supabaseAdmin.from("health_reports").select("metrics, date").eq("user_id", userId).gte("date", cutoffDate.toISOString().split("T")[0]).order("date", { ascending: true });
  if (error) {
    console.warn("Failed to get RHR trend:", error);
    return 0;
  }
  if (!data || data.length < 2) {
    return 0;
  }
  const rhrValues = data.map((report) => report.metrics?.provider?.resting_hr || report.metrics?.restingHR).filter((rhr) => typeof rhr === "number");
  if (rhrValues.length < 2) {
    return 0;
  }
  const midpoint = Math.floor(rhrValues.length / 2);
  const firstHalf = rhrValues.slice(0, midpoint);
  const secondHalf = rhrValues.slice(midpoint);
  const firstAvg = firstHalf.reduce((sum, val) => sum + val, 0) / firstHalf.length;
  const secondAvg = secondHalf.reduce((sum, val) => sum + val, 0) / secondHalf.length;
  return secondAvg - firstAvg;
}
async function getReportsByUserId(userId, options) {
  let query = db.select().from(axleReports).where(eq2(axleReports.userId, userId)).$dynamic();
  const conditions = [eq2(axleReports.userId, userId)];
  if (options?.frequency) {
    conditions.push(eq2(axleReports.frequency, options.frequency));
  }
  if (options?.startDate) {
    conditions.push(gte2(axleReports.timeframeStart, options.startDate));
  }
  if (options?.endDate) {
    conditions.push(lte(axleReports.timeframeEnd, options.endDate));
  }
  query = db.select().from(axleReports).where(and2(...conditions)).orderBy(desc2(axleReports.timeframeStart)).$dynamic();
  if (options?.limit) {
    query = query.limit(options.limit);
  }
  return await query;
}
async function getReportById(reportId, userId) {
  const [report] = await db.select().from(axleReports).where(
    and2(
      eq2(axleReports.id, reportId),
      eq2(axleReports.userId, userId)
    )
  ).limit(1);
  return report || null;
}
async function createReport(data) {
  const [report] = await db.insert(axleReports).values({
    userId: data.userId,
    frequency: data.frequency,
    timeframeStart: data.timeframeStart,
    timeframeEnd: data.timeframeEnd,
    metrics: data.metrics,
    insights: data.insights,
    status: "ready",
    deliveryChannel: []
  }).returning();
  return report;
}
async function updateReportStatus(reportId, status) {
  await db.update(axleReports).set({ status }).where(eq2(axleReports.id, reportId));
}
async function markReportAsViewed(reportId) {
  await db.update(axleReports).set({ viewedAt: /* @__PURE__ */ new Date() }).where(
    and2(
      eq2(axleReports.id, reportId),
      isNull(axleReports.viewedAt)
      // Only update if not already viewed
    )
  );
}
async function markReportAsDelivered(reportId, channel) {
  const [report] = await db.select().from(axleReports).where(eq2(axleReports.id, reportId)).limit(1);
  if (!report) return;
  const channels = [...report.deliveryChannel || []];
  if (!channels.includes(channel)) {
    channels.push(channel);
  }
  await db.update(axleReports).set({
    deliveredAt: /* @__PURE__ */ new Date(),
    deliveryChannel: channels,
    status: "delivered"
  }).where(eq2(axleReports.id, reportId));
}
async function getReportPreferences(userId) {
  const [profile] = await db.select({
    reportFrequency: profiles.reportFrequency,
    reportWeeklyDay: profiles.reportWeeklyDay,
    reportMonthlyDay: profiles.reportMonthlyDay,
    reportDeliveryTime: profiles.reportDeliveryTime,
    enableNotifications: profiles.enableNotifications,
    enableEmail: profiles.enableEmail
  }).from(profiles).where(eq2(profiles.userId, userId)).limit(1);
  return profile || null;
}
async function updateReportPreferences(userId, preferences) {
  await db.update(profiles).set(preferences).where(eq2(profiles.userId, userId));
}
async function reportExists(userId, frequency, timeframeStart) {
  const [existing] = await db.select({ id: axleReports.id }).from(axleReports).where(
    and2(
      eq2(axleReports.userId, userId),
      eq2(axleReports.frequency, frequency),
      eq2(axleReports.timeframeStart, timeframeStart)
    )
  ).limit(1);
  return !!existing;
}
async function deleteReport(reportId, userId) {
  const result = await db.delete(axleReports).where(
    and2(
      eq2(axleReports.id, reportId),
      eq2(axleReports.userId, userId)
    )
  ).returning({ id: axleReports.id });
  return result.length > 0;
}
var init_reports = __esm({
  "server/dal/reports.ts"() {
    "use strict";
    init_db();
    init_schema();
    init_supabaseAdmin();
  }
});

// server/storage.ts
import { randomUUID as randomUUID2 } from "crypto";
var MemStorage, storage;
var init_storage = __esm({
  "server/storage.ts"() {
    "use strict";
    MemStorage = class {
      users;
      workouts;
      personalRecords;
      achievements;
      workoutEvents;
      constructor() {
        this.users = /* @__PURE__ */ new Map();
        this.workouts = /* @__PURE__ */ new Map();
        this.personalRecords = /* @__PURE__ */ new Map();
        this.achievements = /* @__PURE__ */ new Map();
        this.workoutEvents = /* @__PURE__ */ new Map();
      }
      // User methods
      async getUser(id) {
        return this.users.get(id);
      }
      async getUserByUsername(username) {
        return Array.from(this.users.values()).find(
          (user) => user.username === username
        );
      }
      async createUser(insertUser) {
        const userId = randomUUID2();
        const user = {
          userId,
          username: insertUser.username ?? null,
          firstName: insertUser.firstName ?? null,
          lastName: insertUser.lastName ?? null,
          avatarUrl: insertUser.avatarUrl ?? null,
          dateOfBirth: insertUser.dateOfBirth ?? null,
          preferredUnit: insertUser.preferredUnit ?? "lbs",
          favoriteMovements: Array.isArray(insertUser.favoriteMovements) ? insertUser.favoriteMovements : [],
          providers: Array.isArray(insertUser.providers) ? insertUser.providers : [],
          latitude: insertUser.latitude ?? null,
          longitude: insertUser.longitude ?? null,
          timezone: insertUser.timezone ?? null,
          reportFrequency: insertUser.reportFrequency ?? "weekly",
          reportWeeklyDay: insertUser.reportWeeklyDay ?? null,
          reportMonthlyDay: insertUser.reportMonthlyDay ?? null,
          reportDeliveryTime: insertUser.reportDeliveryTime ?? "09:00:00",
          enableNotifications: insertUser.enableNotifications ?? true,
          enableEmail: insertUser.enableEmail ?? false,
          createdAt: /* @__PURE__ */ new Date()
        };
        this.users.set(userId, user);
        return user;
      }
      // Workout methods
      async getWorkouts(userId) {
        return Array.from(this.workouts.values()).filter((workout) => workout.userId === userId).sort((a2, b) => {
          const timeA = a2.createdAt ? new Date(a2.createdAt).getTime() : 0;
          const timeB = b.createdAt ? new Date(b.createdAt).getTime() : 0;
          return timeB - timeA;
        });
      }
      async getWorkout(id) {
        return this.workouts.get(id);
      }
      async createWorkout(insertWorkout2) {
        const id = randomUUID2();
        const workout = {
          ...insertWorkout2,
          id,
          notes: insertWorkout2.notes ?? null,
          completed: insertWorkout2.completed ?? null,
          feedback: insertWorkout2.feedback ?? null,
          seed: insertWorkout2.seed ?? null,
          genSeed: insertWorkout2.genSeed ?? {},
          generatorVersion: insertWorkout2.generatorVersion ?? "v0.3.0",
          generationId: insertWorkout2.generationId ?? null,
          rationale: insertWorkout2.rationale ?? null,
          criticScore: insertWorkout2.criticScore ?? null,
          criticIssues: insertWorkout2.criticIssues ? Array.isArray(insertWorkout2.criticIssues) ? insertWorkout2.criticIssues : [insertWorkout2.criticIssues] : null,
          rawWorkoutJson: insertWorkout2.rawWorkoutJson ?? null,
          userScore: insertWorkout2.userScore ?? null,
          startedAt: null,
          createdAt: /* @__PURE__ */ new Date()
        };
        this.workouts.set(id, workout);
        return workout;
      }
      async updateWorkout(id, updateData) {
        const existing = this.workouts.get(id);
        if (!existing) return void 0;
        const updated = {
          ...existing,
          ...updateData,
          criticIssues: updateData.criticIssues ? Array.isArray(updateData.criticIssues) ? updateData.criticIssues : [updateData.criticIssues] : existing.criticIssues
        };
        this.workouts.set(id, updated);
        return updated;
      }
      async deleteWorkout(id) {
        return this.workouts.delete(id);
      }
      // Personal Record methods
      async getPersonalRecords(userId) {
        return Array.from(this.personalRecords.values()).filter((pr) => pr.userId === userId).sort((a2, b) => new Date(b.date).getTime() - new Date(a2.date).getTime());
      }
      async getPersonalRecord(id) {
        return this.personalRecords.get(id);
      }
      async createPersonalRecord(insertPR) {
        const id = randomUUID2();
        const pr = {
          id,
          userId: insertPR.userId,
          category: insertPR.category,
          movement: insertPR.movement,
          value: String(insertPR.value),
          unit: insertPR.unit,
          repMax: insertPR.repMax ?? null,
          weightKg: insertPR.weightKg ? String(insertPR.weightKg) : null,
          notes: insertPR.notes ?? null,
          workoutId: insertPR.workoutId ?? null,
          date: insertPR.date ?? (/* @__PURE__ */ new Date()).toISOString().split("T")[0],
          createdAt: /* @__PURE__ */ new Date()
        };
        this.personalRecords.set(id, pr);
        return pr;
      }
      async updatePersonalRecord(id, updateData) {
        const existing = this.personalRecords.get(id);
        if (!existing) return void 0;
        const updated = {
          ...existing,
          ...updateData,
          value: updateData.value ? String(updateData.value) : existing.value,
          weightKg: updateData.weightKg ? String(updateData.weightKg) : existing.weightKg
        };
        this.personalRecords.set(id, updated);
        return updated;
      }
      async deletePersonalRecord(id) {
        return this.personalRecords.delete(id);
      }
      // Achievement methods
      async getAchievements(userId) {
        return Array.from(this.achievements.values()).filter((achievement) => achievement.userId === userId).sort((a2, b) => {
          const timeA = a2.updatedAt ? new Date(a2.updatedAt).getTime() : 0;
          const timeB = b.updatedAt ? new Date(b.updatedAt).getTime() : 0;
          return timeB - timeA;
        });
      }
      async createAchievement(insertAchievement) {
        const id = randomUUID2();
        const achievement = {
          id,
          userId: insertAchievement.userId,
          name: insertAchievement.name,
          description: insertAchievement.description,
          progress: insertAchievement.progress ? String(insertAchievement.progress) : "0",
          unlocked: insertAchievement.unlocked ?? false,
          updatedAt: /* @__PURE__ */ new Date()
        };
        this.achievements.set(id, achievement);
        return achievement;
      }
      // Workout Event methods (for telemetry)
      async getWorkoutEvents(userId) {
        const events = Array.from(this.workoutEvents.values());
        if (userId) {
          return events.filter((event) => event.userId === userId);
        }
        return events;
      }
      async createWorkoutEvent(insertEvent) {
        const id = randomUUID2();
        const event = {
          id,
          userId: insertEvent.userId,
          event: insertEvent.event,
          workoutId: insertEvent.workoutId ?? null,
          generationId: insertEvent.generationId ?? null,
          requestHash: insertEvent.requestHash ?? null,
          payload: insertEvent.payload,
          responseTimeMs: insertEvent.responseTimeMs ?? null,
          createdAt: /* @__PURE__ */ new Date()
        };
        this.workoutEvents.set(id, event);
        return event;
      }
      async getWorkoutEventStats(userId) {
        const events = await this.getWorkoutEvents(userId);
        const generationEvents = events.filter((e2) => e2.event === "generate");
        const feedbackEvents = events.filter((e2) => e2.event === "feedback");
        const yesterday = new Date(Date.now() - 24 * 60 * 60 * 1e3);
        const recentGenerations = generationEvents.filter((e2) => e2.createdAt && e2.createdAt > yesterday).length;
        const recentFeedback = feedbackEvents.filter((e2) => e2.createdAt && e2.createdAt > yesterday).length;
        return {
          totalGenerationEvents: generationEvents.length,
          totalFeedbackEvents: feedbackEvents.length,
          recentGenerations,
          recentFeedback
        };
      }
    };
    storage = new MemStorage();
  }
});

// server/workouts/telemetry.ts
var telemetry_exports = {};
__export(telemetry_exports, {
  createRequestHash: () => createRequestHash,
  extractMetricsSnapshot: () => extractMetricsSnapshot,
  getTelemetryStats: () => getTelemetryStats,
  logFeedbackEvent: () => logFeedbackEvent,
  logGenerationEvent: () => logGenerationEvent
});
import crypto4 from "crypto";
import * as Sentry4 from "@sentry/node";
function createRequestHash(data) {
  const hash = crypto4.createHash("sha256");
  const normalizedData = JSON.stringify(data, Object.keys(data).sort());
  hash.update(normalizedData);
  return hash.digest("hex");
}
async function logGenerationEvent(userId, eventData, responseTimeMs, generationId) {
  try {
    const requestHash = createRequestHash(eventData.workoutRequest);
    Sentry4.addBreadcrumb({
      category: "workout.generate",
      message: "Workout generation event logged",
      level: "info",
      data: {
        userId,
        generationId,
        requestHash,
        targetIntensity: eventData.targetIntensity,
        selectedFocus: eventData.selectedFocus,
        blockCount: eventData.blockIds.length,
        estimatedTSS: eventData.estimatedTSS,
        responseTimeMs,
        hasMetrics: Object.keys(eventData.metricsSnapshot).length > 0
      }
    });
    const workoutEvent = {
      userId,
      event: "generate",
      generationId,
      requestHash,
      payload: eventData,
      responseTimeMs
    };
    await storage.createWorkoutEvent(workoutEvent);
    console.log(`\u{1F3AF} [TELEMETRY] Generation event logged for user ${userId}, generation ${generationId}, hash ${requestHash.substring(0, 8)}`);
  } catch (error) {
    console.error("\u274C [TELEMETRY] Failed to log generation event:", error);
    Sentry4.captureException(error, {
      tags: { eventType: "generation_telemetry_error" },
      extra: { userId, generationId }
    });
  }
}
async function logFeedbackEvent(userId, workoutId, generationId, eventData) {
  try {
    Sentry4.addBreadcrumb({
      category: "workout.feedback",
      message: "Workout feedback event logged",
      level: "info",
      data: {
        userId,
        workoutId,
        generationId,
        feedbackType: eventData.feedbackType,
        difficultyRating: eventData.difficultyRating,
        rpe: eventData.rpe,
        completionPercentage: eventData.completionPercentage,
        overallSatisfaction: eventData.overallSatisfaction
      }
    });
    const workoutEvent = {
      userId,
      event: "feedback",
      workoutId,
      generationId,
      payload: eventData
    };
    await storage.createWorkoutEvent(workoutEvent);
    console.log(`\u{1F4AD} [TELEMETRY] Feedback event logged for user ${userId}, workout ${workoutId}, generation ${generationId}`);
  } catch (error) {
    console.error("\u274C [TELEMETRY] Failed to log feedback event:", error);
    Sentry4.captureException(error, {
      tags: { eventType: "feedback_telemetry_error" },
      extra: { userId, workoutId, generationId }
    });
  }
}
async function getTelemetryStats(userId) {
  try {
    const stats = await storage.getWorkoutEventStats(userId);
    return stats;
  } catch (error) {
    console.error("\u274C [TELEMETRY] Failed to get telemetry stats:", error);
    return {
      totalGenerationEvents: 0,
      totalFeedbackEvents: 0,
      recentGenerations: 0,
      recentFeedback: 0
    };
  }
}
function extractMetricsSnapshot(healthData) {
  if (!healthData) return {};
  return {
    vitality: healthData.vitality || void 0,
    performance: healthData.performance || void 0,
    circadian: healthData.circadian || void 0,
    balance: healthData.balance || void 0,
    fatigue: healthData.fatigue || healthData.fatigueScore || void 0,
    stress: healthData.stress || void 0,
    hrv: healthData.hrv || void 0,
    sleepScore: healthData.sleepScore || void 0,
    restingHR: healthData.restingHR || healthData.restingHeartRate || void 0,
    performancePotential: healthData.performancePotential || void 0,
    energyBalance: healthData.energyBalance || void 0,
    uvMax: healthData.uvMax || void 0
  };
}
var init_telemetry = __esm({
  "server/workouts/telemetry.ts"() {
    "use strict";
    init_storage();
  }
});

// server/utils/seed-generator.ts
var seed_generator_exports = {};
__export(seed_generator_exports, {
  convertLegacyRequestToInputs: () => convertLegacyRequestToInputs,
  createSeededRandom: () => createSeededRandom2,
  generateWorkoutSeed: () => generateWorkoutSeed
});
import { randomUUID as randomUUID3 } from "crypto";
function generateWorkoutSeed(inputs, userId, templateId, movementPoolIds, schemeId) {
  const rngSeed = randomUUID3();
  const dateISO = (/* @__PURE__ */ new Date()).toISOString();
  const context = {
    dateISO,
    userId,
    // TODO: Add health modifiers from user's health data
    healthModifiers: {
      axleScore: void 0,
      vitality: void 0,
      performancePotential: void 0,
      circadian: void 0
    }
  };
  const choices = templateId && movementPoolIds && schemeId ? {
    templateId,
    movementPoolIds,
    schemeId
  } : void 0;
  const seed = {
    rngSeed,
    generatorVersion: "v0.3.0",
    inputs,
    context,
    choices
  };
  return seed;
}
function convertLegacyRequestToInputs(request) {
  const categoryToArchetype = (category) => {
    switch (category?.toLowerCase()) {
      case "strength":
      case "powerlifting":
        return "strength";
      case "crossfit/hiit":
      case "hiit":
      case "cardio":
        return "conditioning";
      case "endurance":
        return "endurance";
      default:
        return "mixed";
    }
  };
  return {
    archetype: categoryToArchetype(request.category || request.goals?.[0]),
    minutes: request.duration || request.durationMinutes || 30,
    targetIntensity: request.intensity || 6,
    equipment: request.equipment || ["barbell", "dumbbells", "kettlebell"],
    constraints: request.constraints || [],
    location: request.location || "gym"
  };
}
function createSeededRandom2(seed) {
  let hash = 0;
  for (let i2 = 0; i2 < seed.length; i2++) {
    const char = seed.charCodeAt(i2);
    hash = (hash << 5) - hash + char;
    hash = hash & hash;
  }
  let current = Math.abs(hash);
  return {
    random: () => {
      current = (current * 1664525 + 1013904223) % Math.pow(2, 32);
      return current / Math.pow(2, 32);
    },
    randomInt: (min, max) => {
      const rand = current = (current * 1664525 + 1013904223) % Math.pow(2, 32);
      return min + Math.floor(rand / Math.pow(2, 32) * (max - min + 1));
    },
    choice: (array) => {
      const rand = current = (current * 1664525 + 1013904223) % Math.pow(2, 32);
      const index2 = Math.floor(rand / Math.pow(2, 32) * array.length);
      return array[index2];
    }
  };
}
var init_seed_generator = __esm({
  "server/utils/seed-generator.ts"() {
    "use strict";
  }
});

// client/src/ai/schemas.ts
import { z as z8 } from "zod";
function getValidPercentRanges(category, intensity) {
  if (category === "Powerlifting" || category === "Olympic") {
    switch (intensity) {
      case 1:
      case 2:
        return { min: 40, max: 55 };
      // Recovery/technique
      case 3:
      case 4:
        return { min: 55, max: 70 };
      // Light training
      case 5:
      case 6:
        return { min: 65, max: 80 };
      // Moderate training
      case 7:
      case 8:
        return { min: 75, max: 90 };
      // Heavy training
      case 9:
      case 10:
        return { min: 85, max: 100 };
      // Max effort
      default:
        return { min: 50, max: 85 };
    }
  }
  return { min: 0, max: 100 };
}
var CategoryEnum, FormatEnum, CROSSFIT_MOVEMENTS, POWERLIFTING_MOVEMENTS, OLYMPIC_MOVEMENTS, BODYBUILDING_MOVEMENTS, GYMNASTICS_MOVEMENTS, AEROBIC_MOVEMENTS, MOVEMENT_WHITELIST, MovementSpecSchema, SetSpecSchema, WarmupStepSchema, CooldownStepSchema, WorkoutBlockSchema3, WorkoutSchema;
var init_schemas = __esm({
  "client/src/ai/schemas.ts"() {
    "use strict";
    CategoryEnum = z8.enum([
      "CrossFit/HIIT",
      "Powerlifting",
      "Olympic",
      "Bodybuilding_Upper",
      "Bodybuilding_Lower",
      "Bodybuilding_Full",
      "Gymnastics",
      "Aerobic"
    ]);
    FormatEnum = z8.enum([
      "emom",
      // Every Minute on the Minute
      "amrap",
      // As Many Rounds As Possible
      "for_time",
      // For Time
      "intervals",
      // Interval Training
      "steady",
      // Steady State
      "complex",
      // Complex Training
      "superset",
      // Superset
      "giantset"
      // Giant Set
    ]);
    CROSSFIT_MOVEMENTS = [
      "air_squat",
      "back_squat",
      "front_squat",
      "overhead_squat",
      "thruster",
      "deadlift",
      "sumo_deadlift",
      "romanian_deadlift",
      "press",
      "push_press",
      "push_jerk",
      "split_jerk",
      "pull_up",
      "chin_up",
      "chest_to_bar",
      "muscle_up",
      "push_up",
      "handstand_push_up",
      "burpee",
      "box_jump",
      "kettlebell_swing",
      "kettlebell_snatch",
      "kettlebell_clean",
      "rowing",
      "running",
      "assault_bike",
      "ski_erg",
      "wall_ball",
      "ball_slam",
      "rope_climb",
      "double_under"
    ];
    POWERLIFTING_MOVEMENTS = [
      "back_squat",
      "front_squat",
      "pause_squat",
      "box_squat",
      "conventional_deadlift",
      "sumo_deadlift",
      "deficit_deadlift",
      "rack_pull",
      "bench_press",
      "close_grip_bench",
      "incline_bench",
      "pause_bench",
      "overhead_press",
      "push_press",
      "pin_press",
      "barbell_row",
      "pendlay_row",
      "chest_supported_row",
      "good_morning",
      "stiff_leg_deadlift",
      "romanian_deadlift"
    ];
    OLYMPIC_MOVEMENTS = [
      "snatch",
      "clean_and_jerk",
      "clean",
      "jerk",
      "power_snatch",
      "power_clean",
      "hang_snatch",
      "hang_clean",
      "snatch_pull",
      "clean_pull",
      "snatch_deadlift",
      "clean_deadlift",
      "overhead_squat",
      "front_squat",
      "back_squat",
      "push_press",
      "push_jerk",
      "split_jerk",
      "squat_jerk"
    ];
    BODYBUILDING_MOVEMENTS = [
      // Upper
      "bench_press",
      "incline_bench",
      "decline_bench",
      "dumbbell_press",
      "shoulder_press",
      "lateral_raise",
      "rear_delt_fly",
      "upright_row",
      "pull_up",
      "lat_pulldown",
      "barbell_row",
      "dumbbell_row",
      "cable_row",
      "bicep_curl",
      "hammer_curl",
      "preacher_curl",
      "cable_curl",
      "tricep_extension",
      "close_grip_bench",
      "dips",
      "cable_pushdown",
      // Lower  
      "squat",
      "leg_press",
      "bulgarian_split_squat",
      "walking_lunge",
      "romanian_deadlift",
      "leg_curl",
      "stiff_leg_deadlift",
      "calf_raise",
      "seated_calf_raise",
      "leg_extension",
      // Full
      "deadlift",
      "thruster",
      "clean_and_press",
      "turkish_getup"
    ];
    GYMNASTICS_MOVEMENTS = [
      "handstand",
      "handstand_walk",
      "handstand_push_up",
      "muscle_up",
      "ring_muscle_up",
      "pull_up",
      "chin_up",
      "dips",
      "ring_dips",
      "push_up",
      "pike_push_up",
      "l_sit",
      "v_sit",
      "tuck_planche",
      "front_lever",
      "back_lever",
      "human_flag",
      "pistol_squat",
      "rope_climb",
      "pegboard_climb"
    ];
    AEROBIC_MOVEMENTS = [
      "running",
      "jogging",
      "walking",
      "sprints",
      "cycling",
      "stationary_bike",
      "assault_bike",
      "rowing",
      "swimming",
      "elliptical",
      "stair_climber",
      "ski_erg",
      "versa_climber"
    ];
    MOVEMENT_WHITELIST = {
      "CrossFit/HIIT": CROSSFIT_MOVEMENTS,
      "Powerlifting": POWERLIFTING_MOVEMENTS,
      "Olympic": OLYMPIC_MOVEMENTS,
      "Bodybuilding_Upper": BODYBUILDING_MOVEMENTS,
      "Bodybuilding_Lower": BODYBUILDING_MOVEMENTS,
      "Bodybuilding_Full": BODYBUILDING_MOVEMENTS,
      "Gymnastics": GYMNASTICS_MOVEMENTS,
      "Aerobic": AEROBIC_MOVEMENTS
    };
    MovementSpecSchema = z8.object({
      name: z8.string().min(1, "Movement name required"),
      category: CategoryEnum,
      reps: z8.number().int().min(1).max(500).optional(),
      sets: z8.number().int().min(1).max(20).optional(),
      weight_kg: z8.number().min(0).max(500).optional(),
      weight_percent_1rm: z8.number().min(0).max(120).optional(),
      duration_seconds: z8.number().int().min(1).max(7200).optional(),
      distance_meters: z8.number().min(0).max(5e4).optional(),
      rest_seconds: z8.number().int().min(0).max(600).optional(),
      notes: z8.string().optional()
    }).refine((data) => {
      const allowedMovements = MOVEMENT_WHITELIST[data.category];
      return allowedMovements.includes(data.name);
    }, {
      message: "Movement not allowed for this category"
    });
    SetSpecSchema = z8.object({
      rounds: z8.number().int().min(1).max(50),
      movements: z8.array(MovementSpecSchema).min(1).max(10),
      rest_between_rounds_seconds: z8.number().int().min(0).max(600).optional(),
      time_cap_seconds: z8.number().int().min(30).max(7200).optional()
    });
    WarmupStepSchema = z8.object({
      movement: z8.string().min(1),
      duration_seconds: z8.number().int().min(30).max(900),
      intensity_percent: z8.number().min(10).max(70),
      notes: z8.string().optional()
    });
    CooldownStepSchema = z8.object({
      movement: z8.string().min(1),
      duration_seconds: z8.number().int().min(60).max(900),
      notes: z8.string().optional()
    });
    WorkoutBlockSchema3 = z8.object({
      name: z8.string().min(1, "Block name required"),
      type: z8.enum(["warmup", "main", "accessory", "cooldown"]),
      estimated_duration_min: z8.number().min(1).max(60),
      format: FormatEnum.optional(),
      sets: z8.array(SetSpecSchema).min(1).max(10).optional(),
      warmup_steps: z8.array(WarmupStepSchema).optional(),
      cooldown_steps: z8.array(CooldownStepSchema).optional()
    }).refine((data) => {
      if (data.type === "warmup") {
        return data.warmup_steps && data.warmup_steps.length > 0;
      }
      if (data.type === "cooldown") {
        return data.cooldown_steps && data.cooldown_steps.length > 0;
      }
      if (data.type === "main" || data.type === "accessory") {
        return data.sets && data.sets.length > 0;
      }
      return true;
    }, {
      message: "Block type must match its content structure"
    });
    WorkoutSchema = z8.object({
      name: z8.string().min(1, "Workout name required"),
      category: CategoryEnum,
      format: FormatEnum,
      duration_min: z8.number().int().min(10).max(120),
      intensity_1_to_10: z8.number().int().min(1).max(10),
      description: z8.string().min(10, "Description must be at least 10 characters"),
      blocks: z8.array(WorkoutBlockSchema3).min(1).max(8),
      equipment_needed: z8.array(z8.string()).optional(),
      coaching_notes: z8.string().optional()
    }).refine((data) => {
      const totalBlockDuration = data.blocks.reduce((sum, block) => sum + block.estimated_duration_min, 0);
      const tolerance = data.duration_min * 0.1;
      const minDuration = data.duration_min - tolerance;
      const maxDuration = data.duration_min + tolerance;
      return totalBlockDuration >= minDuration && totalBlockDuration <= maxDuration;
    }, {
      message: "Block durations must sum to within \xB110% of total workout duration"
    }).refine((data) => {
      for (const block of data.blocks) {
        if (!block.sets) continue;
        for (const set of block.sets) {
          for (const movement of set.movements) {
            if (movement.category !== data.category) {
              return false;
            }
            if ((data.category === "Powerlifting" || data.category === "Olympic") && movement.weight_percent_1rm) {
              const validRanges = getValidPercentRanges(data.category, data.intensity_1_to_10);
              if (movement.weight_percent_1rm < validRanges.min || movement.weight_percent_1rm > validRanges.max) {
                return false;
              }
            }
            if ((data.category === "Powerlifting" || data.category === "Olympic") && movement.reps) {
              if (movement.reps < 1 || movement.reps > 12) {
                return false;
              }
            }
            if (!movement.reps && !movement.duration_seconds && !movement.distance_meters) {
              return false;
            }
          }
        }
      }
      return true;
    }, {
      message: "Movement parameters don't match category and intensity requirements, or missing concrete prescriptions"
    });
  }
});

// client/src/ai/json.ts
import { z as z9 } from "zod";
function ensureValid(schema, text2) {
  let parsed;
  try {
    parsed = JSON.parse(text2);
  } catch (jsonError2) {
    if (jsonError2 instanceof SyntaxError) {
      throw new Error(`Invalid JSON: ${jsonError2.message}`);
    }
    throw new Error(`JSON parsing failed: ${String(jsonError2)}`);
  }
  try {
    return schema.parse(parsed);
  } catch (validationError) {
    if (validationError instanceof z9.ZodError) {
      const errorMessages = validationError.errors.map((err) => {
        const path = err.path.length > 0 ? ` at ${err.path.join(".")}` : "";
        return `${err.message}${path}`;
      }).join("; ");
      throw new Error(`Schema validation failed: ${errorMessages}`);
    }
    throw new Error(`Validation failed: ${String(validationError)}`);
  }
}
function extractAndValidate(schema, text2) {
  const jsonBlockMatch = text2.match(/```json\s*([\s\S]*?)\s*```/) || text2.match(/```\s*([\s\S]*?)\s*```/) || text2.match(/(\{[\s\S]*\})/);
  if (jsonBlockMatch) {
    return ensureValid(schema, jsonBlockMatch[1].trim());
  }
  const jsonMatch = text2.match(/\{[^}]*\}/);
  if (jsonMatch) {
    return ensureValid(schema, jsonMatch[0]);
  }
  return ensureValid(schema, text2);
}
var init_json = __esm({
  "client/src/ai/json.ts"() {
    "use strict";
  }
});

// server/ai/generators/crossfit.ts
var crossfit_exports = {};
__export(crossfit_exports, {
  generateCrossFitWorkout: () => generateCrossFitWorkout
});
import OpenAI4 from "openai";
function createCrossFitSystemPrompt() {
  return `You are a CrossFit coach specializing in programming quality WODs. Create authentic CrossFit workouts that follow established patterns and brand format.

CROSSFIT PRINCIPLES:
- Constantly varied functional movements at high intensity
- Balance across 10 fitness domains
- Scale loads and reps appropriately for fitness level
- Time domains: Short (<5min), Medium (5-15min), Long (15-30min)
- Movement patterns: mono-structural, gymnastics, weightlifting

WORKOUT FORMATS (choose ONE):
1. FOR TIME ladder: use "for_time" format with decreasing rep schemes
2. AMRAP: use "amrap" format with fixed time domain
3. EMOM/Intervals: use "intervals" format with work/rest

RX WEIGHT STANDARDS (use kg):
- Thruster: 43kg/29kg (95#/65#)
- Wall Ball: 9kg/6kg (20#/14#) 
- Kettlebell Swing: 24kg/16kg (53#/35#)
- Deadlift: 102kg/70kg (225#/155#) light, 143kg/93kg (315#/205#) heavy
- Box Jump: 61cm/51cm (24"/20")
- Pull-ups: bodyweight or weighted

MOVEMENT BALANCE:
- Include 2-3 movements per workout
- Mix weightlifting + gymnastics + monostructural
- Avoid same muscle group dominance
- Consider grip fatigue and breathing patterns

RECOVERY LOGIC:
- If health shows "caution": reduce intensity 1-2 points, choose lighter movements
- If yesterday was heavy legs: avoid heavy squats/deadlifts today
- If last week >60% one category: diversify with different stimulus

TITLE GENERATION:
- Use fun, memorable names like "Hardy Bacardi Party", "Slap Happy Samurai"
- 2-3 words, catchy and energetic
- Avoid generic names like "CrossFit Workout #1"

OUTPUT JSON SCHEMA (strict adherence):
{
  "name": "string (catchy CrossFit name)",
  "category": "CrossFit/HIIT",
  "format": "amrap|for_time|intervals",
  "duration_min": "number (requested duration)",
  "intensity_1_to_10": "number (requested intensity)", 
  "description": "string (programming rationale)",
  "blocks": [
    {
      "name": "string (block name like 'Warm-up', 'Main WOD', 'Cool Down')",
      "type": "warmup|main|accessory|cooldown",
      "estimated_duration_min": "number (duration for this block)",
      "format": "amrap|for_time|intervals (optional, for main blocks)",
      "sets": [
        {
          "rounds": "number",
          "movements": [
            {
              "name": "string (exact movement name from whitelist)",
              "category": "CrossFit/HIIT",
              "reps": "number (optional)",
              "weight_kg": "number (optional)",
              "duration_seconds": "number (optional)",
              "rest_seconds": "number (optional)",
              "notes": "string (optional)"
            }
          ],
          "rest_between_rounds_seconds": "number (optional)",
          "time_cap_seconds": "number (optional)"
        }
      ]
    }
  ],
  "equipment_needed": ["array of strings"],
  "coaching_notes": "string (optional)"
}`;
}
function getCrossFitFewShots() {
  return `
FEW-SHOT EXAMPLES:

Example 1 - For Time Ladder:
{
  "name": "Thunder Road",
  "category": "CrossFit/HIIT",
  "format": "for_time", 
  "duration_min": 20,
  "intensity_1_to_10": 9,
  "description": "High-intensity combination work with classic CrossFit movements. Scale loads and reps as needed.",
  "blocks": [
    {
      "name": "Warm-up",
      "type": "warmup",
      "estimated_duration_min": 3,
      "warmup_steps": [
        {
          "movement": "light_jog",
          "duration_seconds": 120,
          "intensity_percent": 50
        },
        {
          "movement": "air_squat",
          "duration_seconds": 60,
          "intensity_percent": 40
        }
      ]
    },
    {
      "name": "Main WOD",
      "type": "main",
      "estimated_duration_min": 15,
      "format": "for_time",
      "sets": [
        {
          "rounds": 4,
          "movements": [
            {
              "name": "thruster",
              "category": "CrossFit/HIIT",
              "reps": 21,
              "weight_kg": 43,
              "notes": "Reduce reps: 21-15-9-6"
            },
            {
              "name": "pull_up",
              "category": "CrossFit/HIIT", 
              "reps": 21,
              "notes": "Reduce reps: 21-15-9-6"
            }
          ],
          "time_cap_seconds": 1020
        }
      ]
    },
    {
      "name": "Cool Down",
      "type": "cooldown",
      "estimated_duration_min": 2,
      "cooldown_steps": [
        {
          "movement": "walking",
          "duration_seconds": 120
        }
      ]
    }
  ],
  "equipment_needed": ["barbell", "pull_up_bar"],
  "coaching_notes": "Scale thruster weight as needed. Band-assisted pull-ups for beginners."
}

Example 2 - AMRAP:
{
  "name": "Electric Avenue", 
  "category": "CrossFit/HIIT",
  "format": "amrap",
  "duration_min": 20,
  "intensity_1_to_10": 8,
  "description": "Mixed modal workout combining strength, cardio, and gymnastics elements.",
  "blocks": [
    {
      "name": "Warm-up",
      "type": "warmup", 
      "estimated_duration_min": 3,
      "warmup_steps": [
        {
          "movement": "rowing",
          "duration_seconds": 180,
          "intensity_percent": 60
        }
      ]
    },
    {
      "name": "Main AMRAP",
      "type": "main",
      "estimated_duration_min": 15,
      "format": "amrap",
      "sets": [
        {
          "rounds": 999,
          "movements": [
            {
              "name": "wall_ball",
              "category": "CrossFit/HIIT",
              "reps": 15,
              "weight_kg": 9
            },
            {
              "name": "box_jump",
              "category": "CrossFit/HIIT",
              "reps": 12
            },
            {
              "name": "burpee",
              "category": "CrossFit/HIIT",
              "reps": 9
            }
          ],
          "time_cap_seconds": 900
        }
      ]
    },
    {
      "name": "Cool Down",
      "type": "cooldown",
      "estimated_duration_min": 2,
      "cooldown_steps": [
        {
          "movement": "stretching",
          "duration_seconds": 120
        }
      ]
    }
  ],
  "equipment_needed": ["wall_ball", "box", "floor"],
  "coaching_notes": "Count total rounds completed in 15 minutes."
}`;
}
function normalizeWorkout(workout) {
  const normalized = { ...workout };
  if (normalized.category === "CrossFit") {
    normalized.category = "CrossFit/HIIT";
  }
  if (!normalized.name) normalized.name = "CrossFit Workout";
  if (!normalized.description) normalized.description = "High-intensity functional fitness workout";
  if (!normalized.equipment_needed) normalized.equipment_needed = ["barbell", "pull_up_bar"];
  if (normalized.blocks) {
    normalized.blocks = normalized.blocks.map((block) => {
      const fixedBlock = { ...block };
      const validTypes = ["warmup", "main", "accessory", "cooldown"];
      if (!validTypes.includes(fixedBlock.type)) {
        if (fixedBlock.type?.includes("amrap") || fixedBlock.type?.includes("cf_amrap")) {
          fixedBlock.type = "main";
        } else if (fixedBlock.type?.includes("for_time") || fixedBlock.type?.includes("cf_for_time")) {
          fixedBlock.type = "main";
        } else if (fixedBlock.type?.includes("interval") || fixedBlock.type?.includes("cf_interval")) {
          fixedBlock.type = "main";
        } else if (fixedBlock.type?.includes("strength") || fixedBlock.type?.includes("metcon")) {
          fixedBlock.type = "main";
        } else {
          fixedBlock.type = "main";
        }
      }
      if (!["warmup", "main", "accessory", "cooldown"].includes(fixedBlock.type)) {
        if (fixedBlock.name?.toLowerCase().includes("warm")) {
          fixedBlock.type = "warmup";
        } else if (fixedBlock.name?.toLowerCase().includes("cool")) {
          fixedBlock.type = "cooldown";
        } else {
          fixedBlock.type = "main";
        }
      }
      if (fixedBlock.sets) {
        fixedBlock.sets = fixedBlock.sets.map((set) => {
          const fixedSet = { ...set };
          if (fixedSet.movements) {
            fixedSet.movements = fixedSet.movements.map((movement) => {
              const fixedMovement = { ...movement };
              if (!fixedMovement.category || fixedMovement.category !== "CrossFit/HIIT" || fixedMovement.category === "CrossFit" || fixedMovement.category === "HIIT") {
                fixedMovement.category = "CrossFit/HIIT";
              }
              return fixedMovement;
            });
          }
          return fixedSet;
        });
      }
      return fixedBlock;
    });
  }
  return normalized;
}
async function generateCrossFitWorkout(request) {
  try {
    const userPrompt = `
GENERATE CROSSFIT WORKOUT:
Category: CrossFit/HIIT
Duration: ${request.duration} minutes  
Intensity: ${request.intensity}/10
${request.context?.yesterday ? `Yesterday: ${request.context.yesterday.category} - ${request.context.yesterday.intensity}/10 intensity` : ""}
${request.context?.health_snapshot ? `Health: ${JSON.stringify(request.context.health_snapshot)}` : ""}
${request.context?.equipment ? `Equipment: ${request.context.equipment.join(", ")}` : "Equipment: Full gym"}
${request.context?.constraints ? `Constraints: ${request.context.constraints.join(", ")}` : ""}

Return ONLY valid JSON matching the schema. No explanations.`;
    const completion = await openai4.chat.completions.create({
      model: "gpt-4o",
      messages: [
        { role: "system", content: createCrossFitSystemPrompt() },
        { role: "system", content: getCrossFitFewShots() },
        { role: "user", content: userPrompt }
      ],
      temperature: 0.8,
      max_tokens: 1500
    });
    const content = completion.choices[0]?.message?.content;
    if (!content) {
      throw new Error("No content generated");
    }
    try {
      let workout = extractAndValidate(WorkoutSchema, content);
      workout = normalizeWorkout(workout);
      const finalWorkout = WorkoutSchema.parse(workout);
      return finalWorkout;
    } catch (validationError) {
      const errorMessage = validationError instanceof Error ? validationError.message : String(validationError);
      const repairPrompt = `The generated CrossFit workout had validation errors: ${errorMessage}

Original JSON:
${content}

Fix the errors and return valid JSON matching the schema. Focus on:
- Correct block structure (cf_for_time, cf_amrap, or cf_interval)
- Valid movement names from CrossFit category
- RX weight standards 
- Duration matching \xB125% of target (${request.duration} min)

Return ONLY the corrected JSON:`;
      const repairCompletion = await openai4.chat.completions.create({
        model: "gpt-4o",
        messages: [
          { role: "system", content: "You are a JSON repair specialist. Return ONLY valid JSON." },
          { role: "user", content: repairPrompt }
        ],
        temperature: 0.3,
        max_tokens: 1500
      });
      const repairedContent = repairCompletion.choices[0]?.message?.content;
      if (!repairedContent) {
        throw new Error("Failed to repair workout");
      }
      try {
        const repairedWorkout = extractAndValidate(WorkoutSchema, repairedContent);
        return repairedWorkout;
      } catch (repairError) {
        const repairErrorMessage = repairError instanceof Error ? repairError.message : String(repairError);
        throw new Error(`Validation failed after repair: ${repairErrorMessage}`);
      }
    }
  } catch (error) {
    console.error("CrossFit generation failed:", error);
    throw error;
  }
}
var openai4;
var init_crossfit = __esm({
  "server/ai/generators/crossfit.ts"() {
    "use strict";
    init_schemas();
    init_json();
    openai4 = new OpenAI4({
      apiKey: process.env.OPENAI_API_KEY || process.env.MODEL_API_KEY,
      dangerouslyAllowBrowser: process.env.NODE_ENV === "test"
    });
  }
});

// server/ai/generators/olympic.ts
var olympic_exports = {};
__export(olympic_exports, {
  generateOlympicWorkout: () => generateOlympicWorkout
});
import OpenAI5 from "openai";
function createOlympicSystemPrompt() {
  return `You are an Olympic weightlifting coach specializing in technical development and strength progression. Create structured training sessions that follow classic Oly programming patterns.

OLYMPIC LIFTING PRINCIPLES:
- Technical mastery before load progression
- Proper warm-up and movement preparation
- Block periodization with clear objectives
- %1RM based loading with reference lifts
- Complex training (combinations)
- Accessory work for weaknesses

SESSION STRUCTURE (use A/B/C/D/E sections in block names):
A. Main snatch work (technique, power, or heavy)
B. Main clean & jerk work (technique, power, or heavy)  
C. Squat variation (back/front, related to main lifts)
D. Pulls or accessory strength
E. Additional accessory or corrective work

%1RM PROGRESSION PATTERNS:
- Technique work: 60-75% of 1RM
- Power development: 70-85% of 1RM  
- Heavy singles: 85-105% of 1RM
- Volume work: 65-80% of 1RM

COMPLEX NOTATION in notes:
- "(1+2+1)" = 1 from floor + 2 from hang + 1 from floor
- "(2+1)" = 2 reps + 1 rep (different positions)
- Use for snatch/clean combinations

INTENSITY GUIDELINES:
- 6/10: Technical work, 65-75%
- 7/10: Power development, 75-85%
- 8/10: Heavy work, 85-95%
- 9/10: Competition prep, 90-105%

RECOVERY LOGIC:
- If health shows "caution": reduce intensity 1-2 points, focus on technique
- If yesterday was heavy legs: lighter squats, more upper body accessory
- Alternate heavy/light days appropriately

TITLE GENERATION:
- Use training-focused names: "Power Development", "Technical Flow", "Competition Prep"
- Can include intensity or focus: "Heavy Singles", "Speed Work"

OUTPUT JSON SCHEMA (strict adherence):
{
  "name": "string (training session name)",
  "category": "Olympic",
  "format": "complex",
  "duration_min": "number (requested duration)",
  "intensity_1_to_10": "number (requested intensity)",
  "description": "string (session objective and focus)",
  "blocks": [
    {
      "name": "string (A. Main Snatch, B. Clean & Jerk, C. Squats, etc)",
      "type": "main|accessory",
      "estimated_duration_min": "number (duration for this block)",
      "sets": [
        {
          "rounds": "number (sets)",
          "movements": [
            {
              "name": "string (exact movement name from Olympic whitelist)",
              "category": "Olympic",
              "reps": "number (1-12)",
              "weight_percent_1rm": "number (60-105, optional)",
              "rest_seconds": "number (120-300, optional)",
              "notes": "string (coaching cues, %1RM reference, complex notation)"
            }
          ]
        }
      ]
    }
  ],
  "equipment_needed": ["barbell", "platform", "squat_rack"],
  "coaching_notes": "string (session focus and progression notes)"
}`;
}
function getOlympicFewShots() {
  return `
FEW-SHOT EXAMPLES:

Example 1 - Power Development:
{
  "name": "Power Development",
  "category": "Olympic",
  "format": "complex",
  "duration_min": 60,
  "intensity_1_to_10": 7,
  "description": "Technical session focusing on power development and consistency. Work on speed under the bar.",
  "blocks": [
    {
      "name": "A. Main Snatch",
      "type": "main",
      "estimated_duration_min": 20,
      "sets": [
        {
          "rounds": 6,
          "movements": [
            {
              "name": "snatch",
              "category": "Olympic",
              "reps": 2,
              "weight_percent_1rm": 75,
              "rest_seconds": 180,
              "notes": "Focus on third pull timing at 75% of 1RM Snatch"
            }
          ]
        }
      ]
    },
    {
      "name": "B. Clean & Jerk Complex",
      "type": "main",
      "estimated_duration_min": 20,
      "sets": [
        {
          "rounds": 5,
          "movements": [
            {
              "name": "clean_and_jerk",
              "category": "Olympic",
              "reps": 1,
              "weight_percent_1rm": 70,
              "rest_seconds": 240,
              "notes": "(1+2+1) complex at 70% of 1RM Clean. Pause 2s in front squat bottom"
            }
          ]
        }
      ]
    },
    {
      "name": "C. Back Squat",
      "type": "accessory",
      "estimated_duration_min": 15,
      "sets": [
        {
          "rounds": 4,
          "movements": [
            {
              "name": "back_squat",
              "category": "Olympic",
              "reps": 3,
              "weight_percent_1rm": 80,
              "rest_seconds": 180,
              "notes": "80% of 1RM Back Squat"
            }
          ]
        }
      ]
    },
    {
      "name": "D. Accessory Work",
      "type": "accessory",
      "estimated_duration_min": 5,
      "sets": [
        {
          "rounds": 3,
          "movements": [
            {
              "name": "snatch_pull",
              "category": "Olympic",
              "reps": 5,
              "weight_percent_1rm": 90,
              "notes": "90% of 1RM Snatch. Slow negative"
            },
            {
              "name": "overhead_squat",
              "category": "Olympic",
              "reps": 8,
              "weight_percent_1rm": 60,
              "notes": "60% of 1RM Snatch"
            }
          ]
        }
      ]
    }
  ],
  "equipment_needed": ["barbell", "platform", "squat_rack"],
  "coaching_notes": "Focus on speed under the bar and timing. Technical work with moderate loading."
}

Example 2 - Competition Prep:
{
  "name": "Competition Prep",
  "category": "Olympic",
  "format": "complex",
  "duration_min": 75,
  "intensity_1_to_10": 9,
  "description": "Competition simulation with opener-second-third attempt progression.",
  "blocks": [
    {
      "name": "A. Snatch Openers",
      "type": "main",
      "estimated_duration_min": 30,
      "sets": [
        {
          "rounds": 9,
          "movements": [
            {
              "name": "snatch",
              "category": "Olympic",
              "reps": 1,
              "weight_percent_1rm": 95,
              "rest_seconds": 180,
              "notes": "Work up to competition third attempt at 95% of 1RM Snatch. 3 openers, 3 seconds, 3 thirds."
            }
          ]
        }
      ]
    },
    {
      "name": "B. Clean & Jerk Openers",
      "type": "main",
      "estimated_duration_min": 30,
      "sets": [
        {
          "rounds": 9,
          "movements": [
            {
              "name": "clean_and_jerk",
              "category": "Olympic",
              "reps": 1,
              "weight_percent_1rm": 95,
              "rest_seconds": 180,
              "notes": "Work up to competition third attempt at 95% of 1RM Clean. 3 openers, 3 seconds, 3 thirds."
            }
          ]
        }
      ]
    },
    {
      "name": "C. Recovery Strength",
      "type": "accessory",
      "estimated_duration_min": 15,
      "sets": [
        {
          "rounds": 1,
          "movements": [
            {
              "name": "front_squat",
              "category": "Olympic",
              "reps": 3,
              "weight_percent_1rm": 105,
              "rest_seconds": 240,
              "notes": "105% of 1RM Clean for opener recovery strength"
            }
          ]
        }
      ]
    }
  ],
  "equipment_needed": ["barbell", "platform", "competition_plates"],
  "coaching_notes": "Simulate competition environment. Focus on opener confidence and competition timing."
}`;
}
function normalizeOlympicWorkout(workout) {
  const normalized = { ...workout };
  if (!normalized.name) normalized.name = "Olympic Training";
  if (!normalized.description) normalized.description = "Olympic weightlifting technical session";
  if (!normalized.equipment_needed) normalized.equipment_needed = ["barbell", "platform", "squat_rack"];
  if (normalized.blocks) {
    normalized.blocks = normalized.blocks.map((block) => {
      const fixedBlock = { ...block };
      const validTypes = ["warmup", "main", "accessory", "cooldown"];
      if (!validTypes.includes(fixedBlock.type)) {
        if (fixedBlock.type?.includes("strength") || fixedBlock.type?.includes("main")) {
          fixedBlock.type = "main";
        } else {
          fixedBlock.type = "main";
        }
      }
      if (!["warmup", "main", "accessory", "cooldown"].includes(fixedBlock.type)) {
        if (fixedBlock.name?.toLowerCase().includes("warm")) {
          fixedBlock.type = "warmup";
        } else if (fixedBlock.name?.toLowerCase().includes("cool")) {
          fixedBlock.type = "cooldown";
        } else {
          fixedBlock.type = "main";
        }
      }
      if (fixedBlock.sets) {
        fixedBlock.sets = fixedBlock.sets.map((set) => {
          const fixedSet = { ...set };
          if (fixedSet.movements) {
            fixedSet.movements = fixedSet.movements.map((movement) => {
              const fixedMovement = { ...movement };
              if (!fixedMovement.category || fixedMovement.category !== "Olympic" || fixedMovement.category === "Strength" || fixedMovement.category === "Accessory" || fixedMovement.category === "olympic") {
                fixedMovement.category = "Olympic";
              }
              return fixedMovement;
            });
          }
          return fixedSet;
        });
      }
      return fixedBlock;
    });
  }
  return normalized;
}
async function generateOlympicWorkout(request) {
  try {
    const userPrompt = `
GENERATE OLYMPIC WEIGHTLIFTING WORKOUT:
Category: Olympic
Duration: ${request.duration} minutes
Intensity: ${request.intensity}/10
${request.context?.yesterday ? `Yesterday: ${request.context.yesterday.category} - ${request.context.yesterday.intensity}/10 intensity` : ""}
${request.context?.health_snapshot ? `Health: ${JSON.stringify(request.context.health_snapshot)}` : ""}
${request.context?.equipment ? `Equipment: ${request.context.equipment.join(", ")}` : "Equipment: Full Olympic platform"}
${request.context?.constraints ? `Constraints: ${request.context.constraints.join(", ")}` : ""}

Requirements:
- Use A/B/C/D/E section structure  
- Include %1RM with ref_1rm_of notation
- At least one complex or progression pattern
- Appropriate intensity for requested level

Return ONLY valid JSON matching the schema. No explanations.`;
    const completion = await openai5.chat.completions.create({
      model: "gpt-4o",
      messages: [
        { role: "system", content: createOlympicSystemPrompt() },
        { role: "system", content: getOlympicFewShots() },
        { role: "user", content: userPrompt }
      ],
      temperature: 0.8,
      max_tokens: 2e3
    });
    const content = completion.choices[0]?.message?.content;
    if (!content) {
      throw new Error("No content generated");
    }
    try {
      let workout = extractAndValidate(WorkoutSchema, content);
      workout = normalizeOlympicWorkout(workout);
      const finalWorkout = WorkoutSchema.parse(workout);
      return finalWorkout;
    } catch (validationError) {
      const errorMessage = validationError instanceof Error ? validationError.message : String(validationError);
      const repairPrompt = `The generated Olympic weightlifting workout had validation errors: ${errorMessage}

Original JSON:
${content}

Fix the errors and return valid JSON matching the schema. Focus on:
- Correct block structure (strength blocks with %1RM, accessory blocks)
- Valid Olympic movement names
- Proper ref_1rm_of notation ("1RM Snatch", "1RM Clean", etc)
- Duration matching \xB125% of target (${request.duration} min)
- A/B/C/D/E section structure

Return ONLY the corrected JSON:`;
      const repairCompletion = await openai5.chat.completions.create({
        model: "gpt-4o",
        messages: [
          { role: "system", content: "You are a JSON repair specialist. Return ONLY valid JSON." },
          { role: "user", content: repairPrompt }
        ],
        temperature: 0.3,
        max_tokens: 2e3
      });
      const repairedContent = repairCompletion.choices[0]?.message?.content;
      if (!repairedContent) {
        throw new Error("Failed to repair workout");
      }
      try {
        let repairedWorkout = extractAndValidate(WorkoutSchema, repairedContent);
        repairedWorkout = normalizeOlympicWorkout(repairedWorkout);
        const finalWorkout = WorkoutSchema.parse(repairedWorkout);
        return finalWorkout;
      } catch (repairError) {
        const repairErrorMessage = repairError instanceof Error ? repairError.message : String(repairError);
        throw new Error(`Validation failed after repair: ${repairErrorMessage}`);
      }
    }
  } catch (error) {
    console.error("Olympic generation failed:", error);
    throw error;
  }
}
var openai5;
var init_olympic = __esm({
  "server/ai/generators/olympic.ts"() {
    "use strict";
    init_schemas();
    init_json();
    openai5 = new OpenAI5({
      apiKey: process.env.OPENAI_API_KEY || process.env.MODEL_API_KEY,
      dangerouslyAllowBrowser: process.env.NODE_ENV === "test"
    });
  }
});

// server/ai/title.ts
var title_exports = {};
__export(title_exports, {
  extractPrimaryMovements: () => extractPrimaryMovements,
  generateTitle: () => generateTitle,
  generateWorkoutTitle: () => generateWorkoutTitle
});
import { createHash } from "crypto";
function generateTitle(movements = [], category = "CrossFit", date2 = /* @__PURE__ */ new Date()) {
  const dateStr = date2.toISOString().split("T")[0];
  const movementKey = movements.join("|").toLowerCase();
  const hash = createHash("md5").update(`${dateStr}:${movementKey}:${category}`).digest("hex");
  const seed = parseInt(hash.substring(0, 8), 16);
  let prefix = "";
  for (const movement of movements) {
    for (const [key, prefixes] of Object.entries(MOVEMENT_PREFIXES)) {
      if (movement.toLowerCase().includes(key)) {
        const prefixIndex = (seed + movement.length) % prefixes.length;
        prefix = prefixes[prefixIndex];
        break;
      }
    }
    if (prefix) break;
  }
  if (!prefix) {
    const useAlliterative = seed % 3 === 0;
    if (useAlliterative) {
      const pairIndex = seed % ALLITERATIVE_PAIRS.length;
      return ALLITERATIVE_PAIRS[pairIndex];
    } else {
      const adjIndex = seed % ADJECTIVES.length;
      const nounIndex = seed * 7 % NOUNS.length;
      return `${ADJECTIVES[adjIndex]} ${NOUNS[nounIndex]}`;
    }
  }
  const suffixSeed = seed * 13 % NOUNS.length;
  const suffix = NOUNS[suffixSeed];
  return `${prefix} ${suffix}`;
}
function extractPrimaryMovements(workoutBlocks) {
  const movements = [];
  for (const block of workoutBlocks) {
    if (block.sets) {
      for (const set of block.sets) {
        if (set.movements) {
          for (const movement of set.movements) {
            if (movement.name) {
              movements.push(movement.name);
            }
          }
        }
      }
    }
  }
  return movements.slice(0, 3);
}
function generateWorkoutTitle(workout, category = "CrossFit", date2 = /* @__PURE__ */ new Date()) {
  const movements = extractPrimaryMovements(workout.blocks || []);
  return generateTitle(movements, category, date2);
}
var ADJECTIVES, NOUNS, ALLITERATIVE_PAIRS, MOVEMENT_PREFIXES;
var init_title = __esm({
  "server/ai/title.ts"() {
    "use strict";
    ADJECTIVES = [
      "BRUTAL",
      "SAVAGE",
      "EPIC",
      "MIGHTY",
      "FURIOUS",
      "IRON",
      "STEEL",
      "BLAZING",
      "THUNDER",
      "LIGHTNING",
      "HURRICANE",
      "TORNADO",
      "VOLCANIC",
      "ATOMIC",
      "NUCLEAR",
      "TITANIUM",
      "DIAMOND",
      "GRANITE",
      "PHOENIX",
      "DRAGON",
      "WARRIOR",
      "GLADIATOR",
      "CHAMPION",
      "DESTROYER",
      "CRUSHER",
      "HAMMER",
      "ANVIL",
      "FORGE",
      "INFERNO",
      "RAMPAGE",
      "BEAST",
      "MONSTER",
      "GIANT",
      "TITAN",
      "KING",
      "EMPEROR",
      "LEGEND",
      "WILD",
      "CRAZY",
      "INSANE",
      "WICKED",
      "TWISTED",
      "RUTHLESS",
      "RELENTLESS",
      "UNSTOPPABLE",
      "UNTAMED",
      "UNBREAKABLE",
      "INVINCIBLE",
      "IMMORTAL",
      "ETERNAL"
    ];
    NOUNS = [
      "BLITZ",
      "STORM",
      "FURY",
      "RAGE",
      "FORCE",
      "POWER",
      "MIGHT",
      "STRENGTH",
      "THUNDER",
      "LIGHTNING",
      "HURRICANE",
      "TORNADO",
      "AVALANCHE",
      "EARTHQUAKE",
      "TSUNAMI",
      "VOLCANO",
      "EXPLOSION",
      "CHAOS",
      "MAYHEM",
      "CARNAGE",
      "BATTLE",
      "WAR",
      "COMBAT",
      "SIEGE",
      "ASSAULT",
      "ATTACK",
      "STRIKE",
      "CRUSH",
      "SMASH",
      "DOMINATION",
      "DESTRUCTION",
      "ANNIHILATION",
      "OBLITERATION",
      "DEVASTATION",
      "MASSACRE",
      "SLAUGHTER",
      "RAMPAGE",
      "ONSLAUGHT",
      "BARRAGE",
      "BOMBARDMENT",
      "KRONOS",
      "ATLAS",
      "HERCULES",
      "SPARTAN",
      "VIKING",
      "SAMURAI",
      "NINJA",
      "GLADIATOR",
      "WARRIOR",
      "BERSERKER",
      "DESTROYER",
      "CONQUEROR",
      "CHAMPION"
    ];
    ALLITERATIVE_PAIRS = [
      "BRUTAL BLITZ",
      "SAVAGE STORM",
      "MIGHTY MAYHEM",
      "FURIOUS FURY",
      "IRON INFERNO",
      "STEEL STORM",
      "BLAZING BLITZ",
      "THUNDER TITAN",
      "LIGHTNING LEGEND",
      "HURRICANE HAMMER",
      "TORNADO THUNDER",
      "VOLCANIC VIKING",
      "ATOMIC ANVIL",
      "NUCLEAR NINJA",
      "TITANIUM TITAN",
      "DIAMOND DESTROYER",
      "GRANITE GLADIATOR",
      "PHOENIX POWER",
      "DRAGON DESTROYER",
      "WARRIOR WRATH",
      "GLADIATOR GLORY",
      "CHAMPION CHAOS",
      "DESTROYER DOMINATION",
      "CRUSHER CARNAGE",
      "HAMMER HURRICANE",
      "ANVIL ATTACK",
      "FORGE FURY",
      "INFERNO IRON",
      "RAMPAGE RIOT",
      "BEAST BLITZ",
      "MONSTER MAYHEM",
      "GIANT GLADIATOR",
      "TITAN THUNDER",
      "KING KRONOS",
      "EMPEROR EARTHQUAKE",
      "LEGEND LIGHTNING"
    ];
    MOVEMENT_PREFIXES = {
      "kettlebell": ["KETTLEBELL", "BELL", "IRON BELL"],
      "barbell": ["BARBELL", "BAR", "IRON BAR", "STEEL BAR"],
      "dumbbell": ["DUMBBELL", "BELL", "IRON"],
      "pull": ["PULL-UP", "PULLUP", "CHIN"],
      "squat": ["SQUAT", "GOBLET", "FRONT"],
      "deadlift": ["DEADLIFT", "DEAD", "LIFT"],
      "press": ["PRESS", "PUSH", "OVERHEAD"],
      "row": ["ROW", "BENT", "ERGO", "C2"],
      "clean": ["CLEAN", "POWER"],
      "snatch": ["SNATCH", "POWER"],
      "jerk": ["JERK", "PUSH"],
      "burpee": ["BURPEE", "DEATH"],
      "run": ["RUN", "SPRINT", "DASH"],
      "box": ["BOX", "JUMP", "STEP"],
      "wall": ["WALL", "SLAM"],
      "rope": ["ROPE", "CLIMB", "BATTLE"],
      "bike": ["BIKE", "CYCLE", "ASSAULT"],
      "ski": ["SKI", "ERGO"]
    };
  }
});

// server/ai/critic.ts
var critic_exports = {};
__export(critic_exports, {
  critiqueAndRepair: () => critiqueAndRepair
});
import OpenAI6 from "openai";
async function critiqueAndRepair(workout, context) {
  try {
    const criticPrompt = buildCriticPrompt(workout, context);
    const criticResponse = await callCriticModel(criticPrompt);
    let finalWorkout = workout;
    let wasPatched = false;
    if (criticResponse.patch) {
      finalWorkout = deepMergeWorkout(workout, criticResponse.patch);
      const validation = WorkoutSchema.safeParse(finalWorkout);
      if (!validation.success) {
        console.warn("Critic patch created invalid workout, using original");
        finalWorkout = workout;
      } else {
        wasPatched = true;
      }
    }
    return {
      workout: finalWorkout,
      score: criticResponse.score,
      issues: criticResponse.issues,
      wasPatched
    };
  } catch (error) {
    console.warn("Critic failed, using original workout:", error);
    return {
      workout,
      score: 75,
      // Default passing score
      issues: ["Critic system unavailable"],
      wasPatched: false
    };
  }
}
function buildCriticPrompt(workout, context) {
  const { request } = context;
  return `You are AXLE QA coach. Score this workout draft 0\u2013100 on these weighted criteria:

SCORING CRITERIA (weighted):
1) Safety & constraints (injuries/equipment) \u2013 40%
   - Are movements safe for user's injury history?
   - Does equipment match what's available?
   - Are load prescriptions reasonable?
   - Any contraindicated combinations?

2) Recovery fit (yesterday/week + health snapshot) \u2013 20%
   - Does intensity match health indicators?
   - Appropriate for recent training load?
   - Respects yesterday's session type?
   - Accounts for cumulative fatigue?

3) Goal & category alignment \u2013 20%
   - Movements match declared category?
   - Programming supports stated goals?
   - Appropriate volume/intensity for objectives?
   - Logical block progression?

4) Time & intensity precision \u2013 10%
   - Block durations sum within \xB110% of target?
   - Intensity mapping accurate for category?
   - Realistic time estimates?
   - Proper rest intervals?

5) Variety & movement balance \u2013 10%
   - Appropriate movement diversity?
   - Balanced muscle groups?
   - Avoids excessive repetition?
   - Interesting but practical?

WORKOUT TO REVIEW:
${JSON.stringify(workout, null, 2)}

CONTEXT:
- Target: ${request.category}, ${request.duration}min, ${request.intensity}/10 intensity
- Equipment: ${request.context?.equipment?.join(", ") || "none"}
- Constraints: ${request.context?.constraints?.join(", ") || "none"}
- Goals: ${request.context?.goals?.join(", ") || "general fitness"}
${request.context?.health_snapshot ? `- Health: HRV ${request.context.health_snapshot.hrv}, RHR ${request.context.health_snapshot.resting_hr}, Sleep ${request.context.health_snapshot.sleep_score}${request.context.health_snapshot.stress_flag ? ", STRESSED" : ""}` : ""}
${request.context?.yesterday ? `- Yesterday: ${request.context.yesterday.category} (${request.context.yesterday.intensity}/10, ${request.context.yesterday.type})` : ""}

RESPONSE FORMAT (JSON only):
{
  "score": number (0-100),
  "issues": string[] (specific problems found),
  "patch": Partial<Workout> | null (minimal fixes, or null if score \u226580)
}

PATCH RULES:
- Only if score <80
- Minimal changes that address highest-impact issues
- Keep duration within \xB110% of ${request.duration}min
- Preserve original category (${request.category}) and core intent
- Focus on safety and recovery fit first`;
}
async function callCriticModel(prompt) {
  const completion = await openai6.chat.completions.create({
    model: "gpt-4o",
    messages: [
      {
        role: "system",
        content: "You are a precise workout critic. Respond only with valid JSON in the exact format specified."
      },
      {
        role: "user",
        content: prompt
      }
    ],
    temperature: 0.3,
    // Lower temperature for more consistent critiques
    max_tokens: 2e3
  });
  const response = completion.choices[0]?.message?.content;
  if (!response) {
    throw new Error("No response from critic model");
  }
  try {
    let cleanResponse = response.trim();
    if (cleanResponse.startsWith("```json")) {
      cleanResponse = cleanResponse.slice(7);
    }
    if (cleanResponse.startsWith("```")) {
      cleanResponse = cleanResponse.slice(3);
    }
    if (cleanResponse.endsWith("```")) {
      cleanResponse = cleanResponse.slice(0, -3);
    }
    const parsed = JSON.parse(cleanResponse.trim());
    if (typeof parsed.score !== "number" || !Array.isArray(parsed.issues) || parsed.patch !== null && typeof parsed.patch !== "object") {
      throw new Error("Invalid critic response format");
    }
    return parsed;
  } catch (error) {
    throw new Error(`Failed to parse critic response: ${error}`);
  }
}
function deepMergeWorkout(original, patch) {
  const result = { ...original };
  for (const [key, value] of Object.entries(patch)) {
    if (value === null || value === void 0) {
      continue;
    }
    if (key === "blocks" && Array.isArray(value)) {
      result.blocks = value;
    } else if (key === "intensity_1_to_10" && typeof value === "number") {
      result.intensity_1_to_10 = value;
    } else if (key === "name" && typeof value === "string") {
      result.name = value;
    } else if (key === "description" && typeof value === "string") {
      result.description = value;
    } else if (key === "category") {
      result.category = value;
    }
  }
  return result;
}
var openai6;
var init_critic = __esm({
  "server/ai/critic.ts"() {
    "use strict";
    init_schemas();
    openai6 = new OpenAI6({
      apiKey: process.env.OPENAI_API_KEY || process.env.MODEL_API_KEY,
      dangerouslyAllowBrowser: process.env.NODE_ENV === "test"
    });
  }
});

// server/app.ts
init_env();
import express from "express";
import cors from "cors";

// server/routes/workouts.ts
import { Router } from "express";
import { z as z4 } from "zod";

// shared/workoutSchema.ts
import { z } from "zod";
var MovementZ = z.object({
  id: z.string(),
  // "pushup"
  name: z.string(),
  // "Push-up"
  equipment: z.array(z.string()),
  // ["bodyweight"] | ["dumbbell"] | ["kettlebell"] | ["barbell"]
  tags: z.array(z.string())
  // ["push","upper","hinge","core","mono","warmup"]
});
var PrescriptionZ = z.object({
  type: z.enum(["reps", "time", "distance"]),
  // dosing modality
  sets: z.number().int().min(1),
  // 3
  reps: z.number().int().min(1).optional(),
  // if type="reps"
  seconds: z.number().int().min(5).optional(),
  // if type="time"
  meters: z.number().int().min(10).optional(),
  // if type="distance"
  calories: z.number().int().min(1).optional(),
  // if type="distance" (alternative to meters for cardio)
  load: z.string().optional(),
  // "2x20lb", "bodyweight", "RPE 8"
  restSec: z.number().int().min(0).default(0),
  tempo: z.string().optional(),
  // "30X1"
  notes: z.string().optional()
});
var BlockItemZ = z.object({
  movementId: z.string(),
  // references MovementZ.id
  name: z.string(),
  prescription: PrescriptionZ
});
var BlockZ = z.object({
  key: z.enum(["warmup", "main", "cooldown", "accessory"]).or(z.string()),
  title: z.string(),
  items: z.array(BlockItemZ).min(1),
  // never empty
  targetSeconds: z.number().int().min(60),
  // planned time for block
  style: z.enum(["straight-sets", "emom", "amrap", "interval", "circuit"]).optional(),
  // Wodify-style enhancements
  workoutTitle: z.string().optional(),
  // Creative name for main blocks (e.g., "FRUIT LOOPS IN MY ORANGE JUICE")
  scoreType: z.string().optional(),
  // "For Time", "AMRAP", "EMOM", "Score Weight", "Score Rounds", etc.
  coachingCues: z.string().optional(),
  // Short goal-oriented description with workout intent
  scalingNotes: z.string().optional()
  // Quick scaling suggestions (lighter weight, reduced complexity, etc.)
});
var WorkoutPlanZ = z.object({
  id: z.string().optional(),
  // will exist after save
  seed: z.string(),
  // for determinism
  focus: z.enum([
    "strength",
    "conditioning",
    "mixed",
    "endurance",
    "crossfit",
    "olympic_weightlifting",
    "powerlifting",
    "bb_full_body",
    "bb_upper",
    "bb_lower",
    "aerobic",
    "gymnastics",
    "mobility"
  ]),
  durationMin: z.number().int().min(10).max(120),
  intensity: z.number().int().min(1).max(10),
  equipment: z.array(z.string()),
  // from user
  blocks: z.array(BlockZ).min(2),
  totalSeconds: z.number().int().min(300),
  summary: z.string(),
  // human synopsis
  version: z.literal(1)
});

// server/workouts/adapter.ts
function coerceNumber(value, options = {}) {
  if (value === null || value === void 0) return null;
  let num = typeof value === "number" ? value : parseFloat(value);
  if (isNaN(num)) return null;
  if (options.requireInt) {
    num = Math.round(num);
  }
  if (options.min !== void 0 && num < options.min) {
    return null;
  }
  return num;
}
function adaptToPlanV1(raw) {
  try {
    const rawBlocks = raw.blocks || [];
    let adaptedBlocks;
    if (rawBlocks.length === 0) {
      const durationMin = raw.durationMin || 30;
      const focus = raw.focus || "mixed";
      adaptedBlocks = [
        {
          key: "warmup",
          title: `${focus} warmup`,
          targetSeconds: 300,
          // 5 minutes
          items: [{
            movementId: "warmup_default",
            name: "Dynamic warmup",
            prescription: {
              type: "time",
              sets: 1,
              seconds: 300,
              restSec: 0
            }
          }]
        },
        {
          key: "main",
          title: "Main workout",
          targetSeconds: (durationMin - 5) * 60,
          items: [{
            movementId: "main_default",
            name: `${focus} training`,
            prescription: {
              type: "time",
              sets: 1,
              seconds: (durationMin - 5) * 60,
              restSec: 0
            }
          }]
        }
      ];
    } else {
      console.log("[ADAPTER] Input blocks:", rawBlocks.map((b) => ({
        key: b.key,
        title: b.title,
        workoutTitle: b.workoutTitle,
        scoreType: b.scoreType,
        coachingCues: b.coachingCues
      })));
      adaptedBlocks = rawBlocks.map((block) => ({
        ...block,
        key: block.key || block.type || "main",
        title: block.title || block.notes || `${block.type || "main"} block`,
        targetSeconds: coerceNumber(block.targetSeconds || (block.minutes ? block.minutes * 60 : 300), { requireInt: true, min: 60 }) || 300,
        items: block.items && block.items.length > 0 ? block.items.map((item) => {
          const prescription = {
            type: item.prescription?.type || "reps",
            sets: coerceNumber(item.prescription?.sets, { requireInt: true, min: 1 }) || 1,
            restSec: coerceNumber(item.prescription?.restSec, { requireInt: true, min: 0 }) || 0
          };
          const reps = coerceNumber(item.prescription?.reps, { requireInt: true, min: 1 });
          if (reps !== null) prescription.reps = reps;
          const seconds = coerceNumber(item.prescription?.seconds, { requireInt: true, min: 5 });
          if (seconds !== null) prescription.seconds = seconds;
          const meters = coerceNumber(item.prescription?.meters, { requireInt: true, min: 10 });
          if (meters !== null) prescription.meters = meters;
          const calories = coerceNumber(item.prescription?.calories, { requireInt: true, min: 1 });
          if (calories !== null) prescription.calories = calories;
          if (item.prescription?.load) prescription.load = item.prescription.load;
          if (item.prescription?.tempo) prescription.tempo = item.prescription.tempo;
          if (item.prescription?.notes) prescription.notes = item.prescription.notes;
          return {
            ...item,
            prescription
          };
        }) : [
          {
            movementId: "default",
            name: block.notes || "Default exercise",
            prescription: {
              type: "time",
              sets: 1,
              seconds: coerceNumber(block.targetSeconds || (block.minutes ? block.minutes * 60 : 300), { requireInt: true, min: 5 }) || 300,
              restSec: 0
            }
          }
        ]
      }));
      console.log("[ADAPTER] Output blocks:", adaptedBlocks.map((b) => ({
        key: b.key,
        title: b.title,
        workoutTitle: b.workoutTitle,
        scoreType: b.scoreType,
        coachingCues: b.coachingCues
      })));
    }
    if (adaptedBlocks.length < 2) {
      adaptedBlocks.push({
        key: "cooldown",
        title: "Cool down",
        targetSeconds: 180,
        // 3 minutes
        items: [{
          movementId: "cooldown_default",
          name: "Recovery",
          prescription: {
            type: "time",
            sets: 1,
            seconds: 180,
            restSec: 0
          }
        }]
      });
    }
    const adapted = {
      ...raw,
      version: 1,
      blocks: adaptedBlocks,
      // Ensure required top-level fields
      seed: raw.seed || crypto.randomUUID(),
      focus: raw.focus || "mixed",
      durationMin: raw.durationMin || 30,
      intensity: raw.intensity || 5,
      equipment: raw.equipment || [],
      totalSeconds: raw.totalSeconds || (raw.durationMin ? raw.durationMin * 60 : 1800),
      summary: raw.summary || `${raw.focus || "Mixed"} workout`
    };
    const plan = WorkoutPlanZ.parse(adapted);
    return plan;
  } catch (error) {
    throw new Error(`Failed to adapt workout data: ${error instanceof Error ? error.message : "Unknown error"}`);
  }
}

// server/routes/workouts.ts
var workouts2 = Router();
function transformSetsToBlocks(sets, durationMin) {
  console.log("[TRANSFORM] Input sets headers:", sets.filter((s2) => s2.is_header).map((s2) => ({
    exercise: s2.exercise,
    workoutTitle: s2.workoutTitle,
    scoreType: s2.scoreType,
    coachingCues: s2.coachingCues
  })));
  const blocks = [];
  let currentBlock = null;
  for (const set of sets) {
    if (set.is_header) {
      if (currentBlock && currentBlock.items.length > 0) {
        blocks.push(currentBlock);
      }
      const exerciseLower = set.exercise.toLowerCase();
      let blockKey = "main";
      if (exerciseLower.includes("warm")) {
        blockKey = "warmup";
      } else if (exerciseLower.includes("cool")) {
        blockKey = "cooldown";
      }
      currentBlock = {
        key: blockKey,
        title: set.exercise,
        targetSeconds: set.duration || 300,
        items: [],
        // Wodify-style enhancements (only for main section)
        workoutTitle: set.workoutTitle || void 0,
        scoreType: set.scoreType || void 0,
        coachingCues: set.coachingCues || void 0,
        scalingNotes: set.scalingNotes || void 0
      };
    } else if (currentBlock) {
      const prescription = {
        type: set.distance_m || set.distance ? "distance" : set.calories ? "distance" : set.duration ? "time" : set.reps ? "reps" : "reps",
        sets: set.num_sets || 1,
        restSec: set.rest_s || 0
      };
      if (set.distance_m || set.distance) {
        prescription.meters = set.distance_m || set.distance;
      } else if (set.calories) {
        prescription.calories = set.calories;
      } else if (set.duration) {
        prescription.seconds = set.duration;
      } else if (set.reps) {
        prescription.reps = set.reps;
      }
      currentBlock.items.push({
        movementId: set.id,
        name: set.exercise,
        prescription,
        notes: set.notes
      });
    }
  }
  if (currentBlock && currentBlock.items.length > 0) {
    blocks.push(currentBlock);
  }
  if (blocks.length === 0) {
    blocks.push({
      key: "main",
      title: "Main Workout",
      targetSeconds: durationMin * 60,
      items: sets.filter((s2) => !s2.is_header).map((set) => ({
        movementId: set.id,
        name: set.exercise,
        prescription: {
          type: set.reps ? "reps" : "time",
          sets: set.num_sets || 1,
          reps: set.reps,
          seconds: set.duration,
          restSec: set.rest_s || 0
        }
      }))
    });
  }
  return blocks;
}
var PreviewSchema = z4.object({
  focus: z4.enum([
    "strength",
    "conditioning",
    "mixed",
    "endurance",
    "crossfit",
    "olympic_weightlifting",
    "powerlifting",
    "bb_full_body",
    "bb_upper",
    "bb_lower",
    "aerobic",
    "gymnastics",
    "mobility"
  ]),
  durationMin: z4.coerce.number().int().min(10).max(120),
  // Align with WorkoutPlanZ
  equipment: z4.array(z4.string()).default([]),
  intensity: z4.coerce.number().int().min(1).max(10),
  // Align with WorkoutPlanZ - must be integer
  seed: z4.string().optional()
});
workouts2.post("/preview", async (req, res) => {
  const parsed = PreviewSchema.safeParse(req.body);
  if (!parsed.success) {
    return res.status(400).json({ ok: false, error: "invalid_request", details: parsed.error.flatten() });
  }
  try {
    const { focus, durationMin, equipment, intensity, seed } = parsed.data;
    const workoutSeed = seed ?? Math.random().toString(16).slice(2).toUpperCase();
    const { generateWorkout: generateWorkout4 } = await Promise.resolve().then(() => (init_workoutGenerator(), workoutGenerator_exports));
    console.log("[WORKOUTS ROUTER /preview] OpenAI-first generation:", {
      style: focus,
      duration: durationMin,
      equipment: equipment.length,
      seed: workoutSeed
    });
    const generatedPlan = await generateWorkout4({
      category: focus,
      style: focus,
      goal: focus,
      focus,
      durationMin,
      duration: durationMin,
      intensity,
      equipment,
      seed: workoutSeed
    });
    console.log("[WORKOUTS ROUTER /preview] Generated successfully");
    const transformedPlan = {
      seed: workoutSeed,
      focus,
      durationMin,
      intensity,
      equipment,
      blocks: transformSetsToBlocks(generatedPlan.sets, durationMin),
      totalSeconds: durationMin * 60,
      summary: generatedPlan.description || `${focus} workout`,
      version: 1
    };
    const validatedPlan = adaptToPlanV1(transformedPlan);
    console.log("[PREVIEW DEBUG] Blocks with Wodify fields:", validatedPlan.blocks.map((b) => ({
      key: b.key,
      title: b.title,
      workoutTitle: b.workoutTitle,
      scoreType: b.scoreType,
      coachingCues: b.coachingCues
    })));
    return res.json({ ok: true, preview: validatedPlan, seed: workoutSeed });
  } catch (err) {
    req.log?.error({ err }, "preview failed");
    const message2 = err instanceof Error ? err.message : "Failed to generate valid workout plan";
    const errorCode = err?.code || "UNKNOWN_ERROR";
    const errorStatus = err?.status || 500;
    console.error("[WORKOUTS ROUTER /preview] Generation error:", {
      message: message2,
      code: errorCode,
      status: errorStatus,
      stack: err?.stack?.split("\n").slice(0, 3).join("\n")
    });
    let userMessage = message2;
    if (message2.includes("timed out")) {
      userMessage = "Workout generation took too long. Please try again with simpler settings.";
    } else if (message2.includes("API key") || message2.includes("not configured")) {
      userMessage = "OpenAI API configuration error. Please check your API key.";
    } else if (message2.includes("rate limit")) {
      userMessage = "Too many requests. Please wait a moment and try again.";
    }
    return res.status(500).json({
      ok: false,
      error: "preview_failed",
      message: userMessage,
      details: message2
    });
  }
});
workouts2.post("/generate/preview", async (req, res) => {
  return res.redirect(307, "/api/workouts/preview");
});

// server/sentry.ts
import * as Sentry from "@sentry/node";
function initSentry() {
  if (!process.env.SENTRY_DSN_SERVER) return;
  Sentry.init({
    dsn: process.env.SENTRY_DSN_SERVER,
    environment: process.env.SENTRY_ENV || "dev",
    tracesSampleRate: 0.2
  });
}

// server/middleware/logging.ts
import pinoHttp from "pino-http";
import { randomUUID } from "node:crypto";
var logging = pinoHttp({
  genReqId: (req) => req.headers["x-request-id"] || randomUUID(),
  customSuccessMessage: function(req, res) {
    return `${req.method} ${req.url} -> ${res.statusCode}`;
  },
  serializers: {
    req(req) {
      return {
        id: req.id,
        method: req.method,
        url: req.url
      };
    }
  }
});

// server/middleware/error.ts
init_workoutGenerator();
function jsonError(err, req, res, _next) {
  const status = err.statusCode || err.status || 500;
  const code = err.code ? String(err.code).toLowerCase() : null;
  const msg = String(err.message || "unknown_error");
  const style = String(req.body?.style || req.body?.goal || req.body?.focus || "unknown").toLowerCase();
  console.error("[AXLE][GEN][ERROR]", { status, code, msg, style, stamp: GENERATOR_STAMP });
  res.status(status).json({
    ok: false,
    error: msg,
    code,
    style,
    stamp: GENERATOR_STAMP,
    // allow clients/CLI to see acceptance/policy hints when available
    meta: {
      hint: err.hint || null,
      policy: err.policy || null,
      details: err.details || null
    }
  });
}

// server/workouts/library/index.ts
import { z as z5 } from "zod";
import { readFileSync } from "fs";
import { join, dirname } from "path";
import { fileURLToPath } from "url";
var BlockVariantSchema = z5.object({
  name: z5.string(),
  movements: z5.array(z5.string())
});
var WorkoutBlockSchema2 = z5.object({
  id: z5.string(),
  type: z5.enum(["warmup", "primary", "accessory", "conditioning", "finisher", "cooldown"]),
  durationMin: z5.number().min(1).max(120),
  minEquipment: z5.array(z5.string()),
  contraindications: z5.array(z5.string()),
  experience: z5.enum(["beginner", "intermediate", "advanced", "expert"]),
  energySystems: z5.array(z5.enum(["alactic", "phosphocreatine", "glycolytic", "aerobicZ1", "aerobicZ2", "aerobicZ3"])),
  movementPatterns: z5.array(z5.enum(["squat", "hinge", "push", "pull", "carry", "locomotion", "power", "core"])),
  progressionKey: z5.string(),
  variants: z5.array(BlockVariantSchema)
});
var blocksCache = [];
var isLoaded = false;
function loadBlocks() {
  const errors = [];
  const allBlocks = [];
  const blockCategories = ["warmup", "primary", "accessory", "conditioning", "finisher"];
  const __filename = fileURLToPath(import.meta.url);
  const __dirname = dirname(__filename);
  const libraryPath = join(__dirname, "blocks");
  for (const category of blockCategories) {
    try {
      const filePath = join(libraryPath, `${category}.json`);
      const fileContent = readFileSync(filePath, "utf-8");
      const rawBlocks = JSON.parse(fileContent);
      if (!Array.isArray(rawBlocks)) {
        errors.push(`${category}.json: Expected array of blocks`);
        continue;
      }
      for (let i2 = 0; i2 < rawBlocks.length; i2++) {
        try {
          const validatedBlock = WorkoutBlockSchema2.parse(rawBlocks[i2]);
          allBlocks.push(validatedBlock);
        } catch (validationError) {
          if (validationError instanceof z5.ZodError) {
            errors.push(`${category}.json[${i2}]: ${validationError.issues.map(
              (issue) => `${issue.path.join(".")}: ${issue.message}`
            ).join(", ")}`);
          } else {
            errors.push(`${category}.json[${i2}]: Validation failed`);
          }
        }
      }
    } catch (fileError) {
      errors.push(`Failed to load ${category}.json: ${fileError instanceof Error ? fileError.message : "Unknown error"}`);
    }
  }
  return { blocks: allBlocks, errors };
}
function initializeBlockLibrary() {
  const { blocks, errors } = loadBlocks();
  blocksCache = blocks;
  isLoaded = true;
  console.log(`Loaded ${blocks.length} blocks validated (${errors.length} errors)`);
  if (errors.length > 0) {
    console.error("Block validation errors:");
    errors.forEach((error) => console.error(`  - ${error}`));
  }
}
function getBlocks(filter) {
  if (!isLoaded) {
    initializeBlockLibrary();
  }
  if (!filter) {
    return [...blocksCache];
  }
  return blocksCache.filter((block) => {
    if (filter.type && block.type !== filter.type) {
      return false;
    }
    if (filter.energySystem && !block.energySystems.includes(filter.energySystem)) {
      return false;
    }
    if (filter.movementPattern && !block.movementPatterns.includes(filter.movementPattern)) {
      return false;
    }
    if (filter.experience && block.experience !== filter.experience) {
      return false;
    }
    if (filter.equipment) {
      const hasRequiredEquipment = block.minEquipment.every(
        (required) => filter.equipment.includes(required)
      );
      if (!hasRequiredEquipment) {
        return false;
      }
    }
    if (filter.maxDuration && block.durationMin > filter.maxDuration) {
      return false;
    }
    if (filter.contraindications && filter.contraindications.length > 0) {
      const hasContraindication = block.contraindications.some(
        (contraindication) => filter.contraindications.includes(contraindication)
      );
      if (hasContraindication) {
        return false;
      }
    }
    return true;
  });
}

// server/routes/suggestions.ts
import { z as z6 } from "zod";
import crypto3 from "crypto";

// node_modules/nanoid/index.js
import crypto2 from "crypto";

// node_modules/nanoid/url-alphabet/index.js
var urlAlphabet = "useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";

// node_modules/nanoid/index.js
var POOL_SIZE_MULTIPLIER = 128;
var pool;
var poolOffset;
var fillPool = (bytes) => {
  if (!pool || pool.length < bytes) {
    pool = Buffer.allocUnsafe(bytes * POOL_SIZE_MULTIPLIER);
    crypto2.randomFillSync(pool);
    poolOffset = 0;
  } else if (poolOffset + bytes > pool.length) {
    crypto2.randomFillSync(pool);
    poolOffset = 0;
  }
  poolOffset += bytes;
};
var nanoid = (size = 21) => {
  fillPool(size |= 0);
  let id = "";
  for (let i2 = poolOffset - size; i2 < poolOffset; i2++) {
    id += urlAlphabet[pool[i2] & 63];
  }
  return id;
};

// server/routes/suggestions.ts
import * as Sentry3 from "@sentry/node";

// server/middleware/auth.ts
init_supabaseAdmin();
async function requireAuth(req, res, next) {
  const authHeader = req.headers.authorization;
  if (!authHeader || !authHeader.startsWith("Bearer ")) {
    res.status(401).json({ message: "Authorization token required" });
    return;
  }
  const token = authHeader.substring(7);
  try {
    const { data: { user }, error } = await supabaseAdmin.auth.getUser(token);
    if (error || !user) {
      res.status(401).json({ message: "Invalid token" });
      return;
    }
    req.user = {
      id: user.id,
      email: user.email
    };
    next();
  } catch (error) {
    console.error("Auth error:", error);
    res.status(401).json({ message: "Authentication failed" });
  }
}
async function requireAdmin(req, res, next) {
  await new Promise((resolve, reject) => {
    requireAuth(req, res, (err) => {
      if (err) reject(err);
      else resolve();
    });
  });
  const authReq = req;
  const adminEmails = (process.env.ADMIN_EMAILS || "").split(",").map((email) => email.trim());
  if (!adminEmails.includes(authReq.user.email || "")) {
    res.status(403).json({ message: "Admin access required" });
    return;
  }
  next();
}

// server/routes/suggestions.ts
init_suggestions();
init_generate();
init_workouts();

// server/dal/profiles.ts
init_supabaseAdmin();
init_db();
function mapProfileToFrontend(dbProfile) {
  if (!dbProfile) return null;
  return {
    userId: dbProfile.user_id,
    firstName: dbProfile.first_name,
    lastName: dbProfile.last_name,
    username: dbProfile.username,
    dateOfBirth: dbProfile.date_of_birth,
    avatarUrl: dbProfile.avatar_url,
    preferredUnit: dbProfile.preferred_unit,
    favoriteMovements: dbProfile.favorite_movements || [],
    providers: dbProfile.providers,
    // Convert timestamp strings to Date objects for frontend
    createdAt: dbProfile.created_at ? new Date(dbProfile.created_at) : void 0,
    // Include any other fields that might exist
    latitude: dbProfile.latitude,
    longitude: dbProfile.longitude,
    timezone: dbProfile.timezone
  };
}
async function getProfile(userId) {
  if (!process.env.DATABASE_URL) {
    console.error("[DAL:profiles:getProfile] FATAL: DATABASE_URL environment variable is not set");
    throw new Error("Database connection not configured. DATABASE_URL environment variable is missing.");
  }
  let client;
  try {
    client = await pool2.connect();
    const result = await client.query(
      `SELECT 
        user_id, first_name, last_name, username, date_of_birth, avatar_url, 
        preferred_unit, favorite_movements, providers, created_at,
        latitude, longitude, timezone
       FROM profiles 
       WHERE user_id = $1`,
      [userId]
    );
    if (result.rows.length === 0) {
      return null;
    }
    return mapProfileToFrontend(result.rows[0]);
  } catch (error) {
    console.error("[DAL:profiles:getProfile] Failed to fetch profile:", {
      userId,
      error: error.message,
      code: error.code,
      hint: "Check DATABASE_URL environment variable and database connection. Ensure SSL is configured for production.",
      stack: error.stack
    });
    throw new Error(`Failed to get profile: ${error.message}`);
  } finally {
    if (client) client.release();
  }
}

// server/services/suggestionInputs.ts
init_reports();
init_workouts();
async function deriveSuggestionSeed(userId) {
  const profile = await getProfile(userId).catch(() => null);
  const healthReports2 = await listReports(userId, { days: 7 }).catch(() => []);
  const recent = await listWorkouts(userId, { limit: 4 }).catch(() => []);
  const health = healthReports2 && healthReports2.length > 0 ? healthReports2[0] : null;
  const inputs = {
    archetype: "mixed",
    minutes: 30,
    targetIntensity: 6,
    equipment: ["dumbbells", "bodyweight"],
    constraints: [],
    location: "gym"
  };
  const context = {
    dateISO: (/* @__PURE__ */ new Date()).toISOString(),
    userId,
    healthModifiers: health ? {
      axleScore: health.metrics?.axle_score ?? void 0,
      vitality: health.metrics?.vitality_score ?? void 0,
      performancePotential: health.metrics?.performance_potential ?? void 0,
      circadian: health.metrics?.circadian_alignment ?? void 0
    } : void 0
  };
  return { inputs, context, recent };
}

// server/routes/suggestions.ts
init_db();
init_schema();
import { eq as eq3, desc as desc3, and as and3, sql as sql3 } from "drizzle-orm";
function registerSuggestionRoutes(app2) {
  app2.get("/api/suggestions/today", async (req, res) => {
    const requestId = crypto3.randomUUID();
    try {
      res.type("application/json");
      const authReq = req;
      if (!authReq.user?.id) {
        console.log({ requestId }, "Unauthenticated request to /api/suggestions/today");
        return res.status(200).json({
          suggestion: null,
          reason: "unauthenticated",
          requestId
        });
      }
      const userId = authReq.user.id;
      console.log({ requestId, userId }, "GET /api/suggestions/today");
      const today = (/* @__PURE__ */ new Date()).toISOString().split("T")[0];
      const existingSuggestion = await db.select().from(suggestedWorkouts).where(and3(
        eq3(suggestedWorkouts.userId, userId),
        eq3(suggestedWorkouts.date, today)
      )).limit(1);
      const suggestion = existingSuggestion[0] || null;
      if (suggestion) {
        console.log(`\u2705 Returning existing suggestion for ${today}`);
        return res.status(200).json({
          ...suggestion,
          isExisting: true,
          requestId
        });
      }
      let inputs, context, recent;
      try {
        const seedData = await deriveSuggestionSeed(userId);
        inputs = seedData.inputs;
        context = seedData.context;
        recent = seedData.recent;
      } catch (seedError) {
        console.log({ requestId, userId, error: seedError }, "Cannot derive suggestion inputs");
        return res.status(200).json({
          suggestion: null,
          reason: "insufficient-context",
          requestId
        });
      }
      console.log(`\u{1F9E0} Computing new suggestion for ${today}`);
      const seed = {
        rngSeed: nanoid(10),
        generatorVersion: "v0.3.0",
        inputs,
        context
      };
      let suggestionResult;
      try {
        suggestionResult = await computeSuggestion(userId, /* @__PURE__ */ new Date());
      } catch (generatorError) {
        console.log({ requestId, userId, error: generatorError }, "Failed to compute suggestion");
        Sentry3.captureException(generatorError, {
          extra: { requestId, userId },
          tags: { component: "suggestions" }
        });
        return res.status(500).json({
          error: "internal",
          requestId
        });
      }
      let hasGenColumns = false;
      try {
        const columnCheck = await db.execute(
          sql3`SELECT column_name FROM information_schema.columns 
              WHERE table_name='workouts' AND column_name IN ('gen_seed','generator_version')`
        );
        hasGenColumns = (columnCheck.rows?.length ?? 0) >= 2;
      } catch (schemaError) {
        console.log({ requestId }, "Could not check schema, assuming no gen columns");
        hasGenColumns = false;
      }
      const insertedSuggestion = await db.insert(suggestedWorkouts).values({
        userId,
        date: today,
        request: suggestionResult.request,
        rationale: suggestionResult.rationale,
        workoutId: null
        // Will be set when user generates the actual workout
      }).returning();
      if (!insertedSuggestion[0]) {
        console.error({ requestId }, "Error inserting suggestion");
        Sentry3.captureMessage("Failed to insert suggestion", {
          extra: { requestId, userId }
        });
        return res.status(500).json({
          error: "internal",
          requestId
        });
      }
      console.log(`\u2705 Generated and stored new suggestion with ID: ${insertedSuggestion[0].id}`);
      return res.status(200).json({
        ...insertedSuggestion[0],
        customSuggestions: suggestionResult.customSuggestions || [],
        isExisting: false,
        seed: {
          rngSeed: seed.rngSeed,
          generatorVersion: seed.generatorVersion
        },
        hasGenColumns,
        // For debugging
        requestId
      });
    } catch (error) {
      console.error({ requestId }, "Error in /api/suggestions/today:", error);
      Sentry3.captureException(error, {
        extra: { requestId },
        tags: { route: "/api/suggestions/today" }
      });
      return res.status(500).json({
        error: "internal",
        requestId
      });
    }
  });
  app2.post("/api/suggestions/generate", requireAuth, async (req, res) => {
    const requestId = crypto3.randomUUID();
    try {
      res.type("application/json");
      const authReq = req;
      const userId = authReq.user.id;
      const bodySchema = z6.object({
        regenerate: z6.boolean().optional()
      });
      const { regenerate = false } = bodySchema.parse(req.body);
      console.log({ requestId, userId, regenerate }, "POST /api/suggestions/generate");
      const today = (/* @__PURE__ */ new Date()).toISOString().split("T")[0];
      let suggestion;
      if (regenerate) {
        console.log(`\u{1F504} Regenerating suggestion for ${today}`);
        const suggestionResult = await computeSuggestion(userId, /* @__PURE__ */ new Date());
        const existingSuggestion = await db.select().from(suggestedWorkouts).where(and3(
          eq3(suggestedWorkouts.userId, userId),
          eq3(suggestedWorkouts.date, today)
        )).limit(1);
        if (existingSuggestion[0]) {
          const updated = await db.update(suggestedWorkouts).set({
            request: suggestionResult.request,
            rationale: suggestionResult.rationale,
            workoutId: null
          }).where(and3(
            eq3(suggestedWorkouts.userId, userId),
            eq3(suggestedWorkouts.date, today)
          )).returning();
          suggestion = updated[0];
        } else {
          const inserted = await db.insert(suggestedWorkouts).values({
            userId,
            date: today,
            request: suggestionResult.request,
            rationale: suggestionResult.rationale,
            workoutId: null
          }).returning();
          suggestion = inserted[0];
        }
      } else {
        const existingSuggestion = await db.select().from(suggestedWorkouts).where(and3(
          eq3(suggestedWorkouts.userId, userId),
          eq3(suggestedWorkouts.date, today)
        )).limit(1);
        if (!existingSuggestion[0]) {
          return res.status(404).json({
            message: "No suggestion found for today. Call /api/suggestions/today first.",
            requestId
          });
        }
        suggestion = existingSuggestion[0];
      }
      const [recentWorkouts, recentPRs, latestHealth] = await Promise.all([
        db.select().from(workouts).where(eq3(workouts.userId, userId)).orderBy(desc3(workouts.createdAt)).limit(14),
        db.select().from(prs).where(eq3(prs.userId, userId)).orderBy(desc3(prs.date)).limit(5),
        db.select().from(healthReports).where(eq3(healthReports.userId, userId)).orderBy(desc3(healthReports.date)).limit(1)
      ]);
      const requestData = suggestion.request;
      const enhancedRequest = {
        category: requestData.category,
        duration: requestData.duration,
        intensity: requestData.intensity,
        recentPRs: recentPRs.map((pr) => ({
          exercise: `${pr.movement} (${pr.category})`,
          weight: pr.weightKg ? parseFloat(pr.weightKg.toString()) * 2.20462 : void 0,
          // Convert kg to lbs
          reps: pr.repMax,
          date: pr.date,
          unit: "lbs"
        })),
        lastWorkouts: recentWorkouts.slice(0, 3).map((w) => ({
          name: w.title,
          category: w.request?.category || requestData.category,
          duration: w.request?.duration || requestData.duration,
          intensity: w.request?.intensity || requestData.intensity,
          date: w.createdAt,
          exercises: []
          // Could extract from sets if needed
        })),
        todaysReport: latestHealth[0]?.metrics ? {
          energy: latestHealth[0].metrics?.recovery?.score ? Math.round(latestHealth[0].metrics.recovery.score / 10) : 7,
          stress: latestHealth[0].metrics?.stress || 5,
          sleep: latestHealth[0].metrics?.sleepScore ? Math.round(latestHealth[0].metrics.sleepScore / 10) : 7,
          soreness: 4
          // Would come from user input or wearables
        } : void 0
      };
      console.log(`\u{1F916} Generating workout with AI for category: ${requestData.category}`);
      const workoutInputs = {
        archetype: requestData.category,
        minutes: requestData.duration,
        targetIntensity: requestData.intensity,
        equipment: requestData.equipment || [],
        constraints: requestData.constraints || []
      };
      const result = await generateWithFallback(workoutInputs, { request: enhancedRequest });
      const generatedWorkout = result.workout || result;
      const workoutData = {
        userId: authReq.user.id,
        workout: {
          title: generatedWorkout.name,
          request: {
            ...enhancedRequest,
            meta: {
              origin: "suggestion",
              suggestedFor: today,
              version: "2.0",
              rationale: suggestion.rationale
            }
          },
          sets: generatedWorkout.blocks?.map((block, index2) => ({
            id: `block-${index2}`,
            exercise: block.name || block.type || "Exercise",
            notes: block.notes || block.description || ""
          })) || [],
          notes: generatedWorkout.description,
          completed: false
        }
      };
      const dbWorkout = await insertWorkout(workoutData);
      if (!dbWorkout) {
        console.error({ requestId }, "Failed to insert workout into database");
        return res.status(500).json({
          error: "Failed to save workout to database",
          requestId
        });
      }
      try {
        await db.update(suggestedWorkouts).set({ workoutId: dbWorkout.id }).where(eq3(suggestedWorkouts.id, suggestion.id));
      } catch (updateError) {
        console.error({ requestId }, "Error linking workout to suggestion:", updateError);
      }
      console.log(`\u2705 Generated workout with ID: ${dbWorkout.id} and linked to suggestion ${suggestion.id}`);
      return res.status(200).json({
        suggestion: {
          ...suggestion,
          workoutId: dbWorkout.id
        },
        workout: {
          ...generatedWorkout,
          id: dbWorkout.id,
          dbId: dbWorkout.id
        },
        requestId
      });
    } catch (error) {
      console.error({ requestId }, "Error in /api/suggestions/generate:", error);
      if (error instanceof z6.ZodError) {
        return res.status(400).json({
          message: "Invalid request data",
          errors: error.issues,
          requestId
        });
      }
      Sentry3.captureException(error, {
        extra: { requestId },
        tags: { route: "/api/suggestions/generate" }
      });
      return res.status(500).json({
        error: "internal",
        requestId
      });
    }
  });
  app2.get("/api/suggestions/debug", requireAuth, async (req, res) => {
    const requestId = crypto3.randomUUID();
    try {
      res.type("application/json");
      if (process.env.NODE_ENV === "production") {
        return res.status(403).json({
          message: "Debug endpoint not available in production",
          requestId
        });
      }
      const authReq = req;
      const userId = authReq.user.id;
      console.log({ requestId, userId }, "GET /api/suggestions/debug");
      const { fetchWorkoutData: fetchWorkoutData2, fetchLatestHealthReport: fetchLatestHealthReport2 } = await Promise.resolve().then(() => (init_suggestions(), suggestions_exports));
      const today = /* @__PURE__ */ new Date();
      const workoutData = await fetchWorkoutData2(userId, today);
      const latestHealth = await fetchLatestHealthReport2(userId);
      const seedData = await deriveSuggestionSeed(userId);
      return res.status(200).json({
        userId,
        date: today.toISOString().split("T")[0],
        inputs: {
          workouts: {
            last1Day: workoutData.last1,
            last7Days: workoutData.last7,
            last14Days: workoutData.last14,
            last28Days: workoutData.last28
          },
          health: {
            latest: latestHealth,
            metrics: latestHealth?.metrics || null
          },
          v03Seed: {
            inputs: seedData.inputs,
            context: seedData.context,
            recent: seedData.recent
          }
        },
        summary: {
          totalWorkouts: workoutData.last28.length,
          recentWorkout: workoutData.last28[0] || null,
          hasHealthData: !!latestHealth,
          healthMetricsKeys: latestHealth?.metrics ? Object.keys(latestHealth.metrics) : []
        },
        requestId
      });
    } catch (error) {
      console.error({ requestId }, "Error in /api/suggestions/debug:", error);
      Sentry3.captureException(error, {
        extra: { requestId },
        tags: { route: "/api/suggestions/debug" }
      });
      return res.status(500).json({
        error: "internal",
        requestId
      });
    }
  });
}

// server/routes/workout-freeform.ts
import { Router as Router2 } from "express";

// server/lib/openai.ts
import OpenAI3 from "openai";
var openai3 = new OpenAI3({
  apiKey: process.env.OPENAI_API_KEY,
  timeout: 6e4,
  // 60 second timeout
  maxRetries: 2
});

// server/lib/supabaseFromReq.ts
import { createClient as createClient2 } from "@supabase/supabase-js";
var supabaseFromReq = (req) => createClient2(process.env.SUPABASE_URL, process.env.VITE_SUPABASE_ANON_KEY, {
  global: { headers: { Authorization: req.headers["authorization"] ?? "" } },
  auth: { persistSession: false }
});

// server/routes/workout-freeform.ts
var router = Router2();
router.post("/parse-freeform", requireAuth, async (req, res) => {
  const text2 = String(req.body?.text || "").slice(0, 12e3);
  if (!text2) {
    return res.status(400).json({ error: "text required" });
  }
  try {
    const r4 = await openai3.chat.completions.create({
      model: "gpt-4o-mini",
      temperature: 0.2,
      response_format: {
        type: "json_schema",
        json_schema: {
          name: "FreeformParsed",
          schema: {
            type: "object",
            properties: {
              title: { type: "string" },
              est_duration_min: { type: "number" },
              intensity: { type: "number" },
              confidence: { type: "number" },
              request: {
                type: "object",
                properties: {
                  category: { type: "string" },
                  durationMinutes: { type: "number" },
                  intensity: { type: "number" }
                },
                required: ["category", "durationMinutes", "intensity"],
                additionalProperties: false
              },
              sets: {
                type: "array",
                items: {
                  type: "object",
                  properties: {
                    movement: { type: "string" },
                    sets: { anyOf: [{ type: "number" }, { type: "null" }] },
                    reps: { anyOf: [{ type: "string" }, { type: "null" }] },
                    repScheme: { anyOf: [{ type: "string" }, { type: "null" }] },
                    weightKg: { anyOf: [{ type: "number" }, { type: "null" }] },
                    timeCapMinutes: { anyOf: [{ type: "number" }, { type: "null" }] },
                    restMinutes: { anyOf: [{ type: "number" }, { type: "null" }] },
                    notes: { anyOf: [{ type: "string" }, { type: "null" }] }
                  },
                  required: ["movement", "sets", "reps", "repScheme", "weightKg", "timeCapMinutes", "restMinutes", "notes"],
                  additionalProperties: false
                }
              },
              notes: { anyOf: [{ type: "string" }, { type: "null" }] }
            },
            required: ["title", "est_duration_min", "intensity", "confidence", "request", "sets", "notes"],
            additionalProperties: false
          },
          strict: true
        }
      },
      messages: [
        {
          role: "system",
          content: `Parse workout description into structured JSON matching the schema. Extract:
- title: descriptive workout name
- est_duration_min: estimated duration 
- intensity: 1-10 scale
- confidence: 0-1 parsing confidence
- request: {category, durationMinutes, intensity} 
- sets: array of exercises with movement, sets, reps, weight, etc
- notes: additional observations

Categories: strength, cardio, crossfit, yoga, sports, other
Use reasonable estimates when data is missing.`
        },
        { role: "user", content: text2 }
      ]
    });
    const parsed = JSON.parse(r4.choices?.[0]?.message?.content ?? "{}");
    res.json({ parsed, success: true });
  } catch (e2) {
    console.error("[dev/parse] err", e2);
    if (e2?.message?.includes("Rate limit")) {
      return res.status(429).json({ error: "Rate limit exceeded. Please try again later." });
    }
    res.status(500).json({ error: e2?.message || "parse failed" });
  }
});
router.post("/log-freeform", requireAuth, async (req, res) => {
  const authReq = req;
  const sb = supabaseFromReq(req);
  const { parsed, title } = req.body ?? {};
  if (!parsed) {
    return res.status(400).json({ error: "parsed required" });
  }
  try {
    const { data: user, error: authError } = await sb.auth.getUser();
    if (authError || !user?.user) {
      return res.status(401).json({ error: "Unauthorized" });
    }
    const transformedSets = parsed.sets?.map((set, index2) => ({
      id: `freeform-${index2}`,
      exercise: set.movement,
      weight: set.weightKg ? Math.round(set.weightKg * 2.20462 * 2) / 2 : void 0,
      // kg to lbs
      reps: set.reps,
      duration: set.timeCapMinutes ? set.timeCapMinutes * 60 : void 0,
      // minutes to seconds
      restTime: set.restMinutes ? set.restMinutes * 60 : void 0,
      // minutes to seconds
      notes: set.notes,
      repScheme: set.repScheme,
      timeCapMinutes: set.timeCapMinutes
    })) || [];
    const { data, error } = await sb.from("workouts").insert({
      user_id: user.user.id,
      title: title || parsed.title || "Freeform workout",
      request: {
        category: parsed.request?.category || "other",
        durationMinutes: parsed.request?.durationMinutes || parsed.est_duration_min || 30,
        intensity: parsed.request?.intensity || parsed.intensity || 5
      },
      sets: transformedSets,
      notes: parsed.notes || null,
      completed: true,
      feedback: {
        source: "freeform",
        confidence: parsed.confidence || 0.8
      }
    }).select("id").single();
    if (error) {
      console.error("[dev/log] db error:", error);
      return res.status(400).json({ error: error.message });
    }
    res.json({ id: data.id, success: true });
  } catch (e2) {
    console.error("[dev/log] err", e2);
    res.status(500).json({ error: e2?.message || "log failed" });
  }
});
router.post("/:id/feedback", requireAuth, async (req, res) => {
  try {
    const authReq = req;
    const userId = authReq.user.id;
    const workoutId = req.params.id;
    const { insertWorkoutFeedbackSchema: insertWorkoutFeedbackSchema2 } = await Promise.resolve().then(() => (init_schema(), schema_exports));
    const validationResult = insertWorkoutFeedbackSchema2.safeParse({
      workoutId,
      userId,
      perceivedIntensity: req.body.perceivedIntensity,
      notes: req.body.notes
    });
    if (!validationResult.success) {
      return res.status(400).json({
        error: "Invalid feedback data",
        details: validationResult.error.issues
      });
    }
    const { perceivedIntensity, notes } = validationResult.data;
    const { getWorkout: getWorkout2, insertWorkoutFeedback: insertWorkoutFeedback2 } = await Promise.resolve().then(() => (init_workouts(), workouts_exports));
    const workout = await getWorkout2(userId, workoutId);
    if (!workout) {
      return res.status(404).json({ error: "Workout not found" });
    }
    let feedback;
    try {
      feedback = await insertWorkoutFeedback2({
        workoutId,
        userId,
        perceivedIntensity,
        notes: notes || ""
      });
    } catch (error) {
      if (error.message.includes("Feedback already submitted for this workout")) {
        return res.status(409).json({
          error: "Feedback already submitted for this workout"
        });
      }
      throw error;
    }
    try {
      const { logFeedbackEvent: logFeedbackEvent2 } = await Promise.resolve().then(() => (init_telemetry(), telemetry_exports));
      const generationId = workout.generationId || "unknown";
      await logFeedbackEvent2(userId, workoutId, generationId, {
        feedbackType: "rpe",
        rpe: perceivedIntensity,
        comments: notes || void 0
      });
    } catch (telemetryError) {
      console.warn("Failed to log telemetry for feedback:", telemetryError);
    }
    res.json({ success: true, feedback });
  } catch (error) {
    console.error("Failed to save workout feedback:", error);
    res.status(500).json({ error: "Failed to save feedback" });
  }
});
var workout_freeform_default = router;

// server/routes/whisper-transcription.ts
import { Router as Router3 } from "express";
import multer from "multer";
var upload = multer({
  storage: multer.memoryStorage(),
  limits: { fileSize: 25 * 1024 * 1024 }
  // 25MB limit
});
var rateLimitMap = /* @__PURE__ */ new Map();
var RATE_LIMIT_WINDOW = 60 * 1e3;
var RATE_LIMIT_MAX = 10;
var checkRateLimit = (userId) => {
  const now = Date.now();
  const userLimit = rateLimitMap.get(userId);
  if (!userLimit || now > userLimit.resetTime) {
    rateLimitMap.set(userId, { count: 1, resetTime: now + RATE_LIMIT_WINDOW });
    return true;
  }
  if (userLimit.count >= RATE_LIMIT_MAX) {
    return false;
  }
  userLimit.count++;
  return true;
};
var router2 = Router3();
router2.post("/whisper", requireAuth, async (req, res, next) => {
  const ct = req.headers["content-type"] || "";
  if (!ct.includes("application/json")) {
    return next("route");
  }
  const authReq = req;
  const userId = authReq.user.id;
  try {
    if (!checkRateLimit(userId)) {
      return res.status(429).json({ error: "Rate limit exceeded. Please wait before trying again." });
    }
    const { audioBase64, mimeType } = req.body ?? {};
    if (!audioBase64) {
      return res.status(400).json({ error: "audioBase64 required" });
    }
    const buf = Buffer.from(audioBase64, "base64");
    if (buf.length > 25 * 1024 * 1024) {
      return res.status(400).json({ error: "Audio file too large (max 25MB)" });
    }
    const file = new File([buf], "audio.webm", {
      type: mimeType || "audio/webm"
    });
    const r4 = await openai3.audio.transcriptions.create({
      file,
      model: "whisper-1",
      language: "en",
      response_format: "json"
    });
    res.json({
      transcript: r4.text ?? "",
      success: true
    });
  } catch (e2) {
    console.error("[dev whisper/json] err", e2);
    if (e2?.status) {
      switch (e2.status) {
        case 429:
          return res.status(429).json({ error: "OpenAI rate limit exceeded. Please try again later." });
        case 402:
          return res.status(402).json({ error: "OpenAI quota exceeded. Please contact support." });
        case 400:
          return res.status(400).json({ error: "Invalid audio format or file. Please try a different recording." });
        default:
          return res.status(500).json({ error: e2?.message || "transcription failed" });
      }
    }
    res.status(500).json({ error: e2?.message || "transcription failed" });
  }
});
router2.post("/whisper", requireAuth, upload.single("audio"), async (req, res) => {
  const authReq = req;
  const userId = authReq.user.id;
  try {
    if (!checkRateLimit(userId)) {
      return res.status(429).json({ error: "Rate limit exceeded. Please wait before trying again." });
    }
    const f2 = req.file;
    if (!f2) {
      return res.status(400).json({ error: "audio field required" });
    }
    if (f2.size > 25 * 1024 * 1024) {
      return res.status(400).json({ error: "Audio file too large (max 25MB)" });
    }
    const uint8Array = new Uint8Array(f2.buffer);
    const file = new File([uint8Array], f2.originalname || "audio.webm", {
      type: f2.mimetype || "audio/webm"
    });
    console.log(`\u{1F399}\uFE0F Transcribing: ${f2.originalname} (${f2.size} bytes) for user ${userId}`);
    const r4 = await openai3.audio.transcriptions.create({
      file,
      model: "whisper-1",
      language: "en",
      response_format: "json"
    });
    console.log(`\u2705 Transcription completed: "${r4.text?.substring(0, 100)}..."`);
    res.json({
      transcript: r4.text ?? "",
      success: true
    });
  } catch (e2) {
    console.error("[dev whisper/multipart] err", e2);
    if (e2 instanceof multer.MulterError) {
      if (e2.code === "LIMIT_FILE_SIZE") {
        return res.status(400).json({ error: "Audio file too large (max 25MB)" });
      }
      return res.status(400).json({ error: `File upload error: ${e2.message}` });
    }
    if (e2?.status) {
      switch (e2.status) {
        case 429:
          return res.status(429).json({ error: "OpenAI rate limit exceeded. Please try again later." });
        case 402:
          return res.status(402).json({ error: "OpenAI quota exceeded. Please contact support." });
        case 400:
          return res.status(400).json({ error: "Invalid audio format or file. Please try a different recording." });
        default:
          return res.status(500).json({ error: e2?.message || "transcription failed" });
      }
    }
    res.status(500).json({ error: e2?.message || "transcription failed" });
  }
});
var whisper_transcription_default = router2;

// server/middleware/requireAuth.ts
init_supabaseAdmin();
async function requireAuth2(req, res, next) {
  try {
    const authHeader = req.headers.authorization;
    if (!authHeader || !authHeader.startsWith("Bearer ")) {
      res.status(401).json({ error: "Missing or invalid authorization header" });
      return;
    }
    const token = authHeader.substring(7);
    const { data: user, error } = await supabaseAdmin.auth.getUser(token);
    if (error || !user?.user) {
      res.status(401).json({ error: "Invalid or expired token" });
      return;
    }
    req.user = {
      id: user.user.id,
      email: user.user.email || ""
    };
    next();
  } catch (error) {
    console.error("Auth middleware error:", error);
    res.status(500).json({ error: "Internal server error during authentication" });
  }
}

// server/middleware/reactionRateLimit.ts
var reactionAttempts = /* @__PURE__ */ new Map();
var RATE_LIMIT_WINDOW_MS = 60 * 1e3;
var MAX_REACTIONS_PER_WINDOW = 20;
var CLEANUP_INTERVAL_MS = 5 * 60 * 1e3;
setInterval(() => {
  const now = Date.now();
  const userIds = Array.from(reactionAttempts.keys());
  for (const userId of userIds) {
    const tracker = reactionAttempts.get(userId);
    if (tracker) {
      tracker.attempts = tracker.attempts.filter(
        (attempt) => now - attempt < RATE_LIMIT_WINDOW_MS
      );
      if (tracker.attempts.length === 0) {
        reactionAttempts.delete(userId);
      }
    }
  }
}, CLEANUP_INTERVAL_MS);
function reactionRateLimit(req, res, next) {
  const userId = req.user?.id;
  if (!userId) {
    return res.status(401).json({
      message: "User not authenticated"
    });
  }
  const now = Date.now();
  let tracker = reactionAttempts.get(userId);
  if (!tracker) {
    tracker = { attempts: [], windowStart: now };
    reactionAttempts.set(userId, tracker);
  }
  tracker.attempts = tracker.attempts.filter(
    (attempt) => now - attempt < RATE_LIMIT_WINDOW_MS
  );
  if (tracker.attempts.length >= MAX_REACTIONS_PER_WINDOW) {
    const oldestAttempt = Math.min(...tracker.attempts);
    const timeUntilReset = RATE_LIMIT_WINDOW_MS - (now - oldestAttempt);
    return res.status(429).json({
      message: "Rate limit exceeded",
      details: `Too many reactions. You can react ${MAX_REACTIONS_PER_WINDOW} times per minute.`,
      retryAfter: Math.ceil(timeUntilReset / 1e3),
      rateLimitInfo: {
        max: MAX_REACTIONS_PER_WINDOW,
        windowMs: RATE_LIMIT_WINDOW_MS,
        current: tracker.attempts.length,
        resetTime: new Date(now + timeUntilReset).toISOString()
      }
    });
  }
  tracker.attempts.push(now);
  res.setHeader("X-RateLimit-Limit", MAX_REACTIONS_PER_WINDOW);
  res.setHeader("X-RateLimit-Remaining", Math.max(0, MAX_REACTIONS_PER_WINDOW - tracker.attempts.length));
  res.setHeader("X-RateLimit-Reset", new Date(now + RATE_LIMIT_WINDOW_MS).toISOString());
  next();
}

// server/dal/groups.ts
init_db();
init_schema();
import { eq as eq4, and as and4, desc as desc4, asc, gte as gte3, sql as sql4 } from "drizzle-orm";
async function setUserContext(userId) {
  const database = db;
  try {
    await database.execute(sql4.raw(`SET LOCAL app.user_id = '${userId}'`));
  } catch (error) {
    console.error("[DAL:groups] Failed to set user context for RLS:", {
      userId,
      error: error instanceof Error ? error.message : String(error),
      hint: "This may indicate a database connection issue or missing DATABASE_URL environment variable"
    });
    throw new Error(`Database connection failed: ${error instanceof Error ? error.message : "Unknown error"}`);
  }
}
async function createGroup(userId, params) {
  const database = db;
  await setUserContext(userId);
  const groupResult = await database.insert(groups).values({
    name: params.name,
    description: params.description,
    isPublic: params.isPublic,
    photoUrl: params.photoUrl,
    ownerId: userId
  }).returning();
  if (!groupResult[0]) {
    throw new Error("Failed to create group");
  }
  await database.insert(groupMembers).values({
    groupId: groupResult[0].id,
    userId,
    role: "owner"
  });
  return groupResult[0];
}
async function getUserGroups(userId) {
  const database = db;
  try {
    await setUserContext(userId);
    const userGroups = await database.select({
      id: groups.id,
      name: groups.name,
      description: groups.description,
      photoUrl: groups.photoUrl,
      isPublic: groups.isPublic,
      ownerId: groups.ownerId,
      createdAt: groups.createdAt,
      role: groupMembers.role,
      joinedAt: groupMembers.joinedAt
    }).from(groups).innerJoin(groupMembers, eq4(groups.id, groupMembers.groupId)).where(eq4(groupMembers.userId, userId)).orderBy(desc4(groupMembers.joinedAt));
    return userGroups;
  } catch (error) {
    console.error("[DAL:groups:getUserGroups] Failed to fetch user groups:", {
      userId,
      error: error instanceof Error ? error.message : String(error),
      stack: error instanceof Error ? error.stack : void 0,
      hint: "Check DATABASE_URL, SUPABASE_URL, and SUPABASE_SERVICE_ROLE_KEY environment variables"
    });
    throw error;
  }
}
async function deleteGroupPost(userId, groupId, postId) {
  const database = db;
  await setUserContext(userId);
  const membership = await database.select({ role: groupMembers.role }).from(groupMembers).where(
    and4(
      eq4(groupMembers.groupId, groupId),
      eq4(groupMembers.userId, userId)
    )
  );
  if (!membership[0] || !["owner", "admin"].includes(membership[0].role)) {
    throw new Error("Only owners and admins can delete posts");
  }
  const deleted = await database.delete(groupPosts).where(
    and4(
      eq4(groupPosts.groupId, groupId),
      eq4(groupPosts.postId, postId)
    )
  ).returning();
  if (deleted.length === 0) {
    throw new Error("Post not found in this group");
  }
  await database.delete(groupReactions).where(
    and4(
      eq4(groupReactions.groupId, groupId),
      eq4(groupReactions.postId, postId)
    )
  );
  return { success: true };
}
async function removeMemberFromGroup(userId, groupId, targetUserId) {
  const database = db;
  await setUserContext(userId);
  const membership = await database.select({ role: groupMembers.role }).from(groupMembers).where(
    and4(
      eq4(groupMembers.groupId, groupId),
      eq4(groupMembers.userId, userId)
    )
  );
  if (!membership[0] || !["owner", "admin"].includes(membership[0].role)) {
    throw new Error("Only owners and admins can remove members");
  }
  const targetMembership = await database.select({ role: groupMembers.role }).from(groupMembers).where(
    and4(
      eq4(groupMembers.groupId, groupId),
      eq4(groupMembers.userId, targetUserId)
    )
  );
  if (targetMembership[0]?.role === "owner") {
    throw new Error("Cannot remove the group owner");
  }
  const removed = await database.delete(groupMembers).where(
    and4(
      eq4(groupMembers.groupId, groupId),
      eq4(groupMembers.userId, targetUserId)
    )
  ).returning();
  if (removed.length === 0) {
    throw new Error("Member not found in this group");
  }
  return { success: true };
}
async function getGroupProfile(userId, groupId) {
  const database = db;
  await setUserContext(userId);
  const groupInfo = await database.select({
    id: groups.id,
    name: groups.name,
    description: groups.description,
    photoUrl: groups.photoUrl,
    isPublic: groups.isPublic,
    ownerId: groups.ownerId,
    createdAt: groups.createdAt,
    userRole: groupMembers.role
  }).from(groups).leftJoin(
    groupMembers,
    and4(
      eq4(groups.id, groupMembers.groupId),
      eq4(groupMembers.userId, userId)
    )
  ).where(eq4(groups.id, groupId)).limit(1);
  if (!groupInfo[0]) {
    return null;
  }
  const memberCount = await database.select({ count: sql4`count(*)` }).from(groupMembers).where(eq4(groupMembers.groupId, groupId));
  const postCount = await database.select({ count: sql4`count(*)` }).from(groupPosts).where(eq4(groupPosts.groupId, groupId));
  return {
    ...groupInfo[0],
    memberCount: memberCount[0]?.count || 0,
    postCount: postCount[0]?.count || 0
  };
}
async function joinGroup(userId, groupId, inviteCode) {
  const database = db;
  await setUserContext(userId);
  const group = await database.select().from(groups).where(eq4(groups.id, groupId)).limit(1);
  if (!group[0]) {
    throw new Error("Group not found");
  }
  const existingMember = await database.select().from(groupMembers).where(
    and4(
      eq4(groupMembers.groupId, groupId),
      eq4(groupMembers.userId, userId)
    )
  ).limit(1);
  if (existingMember[0]) {
    throw new Error("Already a member of this group");
  }
  if (!group[0].isPublic) {
    if (!inviteCode) {
      throw new Error("Invite code required for private group");
    }
    const invite = await database.select().from(groupInvites).where(
      and4(
        eq4(groupInvites.code, inviteCode),
        eq4(groupInvites.groupId, groupId),
        gte3(groupInvites.expiresAt, /* @__PURE__ */ new Date())
      )
    ).limit(1);
    if (!invite[0]) {
      throw new Error("Invalid or expired invite code");
    }
  }
  const newMember = await database.insert(groupMembers).values({
    groupId,
    userId,
    role: "member"
  }).returning();
  return newMember[0];
}
async function leaveGroup(userId, groupId) {
  const database = db;
  await setUserContext(userId);
  const membership = await database.select().from(groupMembers).where(
    and4(
      eq4(groupMembers.groupId, groupId),
      eq4(groupMembers.userId, userId)
    )
  ).limit(1);
  if (!membership[0]) {
    throw new Error("Not a member of this group");
  }
  if (membership[0].role === "owner") {
    const ownerCount = await database.select({ count: sql4`count(*)` }).from(groupMembers).where(
      and4(
        eq4(groupMembers.groupId, groupId),
        eq4(groupMembers.role, "owner")
      )
    );
    if (ownerCount[0]?.count === 1) {
      throw new Error("Cannot leave group as last owner. Transfer ownership first.");
    }
  }
  await database.delete(groupMembers).where(
    and4(
      eq4(groupMembers.groupId, groupId),
      eq4(groupMembers.userId, userId)
    )
  );
  return { success: true };
}
async function createGroupInvite(userId, groupId, invitedEmail) {
  const database = db;
  const membership = await database.select().from(groupMembers).where(
    and4(
      eq4(groupMembers.groupId, groupId),
      eq4(groupMembers.userId, userId)
    )
  ).limit(1);
  if (!membership[0] || !["owner", "admin"].includes(membership[0].role)) {
    throw new Error("Only group owners and admins can create invites");
  }
  const code = Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15);
  const invite = await database.insert(groupInvites).values({
    groupId,
    code,
    invitedEmail,
    createdBy: userId
  }).returning();
  return invite[0];
}
async function acceptInvite(userId, inviteCode) {
  const database = db;
  const invite = await database.select().from(groupInvites).where(
    and4(
      eq4(groupInvites.code, inviteCode),
      gte3(groupInvites.expiresAt, /* @__PURE__ */ new Date())
    )
  ).limit(1);
  if (!invite[0]) {
    throw new Error("Invalid or expired invite code");
  }
  await setUserContext(userId);
  const existingMember = await database.select().from(groupMembers).where(
    and4(
      eq4(groupMembers.groupId, invite[0].groupId),
      eq4(groupMembers.userId, userId)
    )
  ).limit(1);
  if (existingMember[0]) {
    throw new Error("Already a member of this group");
  }
  const membership = await database.insert(groupMembers).values({
    groupId: invite[0].groupId,
    userId,
    role: "member"
  }).returning();
  await database.insert(referrals).values({
    referrerUserId: invite[0].createdBy,
    referredUserId: userId,
    groupId: invite[0].groupId
  });
  return {
    membership: membership[0],
    groupId: invite[0].groupId
  };
}
async function createPost(userId, params) {
  const database = db;
  await setUserContext(userId);
  const post = await database.insert(posts).values({
    userId,
    kind: params.kind,
    content: params.content
  }).returning();
  if (!post[0]) {
    throw new Error("Failed to create post");
  }
  const groupPostPromises = params.groupIds.map(
    (groupId) => database.insert(groupPosts).values({
      groupId,
      postId: post[0].id
    }).returning()
  );
  await Promise.all(groupPostPromises);
  return post[0];
}
async function getGroupFeed(userId, groupId, options = {}) {
  const database = db;
  const { after, limit = 30 } = options;
  await setUserContext(userId);
  const whereConditions = after ? and4(
    eq4(groupPosts.groupId, groupId),
    gte3(groupPosts.createdAt, new Date(after))
  ) : eq4(groupPosts.groupId, groupId);
  const query = database.select({
    id: posts.id,
    userId: posts.userId,
    kind: posts.kind,
    content: posts.content,
    createdAt: posts.createdAt,
    groupCreatedAt: groupPosts.createdAt,
    authorUsername: profiles.username,
    authorFirstName: profiles.firstName,
    authorLastName: profiles.lastName,
    authorAvatarUrl: profiles.avatarUrl
  }).from(groupPosts).innerJoin(posts, eq4(groupPosts.postId, posts.id)).innerJoin(profiles, eq4(posts.userId, profiles.userId)).where(whereConditions);
  const feed = await query.orderBy(asc(groupPosts.createdAt)).limit(limit);
  return feed;
}
async function toggleReaction(userId, params) {
  const database = db;
  await setUserContext(userId);
  const existing = await database.select().from(groupReactions).where(
    and4(
      eq4(groupReactions.groupId, params.groupId),
      eq4(groupReactions.postId, params.postId),
      eq4(groupReactions.userId, userId),
      eq4(groupReactions.emoji, params.emoji)
    )
  ).limit(1);
  if (existing[0]) {
    await database.delete(groupReactions).where(
      and4(
        eq4(groupReactions.groupId, params.groupId),
        eq4(groupReactions.postId, params.postId),
        eq4(groupReactions.userId, userId),
        eq4(groupReactions.emoji, params.emoji)
      )
    );
    return { action: "removed" };
  } else {
    const reaction = await database.insert(groupReactions).values({
      groupId: params.groupId,
      postId: params.postId,
      userId,
      emoji: params.emoji
    }).returning();
    return { action: "added", reaction: reaction[0] };
  }
}
async function getReactionSummary(userId, groupId, postId) {
  const database = db;
  await setUserContext(userId);
  const reactions = await database.select({
    emoji: groupReactions.emoji,
    count: sql4`count(*)`,
    userReacted: sql4`bool_or(${groupReactions.userId} = ${userId})`
  }).from(groupReactions).where(
    and4(
      eq4(groupReactions.groupId, groupId),
      eq4(groupReactions.postId, postId)
    )
  ).groupBy(groupReactions.emoji);
  return reactions;
}
async function upsertRsvp(userId, params) {
  const database = db;
  await setUserContext(userId);
  const existing = await database.select().from(groupEventRsvps).where(
    and4(
      eq4(groupEventRsvps.groupId, params.groupId),
      eq4(groupEventRsvps.postId, params.postId),
      eq4(groupEventRsvps.userId, userId)
    )
  ).limit(1);
  if (existing[0]) {
    const updated = await database.update(groupEventRsvps).set({ status: params.status }).where(
      and4(
        eq4(groupEventRsvps.groupId, params.groupId),
        eq4(groupEventRsvps.postId, params.postId),
        eq4(groupEventRsvps.userId, userId)
      )
    ).returning();
    return { action: "updated", rsvp: updated[0] };
  } else {
    const rsvp = await database.insert(groupEventRsvps).values({
      groupId: params.groupId,
      postId: params.postId,
      userId,
      status: params.status
    }).returning();
    return { action: "created", rsvp: rsvp[0] };
  }
}
async function removeRsvp(userId, groupId, postId) {
  const database = db;
  await setUserContext(userId);
  await database.delete(groupEventRsvps).where(
    and4(
      eq4(groupEventRsvps.groupId, groupId),
      eq4(groupEventRsvps.postId, postId),
      eq4(groupEventRsvps.userId, userId)
    )
  );
  return { action: "removed" };
}
async function getPostRsvps(userId, groupId, postId) {
  const database = db;
  await setUserContext(userId);
  const rsvps = await database.select({
    userId: groupEventRsvps.userId,
    status: groupEventRsvps.status,
    createdAt: groupEventRsvps.createdAt,
    userUsername: profiles.username,
    userFirstName: profiles.firstName,
    userLastName: profiles.lastName,
    userAvatarUrl: profiles.avatarUrl
  }).from(groupEventRsvps).innerJoin(profiles, eq4(groupEventRsvps.userId, profiles.userId)).where(
    and4(
      eq4(groupEventRsvps.groupId, groupId),
      eq4(groupEventRsvps.postId, postId)
    )
  ).orderBy(groupEventRsvps.createdAt);
  const grouped = {
    going: rsvps.filter((r4) => r4.status === "going"),
    maybe: rsvps.filter((r4) => r4.status === "maybe"),
    no: rsvps.filter((r4) => r4.status === "no")
  };
  return grouped;
}
async function deleteGroup(userId, groupId) {
  const database = db;
  await setUserContext(userId);
  const membership = await database.select({ role: groupMembers.role }).from(groupMembers).where(
    and4(
      eq4(groupMembers.groupId, groupId),
      eq4(groupMembers.userId, userId)
    )
  ).limit(1);
  if (!membership[0]) {
    throw new Error("Group not found or access denied");
  }
  if (membership[0].role !== "owner") {
    throw new Error("Only group owners can delete groups");
  }
  const result = await database.transaction(async (tx) => {
    await tx.delete(groupEventRsvps).where(eq4(groupEventRsvps.groupId, groupId));
    await tx.delete(groupReactions).where(eq4(groupReactions.groupId, groupId));
    await tx.delete(groupPosts).where(eq4(groupPosts.groupId, groupId));
    await tx.delete(groupInvites).where(eq4(groupInvites.groupId, groupId));
    await tx.delete(referrals).where(eq4(referrals.groupId, groupId));
    await tx.delete(groupMembers).where(eq4(groupMembers.groupId, groupId));
    const deletedGroup = await tx.delete(groups).where(eq4(groups.id, groupId)).returning();
    if (deletedGroup.length === 0) {
      throw new Error("Group not found");
    }
    return deletedGroup[0];
  });
  return { success: true, deletedGroup: result };
}
async function updateGroup(userId, groupId, updates) {
  const database = db;
  await setUserContext(userId);
  const membership = await database.select().from(groupMembers).where(and4(
    eq4(groupMembers.groupId, groupId),
    eq4(groupMembers.userId, userId),
    eq4(groupMembers.role, "owner")
  ));
  if (membership.length === 0) {
    throw new Error("Only group owners can update group details");
  }
  const updateData = {};
  if (updates.name !== void 0) updateData.name = updates.name;
  if (updates.description !== void 0) updateData.description = updates.description;
  if (updates.photoUrl !== void 0) updateData.photoUrl = updates.photoUrl;
  if (Object.keys(updateData).length === 0) {
    throw new Error("No fields to update");
  }
  const updatedGroup = await database.update(groups).set(updateData).where(eq4(groups.id, groupId)).returning();
  if (updatedGroup.length === 0) {
    throw new Error("Group not found");
  }
  return updatedGroup[0];
}
async function getGroupMembers(userId, groupId) {
  const database = db;
  await setUserContext(userId);
  const membership = await database.select().from(groupMembers).where(and4(
    eq4(groupMembers.groupId, groupId),
    eq4(groupMembers.userId, userId)
  ));
  if (membership.length === 0) {
    throw new Error("Only group members can view member list");
  }
  const members = await database.select({
    userId: groupMembers.userId,
    role: groupMembers.role,
    joinedAt: groupMembers.joinedAt,
    firstName: profiles.firstName,
    lastName: profiles.lastName,
    username: profiles.username,
    avatarUrl: profiles.avatarUrl
  }).from(groupMembers).leftJoin(profiles, eq4(groupMembers.userId, profiles.userId)).where(eq4(groupMembers.groupId, groupId)).orderBy(asc(groupMembers.role), asc(groupMembers.joinedAt));
  return members;
}
async function addMemberToGroup(userId, groupId, memberUserId, role = "member") {
  const database = db;
  await setUserContext(userId);
  const membership = await database.select().from(groupMembers).where(and4(
    eq4(groupMembers.groupId, groupId),
    eq4(groupMembers.userId, userId),
    sql4`${groupMembers.role} IN ('owner', 'admin')`
  ));
  if (membership.length === 0) {
    throw new Error("Only group owners and admins can add members");
  }
  const existingMember = await database.select().from(groupMembers).where(and4(
    eq4(groupMembers.groupId, groupId),
    eq4(groupMembers.userId, memberUserId)
  ));
  if (existingMember.length > 0) {
    throw new Error("User is already a member of this group");
  }
  const newMember = await database.insert(groupMembers).values({
    groupId,
    userId: memberUserId,
    role: role === "admin" && membership[0].role === "owner" ? "admin" : "member"
  }).returning();
  if (newMember.length === 0) {
    throw new Error("Failed to add member");
  }
  return newMember[0];
}

// server/dal/groupAchievements.ts
init_db();
init_schema();
import { eq as eq5, and as and5, desc as desc5, gte as gte4, sql as sql5, count } from "drizzle-orm";
var GROUP_ACHIEVEMENT_DEFINITIONS = {
  SQUAD_GOALS: {
    name: "Squad Goals",
    description: "25 posts in a week",
    target: 25,
    timeWindow: "7 days"
  },
  HYPE_TRAIN: {
    name: "Hype Train",
    description: "50 reactions in a week",
    target: 50,
    timeWindow: "7 days"
  },
  PR_PARTY: {
    name: "PR Party",
    description: "5 PR shares in a month",
    target: 5,
    timeWindow: "30 days"
  }
};
async function computeSquadGoalsProgress(groupId) {
  const oneWeekAgo = /* @__PURE__ */ new Date();
  oneWeekAgo.setDate(oneWeekAgo.getDate() - 7);
  const result = await db.select({ count: count() }).from(groupPosts).innerJoin(posts, eq5(groupPosts.postId, posts.id)).where(
    and5(
      eq5(groupPosts.groupId, groupId),
      gte4(posts.createdAt, oneWeekAgo)
    )
  );
  const postCount = result[0]?.count || 0;
  return Math.min(postCount / GROUP_ACHIEVEMENT_DEFINITIONS.SQUAD_GOALS.target, 1);
}
async function computeHypeTrainProgress(groupId) {
  const oneWeekAgo = /* @__PURE__ */ new Date();
  oneWeekAgo.setDate(oneWeekAgo.getDate() - 7);
  const result = await db.select({ count: count() }).from(groupReactions).where(
    and5(
      eq5(groupReactions.groupId, groupId),
      gte4(groupReactions.createdAt, oneWeekAgo)
    )
  );
  const reactionCount = result[0]?.count || 0;
  return Math.min(reactionCount / GROUP_ACHIEVEMENT_DEFINITIONS.HYPE_TRAIN.target, 1);
}
async function computePrPartyProgress(groupId) {
  const oneMonthAgo = /* @__PURE__ */ new Date();
  oneMonthAgo.setDate(oneMonthAgo.getDate() - 30);
  const result = await db.select({ count: count() }).from(groupPosts).innerJoin(posts, eq5(groupPosts.postId, posts.id)).where(
    and5(
      eq5(groupPosts.groupId, groupId),
      eq5(posts.kind, "pr"),
      gte4(posts.createdAt, oneMonthAgo)
    )
  );
  const prCount = result[0]?.count || 0;
  return Math.min(prCount / GROUP_ACHIEVEMENT_DEFINITIONS.PR_PARTY.target, 1);
}
async function computeGroupAchievements(groupId) {
  const [squadGoalsProgress, hypeTrainProgress, prPartyProgress] = await Promise.all([
    computeSquadGoalsProgress(groupId),
    computeHypeTrainProgress(groupId),
    computePrPartyProgress(groupId)
  ]);
  return [
    {
      name: GROUP_ACHIEVEMENT_DEFINITIONS.SQUAD_GOALS.name,
      description: GROUP_ACHIEVEMENT_DEFINITIONS.SQUAD_GOALS.description,
      progress: squadGoalsProgress,
      unlocked: squadGoalsProgress >= 1
    },
    {
      name: GROUP_ACHIEVEMENT_DEFINITIONS.HYPE_TRAIN.name,
      description: GROUP_ACHIEVEMENT_DEFINITIONS.HYPE_TRAIN.description,
      progress: hypeTrainProgress,
      unlocked: hypeTrainProgress >= 1
    },
    {
      name: GROUP_ACHIEVEMENT_DEFINITIONS.PR_PARTY.name,
      description: GROUP_ACHIEVEMENT_DEFINITIONS.PR_PARTY.description,
      progress: prPartyProgress,
      unlocked: prPartyProgress >= 1
    }
  ];
}
async function upsertGroupAchievements(groupId, achievements2) {
  const insertData = achievements2.map((achievement) => ({
    groupId,
    name: achievement.name,
    description: achievement.description,
    progress: achievement.progress.toString(),
    // Convert to string for numeric field
    unlocked: achievement.unlocked,
    updatedAt: /* @__PURE__ */ new Date()
  }));
  await db.insert(groupAchievements).values(insertData).onConflictDoUpdate({
    target: [groupAchievements.groupId, groupAchievements.name],
    set: {
      progress: sql5`excluded.progress`,
      unlocked: sql5`excluded.unlocked`,
      updatedAt: sql5`excluded.updated_at`
    }
  });
}
async function getGroupAchievements(groupId) {
  return await db.select().from(groupAchievements).where(eq5(groupAchievements.groupId, groupId)).orderBy(desc5(groupAchievements.updatedAt));
}
async function recomputeAndUpdateGroupAchievements(groupId) {
  const currentAchievements = await getGroupAchievements(groupId);
  const currentUnlocked = new Set(
    currentAchievements.filter((a2) => a2.unlocked).map((a2) => a2.name)
  );
  const newAchievements = await computeGroupAchievements(groupId);
  const newlyUnlocked = newAchievements.filter(
    (achievement) => achievement.unlocked && !currentUnlocked.has(achievement.name)
  );
  await upsertGroupAchievements(groupId, newAchievements);
  return { newlyUnlocked };
}

// server/routes/groups.ts
init_schema();
import { z as z7 } from "zod";
function handleGroupError(res, error, defaultMessage) {
  console.error(`[Groups API] ${defaultMessage}:`, error);
  if (error instanceof Error && error.message.includes("Groups feature unavailable")) {
    return res.status(503).json({
      message: "Groups feature unavailable",
      error: "This feature requires DATABASE_URL to be configured. Please contact your administrator.",
      feature: "groups"
    });
  }
  if (error instanceof z7.ZodError) {
    return res.status(400).json({
      message: "Invalid input",
      errors: error.errors
    });
  }
  return res.status(500).json({
    message: defaultMessage,
    error: error instanceof Error ? error.message : "Unknown error"
  });
}
function registerGroupRoutes(app2) {
  app2.get("/api/groups", requireAuth2, async (req, res) => {
    try {
      const authReq = req;
      const userId = authReq.user.id;
      const groups3 = await getUserGroups(userId);
      res.json(groups3);
    } catch (error) {
      handleGroupError(res, error, "Failed to fetch groups");
    }
  });
  app2.post("/api/groups", requireAuth2, async (req, res) => {
    try {
      const authReq = req;
      const userId = authReq.user.id;
      const createGroupData = insertGroupSchema.parse(req.body);
      const group = await createGroup(userId, {
        name: createGroupData.name,
        description: createGroupData.description || void 0,
        isPublic: createGroupData.isPublic ?? false,
        photoUrl: createGroupData.photoUrl || void 0
      });
      res.status(201).json(group);
    } catch (error) {
      handleGroupError(res, error, "Failed to create group");
    }
  });
  app2.get("/api/groups/mine", requireAuth2, async (req, res) => {
    try {
      const authReq = req;
      const userId = authReq.user.id;
      const groups3 = await getUserGroups(userId);
      res.json(groups3);
    } catch (error) {
      handleGroupError(res, error, "Failed to fetch groups");
    }
  });
  app2.get("/api/groups/:id", requireAuth2, async (req, res) => {
    try {
      const authReq = req;
      const userId = authReq.user.id;
      const { id: groupId } = req.params;
      const groupProfile = await getGroupProfile(userId, groupId);
      if (!groupProfile) {
        return res.status(404).json({ message: "Group not found" });
      }
      res.json(groupProfile);
    } catch (error) {
      handleGroupError(res, error, "Failed to fetch group profile");
    }
  });
  app2.post("/api/groups/:id/members", requireAuth2, async (req, res) => {
    try {
      const authReq = req;
      const userId = authReq.user.id;
      const { id: groupId } = req.params;
      const { inviteCode } = req.body;
      const membership = await joinGroup(userId, groupId, inviteCode);
      res.status(201).json(membership);
    } catch (error) {
      handleGroupError(res, error, "Failed to join group");
    }
  });
  app2.delete("/api/groups/:id/members", requireAuth2, async (req, res) => {
    try {
      const authReq = req;
      const userId = authReq.user.id;
      const { id: groupId } = req.params;
      const result = await leaveGroup(userId, groupId);
      res.json(result);
    } catch (error) {
      handleGroupError(res, error, "Failed to leave group");
    }
  });
  const updateGroupSchema = z7.object({
    name: z7.string().min(1).max(100).optional(),
    description: z7.string().max(500).optional(),
    photoUrl: z7.string().url().optional()
  });
  app2.patch("/api/groups/:id", requireAuth2, async (req, res) => {
    try {
      const authReq = req;
      const userId = authReq.user.id;
      const { id: groupId } = req.params;
      const validatedData = updateGroupSchema.parse(req.body);
      const updatedGroup = await updateGroup(userId, groupId, validatedData);
      res.json(updatedGroup);
    } catch (error) {
      handleGroupError(res, error, "Failed to update group");
    }
  });
  app2.get("/api/groups/:id/members", requireAuth2, async (req, res) => {
    try {
      const authReq = req;
      const userId = authReq.user.id;
      const { id: groupId } = req.params;
      const members = await getGroupMembers(userId, groupId);
      res.json(members);
    } catch (error) {
      handleGroupError(res, error, "Failed to fetch group members");
    }
  });
  const addMemberSchema = z7.object({
    userId: z7.string().uuid(),
    role: z7.enum(["member", "admin"]).optional()
  });
  app2.post("/api/groups/:id/members/admin-add", requireAuth2, async (req, res) => {
    try {
      const authReq = req;
      const userId = authReq.user.id;
      const { id: groupId } = req.params;
      const validatedData = addMemberSchema.parse(req.body);
      const newMember = await addMemberToGroup(userId, groupId, validatedData.userId, validatedData.role);
      res.status(201).json(newMember);
    } catch (error) {
      handleGroupError(res, error, "Failed to add member");
    }
  });
  app2.post("/api/invites/:groupId", requireAuth2, async (req, res) => {
    try {
      const authReq = req;
      const userId = authReq.user.id;
      const { groupId } = req.params;
      const { invitedEmail } = req.body;
      const invite = await createGroupInvite(userId, groupId, invitedEmail);
      res.status(201).json(invite);
    } catch (error) {
      handleGroupError(res, error, "Failed to create invite");
    }
  });
  app2.post("/api/invites/accept", requireAuth2, async (req, res) => {
    try {
      const authReq = req;
      const userId = authReq.user.id;
      const { code } = req.body;
      if (!code) {
        return res.status(400).json({ message: "Invite code is required" });
      }
      const result = await acceptInvite(userId, code);
      res.json(result);
    } catch (error) {
      handleGroupError(res, error, "Failed to accept invite");
    }
  });
  app2.post("/api/posts", requireAuth2, async (req, res) => {
    try {
      const authReq = req;
      const userId = authReq.user.id;
      const schema = z7.object({
        kind: z7.enum(["text", "workout", "pr", "event"]),
        content: z7.record(z7.any()),
        groupIds: z7.array(z7.string().uuid())
      });
      const { kind, content, groupIds } = schema.parse(req.body);
      if (groupIds.length === 0) {
        return res.status(400).json({ message: "At least one group must be selected" });
      }
      const post = await createPost(userId, { kind, content, groupIds });
      groupIds.forEach(async (groupId) => {
        try {
          const result = await recomputeAndUpdateGroupAchievements(groupId);
          if (result.newlyUnlocked.length > 0) {
            console.log(`New achievements unlocked for group ${groupId}:`, result.newlyUnlocked);
          }
        } catch (error) {
          console.error(`Failed to update group achievements for group ${groupId}:`, error);
        }
      });
      res.status(201).json(post);
    } catch (error) {
      handleGroupError(res, error, "Failed to create post");
    }
  });
  app2.get("/api/groups/:id/feed", requireAuth2, async (req, res) => {
    try {
      const authReq = req;
      const userId = authReq.user.id;
      const { id: groupId } = req.params;
      const { after, limit } = req.query;
      const options = {
        after: after ? String(after) : void 0,
        limit: limit ? parseInt(String(limit), 10) : void 0
      };
      const feed = await getGroupFeed(userId, groupId, options);
      res.json(feed);
    } catch (error) {
      handleGroupError(res, error, "Failed to fetch group feed");
    }
  });
  app2.post("/api/reactions", requireAuth2, reactionRateLimit, async (req, res) => {
    try {
      const authReq = req;
      const userId = authReq.user.id;
      const schema = z7.object({
        groupId: z7.string().uuid(),
        postId: z7.string().uuid(),
        emoji: z7.string().min(1)
      });
      const params = schema.parse(req.body);
      const result = await toggleReaction(userId, params);
      try {
        const result2 = await recomputeAndUpdateGroupAchievements(params.groupId);
        if (result2.newlyUnlocked.length > 0) {
          console.log(`New achievements unlocked for group ${params.groupId}:`, result2.newlyUnlocked);
        }
      } catch (error) {
        console.error(`Failed to update group achievements for group ${params.groupId}:`, error);
      }
      res.json(result);
    } catch (error) {
      handleGroupError(res, error, "Failed to toggle reaction");
    }
  });
  app2.delete("/api/reactions", requireAuth2, reactionRateLimit, async (req, res) => {
    try {
      const authReq = req;
      const userId = authReq.user.id;
      const schema = z7.object({
        groupId: z7.string().uuid(),
        postId: z7.string().uuid(),
        emoji: z7.string().min(1)
      });
      const params = schema.parse(req.body);
      const result = await toggleReaction(userId, params);
      try {
        const result2 = await recomputeAndUpdateGroupAchievements(params.groupId);
        if (result2.newlyUnlocked.length > 0) {
          console.log(`New achievements unlocked for group ${params.groupId}:`, result2.newlyUnlocked);
        }
      } catch (error) {
        console.error(`Failed to update group achievements for group ${params.groupId}:`, error);
      }
      res.json(result);
    } catch (error) {
      handleGroupError(res, error, "Failed to remove reaction");
    }
  });
  app2.get("/api/groups/:id/reactions", requireAuth2, async (req, res) => {
    try {
      const authReq = req;
      const userId = authReq.user.id;
      const { id: groupId } = req.params;
      const { post_id: postId } = req.query;
      if (!postId) {
        return res.status(400).json({ message: "post_id query parameter is required" });
      }
      if (String(postId).startsWith("temp-")) {
        return res.json([]);
      }
      const reactions = await getReactionSummary(userId, groupId, String(postId));
      res.json(reactions);
    } catch (error) {
      handleGroupError(res, error, "Failed to fetch reaction summary");
    }
  });
  app2.post("/api/groups/:groupId/posts/:postId/rsvp", requireAuth2, async (req, res) => {
    try {
      const authReq = req;
      const userId = authReq.user.id;
      const { groupId, postId } = req.params;
      const { status } = req.body;
      const validStatuses = ["going", "maybe", "no"];
      if (!validStatuses.includes(status)) {
        return res.status(400).json({
          message: "Invalid RSVP status. Must be 'going', 'maybe', or 'no'"
        });
      }
      const result = await upsertRsvp(userId, { groupId, postId, status });
      res.json(result);
    } catch (error) {
      handleGroupError(res, error, "Failed to update RSVP");
    }
  });
  app2.delete("/api/groups/:groupId/posts/:postId/rsvp", requireAuth2, async (req, res) => {
    try {
      const authReq = req;
      const userId = authReq.user.id;
      const { groupId, postId } = req.params;
      const result = await removeRsvp(userId, groupId, postId);
      res.json(result);
    } catch (error) {
      handleGroupError(res, error, "Failed to remove RSVP");
    }
  });
  app2.get("/api/groups/:groupId/posts/:postId/rsvps", requireAuth2, async (req, res) => {
    try {
      const authReq = req;
      const userId = authReq.user.id;
      const { groupId, postId } = req.params;
      const rsvps = await getPostRsvps(userId, groupId, postId);
      res.json(rsvps);
    } catch (error) {
      handleGroupError(res, error, "Failed to fetch RSVPs");
    }
  });
  app2.get("/api/groups/:id/achievements", requireAuth2, async (req, res) => {
    try {
      const { id: groupId } = req.params;
      const achievements2 = await getGroupAchievements(groupId);
      res.json(achievements2);
    } catch (error) {
      handleGroupError(res, error, "Failed to fetch group achievements");
    }
  });
  app2.delete("/api/groups/:groupId/posts/:postId", requireAuth2, async (req, res) => {
    try {
      const authReq = req;
      const userId = authReq.user.id;
      const { groupId, postId } = req.params;
      const result = await deleteGroupPost(userId, groupId, postId);
      res.json(result);
    } catch (error) {
      handleGroupError(res, error, "Failed to delete post");
    }
  });
  app2.delete("/api/groups/:groupId/members/:userId", requireAuth2, async (req, res) => {
    try {
      const authReq = req;
      const currentUserId = authReq.user.id;
      const { groupId, userId: targetUserId } = req.params;
      const result = await removeMemberFromGroup(currentUserId, groupId, targetUserId);
      res.json(result);
    } catch (error) {
      handleGroupError(res, error, "Failed to remove member");
    }
  });
  app2.delete("/api/groups/:id", requireAuth2, async (req, res) => {
    try {
      const authReq = req;
      const userId = authReq.user.id;
      const { id: groupId } = req.params;
      const result = await deleteGroup(userId, groupId);
      res.json(result);
    } catch (error) {
      handleGroupError(res, error, "Failed to delete group");
    }
  });
  app2.get("/api/groups/:id/posts", async (req, res) => {
    const groupId = req.params.id;
    const supabase = supabaseFromReq(req);
    const since = req.query.since;
    let q = supabase.from("group_posts").select("id, group_id, author_id, body, meta, created_at").eq("group_id", groupId).order("created_at", { ascending: false }).limit(50);
    if (since) q = q.gte("created_at", since);
    const { data, error } = await q;
    if (error) return res.status(400).json({ error: error.message });
    res.json({ posts: data ?? [] });
  });
  app2.post("/api/groups/:id/posts", async (req, res) => {
    const groupId = req.params.id;
    const { body, meta } = req.body ?? {};
    if (!body || !String(body).trim()) return res.status(400).json({ error: "Body required" });
    const supabase = supabaseFromReq(req);
    const { data, error } = await supabase.from("group_posts").insert({ group_id: groupId, body: String(body).trim(), meta: meta ?? null }).select("*").single();
    if (error) return res.status(400).json({ error: error.message });
    res.status(201).json(data);
  });
}

// server/routes/workout-generation.ts
import { z as z10 } from "zod";

// client/src/ai/render.ts
function render(workout) {
  const sections = [];
  sections.push(`# ${workout.name}`);
  sections.push(`**Category:** ${workout.category}`);
  sections.push(`**Format:** ${workout.format}`);
  sections.push(`**Duration:** ${workout.duration_min} minutes`);
  sections.push(`**Intensity:** ${workout.intensity_1_to_10}/10`);
  if (workout.description) {
    sections.push(`**Description:** ${workout.description}`);
  }
  if (workout.equipment_needed && workout.equipment_needed.length > 0) {
    sections.push(`**Equipment:** ${workout.equipment_needed.join(", ")}`);
  }
  sections.push("");
  workout.blocks.forEach((block, index2) => {
    sections.push(renderBlock(block, index2 + 1));
    sections.push("");
  });
  if (workout.coaching_notes) {
    sections.push("## Coaching Notes");
    sections.push(workout.coaching_notes);
  }
  return sections.join("\n");
}
function renderBlock(block, blockNumber) {
  const sections = [];
  sections.push(`## Block ${blockNumber}: ${block.name}`);
  sections.push(`**Type:** ${block.type} | **Duration:** ~${block.estimated_duration_min} min`);
  if (block.format) {
    sections.push(`**Format:** ${block.format}`);
  }
  if (block.warmup_steps && block.warmup_steps.length > 0) {
    sections.push("**Warmup:**");
    block.warmup_steps.forEach((step, index2) => {
      const duration = Math.round(step.duration_seconds / 60 * 10) / 10;
      sections.push(`  ${index2 + 1}. ${step.movement} - ${duration}min @ ${step.intensity_percent}% intensity`);
      if (step.notes) {
        sections.push(`     *${step.notes}*`);
      }
    });
  }
  if (block.sets && block.sets.length > 0) {
    if (block.sets.length === 1) {
      sections.push("**Set:**");
    } else {
      sections.push("**Sets:**");
    }
    block.sets.forEach((set, setIndex) => {
      if (block.sets.length > 1) {
        sections.push(`  **Set ${setIndex + 1}** (${set.rounds} rounds):`);
      } else {
        sections.push(`  **${set.rounds} rounds:**`);
      }
      set.movements.forEach((movement, movIndex) => {
        sections.push(`    ${movIndex + 1}. ${renderMovement(movement)}`);
      });
      if (set.rest_between_rounds_seconds) {
        const restMin = Math.round(set.rest_between_rounds_seconds / 60 * 10) / 10;
        sections.push(`    *Rest ${restMin}min between rounds*`);
      }
      if (set.time_cap_seconds) {
        const capMin = Math.round(set.time_cap_seconds / 60 * 10) / 10;
        sections.push(`    *Time cap: ${capMin}min*`);
      }
    });
  }
  if (block.cooldown_steps && block.cooldown_steps.length > 0) {
    sections.push("**Cooldown:**");
    block.cooldown_steps.forEach((step, index2) => {
      const duration = Math.round(step.duration_seconds / 60 * 10) / 10;
      sections.push(`  ${index2 + 1}. ${step.movement} - ${duration}min`);
      if (step.notes) {
        sections.push(`     *${step.notes}*`);
      }
    });
  }
  return sections.join("\n");
}
function renderMovement(movement) {
  const parts = [];
  const formattedName = movement.name.split("_").map((word) => word.charAt(0).toUpperCase() + word.slice(1)).join(" ");
  parts.push(formattedName);
  const specs = [];
  if (movement.reps) {
    specs.push(`${movement.reps} reps`);
  }
  if (movement.sets && movement.sets > 1) {
    specs.push(`${movement.sets} sets`);
  }
  if (movement.weight_kg) {
    specs.push(`${movement.weight_kg}kg`);
  }
  if (movement.weight_percent_1rm) {
    specs.push(`${movement.weight_percent_1rm}% 1RM`);
  }
  if (movement.duration_seconds) {
    const duration = movement.duration_seconds < 60 ? `${movement.duration_seconds}sec` : `${Math.round(movement.duration_seconds / 60 * 10) / 10}min`;
    specs.push(duration);
  }
  if (movement.distance_meters) {
    const distance = movement.distance_meters >= 1e3 ? `${movement.distance_meters / 1e3}km` : `${movement.distance_meters}m`;
    specs.push(distance);
  }
  if (movement.rest_seconds) {
    const rest = movement.rest_seconds < 60 ? `${movement.rest_seconds}sec rest` : `${Math.round(movement.rest_seconds / 60 * 10) / 10}min rest`;
    specs.push(rest);
  }
  if (specs.length > 0) {
    parts.push(`(${specs.join(", ")})`);
  }
  if (movement.notes) {
    parts.push(`- *${movement.notes}*`);
  }
  return parts.join(" ");
}

// server/config/flags.ts
var featureFlags = {
  workouts: {
    v2: {
      enabled: true,
      useMLPolicy: false,
      // Future ML policy integration
      debugMetrics: true
      // Show metrics debug info in response
    }
  }
};
function getFlag(path) {
  const parts = path.split(".");
  let current = featureFlags;
  for (const part of parts) {
    if (current && typeof current === "object" && part in current) {
      current = current[part];
    } else {
      return false;
    }
  }
  return Boolean(current);
}
function isWorkoutV2Enabled() {
  return getFlag("workouts.v2.enabled");
}
function shouldShowMetricsDebug() {
  return getFlag("workouts.v2.debugMetrics");
}

// server/workouts/engine.ts
function generateWorkoutPlan(request, history = [], progressionStates = [], biometrics = {}, energySystemsHistory) {
  const rationale = [];
  const focus = determineFocus(request, history, biometrics, rationale, energySystemsHistory);
  const targetIntensity = calculateTargetIntensity(biometrics, history, rationale);
  const safetyAdjustments = applySafetyGuardrails(focus, targetIntensity, biometrics, rationale);
  const adjustedFocus = safetyAdjustments.focus || focus;
  const adjustedIntensity = safetyAdjustments.intensity || targetIntensity;
  const selectedBlocks = composeWorkout(
    adjustedFocus,
    adjustedIntensity,
    request,
    history,
    rationale
  );
  const blocksWithProgression = applyProgression(
    selectedBlocks,
    progressionStates,
    rationale
  );
  const workoutFocus = convertToExistingFocus(adjustedFocus);
  const workoutPlan = {
    focus: workoutFocus,
    targetIntensity: adjustedIntensity,
    targetRPE: {
      min: Math.max(1, adjustedIntensity - 1),
      max: Math.min(10, adjustedIntensity + 1),
      target: adjustedIntensity
    },
    blocks: blocksWithProgression,
    estimatedCalories: estimateCalories(blocksWithProgression, adjustedIntensity),
    estimatedTSS: estimateTSS(blocksWithProgression, adjustedIntensity),
    rationale: rationale.map((r4) => `${r4.step}: ${r4.decision} (${r4.factors.join(", ")})`)
  };
  return workoutPlan;
}
function determineFocus(request, history, biometrics, rationale, energySystemsHistory) {
  const factors = [];
  let primary = "conditioning";
  let energySystem = "aerobicZ2";
  let movementPattern = "squat";
  const recentHistory = history.filter(
    (h) => new Date(h.date) > new Date(Date.now() - 7 * 24 * 60 * 60 * 1e3)
  );
  const last48h = history.filter(
    (h) => new Date(h.date) > new Date(Date.now() - 2 * 24 * 60 * 60 * 1e3)
  );
  const recentPatterns = last48h.map((h) => h.primaryPattern);
  const performancePotential = biometrics.performancePotential || 50;
  const vitality = biometrics.vitality || 50;
  const sleepScore = biometrics.sleepScore || 70;
  if (performancePotential >= 70 && vitality >= 60) {
    primary = "strength";
    energySystem = "phosphocreatine";
    factors.push(`High performance potential (${performancePotential}) and vitality (${vitality})`);
  } else if (vitality < 40 || sleepScore < 60) {
    primary = "recovery";
    energySystem = "aerobicZ2";
    factors.push(`Low vitality (${vitality}) or poor sleep (${sleepScore})`);
  } else {
    primary = "conditioning";
    energySystem = "glycolytic";
    factors.push("Moderate biometrics, defaulting to conditioning");
  }
  const movementPatterns = ["squat", "hinge", "push", "pull"];
  const patternCounts = movementPatterns.map((pattern) => ({
    pattern,
    count: recentHistory.filter((h) => h.primaryPattern === pattern).length
  }));
  const availablePatterns = movementPatterns.filter((p2) => !recentPatterns.includes(p2));
  if (availablePatterns.length > 0) {
    const leastUsed = patternCounts.filter((pc) => availablePatterns.includes(pc.pattern)).sort((a2, b) => a2.count - b.count)[0];
    movementPattern = leastUsed.pattern;
    factors.push(`Selected ${movementPattern} (least used, no 48h conflict)`);
  } else {
    movementPattern = patternCounts.sort((a2, b) => a2.count - b.count)[0].pattern;
    factors.push(`Selected ${movementPattern} (least used overall)`);
  }
  let energySystemCounts;
  if (energySystemsHistory && Object.keys(energySystemsHistory).length > 0) {
    energySystemCounts = { ...energySystemsHistory };
    factors.push("Using AXLE energy systems history for balance");
  } else {
    energySystemCounts = recentHistory.reduce((acc, h) => {
      h.energySystems.forEach((es) => {
        acc[es] = (acc[es] || 0) + 1;
      });
      return acc;
    }, {});
    factors.push("Using workout history for energy system balance");
  }
  const allEnergySystems = [
    "alactic",
    "phosphocreatine",
    "glycolytic",
    "aerobicZ1",
    "aerobicZ2",
    "aerobicZ3"
  ];
  const leastUsedEnergySystem = allEnergySystems.map((es) => ({ es, count: energySystemCounts[es] || 0 })).sort((a2, b) => a2.count - b.count)[0];
  if (primary !== "recovery") {
    energySystem = leastUsedEnergySystem.es;
    factors.push(`Energy system balance: ${energySystem} least used (count: ${leastUsedEnergySystem.count})`);
  }
  rationale.push({
    step: "Focus Determination",
    decision: `Primary: ${primary}, Energy: ${energySystem}, Pattern: ${movementPattern}`,
    factors,
    metrics: { performancePotential, vitality, sleepScore }
  });
  return {
    primary,
    energySystem,
    movementPattern,
    rationale: factors.join("; ")
  };
}
function calculateTargetIntensity(biometrics, history, rationale) {
  const factors = [];
  let intensity = 5;
  const performancePotential = biometrics.performancePotential || 50;
  const vitality = biometrics.vitality || 50;
  intensity = Math.round(performancePotential / 10);
  factors.push(`Base from performance potential: ${intensity}`);
  const vitalityModifier = (vitality - 50) / 50;
  intensity += Math.round(vitalityModifier * 2);
  factors.push(`Vitality modifier: ${vitalityModifier.toFixed(2)} (${vitality})`);
  const recentWorkouts = history.slice(-3);
  const highIntensityFeedback = recentWorkouts.filter((w) => w.intensityRating && w.intensityRating >= 9);
  if (highIntensityFeedback.length >= 2) {
    intensity -= 1;
    factors.push("Recent high intensity feedback - reducing");
  }
  const microcycleDay = ((/* @__PURE__ */ new Date()).getDay() + 1) % 7;
  if (microcycleDay === 0) {
    const weeklyTSS = history.filter((h) => new Date(h.date) > new Date(Date.now() - 7 * 24 * 60 * 60 * 1e3)).reduce((sum, h) => sum + h.estimatedTSS, 0);
    if (weeklyTSS > 300) {
      intensity = Math.min(intensity, 4);
      factors.push(`Deload: Weekly TSS (${weeklyTSS}) exceeds threshold`);
    }
  }
  intensity = Math.max(1, Math.min(10, intensity));
  rationale.push({
    step: "Intensity Calculation",
    decision: `Target intensity: ${intensity}/10`,
    factors,
    metrics: { performancePotential, vitality, intensity }
  });
  return intensity;
}
function applySafetyGuardrails(focus, intensity, biometrics, rationale) {
  const adjustments = {};
  const factors = [];
  const vitality = biometrics.vitality || 50;
  const sleepScore = biometrics.sleepScore || 70;
  if (vitality < 40) {
    adjustments.focus = {
      ...focus,
      primary: "recovery",
      energySystem: "aerobicZ2"
    };
    adjustments.intensity = Math.min(intensity, 4);
    factors.push(`Vitality ${vitality} < 40: Forced recovery mode`);
  }
  if (sleepScore < 60) {
    adjustments.intensity = Math.min(intensity, 6);
    factors.push(`Sleep score ${sleepScore} < 60: Capped intensity at 6`);
  }
  if (factors.length > 0) {
    rationale.push({
      step: "Safety Guardrails",
      decision: "Applied safety adjustments",
      factors,
      metrics: { vitality, sleepScore }
    });
  }
  return adjustments;
}
function composeWorkout(focus, intensity, request, history, rationale) {
  const blocks = [];
  const factors = [];
  let remainingMinutes = request.availableMinutes || 45;
  const circadianAdjustments = request.circadianAdjustments;
  const shouldExtendWarmup = circadianAdjustments?.extendWarmup;
  const shouldShortenHIIT = circadianAdjustments?.shortenHIIT;
  if (circadianAdjustments) {
    factors.push(`Circadian adjustments: ${circadianAdjustments.reason}`);
  }
  let warmupDuration = Math.min(10, remainingMinutes * 0.2);
  if (shouldExtendWarmup) {
    warmupDuration = Math.min(15, remainingMinutes * 0.3);
    factors.push("Extended warmup for circadian alignment");
  }
  const warmupBlocks = getBlocks({
    type: "warmup",
    movementPattern: focus.movementPattern,
    maxDuration: warmupDuration
  });
  if (warmupBlocks.length > 0) {
    const warmup = selectBestBlock(warmupBlocks, "warmup", intensity);
    blocks.push(convertToBlock(warmup));
    remainingMinutes -= warmup.durationMin;
    factors.push(`Warmup: ${warmup.id} (${warmup.durationMin}min)`);
  }
  const primaryBlocks = getBlocks({
    type: "primary",
    movementPattern: focus.movementPattern,
    energySystem: focus.energySystem,
    equipment: request.equipment,
    maxDuration: remainingMinutes * 0.6
  });
  if (primaryBlocks.length > 0) {
    const primary = selectBestBlock(primaryBlocks, "primary", intensity);
    blocks.push(convertToBlock(primary));
    remainingMinutes -= primary.durationMin;
    factors.push(`Primary: ${primary.id} (${primary.durationMin}min)`);
  }
  if (remainingMinutes > 15) {
    const accessoryBlocks = getBlocks({
      type: "accessory",
      equipment: request.equipment,
      maxDuration: Math.min(12, remainingMinutes * 0.4)
    });
    if (accessoryBlocks.length > 0) {
      const accessory = selectBestBlock(accessoryBlocks, "accessory", intensity);
      blocks.push(convertToBlock(accessory));
      remainingMinutes -= accessory.durationMin;
      factors.push(`Accessory: ${accessory.id} (${accessory.durationMin}min)`);
    }
  }
  if (remainingMinutes > 8 && focus.primary !== "recovery") {
    let conditioningDuration = remainingMinutes - 5;
    if (shouldShortenHIIT && (focus.energySystem === "phosphocreatine" || focus.energySystem === "glycolytic")) {
      conditioningDuration = Math.min(conditioningDuration, 8);
      factors.push("Shortened HIIT for circadian alignment");
    }
    const conditioningBlocks = getBlocks({
      type: intensity >= 7 ? "conditioning" : "finisher",
      energySystem: focus.energySystem,
      equipment: request.equipment,
      maxDuration: conditioningDuration
    });
    if (conditioningBlocks.length > 0) {
      const conditioning = selectBestBlock(conditioningBlocks, "conditioning", intensity);
      blocks.push(convertToBlock(conditioning));
      remainingMinutes -= conditioning.durationMin;
      factors.push(`Conditioning: ${conditioning.id} (${conditioning.durationMin}min)`);
    }
  }
  if (remainingMinutes >= 3) {
    const cooldownBlocks = getBlocks({
      type: "cooldown",
      maxDuration: Math.min(6, remainingMinutes)
    });
    if (cooldownBlocks.length > 0) {
      const cooldown = selectBestBlock(cooldownBlocks, "cooldown", intensity);
      blocks.push(convertToBlock(cooldown));
      factors.push(`Cooldown: ${cooldown.id} (${cooldown.durationMin}min)`);
    }
  }
  if (blocks.length === 0 || !request.equipment?.length && request.availableMinutes && request.availableMinutes < 20) {
    return createBodyweightFallback(request.availableMinutes || 15);
  }
  rationale.push({
    step: "Block Composition",
    decision: `Selected ${blocks.length} blocks`,
    factors
  });
  return blocks;
}
function selectBestBlock(candidates, blockType, targetIntensity) {
  if (candidates.length === 1) return candidates[0];
  return candidates.reduce((best, candidate) => {
    const bestScore = scoreBlock(best, blockType, targetIntensity);
    const candidateScore = scoreBlock(candidate, blockType, targetIntensity);
    return candidateScore > bestScore ? candidate : best;
  });
}
function scoreBlock(block, blockType, targetIntensity) {
  let score = 0;
  const experienceScores = { beginner: 6, intermediate: 8, advanced: 10, expert: 9 };
  score += experienceScores[block.experience] || 5;
  const blockIntensity = estimateBlockIntensity(block);
  const intensityDiff = Math.abs(blockIntensity - targetIntensity);
  score += Math.max(0, 10 - intensityDiff);
  score += Math.min(5, block.variants.length);
  return score;
}
function estimateBlockIntensity(block) {
  if (block.energySystems.includes("phosphocreatine")) return 8;
  if (block.energySystems.includes("glycolytic")) return 7;
  if (block.energySystems.includes("aerobicZ3")) return 6;
  if (block.energySystems.includes("aerobicZ2")) return 4;
  if (block.energySystems.includes("aerobicZ1")) return 3;
  return 5;
}
function applyProgression(blocks, progressionStates, rationale) {
  const factors = [];
  return blocks.map((block) => {
    return block;
  });
}
function convertToExistingFocus(focus) {
  if (focus.primary === "strength") {
    return focus.movementPattern === "squat" || focus.movementPattern === "hinge" ? "Strength Lower" : "Strength Upper";
  }
  if (focus.primary === "conditioning") {
    if (focus.energySystem === "aerobicZ2" || focus.energySystem === "aerobicZ1") {
      return "Endurance Zone2";
    }
    if (focus.energySystem === "phosphocreatine") {
      return "Power Development";
    }
    return "Hybrid MetCon";
  }
  if (focus.primary === "recovery") {
    return "Recovery Active";
  }
  if (focus.primary === "technique") {
    return "Mobility Focus";
  }
  return "Hybrid MetCon";
}
function estimateCalories(blocks, intensity) {
  const totalMinutes = blocks.reduce((sum, block) => {
    return sum + (block.prescription?.time ? block.prescription.time / 60 : 20);
  }, 0);
  const baseCaloriesPerMinute = 8;
  const intensityMultiplier = 0.5 + intensity / 10 * 1.5;
  return Math.round(totalMinutes * baseCaloriesPerMinute * intensityMultiplier);
}
function estimateTSS(blocks, intensity) {
  const totalMinutes = blocks.reduce((sum, block) => {
    return sum + (block.prescription?.time ? block.prescription.time / 60 : 20);
  }, 0);
  const intensityFactor = Math.pow(intensity / 10, 2);
  const baseTSSPerHour = 100;
  return Math.round(totalMinutes / 60 * baseTSSPerHour * intensityFactor);
}
function convertToBlock(workoutBlock) {
  const variant = workoutBlock.variants[0];
  const energySystems = workoutBlock.energySystems.map((es) => {
    switch (es) {
      case "alactic":
      case "phosphocreatine":
        return "phosphocreatine";
      case "glycolytic":
      case "aerobicZ3":
        return "glycolytic";
      case "aerobicZ1":
      case "aerobicZ2":
        return "oxidative";
      default:
        return "mixed";
    }
  });
  return {
    type: workoutBlock.type,
    energySystems: energySystems.length > 0 ? energySystems : ["mixed"],
    movements: variant.movements.map((movement) => ({
      name: movement,
      category: workoutBlock.movementPatterns[0] || "squat",
      primaryMuscles: ["unknown"],
      // Would need more detailed mapping
      equipment: workoutBlock.minEquipment || [],
      complexity: workoutBlock.experience === "beginner" ? "simple" : "moderate"
    })),
    prescription: {
      time: workoutBlock.durationMin * 60,
      // Convert to seconds
      load: {
        type: "RPE",
        value: 6
        // Default RPE
      }
    },
    rest: {
      betweenSets: 60,
      betweenMovements: 30,
      betweenBlocks: 120,
      type: "incomplete"
    },
    notes: variant.name,
    scaling: {
      beginner: "Reduce intensity by 20%",
      intermediate: "As prescribed",
      advanced: "Increase intensity by 10%"
    }
  };
}
function createBodyweightFallback(availableMinutes) {
  const duration = Math.max(10, availableMinutes);
  return [{
    type: "primary",
    energySystems: ["mixed"],
    movements: [
      {
        name: "Bodyweight squats",
        category: "squat",
        primaryMuscles: ["quadriceps", "glutes"],
        equipment: [],
        complexity: "simple"
      },
      {
        name: "Push-ups",
        category: "push",
        primaryMuscles: ["chest", "triceps"],
        equipment: [],
        complexity: "simple"
      },
      {
        name: "Walking",
        category: "locomotion",
        primaryMuscles: ["legs"],
        equipment: [],
        complexity: "simple"
      }
    ],
    prescription: {
      time: duration * 60,
      load: {
        type: "bodyweight",
        value: 1
      }
    },
    rest: {
      betweenSets: 30,
      betweenMovements: 60,
      betweenBlocks: 0,
      type: "incomplete"
    },
    notes: "Equipment-free workout",
    scaling: {
      beginner: "Reduce reps by 50%",
      intermediate: "As prescribed",
      advanced: "Add plyometric variations"
    }
  }];
}

// server/routes/workout-generation.ts
init_telemetry();
import { randomUUID as randomUUID4 } from "crypto";
var metricsSnapshotSchema = z10.object({
  vitality: z10.number().min(0).max(100).optional(),
  performancePotential: z10.number().min(0).max(100).optional(),
  circadianAlignment: z10.number().min(0).max(100).optional(),
  energySystemsBalance: z10.number().min(0).max(100).optional(),
  fatigueScore: z10.number().min(0).max(100).optional(),
  hrv: z10.number().min(0).optional(),
  rhr: z10.number().min(30).max(200).optional(),
  sleepScore: z10.number().min(0).max(100).optional()
}).optional();
var generateWorkoutSchema = z10.object({
  duration: z10.number().min(5).max(120),
  intensity: z10.number().min(1).max(10),
  equipment: z10.array(z10.string()).optional(),
  constraints: z10.array(z10.string()).optional(),
  goals: z10.array(z10.string()).optional(),
  metricsSnapshot: metricsSnapshotSchema
});
async function composeUserContext(userId) {
  try {
    const { listWorkouts: listWorkouts2 } = await Promise.resolve().then(() => (init_workouts(), workouts_exports));
    const recentWorkouts = await listWorkouts2(userId, { limit: 7 });
    const { listReports: listReports2 } = await Promise.resolve().then(() => (init_reports(), reports_exports));
    const healthReports2 = await listReports2(userId, { days: 1 });
    const latestHealth = healthReports2[0];
    const yesterday = /* @__PURE__ */ new Date();
    yesterday.setDate(yesterday.getDate() - 1);
    const yesterdayStr = yesterday.toISOString().split("T")[0];
    const yesterdayWorkout = recentWorkouts.find(
      (w) => w?.createdAt && w.createdAt.toISOString().split("T")[0] === yesterdayStr
    );
    const weekAgo = /* @__PURE__ */ new Date();
    weekAgo.setDate(weekAgo.getDate() - 7);
    const weeklyWorkouts = recentWorkouts.filter(
      (w) => w?.createdAt && w.createdAt >= weekAgo
    );
    const weeklyCounts = {};
    weeklyWorkouts.forEach((w) => {
      if (w && w.request && typeof w.request === "object" && "category" in w.request) {
        const category = w.request.category;
        weeklyCounts[category] = (weeklyCounts[category] || 0) + 1;
      }
    });
    let healthModifiers = void 0;
    if (latestHealth?.metrics) {
      const metrics = latestHealth.metrics;
      const axleScores = metrics.axle || {};
      healthModifiers = {
        axleScore: axleScores.axle_score || void 0,
        vitality: axleScores.vitality_score || void 0,
        performancePotential: axleScores.performance_potential || void 0,
        circadian: axleScores.circadian || void 0
      };
    }
    return {
      yesterday: yesterdayWorkout ? {
        category: yesterdayWorkout.request?.category || "Unknown",
        intensity: yesterdayWorkout.request?.intensity || 5,
        type: "workout"
      } : void 0,
      health_snapshot: latestHealth ? {
        hrv: latestHealth.metrics?.hrv || null,
        resting_hr: latestHealth.metrics?.restingHeartRate || null,
        sleep_score: latestHealth.metrics?.sleepScore || null,
        stress_flag: (latestHealth.metrics?.stress || 0) > 7
      } : void 0,
      equipment: ["barbell", "kettlebell", "pull_up_bar", "box", "floor"],
      // Default equipment
      constraints: [],
      goals: ["general_fitness"]
    };
  } catch (error) {
    console.warn("Failed to compose user context:", error);
    return {
      equipment: ["barbell", "kettlebell", "pull_up_bar", "box", "floor"],
      constraints: [],
      goals: ["general_fitness"]
    };
  }
}
async function generateAndPersistWorkout(userId, category, request) {
  const { generateWithFallback: generateWithFallback2 } = await Promise.resolve().then(() => (init_generate(), generate_exports));
  const { generateWorkoutSeed: generateWorkoutSeed3, convertLegacyRequestToInputs: convertLegacyRequestToInputs3 } = await Promise.resolve().then(() => (init_seed_generator(), seed_generator_exports));
  const inputs = convertLegacyRequestToInputs3(request);
  const context = await composeUserContext(userId);
  const seed = generateWorkoutSeed3(inputs, userId);
  const { listWorkouts: listWorkouts2 } = await Promise.resolve().then(() => (init_workouts(), workouts_exports));
  const recentWorkouts = await listWorkouts2(userId, { limit: 28 });
  try {
    const result = await generateWithFallback2(
      inputs,
      {
        context: { ...context, dateISO: (/* @__PURE__ */ new Date()).toISOString(), userId },
        seed: seed.rngSeed,
        recentWorkouts
      }
    );
    const { db: db2 } = await Promise.resolve().then(() => (init_db(), db_exports));
    const { workouts: workouts3 } = await Promise.resolve().then(() => (init_schema(), schema_exports));
    const [savedWorkout] = await db2.insert(workouts3).values({
      userId,
      title: result.workout.name,
      request,
      sets: result.workout.blocks?.map((block) => ({
        id: `block-${Math.random().toString(36).substr(2, 9)}`,
        exercise: block.name || `${block.type} block`,
        notes: block.notes || ""
      })) || [],
      notes: result.workout.coaching_notes || "",
      completed: false,
      genSeed: { ...seed, choices: result.choices },
      generatorVersion: "v0.3.0"
    }).returning();
    return {
      workout: savedWorkout,
      rendered: result.workout.description || "Generated workout",
      score: 85,
      // Default score for new generator
      issues: [],
      wasPatched: false,
      seed: { ...seed, choices: result.choices }
    };
  } catch (error) {
    console.warn("New generator failed, falling back to legacy system:", error);
    const { generateCrossFitWorkout: generateCrossFitWorkout2 } = await Promise.resolve().then(() => (init_crossfit(), crossfit_exports));
    const { generateOlympicWorkout: generateOlympicWorkout2 } = await Promise.resolve().then(() => (init_olympic(), olympic_exports));
    const { generateWorkoutTitle: generateWorkoutTitle2 } = await Promise.resolve().then(() => (init_title(), title_exports));
    const { critiqueAndRepair: critiqueAndRepair2 } = await Promise.resolve().then(() => (init_critic(), critic_exports));
    const generator = category === "CrossFit/HIIT" ? generateCrossFitWorkout2 : generateOlympicWorkout2;
    const workout = await generator(request);
    if (!workout.name || workout.name === "CrossFit Workout" || workout.name === "Olympic Training") {
      workout.name = generateWorkoutTitle2(workout, category);
    }
    const critique = await critiqueAndRepair2(workout, {
      request,
      originalWorkout: workout
    });
    const renderedWorkout = render(critique.workout);
    const { db: db2 } = await Promise.resolve().then(() => (init_db(), db_exports));
    const { workouts: workouts3 } = await Promise.resolve().then(() => (init_schema(), schema_exports));
    const [savedWorkout] = await db2.insert(workouts3).values({
      userId,
      title: critique.workout.name,
      request,
      sets: critique.workout.blocks.map((block) => ({
        id: `block-${Math.random().toString(36).substr(2, 9)}`,
        exercise: block.name || `${block.type} block`,
        notes: ""
      })),
      notes: critique.workout.coaching_notes || "",
      completed: false,
      genSeed: seed,
      generatorVersion: seed.generatorVersion
    }).returning();
    return {
      workout: savedWorkout,
      rendered: renderedWorkout,
      score: critique.score,
      issues: critique.issues,
      wasPatched: critique.wasPatched,
      seed
    };
  }
}
async function hydrateMetricsFromHealthReport(userId, requestMetrics) {
  try {
    if (requestMetrics) {
      return requestMetrics;
    }
    const { listReports: listReports2 } = await Promise.resolve().then(() => (init_reports(), reports_exports));
    const reports = await listReports2(userId, { days: 1 });
    const latestReport = reports[0];
    if (!latestReport?.metrics) {
      console.warn(`No health report found for user ${userId}, using defaults`);
      return null;
    }
    const metrics = latestReport.metrics;
    const axleScores = metrics.axle || {};
    const providerMetrics = metrics.provider || {};
    return {
      vitality: axleScores.vitality_score || 65,
      performancePotential: axleScores.performance_potential || 70,
      circadianAlignment: axleScores.circadian_alignment || 75,
      energySystemsBalance: axleScores.energy_systems_balance || 70,
      sleepScore: providerMetrics.sleep_score || 70,
      hrv: providerMetrics.hrv,
      rhr: providerMetrics.resting_hr,
      fatigueScore: providerMetrics.fatigue_score || 30
    };
  } catch (error) {
    console.warn("Failed to hydrate metrics from health report:", error);
    return null;
  }
}
async function getEnergySystemsHistory(userId) {
  try {
    const { listReports: listReports2 } = await Promise.resolve().then(() => (init_reports(), reports_exports));
    const reports = await listReports2(userId, { days: 7 });
    const energySystems = {
      alactic: 0,
      phosphocreatine: 0,
      glycolytic: 0,
      aerobicZ1: 0,
      aerobicZ2: 0,
      aerobicZ3: 0
    };
    reports.forEach((report) => {
      const metrics = report.metrics;
      if (metrics?.energy?.systems) {
        Object.entries(metrics.energy.systems).forEach(([system, count2]) => {
          if (system in energySystems) {
            energySystems[system] += count2 || 0;
          }
        });
      }
    });
    return energySystems;
  } catch (error) {
    console.warn("Failed to get energy systems history:", error);
    return null;
  }
}
function applyCircadianAdjustments(request, circadianAlignment) {
  const currentHour = (/* @__PURE__ */ new Date()).getHours();
  const isEarlyMorning = currentHour >= 5 && currentHour <= 8;
  if (circadianAlignment < 50 && isEarlyMorning) {
    request.circadianAdjustments = {
      shortenHIIT: true,
      extendWarmup: true,
      reason: `Low circadian alignment (${circadianAlignment}) in early AM`
    };
  }
  return request;
}
async function convertToV2Format(userId, context, request) {
  let metrics;
  let metricsSource = "defaults";
  if (request.metricsSnapshot) {
    metrics = {
      vitality: request.metricsSnapshot.vitality || 65,
      performancePotential: request.metricsSnapshot.performancePotential || 70,
      circadianAlignment: request.metricsSnapshot.circadianAlignment || 75,
      energySystemsBalance: request.metricsSnapshot.energySystemsBalance || 70,
      sleepScore: request.metricsSnapshot.sleepScore || 70,
      hrv: request.metricsSnapshot.hrv,
      rhr: request.metricsSnapshot.rhr,
      fatigueScore: request.metricsSnapshot.fatigueScore || 30
    };
    metricsSource = "request_provided";
  } else {
    const hydratedMetrics = await hydrateMetricsFromHealthReport(userId, null);
    if (hydratedMetrics) {
      metrics = hydratedMetrics;
      metricsSource = "health_report";
    } else {
      metrics = {
        vitality: 65,
        performancePotential: 70,
        circadianAlignment: 75,
        energySystemsBalance: 70,
        sleepScore: context?.health_snapshot?.sleep_score || 70,
        hrv: context?.health_snapshot?.hrv,
        rhr: context?.health_snapshot?.resting_hr,
        fatigueScore: 30
      };
      metricsSource = "defaults";
    }
  }
  const energySystemsHistory = await getEnergySystemsHistory(userId);
  const biometrics = {
    performancePotential: metrics.performancePotential,
    vitality: metrics.vitality,
    sleepScore: metrics.sleepScore,
    hrv: metrics.hrv,
    restingHR: metrics.rhr
  };
  const history = context?.yesterday ? [{
    date: new Date(Date.now() - 24 * 60 * 60 * 1e3).toISOString(),
    primaryPattern: "squat",
    // Simplified mapping
    energySystems: ["glycolytic"],
    estimatedTSS: context.yesterday.intensity * 10,
    intensityRating: context.yesterday.intensity
  }] : [];
  const adjustedRequest = applyCircadianAdjustments({ ...request }, metrics.circadianAlignment);
  const workoutRequest = {
    date: (/* @__PURE__ */ new Date()).toISOString(),
    userId,
    goal: "general_fitness",
    availableMinutes: adjustedRequest.duration || 45,
    equipment: context?.equipment || ["barbell", "kettlebell"],
    experienceLevel: "intermediate",
    injuries: context?.constraints || [],
    preferredDays: [],
    recentHistory: [],
    metricsSnapshot: {
      vitality: metrics.vitality,
      performancePotential: metrics.performancePotential,
      circadianAlignment: metrics.circadianAlignment,
      fatigueScore: metrics.fatigueScore,
      hrv: metrics.hrv,
      rhr: metrics.rhr,
      sleepScore: metrics.sleepScore
    },
    intensityFeedback: []
  };
  return {
    workoutRequest,
    biometrics,
    history,
    debugInfo: {
      metricsSource,
      axleScores: {
        vitality: metrics.vitality,
        performancePotential: metrics.performancePotential,
        circadianAlignment: metrics.circadianAlignment,
        energySystemsBalance: metrics.energySystemsBalance
      },
      energySystemsHistory,
      circadianAdjustments: adjustedRequest.circadianAdjustments
    }
  };
}
function registerWorkoutGenerationRoutes(app2) {
  app2.post("/api/generate/v2", requireAuth, async (req, res) => {
    const startTime = Date.now();
    const generationId = randomUUID4();
    try {
      const authReq = req;
      const userId = authReq.user.id;
      if (!isWorkoutV2Enabled()) {
        return res.status(403).json({
          message: "V2 workout generation is not enabled"
        });
      }
      const validatedData = generateWorkoutSchema.parse(req.body);
      const context = await composeUserContext(userId);
      const { workoutRequest, biometrics, history, debugInfo } = await convertToV2Format(userId, context, validatedData);
      const workoutPlan = generateWorkoutPlan(
        workoutRequest,
        history,
        [],
        // No progression states yet - could be loaded from database
        biometrics,
        debugInfo.energySystemsHistory || void 0
      );
      const responseTimeMs = Date.now() - startTime;
      try {
        const metricsSnapshot = extractMetricsSnapshot(debugInfo.axleScores);
        const generationEventData = {
          selectedFocus: workoutPlan.focus,
          targetIntensity: workoutPlan.targetIntensity,
          blockIds: workoutPlan.blocks.map((block, idx) => `block-${idx}`),
          estimatedTSS: workoutPlan.estimatedTSS || 0,
          metricsSnapshot,
          workoutRequest: {
            category: "CrossFit",
            // Default category for V2
            duration: validatedData.duration,
            intensity: validatedData.intensity,
            equipment: validatedData.equipment || []
          },
          v2Request: validatedData
          // Store full V2 request for analysis
        };
        await logGenerationEvent(userId, generationEventData, responseTimeMs, generationId);
      } catch (telemetryError) {
        console.error("\u274C [TELEMETRY] Failed to log generation event:", telemetryError);
      }
      console.log("\u{1F3CB}\uFE0F V2 Workout Generated:", {
        generationId,
        focus: workoutPlan.focus,
        intensity: workoutPlan.targetIntensity,
        blocks: workoutPlan.blocks.length,
        estimatedTSS: workoutPlan.estimatedTSS,
        metricsSource: debugInfo.metricsSource,
        responseTimeMs
      });
      const response = {
        success: true,
        plan: workoutPlan,
        generationId,
        // Include generation ID for feedback linking
        generatedAt: (/* @__PURE__ */ new Date()).toISOString(),
        version: "v2"
      };
      if (shouldShowMetricsDebug()) {
        response.debug = debugInfo;
      }
      res.json(response);
    } catch (error) {
      if (error instanceof z10.ZodError) {
        return res.status(400).json({
          message: "Invalid request data",
          errors: error.issues
        });
      }
      console.error("V2 generation failed:", error);
      res.status(500).json({
        message: "Failed to generate V2 workout",
        error: error instanceof Error ? error.message : "Unknown error"
      });
    }
  });
  if (process.env.NODE_ENV !== "production") {
    app2.post("/api/dev/generate/v2", async (req, res) => {
      try {
        const validatedData = generateWorkoutSchema.parse(req.body);
        const userId = "test-user-123";
        const { workoutRequest, biometrics, history, debugInfo } = await convertToV2Format(userId, {}, validatedData);
        const workoutPlan = generateWorkoutPlan(
          workoutRequest,
          history,
          [],
          // No progression states
          biometrics,
          debugInfo.energySystemsHistory || void 0
        );
        console.log("\u{1F9EA} DEV V2 Workout Generated:", {
          focus: workoutPlan.focus,
          intensity: workoutPlan.targetIntensity,
          blocks: workoutPlan.blocks.length,
          metricsSource: debugInfo.metricsSource
        });
        const response = {
          success: true,
          plan: workoutPlan,
          generatedAt: (/* @__PURE__ */ new Date()).toISOString(),
          version: "v2-dev",
          debug: debugInfo
        };
        res.json(response);
      } catch (error) {
        if (error instanceof z10.ZodError) {
          return res.status(400).json({
            message: "Invalid request data",
            errors: error.issues
          });
        }
        console.error("DEV V2 generation failed:", error);
        res.status(500).json({
          message: "Failed to generate DEV V2 workout",
          error: error instanceof Error ? error.message : "Unknown error"
        });
      }
    });
  }
  app2.post("/api/generate/crossfit", requireAuth, async (req, res) => {
    try {
      const authReq = req;
      const userId = authReq.user.id;
      const validatedData = generateWorkoutSchema.parse(req.body);
      const context = await composeUserContext(userId);
      const request = {
        category: "CrossFit/HIIT",
        duration: validatedData.duration,
        intensity: validatedData.intensity,
        context: context ? {
          ...context,
          equipment: validatedData.equipment || context.equipment || ["barbell"],
          constraints: validatedData.constraints || context.constraints || [],
          goals: validatedData.goals || context.goals || ["general_fitness"]
        } : {
          equipment: validatedData.equipment || ["barbell"],
          constraints: validatedData.constraints || [],
          goals: validatedData.goals || ["general_fitness"]
        }
      };
      const result = await generateAndPersistWorkout(userId, "CrossFit/HIIT", request);
      res.json({
        id: result.workout.id,
        title: result.workout.title,
        rendered: result.rendered,
        score: result.score,
        issues: result.issues,
        wasPatched: result.wasPatched,
        duration: validatedData.duration,
        intensity: validatedData.intensity,
        seed: result.seed
      });
    } catch (error) {
      if (error instanceof z10.ZodError) {
        return res.status(400).json({
          message: "Invalid request data",
          errors: error.issues
        });
      }
      console.error("CrossFit generation failed:", error);
      res.status(500).json({
        message: "Failed to generate CrossFit workout",
        error: error instanceof Error ? error.message : "Unknown error"
      });
    }
  });
  app2.post("/api/generate/olympic", requireAuth, async (req, res) => {
    try {
      const authReq = req;
      const userId = authReq.user.id;
      const validatedData = generateWorkoutSchema.parse(req.body);
      const context = await composeUserContext(userId);
      const request = {
        category: "Olympic",
        duration: validatedData.duration,
        intensity: validatedData.intensity,
        context: context ? {
          ...context,
          equipment: validatedData.equipment || context.equipment || ["barbell"],
          constraints: validatedData.constraints || context.constraints || [],
          goals: validatedData.goals || context.goals || ["general_fitness"]
        } : {
          equipment: validatedData.equipment || ["barbell"],
          constraints: validatedData.constraints || [],
          goals: validatedData.goals || ["general_fitness"]
        }
      };
      const result = await generateAndPersistWorkout(userId, "Olympic", request);
      res.json({
        id: result.workout.id,
        title: result.workout.title,
        rendered: result.rendered,
        score: result.score,
        issues: result.issues,
        wasPatched: result.wasPatched,
        duration: validatedData.duration,
        intensity: validatedData.intensity,
        seed: result.seed
      });
    } catch (error) {
      if (error instanceof z10.ZodError) {
        return res.status(400).json({
          message: "Invalid request data",
          errors: error.issues
        });
      }
      console.error("Olympic generation failed:", error);
      res.status(500).json({
        message: "Failed to generate Olympic workout",
        error: error instanceof Error ? error.message : "Unknown error"
      });
    }
  });
}

// server/routes/workout-seeds.ts
init_crossfit();
init_olympic();
init_critic();
init_title();
import { z as z12 } from "zod";

// shared/generator-types.ts
import { z as z11 } from "zod";
var generatorInputsSchema = z11.object({
  archetype: z11.enum(["strength", "conditioning", "mixed", "endurance"]),
  minutes: z11.number().min(5).max(120),
  targetIntensity: z11.union([
    z11.literal(1),
    z11.literal(2),
    z11.literal(3),
    z11.literal(4),
    z11.literal(5),
    z11.literal(6),
    z11.literal(7),
    z11.literal(8),
    z11.literal(9),
    z11.literal(10)
  ]),
  equipment: z11.array(z11.string()),
  constraints: z11.array(z11.string()).optional(),
  location: z11.enum(["home", "gym", "outside"]).optional()
});
var generatorContextSchema = z11.object({
  dateISO: z11.string(),
  userId: z11.string(),
  healthModifiers: z11.object({
    axleScore: z11.number().min(0).max(100).optional(),
    vitality: z11.number().min(0).max(100).optional(),
    performancePotential: z11.number().min(0).max(100).optional(),
    circadian: z11.number().min(0).max(100).optional()
  }).optional()
});
var generatorChoicesSchema = z11.object({
  templateId: z11.string(),
  movementPoolIds: z11.array(z11.string()),
  schemeId: z11.string()
});
var generatorSeedSchema = z11.object({
  rngSeed: z11.string(),
  generatorVersion: z11.string(),
  inputs: generatorInputsSchema,
  context: generatorContextSchema,
  choices: generatorChoicesSchema.optional()
});

// server/routes/workout-seeds.ts
init_seed_generator();
var regenerateSchema = z12.object({
  workoutId: z12.string().uuid().optional(),
  seed: generatorSeedSchema.optional()
}).refine((data) => data.workoutId || data.seed, {
  message: "Either workoutId or seed must be provided"
});
var simulateSchema = z12.object({
  inputs: z12.object({
    archetype: z12.enum(["strength", "conditioning", "mixed", "endurance"]),
    minutes: z12.number().min(5).max(120),
    targetIntensity: z12.union([
      z12.literal(1),
      z12.literal(2),
      z12.literal(3),
      z12.literal(4),
      z12.literal(5),
      z12.literal(6),
      z12.literal(7),
      z12.literal(8),
      z12.literal(9),
      z12.literal(10)
    ]),
    equipment: z12.array(z12.string()),
    constraints: z12.array(z12.string()).optional(),
    location: z12.enum(["home", "gym", "outside"]).optional()
  }),
  rngSeed: z12.string(),
  generatorVersion: z12.string()
});
function registerSeedRoutes(app2) {
  app2.post("/api/workouts/regenerate", requireAuth, async (req, res) => {
    try {
      const authReq = req;
      const userId = authReq.user.id;
      const validatedData = regenerateSchema.parse(req.body);
      const preview = req.query.preview === "true";
      let seed;
      if (validatedData.workoutId) {
        const { getWorkout: getWorkout2 } = await Promise.resolve().then(() => (init_workouts(), workouts_exports));
        const workout2 = await getWorkout2(userId, validatedData.workoutId);
        if (!workout2) {
          return res.status(404).json({ error: "Workout not found" });
        }
        if (workout2.userId !== userId) {
          return res.status(403).json({ error: "Access denied" });
        }
        const workoutWithSeed = workout2;
        if (!workoutWithSeed.genSeed || typeof workoutWithSeed.genSeed !== "object") {
          return res.status(400).json({
            error: "Workout does not have a valid generation seed",
            details: "This workout was created before seed tracking was implemented"
          });
        }
        seed = workoutWithSeed.genSeed;
      } else if (validatedData.seed) {
        seed = validatedData.seed;
      } else {
        return res.status(400).json({ error: "Either workoutId or seed must be provided" });
      }
      const legacyRequest = {
        category: seed.inputs.archetype === "strength" ? "Strength" : seed.inputs.archetype === "conditioning" ? "CrossFit" : seed.inputs.archetype === "endurance" ? "Cardio" : "HIIT",
        duration: seed.inputs.minutes,
        intensity: seed.inputs.targetIntensity,
        context: {
          equipment: seed.inputs.equipment,
          constraints: seed.inputs.constraints || [],
          goals: [seed.inputs.archetype]
        }
      };
      const isOlympic = seed.inputs.equipment.includes("barbell") && seed.inputs.archetype === "strength";
      const category = isOlympic ? "Olympic" : "CrossFit/HIIT";
      const generator = isOlympic ? generateOlympicWorkout : generateCrossFitWorkout;
      const seededRng = createSeededRandom2(seed.rngSeed);
      const workout = await generator(legacyRequest);
      if (!workout.name || workout.name === "CrossFit Workout" || workout.name === "Olympic Training") {
        workout.name = generateWorkoutTitle(workout, category);
      }
      if (preview) {
        const renderedWorkout2 = render(workout);
        return res.json({
          workout: renderedWorkout2,
          seed,
          preview: true
        });
      }
      const critique = await critiqueAndRepair(workout, {
        request: legacyRequest,
        originalWorkout: workout
      });
      const renderedWorkout = render(critique.workout);
      const { db: db2 } = await Promise.resolve().then(() => (init_db(), db_exports));
      const { workouts: workouts3 } = await Promise.resolve().then(() => (init_schema(), schema_exports));
      const [savedWorkout] = await db2.insert(workouts3).values({
        userId,
        title: critique.workout.name,
        request: legacyRequest,
        sets: critique.workout.blocks.map((block) => ({
          id: `block-${Math.random().toString(36).substr(2, 9)}`,
          exercise: block.name || `${block.type} block`,
          notes: ""
        })),
        notes: critique.workout.coaching_notes || "",
        completed: false,
        genSeed: seed,
        generatorVersion: seed.generatorVersion
      }).returning();
      res.json({
        workout: savedWorkout,
        rendered: renderedWorkout,
        score: critique.score,
        issues: critique.issues,
        wasPatched: critique.wasPatched,
        seed
      });
    } catch (error) {
      console.error("Error in regenerate endpoint:", error);
      if (error instanceof z12.ZodError) {
        return res.status(400).json({
          error: "Invalid request format",
          details: error.errors
        });
      }
      res.status(500).json({
        error: "Failed to regenerate workout",
        details: error instanceof Error ? error.message : String(error)
      });
    }
  });
  app2.post("/api/workouts/simulate", requireAuth, async (req, res) => {
    try {
      const authReq = req;
      const userId = authReq.user.id;
      const validatedData = simulateSchema.parse(req.body);
      const seed = {
        rngSeed: validatedData.rngSeed,
        generatorVersion: validatedData.generatorVersion,
        inputs: validatedData.inputs,
        context: {
          dateISO: (/* @__PURE__ */ new Date()).toISOString(),
          userId
        }
      };
      const legacyRequest = {
        category: seed.inputs.archetype === "strength" ? "Strength" : seed.inputs.archetype === "conditioning" ? "CrossFit" : seed.inputs.archetype === "endurance" ? "Cardio" : "HIIT",
        duration: seed.inputs.minutes,
        intensity: seed.inputs.targetIntensity,
        context: {
          equipment: seed.inputs.equipment,
          constraints: seed.inputs.constraints || [],
          goals: [seed.inputs.archetype]
        }
      };
      const isOlympic = seed.inputs.equipment.includes("barbell") && seed.inputs.archetype === "strength";
      const category = isOlympic ? "Olympic" : "CrossFit/HIIT";
      const generator = isOlympic ? generateOlympicWorkout : generateCrossFitWorkout;
      const seededRng = createSeededRandom2(seed.rngSeed);
      const workout = await generator(legacyRequest);
      if (!workout.name || workout.name === "CrossFit Workout" || workout.name === "Olympic Training") {
        workout.name = generateWorkoutTitle(workout, category);
      }
      const renderedWorkout = render(workout);
      res.json({
        workout: renderedWorkout,
        seed,
        simulation: true
      });
    } catch (error) {
      console.error("Error in simulate endpoint:", error);
      if (error instanceof z12.ZodError) {
        return res.status(400).json({
          error: "Invalid request format",
          details: error.errors
        });
      }
      res.status(500).json({
        error: "Failed to simulate workout",
        details: error instanceof Error ? error.message : String(error)
      });
    }
  });
}

// shared/types/workouts.ts
import { z as z13 } from "zod";
var SUPPORTED_STYLES3 = [
  "crossfit",
  "olympic_weightlifting",
  "powerlifting",
  "bb_full_body",
  "bb_upper",
  "bb_lower",
  "aerobic",
  "conditioning",
  "strength",
  "endurance",
  "gymnastics",
  "mobility",
  "mixed"
];
var StyleEnum = z13.enum(SUPPORTED_STYLES3);
function normalizeToStyle(raw) {
  if (!raw || raw.trim() === "") {
    return "mixed";
  }
  const lower = raw.toLowerCase().trim();
  if (SUPPORTED_STYLES3.includes(lower)) return lower;
  const aliases = {
    "cf": "crossfit",
    "oly": "olympic_weightlifting",
    "olympic": "olympic_weightlifting",
    "pl": "powerlifting",
    "bbfull": "bb_full_body",
    "bb full body": "bb_full_body"
  };
  if (aliases[lower]) return aliases[lower];
  if (lower.includes("olympic")) return "olympic_weightlifting";
  if (lower.includes("bodybuilding")) return "bb_full_body";
  throw new Error(`Unsupported workout style: "${raw}". Supported: ${SUPPORTED_STYLES3.join(", ")}`);
}
var generationSeedSchema = z13.object({
  algo: z13.literal("v1"),
  userHash: z13.string().min(1),
  day: z13.string().regex(/^\d{4}-\d{2}-\d{2}$/),
  // YYYY-MM-DD format
  focus: z13.string().optional(),
  nonce: z13.number().int().min(0).optional()
});
var generatePayloadSchema = z13.object({
  archetype: z13.string().optional(),
  style: z13.string().optional(),
  goal: z13.string().optional(),
  focus: z13.string().optional(),
  minutes: z13.number().min(5).max(120),
  intensity: z13.number().min(1).max(10),
  equipment: z13.array(z13.string()),
  constraints: z13.array(z13.string()).optional(),
  goals: z13.array(z13.string()).optional(),
  seed: generationSeedSchema.optional()
}).transform((d) => {
  const raw = (d.style ?? d.goal ?? d.focus ?? d.archetype ?? "").toString();
  const style = normalizeToStyle(raw);
  if (!SUPPORTED_STYLES3.includes(style)) {
    throw new Error(`Invalid normalized style: "${style}" from input "${raw}"`);
  }
  return { ...d, archetype: style, style, goal: style, focus: style };
});
var simulatePayloadSchema = z13.object({
  archetype: z13.string().optional(),
  style: z13.string().optional(),
  goal: z13.string().optional(),
  focus: z13.string().optional(),
  minutes: z13.number().min(5).max(120),
  intensity: z13.number().min(1).max(10),
  equipment: z13.array(z13.string()),
  constraints: z13.array(z13.string()).optional(),
  goals: z13.array(z13.string()).optional(),
  seed: generationSeedSchema.optional()
}).transform((d) => {
  const raw = (d.style ?? d.goal ?? d.focus ?? d.archetype ?? "").toString();
  const style = normalizeToStyle(raw);
  if (!SUPPORTED_STYLES3.includes(style)) {
    throw new Error(`Invalid normalized style: "${style}" from input "${raw}"`);
  }
  return { ...d, archetype: style, style, goal: style, focus: style };
});

// server/routes/workout-simulate.ts
init_workoutGenerator();
function registerSimulateRoutes(app2) {
  app2.post("/api/workouts/simulate", requireAuth, async (req, res, next) => {
    try {
      const authReq = req;
      const userId = authReq.user.id;
      const validatedData = simulatePayloadSchema.parse(req.body);
      let seedString;
      if (validatedData.seed) {
        seedString = `${validatedData.seed.userHash}-${validatedData.seed.day}-${validatedData.seed.focus || validatedData.archetype}-${validatedData.seed.nonce || 0}`;
      }
      const generatedWorkout = await generateWorkout({
        category: validatedData.archetype,
        duration: validatedData.minutes,
        intensity: validatedData.intensity,
        goal: validatedData.goal,
        focus: validatedData.focus,
        style: validatedData.style,
        equipment: validatedData.equipment,
        seed: seedString,
        durationMin: validatedData.minutes
      });
      const meta = generatedWorkout?.meta || {};
      res.setHeader("X-AXLE-Orchestrator", GENERATOR_STAMP);
      res.setHeader("X-AXLE-Generator", meta.generator || "unknown");
      res.setHeader("X-AXLE-Style", meta.style || req.body?.style || "unknown");
      console.log("[AXLE /simulate] Success:", {
        generator: meta.generator,
        style: meta.style,
        seed: seedString
      });
      return res.json({
        ok: true,
        workout: {
          id: null,
          // No persistence for simulation
          ...generatedWorkout,
          seed: seedString
        },
        meta
      });
    } catch (e2) {
      return next(e2);
    }
  });
}

// server/routes/workout-generate.ts
init_workoutGenerator();
function registerGenerateRoutes(app2) {
  app2.post("/api/workouts/generate", requireAuth, async (req, res, next) => {
    try {
      const authReq = req;
      const userId = authReq.user.id;
      const validatedData = generatePayloadSchema.parse(req.body);
      let seedString;
      if (validatedData.seed) {
        seedString = `${validatedData.seed.userHash}-${validatedData.seed.day}-${validatedData.seed.focus || validatedData.archetype}-${validatedData.seed.nonce || 0}`;
      }
      const generatedWorkout = await generateWorkout({
        category: validatedData.archetype,
        duration: validatedData.minutes,
        intensity: validatedData.intensity,
        goal: validatedData.goal,
        focus: validatedData.focus,
        style: validatedData.style,
        equipment: validatedData.equipment,
        seed: seedString,
        durationMin: validatedData.minutes
      });
      const meta = generatedWorkout?.meta || {};
      res.setHeader("X-AXLE-Orchestrator", GENERATOR_STAMP);
      res.setHeader("X-AXLE-Generator", meta.generator || "unknown");
      res.setHeader("X-AXLE-Style", meta.style || req.body?.style || "unknown");
      const { insertWorkout: insertWorkout2 } = await Promise.resolve().then(() => (init_workouts(), workouts_exports));
      const workoutData = generatedWorkout;
      const workoutParams = {
        userId,
        workout: {
          title: workoutData.name || meta.title || "Generated Workout",
          request: validatedData,
          sets: workoutData.sets || workoutData.blocks || [],
          notes: `${validatedData.archetype} workout for ${validatedData.minutes} minutes`,
          completed: false,
          // Telemetry fields
          genSeed: validatedData.seed,
          generatorVersion: "v0.3.0",
          generationId: meta.generation_id,
          rationale: meta.rationale,
          criticScore: meta.critic_score,
          rawWorkoutJson: generatedWorkout
        }
      };
      const savedWorkout = await insertWorkout2(workoutParams);
      if (!savedWorkout) {
        throw new Error("Failed to save workout to database");
      }
      console.log("[AXLE /generate] Success:", {
        workoutId: savedWorkout.id,
        generator: meta.generator,
        style: meta.style,
        seed: seedString
      });
      return res.json({
        ok: true,
        workout: {
          id: savedWorkout.id,
          ...generatedWorkout,
          seed: seedString
        },
        meta
      });
    } catch (e2) {
      return next(e2);
    }
  });
}

// server/middleware/accept-json.ts
function requireJSON(req, res, next) {
  if (!req.path.startsWith("/api/")) {
    return next();
  }
  res.type("application/json");
  res.setHeader("Vary", "Accept");
  const acceptHeader = req.headers.accept;
  if (acceptHeader && acceptHeader.includes("text/html") && !acceptHeader.includes("application/json") && !acceptHeader.includes("*/*")) {
    return res.status(406).json({
      error: "Not Acceptable",
      message: "This endpoint only supports JSON responses"
    });
  }
  return next();
}

// server/services/suggestions.ts
init_suggestions();

// node_modules/uuid/dist-node/stringify.js
var byteToHex = [];
for (let i2 = 0; i2 < 256; ++i2) {
  byteToHex.push((i2 + 256).toString(16).slice(1));
}
function unsafeStringify(arr, offset = 0) {
  return (byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + "-" + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + "-" + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + "-" + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + "-" + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]]).toLowerCase();
}

// node_modules/uuid/dist-node/rng.js
import { randomFillSync } from "node:crypto";
var rnds8Pool = new Uint8Array(256);
var poolPtr = rnds8Pool.length;
function rng() {
  if (poolPtr > rnds8Pool.length - 16) {
    randomFillSync(rnds8Pool);
    poolPtr = 0;
  }
  return rnds8Pool.slice(poolPtr, poolPtr += 16);
}

// node_modules/uuid/dist-node/native.js
import { randomUUID as randomUUID5 } from "node:crypto";
var native_default = { randomUUID: randomUUID5 };

// node_modules/uuid/dist-node/v4.js
function _v4(options, buf, offset) {
  options = options || {};
  const rnds = options.random ?? options.rng?.() ?? rng();
  if (rnds.length < 16) {
    throw new Error("Random bytes length must be >= 16");
  }
  rnds[6] = rnds[6] & 15 | 64;
  rnds[8] = rnds[8] & 63 | 128;
  if (buf) {
    offset = offset || 0;
    if (offset < 0 || offset + 16 > buf.length) {
      throw new RangeError(`UUID byte range ${offset}:${offset + 15} is out of buffer bounds`);
    }
    for (let i2 = 0; i2 < 16; ++i2) {
      buf[offset + i2] = rnds[i2];
    }
    return buf;
  }
  return unsafeStringify(rnds);
}
function v4(options, buf, offset) {
  if (native_default.randomUUID && !buf && !options) {
    return native_default.randomUUID();
  }
  return _v4(options, buf, offset);
}
var v4_default = v4;

// server/services/workouts/createFromSeed.ts
init_generate();
init_db();
init_schema();
import * as Sentry5 from "@sentry/node";
async function createWorkoutFromSeed(args) {
  try {
    const inputs = {
      archetype: mapFocusToArchetype(args.focus),
      minutes: args.minutes,
      targetIntensity: args.intensity,
      equipment: [],
      // Default to bodyweight, can be enhanced later
      constraints: []
    };
    const result = await generateWithFallback(inputs, {
      context: {
        dateISO: (/* @__PURE__ */ new Date()).toISOString(),
        userId: args.userId
      },
      seed: args.seed.rngSeed || v4_default(),
      source: args.source
    });
    const workout = result.workout || result;
    const id = v4_default();
    const [savedWorkout] = await db.insert(workouts).values({
      id,
      userId: args.userId,
      title: workout.name || `${args.focus} Workout`,
      request: {
        focus: args.focus,
        minutes: args.minutes,
        intensity: args.intensity,
        source: args.source,
        generatedAt: (/* @__PURE__ */ new Date()).toISOString()
      },
      sets: workout.blocks?.map((block, index2) => ({
        id: `block-${index2}`,
        exercise: block.name || block.type || "Exercise",
        notes: block.notes || block.description || ""
      })) || [],
      notes: workout.coaching_notes || workout.description || "",
      completed: false,
      genSeed: args.seed,
      generatorVersion: args.generatorVersion,
      generationId: args.seed.rngSeed || v4_default()
    }).returning();
    return { id: savedWorkout.id };
  } catch (e2) {
    Sentry5.captureException(e2, { tags: { svc: "createWorkoutFromSeed" } });
    throw e2;
  }
}
function mapFocusToArchetype(focus) {
  const focusLower = focus.toLowerCase();
  if (focusLower.includes("strength") || focusLower.includes("power")) {
    return "strength";
  }
  if (focusLower.includes("cardio") || focusLower.includes("endurance") || focusLower.includes("aerobic")) {
    return "endurance";
  }
  if (focusLower.includes("conditioning") || focusLower.includes("hiit") || focusLower.includes("metcon")) {
    return "conditioning";
  }
  return "mixed";
}

// server/services/suggestions.ts
async function computeTodaySuggestion(userId) {
  try {
    const suggestionResult = await computeSuggestion(userId, /* @__PURE__ */ new Date());
    const config2 = {
      focus: suggestionResult.request.category,
      duration: suggestionResult.request.duration,
      intensity: suggestionResult.request.intensity,
      equipment: [],
      // Default to bodyweight - can be enhanced later with user preferences
      constraints: []
      // Default to no constraints - can be enhanced later with user preferences
    };
    const rationale = suggestionResult.rationale;
    return {
      config: config2,
      rationale,
      seed: {
        rngSeed: nanoid(10),
        generatorVersion: "v0.3.0"
      }
    };
  } catch (error) {
    console.error("Failed to compute today suggestion:", error);
    throw error;
  }
}
async function startSuggestion(userId) {
  try {
    const { config: config2, seed } = await computeTodaySuggestion(userId);
    const focus = mapCategoryToFocus(config2.focus);
    const result = await createWorkoutFromSeed({
      userId,
      focus,
      minutes: config2.duration,
      intensity: config2.intensity,
      seed: seed || { rngSeed: nanoid(10) },
      generatorVersion: "v0.3.0",
      source: "daily-suggestion-start"
    });
    return { workoutId: result.id };
  } catch (error) {
    console.error("Failed to start suggestion:", error);
    throw error;
  }
}
function mapCategoryToFocus(category) {
  const categoryLower = category.toLowerCase();
  if (categoryLower.includes("strength") || categoryLower.includes("power")) {
    return "Strength";
  }
  if (categoryLower.includes("cardio") || categoryLower.includes("endurance")) {
    return "Cardio";
  }
  if (categoryLower.includes("conditioning") || categoryLower.includes("hiit") || categoryLower.includes("metcon")) {
    return "Conditioning";
  }
  if (categoryLower.includes("skill") || categoryLower.includes("gymnastics")) {
    return "Skill";
  }
  if (categoryLower.includes("recovery") || categoryLower.includes("mobility")) {
    return "Recovery";
  }
  return "Mixed";
}

// shared/endpoints.ts
var API_ENDPOINTS = {
  // Workout suggestion endpoints
  WORKOUTS_SUGGEST_TODAY: "/api/workouts/suggest/today",
  WORKOUTS_SUGGEST_TODAY_START: "/api/workouts/suggest/today/start",
  // Legacy endpoints (for reference and testing)
  SUGGESTIONS_TODAY: "/api/suggestions/today",
  // Health check endpoint
  HEALTH: "/api/healthz"
};

// server/routes/workout-suggest.ts
function registerWorkoutSuggestionRoutes(app2) {
  app2.get(API_ENDPOINTS.WORKOUTS_SUGGEST_TODAY, requireJSON, requireAuth, async (req, res, next) => {
    try {
      const authReq = req;
      const userId = authReq.user.id;
      const suggestion = await computeTodaySuggestion(userId);
      res.json({ suggestion });
    } catch (error) {
      next(error);
    }
  });
  app2.post(API_ENDPOINTS.WORKOUTS_SUGGEST_TODAY_START, requireJSON, requireAuth, async (req, res, next) => {
    try {
      const authReq = req;
      const userId = authReq.user.id;
      const result = await startSuggestion(userId);
      res.status(201).json({ workoutId: result.workoutId });
    } catch (error) {
      next(error);
    }
  });
  app2.post("/api/workouts/suggest/rotate", requireJSON, requireAuth, async (req, res, next) => {
    try {
      const authReq = req;
      const userId = authReq.user.id;
      const suggestion = await computeTodaySuggestion(userId);
      res.json({ suggestion });
    } catch (error) {
      next(error);
    }
  });
}

// server/routes/health.ts
import { Router as Router4 } from "express";
import { z as z14 } from "zod";
init_db();
init_schema();
import { eq as eq9, and as and9, desc as desc6, gte as gte6, sql as sql6 } from "drizzle-orm";

// server/dal/tokens.ts
init_db();
init_schema();
import { eq as eq6, and as and6 } from "drizzle-orm";

// server/lib/crypto.ts
import crypto5 from "crypto";
var ENCRYPTION_KEY = process.env.ENCRYPTION_KEY;
if (!ENCRYPTION_KEY || ENCRYPTION_KEY.length < 32) {
  console.warn("\u26A0\uFE0F  ENCRYPTION_KEY should be at least 32 characters for secure AES-256-GCM encryption");
  console.warn("\u26A0\uFE0F  Current length:", ENCRYPTION_KEY?.length || 0);
  if (process.env.NODE_ENV === "production") {
    throw new Error("ENCRYPTION_KEY must be at least 32 characters long for secure AES-256-GCM encryption");
  } else {
    ENCRYPTION_KEY = "axle_fitness_tracker_encryption_key_32_chars_long";
    console.warn("\u26A0\uFE0F  Using default development encryption key");
  }
}
var KEY = Buffer.from(ENCRYPTION_KEY, "utf8");
function seal(plain) {
  const iv = crypto5.randomBytes(12);
  const cipher = crypto5.createCipheriv("aes-256-gcm", crypto5.scryptSync(KEY, "axle", 32), iv);
  const enc = Buffer.concat([cipher.update(plain, "utf8"), cipher.final()]);
  const tag = cipher.getAuthTag();
  return Buffer.concat([iv, tag, enc]).toString("base64");
}
function open(b64) {
  const raw = Buffer.from(b64, "base64");
  const iv = raw.subarray(0, 12);
  const tag = raw.subarray(12, 28);
  const data = raw.subarray(28);
  const decipher = crypto5.createDecipheriv("aes-256-gcm", crypto5.scryptSync(KEY, "axle", 32), iv);
  decipher.setAuthTag(tag);
  return Buffer.concat([decipher.update(data), decipher.final()]).toString("utf8");
}

// server/dal/tokens.ts
async function storeEncryptedTokens(userId, provider, tokens) {
  const encryptedAccessToken = seal(tokens.accessToken);
  const encryptedRefreshToken = tokens.refreshToken ? seal(tokens.refreshToken) : null;
  const existing = await db.select().from(wearableTokens).where(and6(
    eq6(wearableTokens.userId, userId),
    eq6(wearableTokens.provider, provider)
  )).limit(1);
  if (existing[0]) {
    await db.update(wearableTokens).set({
      accessToken: encryptedAccessToken,
      refreshToken: encryptedRefreshToken,
      expiresAt: tokens.expiresAt,
      scope: tokens.scope,
      updatedAt: /* @__PURE__ */ new Date()
    }).where(and6(
      eq6(wearableTokens.userId, userId),
      eq6(wearableTokens.provider, provider)
    ));
  } else {
    await db.insert(wearableTokens).values({
      userId,
      provider,
      accessToken: encryptedAccessToken,
      refreshToken: encryptedRefreshToken,
      expiresAt: tokens.expiresAt,
      scope: tokens.scope
    });
  }
}
async function getDecryptedTokens(userId, provider) {
  const tokenRecord = await db.select().from(wearableTokens).where(and6(
    eq6(wearableTokens.userId, userId),
    eq6(wearableTokens.provider, provider)
  )).limit(1);
  if (!tokenRecord[0]) {
    return null;
  }
  const record = tokenRecord[0];
  const accessToken = open(record.accessToken);
  const refreshToken = record.refreshToken ? open(record.refreshToken) : void 0;
  return {
    accessToken,
    refreshToken,
    expiresAt: record.expiresAt || void 0,
    scope: record.scope || void 0
  };
}
async function deleteTokens(userId, provider) {
  await db.delete(wearableTokens).where(and6(
    eq6(wearableTokens.userId, userId),
    eq6(wearableTokens.provider, provider)
  ));
}

// server/providers/health/mock.ts
var MockHealthProvider = class {
  id = "Mock";
  hasConfig() {
    return true;
  }
  async authCallback(params, userId) {
    await storeEncryptedTokens(userId, this.id, {
      accessToken: `mock_access_token_${Date.now()}`,
      refreshToken: `mock_refresh_token_${Date.now()}`,
      expiresAt: new Date(Date.now() + 365 * 24 * 60 * 60 * 1e3),
      // 1 year from now
      scope: "read_health_data"
    });
  }
  async fetchLatest(userId) {
    const today = (/* @__PURE__ */ new Date()).toISOString().split("T")[0];
    const baseHrv = 30 + Math.random() * 40;
    const baseRestingHR = 55 + Math.random() * 20;
    const baseSleepScore = 70 + Math.random() * 25;
    const baseSteps = 5e3 + Math.random() * 8e3;
    const baseCalories = 1800 + Math.random() * 800;
    const variation = 0.1;
    const hrv = Math.round(baseHrv * (1 + (Math.random() - 0.5) * variation * 2));
    const restingHR = Math.round(baseRestingHR * (1 + (Math.random() - 0.5) * variation));
    const sleepScore = Math.round(baseSleepScore * (1 + (Math.random() - 0.5) * variation));
    const steps = Math.round(baseSteps * (1 + (Math.random() - 0.5) * variation));
    const calories = Math.round(baseCalories * (1 + (Math.random() - 0.5) * variation));
    let stress = Math.round(3 + Math.random() * 4);
    const simulateHighStress = process.env.NODE_ENV === "development" && Math.random() < 0.2;
    if (simulateHighStress) {
      stress = Math.round(7 + Math.random() * 3);
    }
    return {
      date: today,
      hrv,
      restingHR,
      sleepScore,
      stress,
      steps,
      calories
    };
  }
};

// server/dal/wearables.ts
init_supabaseAdmin();
async function upsertWearable(params) {
  const { data, error } = await supabaseAdmin.from("wearable_connections").upsert({
    user_id: params.userId,
    provider: params.provider,
    connected: params.connected,
    last_sync: params.lastSync,
    error: params.error,
    status: params.status || (params.connected ? "connected" : "disconnected")
  }, {
    onConflict: "user_id,provider"
  }).select().single();
  if (error) {
    throw new Error(`Failed to upsert wearable: ${error.message}`);
  }
  return data;
}

// server/lib/oauthState.ts
import crypto6 from "crypto";
var SECRET = process.env.OAUTH_STATE_SECRET;
function signState(payload) {
  const json = JSON.stringify(payload);
  const sig = crypto6.createHmac("sha256", SECRET).update(json).digest("hex");
  return Buffer.from(JSON.stringify({ json, sig })).toString("base64url");
}
function verifyState(token) {
  const { json, sig } = JSON.parse(Buffer.from(token, "base64url").toString());
  const check2 = crypto6.createHmac("sha256", SECRET).update(json).digest("hex");
  if (check2 !== sig) throw new Error("bad state");
  return JSON.parse(json);
}

// server/providers/health/oura.ts
var OURA_AUTH = "https://cloud.ouraring.com/oauth/authorize";
var OURA_TOKEN = "https://cloud.ouraring.com/oauth/token";
var OURA_API = "https://api.ouraring.com/v2/usercollection";
var SITE = process.env.VITE_SITE_URL || process.env.SITE_URL || "https://axle-ebon.vercel.app";
var REDIRECT = `${SITE}/api/connect/Oura/callback`;
var OuraHealthProvider = class {
  id = "Oura";
  hasConfig() {
    return !!(process.env.OURA_CLIENT_ID && process.env.OURA_CLIENT_SECRET);
  }
  async authStart(userId) {
    if (!this.hasConfig()) throw new Error("Oura not configured");
    const state = signState({ userId, t: Date.now() });
    const params = new URLSearchParams({
      response_type: "code",
      client_id: process.env.OURA_CLIENT_ID,
      redirect_uri: REDIRECT,
      // Adjust scopes as needed in your Oura app config
      scope: "daily heartrate activity sleep",
      state
    });
    return { redirectUrl: `${OURA_AUTH}?${params.toString()}` };
  }
  async authCallback(params, userId) {
    const { code, state } = params;
    if (!code || !state) throw new Error("Missing code/state");
    const { userId: stateUserId } = verifyState(state);
    const actualUserId = stateUserId || userId;
    const form = new URLSearchParams({
      grant_type: "authorization_code",
      code,
      redirect_uri: REDIRECT,
      client_id: process.env.OURA_CLIENT_ID,
      client_secret: process.env.OURA_CLIENT_SECRET
    });
    const tokRes = await fetch(OURA_TOKEN, {
      method: "POST",
      headers: { "content-type": "application/x-www-form-urlencoded" },
      body: form.toString()
    });
    const tokens = await tokRes.json();
    if (!tokRes.ok) throw new Error(tokens?.error_description || "token exchange failed");
    await storeEncryptedTokens(actualUserId, "Oura", {
      accessToken: tokens.access_token,
      refreshToken: tokens.refresh_token,
      expiresAt: tokens.expires_in ? new Date(Date.now() + tokens.expires_in * 1e3) : void 0,
      scope: tokens.scope
    });
    await upsertWearable({
      userId: actualUserId,
      provider: "Oura",
      connected: true,
      lastSync: (/* @__PURE__ */ new Date()).toISOString()
    });
  }
  async fetchLatest(userId) {
    const tok = await getDecryptedTokens(userId, "Oura");
    if (!tok?.accessToken) throw new Error("Not connected");
    const auth = { Authorization: `Bearer ${tok.accessToken}` };
    const end = /* @__PURE__ */ new Date();
    const start = new Date(end);
    start.setDate(end.getDate() - 1);
    const fmt = (d) => d.toISOString().slice(0, 10);
    const [sleepRes, activityRes] = await Promise.all([
      fetch(`${OURA_API}/daily_sleep?start_date=${fmt(start)}&end_date=${fmt(end)}`, { headers: auth }),
      fetch(`${OURA_API}/daily_activity?start_date=${fmt(start)}&end_date=${fmt(end)}`, { headers: auth })
    ]);
    const sleepJson = await sleepRes.json();
    const actJson = await activityRes.json();
    const sleep = sleepJson?.data?.[0] || {};
    const activity = actJson?.data?.[0] || {};
    return {
      date: sleep?.day || activity?.day || (/* @__PURE__ */ new Date()).toISOString().slice(0, 10),
      hrv: null,
      // Oura's HRV requires additional endpoint; optional for MVP
      restingHR: sleep?.average_heart_rate ?? sleep?.lowest_heart_rate ?? null,
      sleepScore: sleep?.score ?? null,
      stress: null,
      steps: activity?.steps ?? null,
      calories: activity?.cal_total ?? activity?.active_calories ?? null
    };
  }
};

// server/providers/health/fitbit.ts
var FITBIT_AUTH = "https://www.fitbit.com/oauth2/authorize";
var FITBIT_TOKEN = "https://api.fitbit.com/oauth2/token";
var FITBIT_REVOKE = "https://api.fitbit.com/oauth2/revoke";
var FITBIT_API = "https://api.fitbit.com";
var SITE2 = process.env.VITE_SITE_URL || process.env.SITE_URL || "https://axle-ebon.vercel.app";
var REDIRECT2 = `${SITE2}/api/connect/Fitbit/callback`;
var SCOPES = [
  "activity",
  // steps, calories
  "heartrate",
  // resting HR
  "sleep",
  // sleep + (score in v1.2 endpoints)
  "profile"
].join(" ");
var FitbitHealthProvider = class {
  id = "Fitbit";
  hasConfig() {
    return !!(process.env.FITBIT_CLIENT_ID && process.env.FITBIT_CLIENT_SECRET);
  }
  async authStart(userId) {
    if (!this.hasConfig()) throw new Error("Fitbit not configured");
    const state = signState({ userId, t: Date.now() });
    const params = new URLSearchParams({
      response_type: "code",
      client_id: process.env.FITBIT_CLIENT_ID,
      redirect_uri: REDIRECT2,
      scope: SCOPES,
      state
      // Fitbit recommends PKCE for public apps; for MVP we use confidential client on server
    });
    return { redirectUrl: `${FITBIT_AUTH}?${params.toString()}` };
  }
  async authCallback(params) {
    const { code, state } = params;
    if (!code || !state) throw new Error("Missing code/state");
    const { userId } = verifyState(state);
    const body = new URLSearchParams({
      client_id: process.env.FITBIT_CLIENT_ID,
      grant_type: "authorization_code",
      redirect_uri: REDIRECT2,
      code
    }).toString();
    const tokenRes = await fetch(FITBIT_TOKEN, {
      method: "POST",
      headers: {
        "content-type": "application/x-www-form-urlencoded",
        // Fitbit uses Basic auth with client creds on token endpoint
        Authorization: "Basic " + Buffer.from(
          `${process.env.FITBIT_CLIENT_ID}:${process.env.FITBIT_CLIENT_SECRET}`
        ).toString("base64")
      },
      body
    });
    const tokens = await tokenRes.json();
    if (!tokenRes.ok) throw new Error(tokens?.errors?.[0]?.message || "token exchange failed");
    await storeEncryptedTokens(userId, "Fitbit", {
      accessToken: tokens.access_token,
      refreshToken: tokens.refresh_token,
      expiresAt: tokens.expires_in ? new Date(Date.now() + tokens.expires_in * 1e3) : void 0,
      scope: tokens.scope
    });
    await upsertWearable({
      userId,
      provider: "Fitbit",
      connected: true,
      lastSync: null
    });
  }
  async ensureToken(userId) {
    const t2 = await getDecryptedTokens(userId, "Fitbit");
    if (!t2?.accessToken) throw new Error("Not connected");
    if (t2.expiresAt && Date.now() > t2.expiresAt.getTime() - 12e4 && t2.refreshToken) {
      const body = new URLSearchParams({
        grant_type: "refresh_token",
        refresh_token: t2.refreshToken
      }).toString();
      const res = await fetch(FITBIT_TOKEN, {
        method: "POST",
        headers: {
          "content-type": "application/x-www-form-urlencoded",
          Authorization: "Basic " + Buffer.from(
            `${process.env.FITBIT_CLIENT_ID}:${process.env.FITBIT_CLIENT_SECRET}`
          ).toString("base64")
        },
        body
      });
      const j = await res.json();
      if (res.ok) {
        await storeEncryptedTokens(userId, "Fitbit", {
          accessToken: j.access_token,
          refreshToken: j.refresh_token ?? t2.refreshToken,
          expiresAt: j.expires_in ? new Date(Date.now() + j.expires_in * 1e3) : t2.expiresAt,
          scope: j.scope ?? t2.scope
        });
        return j.access_token;
      }
    }
    return t2.accessToken;
  }
  async fetchLatest(userId) {
    const access = await this.ensureToken(userId);
    const auth = { Authorization: `Bearer ${access}` };
    const today = /* @__PURE__ */ new Date();
    const yyyy = today.getFullYear();
    const mm = String(today.getMonth() + 1).padStart(2, "0");
    const dd = String(today.getDate()).padStart(2, "0");
    const d = `${yyyy}-${mm}-${dd}`;
    const actRes = await fetch(`${FITBIT_API}/1/user/-/activities/date/${d}.json`, { headers: auth });
    const act = await actRes.json();
    const hrRes = await fetch(`${FITBIT_API}/1/user/-/activities/heart/date/${d}/1d.json`, { headers: auth });
    const hr = await hrRes.json();
    const sleepRes = await fetch(`${FITBIT_API}/1.2/user/-/sleep/date/${d}.json`, { headers: auth });
    const sleep = await sleepRes.json();
    let hrv_ms = null;
    try {
      const hrvRes = await fetch(`${FITBIT_API}/1/user/-/hrv/date/${d}/1d.json`, { headers: auth });
      if (hrvRes.ok) {
        const hrv = await hrvRes.json();
        const v = hrv?.hrv?.[0]?.value?.dailyRmssd;
        hrv_ms = typeof v === "number" ? v : null;
      }
    } catch {
    }
    const steps = act?.summary?.steps ?? null;
    const calories = act?.summary?.caloriesOut ?? act?.summary?.calories ?? null;
    const resting_hr_bpm = hr?.["activities-heart"]?.[0]?.value?.restingHeartRate ?? null;
    const sleep_score = sleep?.summary?.["stages"]?.score ?? sleep?.sleep?.[0]?.score ?? null;
    const snapshot = {
      provider: "Fitbit",
      date: d,
      hrv_ms,
      resting_hr_bpm,
      sleep_score,
      stress_0_10: null,
      steps,
      calories,
      raw: { act, hr, sleep }
    };
    return snapshot;
  }
  // Optional helper if you add disconnect route
  async revoke(userId) {
    const t2 = await getDecryptedTokens(userId, "Fitbit");
    if (!t2?.accessToken) return;
    await fetch(FITBIT_REVOKE, {
      method: "POST",
      headers: {
        "content-type": "application/x-www-form-urlencoded",
        Authorization: "Basic " + Buffer.from(
          `${process.env.FITBIT_CLIENT_ID}:${process.env.FITBIT_CLIENT_SECRET}`
        ).toString("base64")
      },
      body: new URLSearchParams({ token: t2.accessToken }).toString()
    }).catch(() => {
    });
    await deleteTokens(userId, "Fitbit");
    await upsertWearable({
      userId,
      provider: "Fitbit",
      connected: false,
      lastSync: null
    });
  }
};

// node_modules/date-fns/toDate.mjs
function toDate(argument) {
  const argStr = Object.prototype.toString.call(argument);
  if (argument instanceof Date || typeof argument === "object" && argStr === "[object Date]") {
    return new argument.constructor(+argument);
  } else if (typeof argument === "number" || argStr === "[object Number]" || typeof argument === "string" || argStr === "[object String]") {
    return new Date(argument);
  } else {
    return /* @__PURE__ */ new Date(NaN);
  }
}

// node_modules/date-fns/constructFrom.mjs
function constructFrom(date2, value) {
  if (date2 instanceof Date) {
    return new date2.constructor(value);
  } else {
    return new Date(value);
  }
}

// node_modules/date-fns/addDays.mjs
function addDays(date2, amount) {
  const _date = toDate(date2);
  if (isNaN(amount)) return constructFrom(date2, NaN);
  if (!amount) {
    return _date;
  }
  _date.setDate(_date.getDate() + amount);
  return _date;
}

// node_modules/date-fns/addMilliseconds.mjs
function addMilliseconds(date2, amount) {
  const timestamp2 = +toDate(date2);
  return constructFrom(date2, timestamp2 + amount);
}

// node_modules/date-fns/constants.mjs
var daysInYear = 365.2425;
var maxTime = Math.pow(10, 8) * 24 * 60 * 60 * 1e3;
var minTime = -maxTime;
var millisecondsInWeek = 6048e5;
var millisecondsInDay = 864e5;
var millisecondsInMinute = 6e4;
var millisecondsInHour = 36e5;
var secondsInHour = 3600;
var secondsInDay = secondsInHour * 24;
var secondsInWeek = secondsInDay * 7;
var secondsInYear = secondsInDay * daysInYear;
var secondsInMonth = secondsInYear / 12;
var secondsInQuarter = secondsInMonth * 3;

// node_modules/date-fns/_lib/defaultOptions.mjs
var defaultOptions = {};
function getDefaultOptions() {
  return defaultOptions;
}

// node_modules/date-fns/startOfWeek.mjs
function startOfWeek(date2, options) {
  const defaultOptions2 = getDefaultOptions();
  const weekStartsOn = options?.weekStartsOn ?? options?.locale?.options?.weekStartsOn ?? defaultOptions2.weekStartsOn ?? defaultOptions2.locale?.options?.weekStartsOn ?? 0;
  const _date = toDate(date2);
  const day = _date.getDay();
  const diff = (day < weekStartsOn ? 7 : 0) + day - weekStartsOn;
  _date.setDate(_date.getDate() - diff);
  _date.setHours(0, 0, 0, 0);
  return _date;
}

// node_modules/date-fns/startOfISOWeek.mjs
function startOfISOWeek(date2) {
  return startOfWeek(date2, { weekStartsOn: 1 });
}

// node_modules/date-fns/getISOWeekYear.mjs
function getISOWeekYear(date2) {
  const _date = toDate(date2);
  const year = _date.getFullYear();
  const fourthOfJanuaryOfNextYear = constructFrom(date2, 0);
  fourthOfJanuaryOfNextYear.setFullYear(year + 1, 0, 4);
  fourthOfJanuaryOfNextYear.setHours(0, 0, 0, 0);
  const startOfNextYear = startOfISOWeek(fourthOfJanuaryOfNextYear);
  const fourthOfJanuaryOfThisYear = constructFrom(date2, 0);
  fourthOfJanuaryOfThisYear.setFullYear(year, 0, 4);
  fourthOfJanuaryOfThisYear.setHours(0, 0, 0, 0);
  const startOfThisYear = startOfISOWeek(fourthOfJanuaryOfThisYear);
  if (_date.getTime() >= startOfNextYear.getTime()) {
    return year + 1;
  } else if (_date.getTime() >= startOfThisYear.getTime()) {
    return year;
  } else {
    return year - 1;
  }
}

// node_modules/date-fns/startOfDay.mjs
function startOfDay(date2) {
  const _date = toDate(date2);
  _date.setHours(0, 0, 0, 0);
  return _date;
}

// node_modules/date-fns/_lib/getTimezoneOffsetInMilliseconds.mjs
function getTimezoneOffsetInMilliseconds(date2) {
  const _date = toDate(date2);
  const utcDate = new Date(
    Date.UTC(
      _date.getFullYear(),
      _date.getMonth(),
      _date.getDate(),
      _date.getHours(),
      _date.getMinutes(),
      _date.getSeconds(),
      _date.getMilliseconds()
    )
  );
  utcDate.setUTCFullYear(_date.getFullYear());
  return +date2 - +utcDate;
}

// node_modules/date-fns/differenceInCalendarDays.mjs
function differenceInCalendarDays(dateLeft, dateRight) {
  const startOfDayLeft = startOfDay(dateLeft);
  const startOfDayRight = startOfDay(dateRight);
  const timestampLeft = +startOfDayLeft - getTimezoneOffsetInMilliseconds(startOfDayLeft);
  const timestampRight = +startOfDayRight - getTimezoneOffsetInMilliseconds(startOfDayRight);
  return Math.round((timestampLeft - timestampRight) / millisecondsInDay);
}

// node_modules/date-fns/startOfISOWeekYear.mjs
function startOfISOWeekYear(date2) {
  const year = getISOWeekYear(date2);
  const fourthOfJanuary = constructFrom(date2, 0);
  fourthOfJanuary.setFullYear(year, 0, 4);
  fourthOfJanuary.setHours(0, 0, 0, 0);
  return startOfISOWeek(fourthOfJanuary);
}

// node_modules/date-fns/addMinutes.mjs
function addMinutes(date2, amount) {
  return addMilliseconds(date2, amount * millisecondsInMinute);
}

// node_modules/date-fns/isDate.mjs
function isDate(value) {
  return value instanceof Date || typeof value === "object" && Object.prototype.toString.call(value) === "[object Date]";
}

// node_modules/date-fns/isValid.mjs
function isValid(date2) {
  if (!isDate(date2) && typeof date2 !== "number") {
    return false;
  }
  const _date = toDate(date2);
  return !isNaN(Number(_date));
}

// node_modules/date-fns/startOfYear.mjs
function startOfYear(date2) {
  const cleanDate = toDate(date2);
  const _date = constructFrom(date2, 0);
  _date.setFullYear(cleanDate.getFullYear(), 0, 1);
  _date.setHours(0, 0, 0, 0);
  return _date;
}

// node_modules/date-fns/locale/en-US/_lib/formatDistance.mjs
var formatDistanceLocale = {
  lessThanXSeconds: {
    one: "less than a second",
    other: "less than {{count}} seconds"
  },
  xSeconds: {
    one: "1 second",
    other: "{{count}} seconds"
  },
  halfAMinute: "half a minute",
  lessThanXMinutes: {
    one: "less than a minute",
    other: "less than {{count}} minutes"
  },
  xMinutes: {
    one: "1 minute",
    other: "{{count}} minutes"
  },
  aboutXHours: {
    one: "about 1 hour",
    other: "about {{count}} hours"
  },
  xHours: {
    one: "1 hour",
    other: "{{count}} hours"
  },
  xDays: {
    one: "1 day",
    other: "{{count}} days"
  },
  aboutXWeeks: {
    one: "about 1 week",
    other: "about {{count}} weeks"
  },
  xWeeks: {
    one: "1 week",
    other: "{{count}} weeks"
  },
  aboutXMonths: {
    one: "about 1 month",
    other: "about {{count}} months"
  },
  xMonths: {
    one: "1 month",
    other: "{{count}} months"
  },
  aboutXYears: {
    one: "about 1 year",
    other: "about {{count}} years"
  },
  xYears: {
    one: "1 year",
    other: "{{count}} years"
  },
  overXYears: {
    one: "over 1 year",
    other: "over {{count}} years"
  },
  almostXYears: {
    one: "almost 1 year",
    other: "almost {{count}} years"
  }
};
var formatDistance = (token, count2, options) => {
  let result;
  const tokenValue = formatDistanceLocale[token];
  if (typeof tokenValue === "string") {
    result = tokenValue;
  } else if (count2 === 1) {
    result = tokenValue.one;
  } else {
    result = tokenValue.other.replace("{{count}}", count2.toString());
  }
  if (options?.addSuffix) {
    if (options.comparison && options.comparison > 0) {
      return "in " + result;
    } else {
      return result + " ago";
    }
  }
  return result;
};

// node_modules/date-fns/locale/_lib/buildFormatLongFn.mjs
function buildFormatLongFn(args) {
  return (options = {}) => {
    const width = options.width ? String(options.width) : args.defaultWidth;
    const format3 = args.formats[width] || args.formats[args.defaultWidth];
    return format3;
  };
}

// node_modules/date-fns/locale/en-US/_lib/formatLong.mjs
var dateFormats = {
  full: "EEEE, MMMM do, y",
  long: "MMMM do, y",
  medium: "MMM d, y",
  short: "MM/dd/yyyy"
};
var timeFormats = {
  full: "h:mm:ss a zzzz",
  long: "h:mm:ss a z",
  medium: "h:mm:ss a",
  short: "h:mm a"
};
var dateTimeFormats = {
  full: "{{date}} 'at' {{time}}",
  long: "{{date}} 'at' {{time}}",
  medium: "{{date}}, {{time}}",
  short: "{{date}}, {{time}}"
};
var formatLong = {
  date: buildFormatLongFn({
    formats: dateFormats,
    defaultWidth: "full"
  }),
  time: buildFormatLongFn({
    formats: timeFormats,
    defaultWidth: "full"
  }),
  dateTime: buildFormatLongFn({
    formats: dateTimeFormats,
    defaultWidth: "full"
  })
};

// node_modules/date-fns/locale/en-US/_lib/formatRelative.mjs
var formatRelativeLocale = {
  lastWeek: "'last' eeee 'at' p",
  yesterday: "'yesterday at' p",
  today: "'today at' p",
  tomorrow: "'tomorrow at' p",
  nextWeek: "eeee 'at' p",
  other: "P"
};
var formatRelative = (token, _date, _baseDate, _options) => formatRelativeLocale[token];

// node_modules/date-fns/locale/_lib/buildLocalizeFn.mjs
function buildLocalizeFn(args) {
  return (value, options) => {
    const context = options?.context ? String(options.context) : "standalone";
    let valuesArray;
    if (context === "formatting" && args.formattingValues) {
      const defaultWidth = args.defaultFormattingWidth || args.defaultWidth;
      const width = options?.width ? String(options.width) : defaultWidth;
      valuesArray = args.formattingValues[width] || args.formattingValues[defaultWidth];
    } else {
      const defaultWidth = args.defaultWidth;
      const width = options?.width ? String(options.width) : args.defaultWidth;
      valuesArray = args.values[width] || args.values[defaultWidth];
    }
    const index2 = args.argumentCallback ? args.argumentCallback(value) : value;
    return valuesArray[index2];
  };
}

// node_modules/date-fns/locale/en-US/_lib/localize.mjs
var eraValues = {
  narrow: ["B", "A"],
  abbreviated: ["BC", "AD"],
  wide: ["Before Christ", "Anno Domini"]
};
var quarterValues = {
  narrow: ["1", "2", "3", "4"],
  abbreviated: ["Q1", "Q2", "Q3", "Q4"],
  wide: ["1st quarter", "2nd quarter", "3rd quarter", "4th quarter"]
};
var monthValues = {
  narrow: ["J", "F", "M", "A", "M", "J", "J", "A", "S", "O", "N", "D"],
  abbreviated: [
    "Jan",
    "Feb",
    "Mar",
    "Apr",
    "May",
    "Jun",
    "Jul",
    "Aug",
    "Sep",
    "Oct",
    "Nov",
    "Dec"
  ],
  wide: [
    "January",
    "February",
    "March",
    "April",
    "May",
    "June",
    "July",
    "August",
    "September",
    "October",
    "November",
    "December"
  ]
};
var dayValues = {
  narrow: ["S", "M", "T", "W", "T", "F", "S"],
  short: ["Su", "Mo", "Tu", "We", "Th", "Fr", "Sa"],
  abbreviated: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"],
  wide: [
    "Sunday",
    "Monday",
    "Tuesday",
    "Wednesday",
    "Thursday",
    "Friday",
    "Saturday"
  ]
};
var dayPeriodValues = {
  narrow: {
    am: "a",
    pm: "p",
    midnight: "mi",
    noon: "n",
    morning: "morning",
    afternoon: "afternoon",
    evening: "evening",
    night: "night"
  },
  abbreviated: {
    am: "AM",
    pm: "PM",
    midnight: "midnight",
    noon: "noon",
    morning: "morning",
    afternoon: "afternoon",
    evening: "evening",
    night: "night"
  },
  wide: {
    am: "a.m.",
    pm: "p.m.",
    midnight: "midnight",
    noon: "noon",
    morning: "morning",
    afternoon: "afternoon",
    evening: "evening",
    night: "night"
  }
};
var formattingDayPeriodValues = {
  narrow: {
    am: "a",
    pm: "p",
    midnight: "mi",
    noon: "n",
    morning: "in the morning",
    afternoon: "in the afternoon",
    evening: "in the evening",
    night: "at night"
  },
  abbreviated: {
    am: "AM",
    pm: "PM",
    midnight: "midnight",
    noon: "noon",
    morning: "in the morning",
    afternoon: "in the afternoon",
    evening: "in the evening",
    night: "at night"
  },
  wide: {
    am: "a.m.",
    pm: "p.m.",
    midnight: "midnight",
    noon: "noon",
    morning: "in the morning",
    afternoon: "in the afternoon",
    evening: "in the evening",
    night: "at night"
  }
};
var ordinalNumber = (dirtyNumber, _options) => {
  const number = Number(dirtyNumber);
  const rem100 = number % 100;
  if (rem100 > 20 || rem100 < 10) {
    switch (rem100 % 10) {
      case 1:
        return number + "st";
      case 2:
        return number + "nd";
      case 3:
        return number + "rd";
    }
  }
  return number + "th";
};
var localize = {
  ordinalNumber,
  era: buildLocalizeFn({
    values: eraValues,
    defaultWidth: "wide"
  }),
  quarter: buildLocalizeFn({
    values: quarterValues,
    defaultWidth: "wide",
    argumentCallback: (quarter) => quarter - 1
  }),
  month: buildLocalizeFn({
    values: monthValues,
    defaultWidth: "wide"
  }),
  day: buildLocalizeFn({
    values: dayValues,
    defaultWidth: "wide"
  }),
  dayPeriod: buildLocalizeFn({
    values: dayPeriodValues,
    defaultWidth: "wide",
    formattingValues: formattingDayPeriodValues,
    defaultFormattingWidth: "wide"
  })
};

// node_modules/date-fns/locale/_lib/buildMatchFn.mjs
function buildMatchFn(args) {
  return (string, options = {}) => {
    const width = options.width;
    const matchPattern = width && args.matchPatterns[width] || args.matchPatterns[args.defaultMatchWidth];
    const matchResult = string.match(matchPattern);
    if (!matchResult) {
      return null;
    }
    const matchedString = matchResult[0];
    const parsePatterns = width && args.parsePatterns[width] || args.parsePatterns[args.defaultParseWidth];
    const key = Array.isArray(parsePatterns) ? findIndex(parsePatterns, (pattern) => pattern.test(matchedString)) : (
      // eslint-disable-next-line @typescript-eslint/no-explicit-any -- I challange you to fix the type
      findKey(parsePatterns, (pattern) => pattern.test(matchedString))
    );
    let value;
    value = args.valueCallback ? args.valueCallback(key) : key;
    value = options.valueCallback ? (
      // eslint-disable-next-line @typescript-eslint/no-explicit-any -- I challange you to fix the type
      options.valueCallback(value)
    ) : value;
    const rest = string.slice(matchedString.length);
    return { value, rest };
  };
}
function findKey(object, predicate) {
  for (const key in object) {
    if (Object.prototype.hasOwnProperty.call(object, key) && predicate(object[key])) {
      return key;
    }
  }
  return void 0;
}
function findIndex(array, predicate) {
  for (let key = 0; key < array.length; key++) {
    if (predicate(array[key])) {
      return key;
    }
  }
  return void 0;
}

// node_modules/date-fns/locale/_lib/buildMatchPatternFn.mjs
function buildMatchPatternFn(args) {
  return (string, options = {}) => {
    const matchResult = string.match(args.matchPattern);
    if (!matchResult) return null;
    const matchedString = matchResult[0];
    const parseResult = string.match(args.parsePattern);
    if (!parseResult) return null;
    let value = args.valueCallback ? args.valueCallback(parseResult[0]) : parseResult[0];
    value = options.valueCallback ? options.valueCallback(value) : value;
    const rest = string.slice(matchedString.length);
    return { value, rest };
  };
}

// node_modules/date-fns/locale/en-US/_lib/match.mjs
var matchOrdinalNumberPattern = /^(\d+)(th|st|nd|rd)?/i;
var parseOrdinalNumberPattern = /\d+/i;
var matchEraPatterns = {
  narrow: /^(b|a)/i,
  abbreviated: /^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,
  wide: /^(before christ|before common era|anno domini|common era)/i
};
var parseEraPatterns = {
  any: [/^b/i, /^(a|c)/i]
};
var matchQuarterPatterns = {
  narrow: /^[1234]/i,
  abbreviated: /^q[1234]/i,
  wide: /^[1234](th|st|nd|rd)? quarter/i
};
var parseQuarterPatterns = {
  any: [/1/i, /2/i, /3/i, /4/i]
};
var matchMonthPatterns = {
  narrow: /^[jfmasond]/i,
  abbreviated: /^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,
  wide: /^(january|february|march|april|may|june|july|august|september|october|november|december)/i
};
var parseMonthPatterns = {
  narrow: [
    /^j/i,
    /^f/i,
    /^m/i,
    /^a/i,
    /^m/i,
    /^j/i,
    /^j/i,
    /^a/i,
    /^s/i,
    /^o/i,
    /^n/i,
    /^d/i
  ],
  any: [
    /^ja/i,
    /^f/i,
    /^mar/i,
    /^ap/i,
    /^may/i,
    /^jun/i,
    /^jul/i,
    /^au/i,
    /^s/i,
    /^o/i,
    /^n/i,
    /^d/i
  ]
};
var matchDayPatterns = {
  narrow: /^[smtwf]/i,
  short: /^(su|mo|tu|we|th|fr|sa)/i,
  abbreviated: /^(sun|mon|tue|wed|thu|fri|sat)/i,
  wide: /^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i
};
var parseDayPatterns = {
  narrow: [/^s/i, /^m/i, /^t/i, /^w/i, /^t/i, /^f/i, /^s/i],
  any: [/^su/i, /^m/i, /^tu/i, /^w/i, /^th/i, /^f/i, /^sa/i]
};
var matchDayPeriodPatterns = {
  narrow: /^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,
  any: /^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i
};
var parseDayPeriodPatterns = {
  any: {
    am: /^a/i,
    pm: /^p/i,
    midnight: /^mi/i,
    noon: /^no/i,
    morning: /morning/i,
    afternoon: /afternoon/i,
    evening: /evening/i,
    night: /night/i
  }
};
var match = {
  ordinalNumber: buildMatchPatternFn({
    matchPattern: matchOrdinalNumberPattern,
    parsePattern: parseOrdinalNumberPattern,
    valueCallback: (value) => parseInt(value, 10)
  }),
  era: buildMatchFn({
    matchPatterns: matchEraPatterns,
    defaultMatchWidth: "wide",
    parsePatterns: parseEraPatterns,
    defaultParseWidth: "any"
  }),
  quarter: buildMatchFn({
    matchPatterns: matchQuarterPatterns,
    defaultMatchWidth: "wide",
    parsePatterns: parseQuarterPatterns,
    defaultParseWidth: "any",
    valueCallback: (index2) => index2 + 1
  }),
  month: buildMatchFn({
    matchPatterns: matchMonthPatterns,
    defaultMatchWidth: "wide",
    parsePatterns: parseMonthPatterns,
    defaultParseWidth: "any"
  }),
  day: buildMatchFn({
    matchPatterns: matchDayPatterns,
    defaultMatchWidth: "wide",
    parsePatterns: parseDayPatterns,
    defaultParseWidth: "any"
  }),
  dayPeriod: buildMatchFn({
    matchPatterns: matchDayPeriodPatterns,
    defaultMatchWidth: "any",
    parsePatterns: parseDayPeriodPatterns,
    defaultParseWidth: "any"
  })
};

// node_modules/date-fns/locale/en-US.mjs
var enUS = {
  code: "en-US",
  formatDistance,
  formatLong,
  formatRelative,
  localize,
  match,
  options: {
    weekStartsOn: 0,
    firstWeekContainsDate: 1
  }
};

// node_modules/date-fns/getDayOfYear.mjs
function getDayOfYear(date2) {
  const _date = toDate(date2);
  const diff = differenceInCalendarDays(_date, startOfYear(_date));
  const dayOfYear = diff + 1;
  return dayOfYear;
}

// node_modules/date-fns/getISOWeek.mjs
function getISOWeek(date2) {
  const _date = toDate(date2);
  const diff = +startOfISOWeek(_date) - +startOfISOWeekYear(_date);
  return Math.round(diff / millisecondsInWeek) + 1;
}

// node_modules/date-fns/getWeekYear.mjs
function getWeekYear(date2, options) {
  const _date = toDate(date2);
  const year = _date.getFullYear();
  const defaultOptions2 = getDefaultOptions();
  const firstWeekContainsDate = options?.firstWeekContainsDate ?? options?.locale?.options?.firstWeekContainsDate ?? defaultOptions2.firstWeekContainsDate ?? defaultOptions2.locale?.options?.firstWeekContainsDate ?? 1;
  const firstWeekOfNextYear = constructFrom(date2, 0);
  firstWeekOfNextYear.setFullYear(year + 1, 0, firstWeekContainsDate);
  firstWeekOfNextYear.setHours(0, 0, 0, 0);
  const startOfNextYear = startOfWeek(firstWeekOfNextYear, options);
  const firstWeekOfThisYear = constructFrom(date2, 0);
  firstWeekOfThisYear.setFullYear(year, 0, firstWeekContainsDate);
  firstWeekOfThisYear.setHours(0, 0, 0, 0);
  const startOfThisYear = startOfWeek(firstWeekOfThisYear, options);
  if (_date.getTime() >= startOfNextYear.getTime()) {
    return year + 1;
  } else if (_date.getTime() >= startOfThisYear.getTime()) {
    return year;
  } else {
    return year - 1;
  }
}

// node_modules/date-fns/startOfWeekYear.mjs
function startOfWeekYear(date2, options) {
  const defaultOptions2 = getDefaultOptions();
  const firstWeekContainsDate = options?.firstWeekContainsDate ?? options?.locale?.options?.firstWeekContainsDate ?? defaultOptions2.firstWeekContainsDate ?? defaultOptions2.locale?.options?.firstWeekContainsDate ?? 1;
  const year = getWeekYear(date2, options);
  const firstWeek = constructFrom(date2, 0);
  firstWeek.setFullYear(year, 0, firstWeekContainsDate);
  firstWeek.setHours(0, 0, 0, 0);
  const _date = startOfWeek(firstWeek, options);
  return _date;
}

// node_modules/date-fns/getWeek.mjs
function getWeek(date2, options) {
  const _date = toDate(date2);
  const diff = +startOfWeek(_date, options) - +startOfWeekYear(_date, options);
  return Math.round(diff / millisecondsInWeek) + 1;
}

// node_modules/date-fns/_lib/addLeadingZeros.mjs
function addLeadingZeros(number, targetLength) {
  const sign = number < 0 ? "-" : "";
  const output = Math.abs(number).toString().padStart(targetLength, "0");
  return sign + output;
}

// node_modules/date-fns/_lib/format/lightFormatters.mjs
var lightFormatters = {
  // Year
  y(date2, token) {
    const signedYear = date2.getFullYear();
    const year = signedYear > 0 ? signedYear : 1 - signedYear;
    return addLeadingZeros(token === "yy" ? year % 100 : year, token.length);
  },
  // Month
  M(date2, token) {
    const month = date2.getMonth();
    return token === "M" ? String(month + 1) : addLeadingZeros(month + 1, 2);
  },
  // Day of the month
  d(date2, token) {
    return addLeadingZeros(date2.getDate(), token.length);
  },
  // AM or PM
  a(date2, token) {
    const dayPeriodEnumValue = date2.getHours() / 12 >= 1 ? "pm" : "am";
    switch (token) {
      case "a":
      case "aa":
        return dayPeriodEnumValue.toUpperCase();
      case "aaa":
        return dayPeriodEnumValue;
      case "aaaaa":
        return dayPeriodEnumValue[0];
      case "aaaa":
      default:
        return dayPeriodEnumValue === "am" ? "a.m." : "p.m.";
    }
  },
  // Hour [1-12]
  h(date2, token) {
    return addLeadingZeros(date2.getHours() % 12 || 12, token.length);
  },
  // Hour [0-23]
  H(date2, token) {
    return addLeadingZeros(date2.getHours(), token.length);
  },
  // Minute
  m(date2, token) {
    return addLeadingZeros(date2.getMinutes(), token.length);
  },
  // Second
  s(date2, token) {
    return addLeadingZeros(date2.getSeconds(), token.length);
  },
  // Fraction of second
  S(date2, token) {
    const numberOfDigits = token.length;
    const milliseconds = date2.getMilliseconds();
    const fractionalSeconds = Math.trunc(
      milliseconds * Math.pow(10, numberOfDigits - 3)
    );
    return addLeadingZeros(fractionalSeconds, token.length);
  }
};

// node_modules/date-fns/_lib/format/formatters.mjs
var dayPeriodEnum = {
  am: "am",
  pm: "pm",
  midnight: "midnight",
  noon: "noon",
  morning: "morning",
  afternoon: "afternoon",
  evening: "evening",
  night: "night"
};
var formatters = {
  // Era
  G: function(date2, token, localize2) {
    const era = date2.getFullYear() > 0 ? 1 : 0;
    switch (token) {
      // AD, BC
      case "G":
      case "GG":
      case "GGG":
        return localize2.era(era, { width: "abbreviated" });
      // A, B
      case "GGGGG":
        return localize2.era(era, { width: "narrow" });
      // Anno Domini, Before Christ
      case "GGGG":
      default:
        return localize2.era(era, { width: "wide" });
    }
  },
  // Year
  y: function(date2, token, localize2) {
    if (token === "yo") {
      const signedYear = date2.getFullYear();
      const year = signedYear > 0 ? signedYear : 1 - signedYear;
      return localize2.ordinalNumber(year, { unit: "year" });
    }
    return lightFormatters.y(date2, token);
  },
  // Local week-numbering year
  Y: function(date2, token, localize2, options) {
    const signedWeekYear = getWeekYear(date2, options);
    const weekYear = signedWeekYear > 0 ? signedWeekYear : 1 - signedWeekYear;
    if (token === "YY") {
      const twoDigitYear = weekYear % 100;
      return addLeadingZeros(twoDigitYear, 2);
    }
    if (token === "Yo") {
      return localize2.ordinalNumber(weekYear, { unit: "year" });
    }
    return addLeadingZeros(weekYear, token.length);
  },
  // ISO week-numbering year
  R: function(date2, token) {
    const isoWeekYear = getISOWeekYear(date2);
    return addLeadingZeros(isoWeekYear, token.length);
  },
  // Extended year. This is a single number designating the year of this calendar system.
  // The main difference between `y` and `u` localizers are B.C. years:
  // | Year | `y` | `u` |
  // |------|-----|-----|
  // | AC 1 |   1 |   1 |
  // | BC 1 |   1 |   0 |
  // | BC 2 |   2 |  -1 |
  // Also `yy` always returns the last two digits of a year,
  // while `uu` pads single digit years to 2 characters and returns other years unchanged.
  u: function(date2, token) {
    const year = date2.getFullYear();
    return addLeadingZeros(year, token.length);
  },
  // Quarter
  Q: function(date2, token, localize2) {
    const quarter = Math.ceil((date2.getMonth() + 1) / 3);
    switch (token) {
      // 1, 2, 3, 4
      case "Q":
        return String(quarter);
      // 01, 02, 03, 04
      case "QQ":
        return addLeadingZeros(quarter, 2);
      // 1st, 2nd, 3rd, 4th
      case "Qo":
        return localize2.ordinalNumber(quarter, { unit: "quarter" });
      // Q1, Q2, Q3, Q4
      case "QQQ":
        return localize2.quarter(quarter, {
          width: "abbreviated",
          context: "formatting"
        });
      // 1, 2, 3, 4 (narrow quarter; could be not numerical)
      case "QQQQQ":
        return localize2.quarter(quarter, {
          width: "narrow",
          context: "formatting"
        });
      // 1st quarter, 2nd quarter, ...
      case "QQQQ":
      default:
        return localize2.quarter(quarter, {
          width: "wide",
          context: "formatting"
        });
    }
  },
  // Stand-alone quarter
  q: function(date2, token, localize2) {
    const quarter = Math.ceil((date2.getMonth() + 1) / 3);
    switch (token) {
      // 1, 2, 3, 4
      case "q":
        return String(quarter);
      // 01, 02, 03, 04
      case "qq":
        return addLeadingZeros(quarter, 2);
      // 1st, 2nd, 3rd, 4th
      case "qo":
        return localize2.ordinalNumber(quarter, { unit: "quarter" });
      // Q1, Q2, Q3, Q4
      case "qqq":
        return localize2.quarter(quarter, {
          width: "abbreviated",
          context: "standalone"
        });
      // 1, 2, 3, 4 (narrow quarter; could be not numerical)
      case "qqqqq":
        return localize2.quarter(quarter, {
          width: "narrow",
          context: "standalone"
        });
      // 1st quarter, 2nd quarter, ...
      case "qqqq":
      default:
        return localize2.quarter(quarter, {
          width: "wide",
          context: "standalone"
        });
    }
  },
  // Month
  M: function(date2, token, localize2) {
    const month = date2.getMonth();
    switch (token) {
      case "M":
      case "MM":
        return lightFormatters.M(date2, token);
      // 1st, 2nd, ..., 12th
      case "Mo":
        return localize2.ordinalNumber(month + 1, { unit: "month" });
      // Jan, Feb, ..., Dec
      case "MMM":
        return localize2.month(month, {
          width: "abbreviated",
          context: "formatting"
        });
      // J, F, ..., D
      case "MMMMM":
        return localize2.month(month, {
          width: "narrow",
          context: "formatting"
        });
      // January, February, ..., December
      case "MMMM":
      default:
        return localize2.month(month, { width: "wide", context: "formatting" });
    }
  },
  // Stand-alone month
  L: function(date2, token, localize2) {
    const month = date2.getMonth();
    switch (token) {
      // 1, 2, ..., 12
      case "L":
        return String(month + 1);
      // 01, 02, ..., 12
      case "LL":
        return addLeadingZeros(month + 1, 2);
      // 1st, 2nd, ..., 12th
      case "Lo":
        return localize2.ordinalNumber(month + 1, { unit: "month" });
      // Jan, Feb, ..., Dec
      case "LLL":
        return localize2.month(month, {
          width: "abbreviated",
          context: "standalone"
        });
      // J, F, ..., D
      case "LLLLL":
        return localize2.month(month, {
          width: "narrow",
          context: "standalone"
        });
      // January, February, ..., December
      case "LLLL":
      default:
        return localize2.month(month, { width: "wide", context: "standalone" });
    }
  },
  // Local week of year
  w: function(date2, token, localize2, options) {
    const week = getWeek(date2, options);
    if (token === "wo") {
      return localize2.ordinalNumber(week, { unit: "week" });
    }
    return addLeadingZeros(week, token.length);
  },
  // ISO week of year
  I: function(date2, token, localize2) {
    const isoWeek = getISOWeek(date2);
    if (token === "Io") {
      return localize2.ordinalNumber(isoWeek, { unit: "week" });
    }
    return addLeadingZeros(isoWeek, token.length);
  },
  // Day of the month
  d: function(date2, token, localize2) {
    if (token === "do") {
      return localize2.ordinalNumber(date2.getDate(), { unit: "date" });
    }
    return lightFormatters.d(date2, token);
  },
  // Day of year
  D: function(date2, token, localize2) {
    const dayOfYear = getDayOfYear(date2);
    if (token === "Do") {
      return localize2.ordinalNumber(dayOfYear, { unit: "dayOfYear" });
    }
    return addLeadingZeros(dayOfYear, token.length);
  },
  // Day of week
  E: function(date2, token, localize2) {
    const dayOfWeek = date2.getDay();
    switch (token) {
      // Tue
      case "E":
      case "EE":
      case "EEE":
        return localize2.day(dayOfWeek, {
          width: "abbreviated",
          context: "formatting"
        });
      // T
      case "EEEEE":
        return localize2.day(dayOfWeek, {
          width: "narrow",
          context: "formatting"
        });
      // Tu
      case "EEEEEE":
        return localize2.day(dayOfWeek, {
          width: "short",
          context: "formatting"
        });
      // Tuesday
      case "EEEE":
      default:
        return localize2.day(dayOfWeek, {
          width: "wide",
          context: "formatting"
        });
    }
  },
  // Local day of week
  e: function(date2, token, localize2, options) {
    const dayOfWeek = date2.getDay();
    const localDayOfWeek = (dayOfWeek - options.weekStartsOn + 8) % 7 || 7;
    switch (token) {
      // Numerical value (Nth day of week with current locale or weekStartsOn)
      case "e":
        return String(localDayOfWeek);
      // Padded numerical value
      case "ee":
        return addLeadingZeros(localDayOfWeek, 2);
      // 1st, 2nd, ..., 7th
      case "eo":
        return localize2.ordinalNumber(localDayOfWeek, { unit: "day" });
      case "eee":
        return localize2.day(dayOfWeek, {
          width: "abbreviated",
          context: "formatting"
        });
      // T
      case "eeeee":
        return localize2.day(dayOfWeek, {
          width: "narrow",
          context: "formatting"
        });
      // Tu
      case "eeeeee":
        return localize2.day(dayOfWeek, {
          width: "short",
          context: "formatting"
        });
      // Tuesday
      case "eeee":
      default:
        return localize2.day(dayOfWeek, {
          width: "wide",
          context: "formatting"
        });
    }
  },
  // Stand-alone local day of week
  c: function(date2, token, localize2, options) {
    const dayOfWeek = date2.getDay();
    const localDayOfWeek = (dayOfWeek - options.weekStartsOn + 8) % 7 || 7;
    switch (token) {
      // Numerical value (same as in `e`)
      case "c":
        return String(localDayOfWeek);
      // Padded numerical value
      case "cc":
        return addLeadingZeros(localDayOfWeek, token.length);
      // 1st, 2nd, ..., 7th
      case "co":
        return localize2.ordinalNumber(localDayOfWeek, { unit: "day" });
      case "ccc":
        return localize2.day(dayOfWeek, {
          width: "abbreviated",
          context: "standalone"
        });
      // T
      case "ccccc":
        return localize2.day(dayOfWeek, {
          width: "narrow",
          context: "standalone"
        });
      // Tu
      case "cccccc":
        return localize2.day(dayOfWeek, {
          width: "short",
          context: "standalone"
        });
      // Tuesday
      case "cccc":
      default:
        return localize2.day(dayOfWeek, {
          width: "wide",
          context: "standalone"
        });
    }
  },
  // ISO day of week
  i: function(date2, token, localize2) {
    const dayOfWeek = date2.getDay();
    const isoDayOfWeek = dayOfWeek === 0 ? 7 : dayOfWeek;
    switch (token) {
      // 2
      case "i":
        return String(isoDayOfWeek);
      // 02
      case "ii":
        return addLeadingZeros(isoDayOfWeek, token.length);
      // 2nd
      case "io":
        return localize2.ordinalNumber(isoDayOfWeek, { unit: "day" });
      // Tue
      case "iii":
        return localize2.day(dayOfWeek, {
          width: "abbreviated",
          context: "formatting"
        });
      // T
      case "iiiii":
        return localize2.day(dayOfWeek, {
          width: "narrow",
          context: "formatting"
        });
      // Tu
      case "iiiiii":
        return localize2.day(dayOfWeek, {
          width: "short",
          context: "formatting"
        });
      // Tuesday
      case "iiii":
      default:
        return localize2.day(dayOfWeek, {
          width: "wide",
          context: "formatting"
        });
    }
  },
  // AM or PM
  a: function(date2, token, localize2) {
    const hours = date2.getHours();
    const dayPeriodEnumValue = hours / 12 >= 1 ? "pm" : "am";
    switch (token) {
      case "a":
      case "aa":
        return localize2.dayPeriod(dayPeriodEnumValue, {
          width: "abbreviated",
          context: "formatting"
        });
      case "aaa":
        return localize2.dayPeriod(dayPeriodEnumValue, {
          width: "abbreviated",
          context: "formatting"
        }).toLowerCase();
      case "aaaaa":
        return localize2.dayPeriod(dayPeriodEnumValue, {
          width: "narrow",
          context: "formatting"
        });
      case "aaaa":
      default:
        return localize2.dayPeriod(dayPeriodEnumValue, {
          width: "wide",
          context: "formatting"
        });
    }
  },
  // AM, PM, midnight, noon
  b: function(date2, token, localize2) {
    const hours = date2.getHours();
    let dayPeriodEnumValue;
    if (hours === 12) {
      dayPeriodEnumValue = dayPeriodEnum.noon;
    } else if (hours === 0) {
      dayPeriodEnumValue = dayPeriodEnum.midnight;
    } else {
      dayPeriodEnumValue = hours / 12 >= 1 ? "pm" : "am";
    }
    switch (token) {
      case "b":
      case "bb":
        return localize2.dayPeriod(dayPeriodEnumValue, {
          width: "abbreviated",
          context: "formatting"
        });
      case "bbb":
        return localize2.dayPeriod(dayPeriodEnumValue, {
          width: "abbreviated",
          context: "formatting"
        }).toLowerCase();
      case "bbbbb":
        return localize2.dayPeriod(dayPeriodEnumValue, {
          width: "narrow",
          context: "formatting"
        });
      case "bbbb":
      default:
        return localize2.dayPeriod(dayPeriodEnumValue, {
          width: "wide",
          context: "formatting"
        });
    }
  },
  // in the morning, in the afternoon, in the evening, at night
  B: function(date2, token, localize2) {
    const hours = date2.getHours();
    let dayPeriodEnumValue;
    if (hours >= 17) {
      dayPeriodEnumValue = dayPeriodEnum.evening;
    } else if (hours >= 12) {
      dayPeriodEnumValue = dayPeriodEnum.afternoon;
    } else if (hours >= 4) {
      dayPeriodEnumValue = dayPeriodEnum.morning;
    } else {
      dayPeriodEnumValue = dayPeriodEnum.night;
    }
    switch (token) {
      case "B":
      case "BB":
      case "BBB":
        return localize2.dayPeriod(dayPeriodEnumValue, {
          width: "abbreviated",
          context: "formatting"
        });
      case "BBBBB":
        return localize2.dayPeriod(dayPeriodEnumValue, {
          width: "narrow",
          context: "formatting"
        });
      case "BBBB":
      default:
        return localize2.dayPeriod(dayPeriodEnumValue, {
          width: "wide",
          context: "formatting"
        });
    }
  },
  // Hour [1-12]
  h: function(date2, token, localize2) {
    if (token === "ho") {
      let hours = date2.getHours() % 12;
      if (hours === 0) hours = 12;
      return localize2.ordinalNumber(hours, { unit: "hour" });
    }
    return lightFormatters.h(date2, token);
  },
  // Hour [0-23]
  H: function(date2, token, localize2) {
    if (token === "Ho") {
      return localize2.ordinalNumber(date2.getHours(), { unit: "hour" });
    }
    return lightFormatters.H(date2, token);
  },
  // Hour [0-11]
  K: function(date2, token, localize2) {
    const hours = date2.getHours() % 12;
    if (token === "Ko") {
      return localize2.ordinalNumber(hours, { unit: "hour" });
    }
    return addLeadingZeros(hours, token.length);
  },
  // Hour [1-24]
  k: function(date2, token, localize2) {
    let hours = date2.getHours();
    if (hours === 0) hours = 24;
    if (token === "ko") {
      return localize2.ordinalNumber(hours, { unit: "hour" });
    }
    return addLeadingZeros(hours, token.length);
  },
  // Minute
  m: function(date2, token, localize2) {
    if (token === "mo") {
      return localize2.ordinalNumber(date2.getMinutes(), { unit: "minute" });
    }
    return lightFormatters.m(date2, token);
  },
  // Second
  s: function(date2, token, localize2) {
    if (token === "so") {
      return localize2.ordinalNumber(date2.getSeconds(), { unit: "second" });
    }
    return lightFormatters.s(date2, token);
  },
  // Fraction of second
  S: function(date2, token) {
    return lightFormatters.S(date2, token);
  },
  // Timezone (ISO-8601. If offset is 0, output is always `'Z'`)
  X: function(date2, token, _localize) {
    const timezoneOffset = date2.getTimezoneOffset();
    if (timezoneOffset === 0) {
      return "Z";
    }
    switch (token) {
      // Hours and optional minutes
      case "X":
        return formatTimezoneWithOptionalMinutes(timezoneOffset);
      // Hours, minutes and optional seconds without `:` delimiter
      // Note: neither ISO-8601 nor JavaScript supports seconds in timezone offsets
      // so this token always has the same output as `XX`
      case "XXXX":
      case "XX":
        return formatTimezone(timezoneOffset);
      // Hours, minutes and optional seconds with `:` delimiter
      // Note: neither ISO-8601 nor JavaScript supports seconds in timezone offsets
      // so this token always has the same output as `XXX`
      case "XXXXX":
      case "XXX":
      // Hours and minutes with `:` delimiter
      default:
        return formatTimezone(timezoneOffset, ":");
    }
  },
  // Timezone (ISO-8601. If offset is 0, output is `'+00:00'` or equivalent)
  x: function(date2, token, _localize) {
    const timezoneOffset = date2.getTimezoneOffset();
    switch (token) {
      // Hours and optional minutes
      case "x":
        return formatTimezoneWithOptionalMinutes(timezoneOffset);
      // Hours, minutes and optional seconds without `:` delimiter
      // Note: neither ISO-8601 nor JavaScript supports seconds in timezone offsets
      // so this token always has the same output as `xx`
      case "xxxx":
      case "xx":
        return formatTimezone(timezoneOffset);
      // Hours, minutes and optional seconds with `:` delimiter
      // Note: neither ISO-8601 nor JavaScript supports seconds in timezone offsets
      // so this token always has the same output as `xxx`
      case "xxxxx":
      case "xxx":
      // Hours and minutes with `:` delimiter
      default:
        return formatTimezone(timezoneOffset, ":");
    }
  },
  // Timezone (GMT)
  O: function(date2, token, _localize) {
    const timezoneOffset = date2.getTimezoneOffset();
    switch (token) {
      // Short
      case "O":
      case "OO":
      case "OOO":
        return "GMT" + formatTimezoneShort(timezoneOffset, ":");
      // Long
      case "OOOO":
      default:
        return "GMT" + formatTimezone(timezoneOffset, ":");
    }
  },
  // Timezone (specific non-location)
  z: function(date2, token, _localize) {
    const timezoneOffset = date2.getTimezoneOffset();
    switch (token) {
      // Short
      case "z":
      case "zz":
      case "zzz":
        return "GMT" + formatTimezoneShort(timezoneOffset, ":");
      // Long
      case "zzzz":
      default:
        return "GMT" + formatTimezone(timezoneOffset, ":");
    }
  },
  // Seconds timestamp
  t: function(date2, token, _localize) {
    const timestamp2 = Math.trunc(date2.getTime() / 1e3);
    return addLeadingZeros(timestamp2, token.length);
  },
  // Milliseconds timestamp
  T: function(date2, token, _localize) {
    const timestamp2 = date2.getTime();
    return addLeadingZeros(timestamp2, token.length);
  }
};
function formatTimezoneShort(offset, delimiter = "") {
  const sign = offset > 0 ? "-" : "+";
  const absOffset = Math.abs(offset);
  const hours = Math.trunc(absOffset / 60);
  const minutes = absOffset % 60;
  if (minutes === 0) {
    return sign + String(hours);
  }
  return sign + String(hours) + delimiter + addLeadingZeros(minutes, 2);
}
function formatTimezoneWithOptionalMinutes(offset, delimiter) {
  if (offset % 60 === 0) {
    const sign = offset > 0 ? "-" : "+";
    return sign + addLeadingZeros(Math.abs(offset) / 60, 2);
  }
  return formatTimezone(offset, delimiter);
}
function formatTimezone(offset, delimiter = "") {
  const sign = offset > 0 ? "-" : "+";
  const absOffset = Math.abs(offset);
  const hours = addLeadingZeros(Math.trunc(absOffset / 60), 2);
  const minutes = addLeadingZeros(absOffset % 60, 2);
  return sign + hours + delimiter + minutes;
}

// node_modules/date-fns/_lib/format/longFormatters.mjs
var dateLongFormatter = (pattern, formatLong2) => {
  switch (pattern) {
    case "P":
      return formatLong2.date({ width: "short" });
    case "PP":
      return formatLong2.date({ width: "medium" });
    case "PPP":
      return formatLong2.date({ width: "long" });
    case "PPPP":
    default:
      return formatLong2.date({ width: "full" });
  }
};
var timeLongFormatter = (pattern, formatLong2) => {
  switch (pattern) {
    case "p":
      return formatLong2.time({ width: "short" });
    case "pp":
      return formatLong2.time({ width: "medium" });
    case "ppp":
      return formatLong2.time({ width: "long" });
    case "pppp":
    default:
      return formatLong2.time({ width: "full" });
  }
};
var dateTimeLongFormatter = (pattern, formatLong2) => {
  const matchResult = pattern.match(/(P+)(p+)?/) || [];
  const datePattern = matchResult[1];
  const timePattern = matchResult[2];
  if (!timePattern) {
    return dateLongFormatter(pattern, formatLong2);
  }
  let dateTimeFormat;
  switch (datePattern) {
    case "P":
      dateTimeFormat = formatLong2.dateTime({ width: "short" });
      break;
    case "PP":
      dateTimeFormat = formatLong2.dateTime({ width: "medium" });
      break;
    case "PPP":
      dateTimeFormat = formatLong2.dateTime({ width: "long" });
      break;
    case "PPPP":
    default:
      dateTimeFormat = formatLong2.dateTime({ width: "full" });
      break;
  }
  return dateTimeFormat.replace("{{date}}", dateLongFormatter(datePattern, formatLong2)).replace("{{time}}", timeLongFormatter(timePattern, formatLong2));
};
var longFormatters = {
  p: timeLongFormatter,
  P: dateTimeLongFormatter
};

// node_modules/date-fns/_lib/protectedTokens.mjs
var dayOfYearTokenRE = /^D+$/;
var weekYearTokenRE = /^Y+$/;
var throwTokens = ["D", "DD", "YY", "YYYY"];
function isProtectedDayOfYearToken(token) {
  return dayOfYearTokenRE.test(token);
}
function isProtectedWeekYearToken(token) {
  return weekYearTokenRE.test(token);
}
function warnOrThrowProtectedError(token, format3, input) {
  const _message = message(token, format3, input);
  console.warn(_message);
  if (throwTokens.includes(token)) throw new RangeError(_message);
}
function message(token, format3, input) {
  const subject = token[0] === "Y" ? "years" : "days of the month";
  return `Use \`${token.toLowerCase()}\` instead of \`${token}\` (in \`${format3}\`) for formatting ${subject} to the input \`${input}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`;
}

// node_modules/date-fns/format.mjs
var formattingTokensRegExp = /[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g;
var longFormattingTokensRegExp = /P+p+|P+|p+|''|'(''|[^'])+('|$)|./g;
var escapedStringRegExp = /^'([^]*?)'?$/;
var doubleQuoteRegExp = /''/g;
var unescapedLatinCharacterRegExp = /[a-zA-Z]/;
function format(date2, formatStr, options) {
  const defaultOptions2 = getDefaultOptions();
  const locale = options?.locale ?? defaultOptions2.locale ?? enUS;
  const firstWeekContainsDate = options?.firstWeekContainsDate ?? options?.locale?.options?.firstWeekContainsDate ?? defaultOptions2.firstWeekContainsDate ?? defaultOptions2.locale?.options?.firstWeekContainsDate ?? 1;
  const weekStartsOn = options?.weekStartsOn ?? options?.locale?.options?.weekStartsOn ?? defaultOptions2.weekStartsOn ?? defaultOptions2.locale?.options?.weekStartsOn ?? 0;
  const originalDate = toDate(date2);
  if (!isValid(originalDate)) {
    throw new RangeError("Invalid time value");
  }
  let parts = formatStr.match(longFormattingTokensRegExp).map((substring) => {
    const firstCharacter = substring[0];
    if (firstCharacter === "p" || firstCharacter === "P") {
      const longFormatter = longFormatters[firstCharacter];
      return longFormatter(substring, locale.formatLong);
    }
    return substring;
  }).join("").match(formattingTokensRegExp).map((substring) => {
    if (substring === "''") {
      return { isToken: false, value: "'" };
    }
    const firstCharacter = substring[0];
    if (firstCharacter === "'") {
      return { isToken: false, value: cleanEscapedString(substring) };
    }
    if (formatters[firstCharacter]) {
      return { isToken: true, value: substring };
    }
    if (firstCharacter.match(unescapedLatinCharacterRegExp)) {
      throw new RangeError(
        "Format string contains an unescaped latin alphabet character `" + firstCharacter + "`"
      );
    }
    return { isToken: false, value: substring };
  });
  if (locale.localize.preprocessor) {
    parts = locale.localize.preprocessor(originalDate, parts);
  }
  const formatterOptions = {
    firstWeekContainsDate,
    weekStartsOn,
    locale
  };
  return parts.map((part) => {
    if (!part.isToken) return part.value;
    const token = part.value;
    if (!options?.useAdditionalWeekYearTokens && isProtectedWeekYearToken(token) || !options?.useAdditionalDayOfYearTokens && isProtectedDayOfYearToken(token)) {
      warnOrThrowProtectedError(token, formatStr, String(date2));
    }
    const formatter = formatters[token[0]];
    return formatter(originalDate, token, locale.localize, formatterOptions);
  }).join("");
}
function cleanEscapedString(input) {
  const matched = input.match(escapedStringRegExp);
  if (!matched) {
    return input;
  }
  return matched[1].replace(doubleQuoteRegExp, "'");
}

// node_modules/date-fns/subDays.mjs
function subDays(date2, amount) {
  return addDays(date2, -amount);
}

// node_modules/date-fns/parseISO.mjs
function parseISO(argument, options) {
  const additionalDigits = options?.additionalDigits ?? 2;
  const dateStrings = splitDateString(argument);
  let date2;
  if (dateStrings.date) {
    const parseYearResult = parseYear(dateStrings.date, additionalDigits);
    date2 = parseDate(parseYearResult.restDateString, parseYearResult.year);
  }
  if (!date2 || isNaN(date2.getTime())) {
    return /* @__PURE__ */ new Date(NaN);
  }
  const timestamp2 = date2.getTime();
  let time2 = 0;
  let offset;
  if (dateStrings.time) {
    time2 = parseTime(dateStrings.time);
    if (isNaN(time2)) {
      return /* @__PURE__ */ new Date(NaN);
    }
  }
  if (dateStrings.timezone) {
    offset = parseTimezone(dateStrings.timezone);
    if (isNaN(offset)) {
      return /* @__PURE__ */ new Date(NaN);
    }
  } else {
    const dirtyDate = new Date(timestamp2 + time2);
    const result = /* @__PURE__ */ new Date(0);
    result.setFullYear(
      dirtyDate.getUTCFullYear(),
      dirtyDate.getUTCMonth(),
      dirtyDate.getUTCDate()
    );
    result.setHours(
      dirtyDate.getUTCHours(),
      dirtyDate.getUTCMinutes(),
      dirtyDate.getUTCSeconds(),
      dirtyDate.getUTCMilliseconds()
    );
    return result;
  }
  return new Date(timestamp2 + time2 + offset);
}
var patterns = {
  dateTimeDelimiter: /[T ]/,
  timeZoneDelimiter: /[Z ]/i,
  timezone: /([Z+-].*)$/
};
var dateRegex = /^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/;
var timeRegex = /^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/;
var timezoneRegex = /^([+-])(\d{2})(?::?(\d{2}))?$/;
function splitDateString(dateString) {
  const dateStrings = {};
  const array = dateString.split(patterns.dateTimeDelimiter);
  let timeString;
  if (array.length > 2) {
    return dateStrings;
  }
  if (/:/.test(array[0])) {
    timeString = array[0];
  } else {
    dateStrings.date = array[0];
    timeString = array[1];
    if (patterns.timeZoneDelimiter.test(dateStrings.date)) {
      dateStrings.date = dateString.split(patterns.timeZoneDelimiter)[0];
      timeString = dateString.substr(
        dateStrings.date.length,
        dateString.length
      );
    }
  }
  if (timeString) {
    const token = patterns.timezone.exec(timeString);
    if (token) {
      dateStrings.time = timeString.replace(token[1], "");
      dateStrings.timezone = token[1];
    } else {
      dateStrings.time = timeString;
    }
  }
  return dateStrings;
}
function parseYear(dateString, additionalDigits) {
  const regex = new RegExp(
    "^(?:(\\d{4}|[+-]\\d{" + (4 + additionalDigits) + "})|(\\d{2}|[+-]\\d{" + (2 + additionalDigits) + "})$)"
  );
  const captures = dateString.match(regex);
  if (!captures) return { year: NaN, restDateString: "" };
  const year = captures[1] ? parseInt(captures[1]) : null;
  const century = captures[2] ? parseInt(captures[2]) : null;
  return {
    year: century === null ? year : century * 100,
    restDateString: dateString.slice((captures[1] || captures[2]).length)
  };
}
function parseDate(dateString, year) {
  if (year === null) return /* @__PURE__ */ new Date(NaN);
  const captures = dateString.match(dateRegex);
  if (!captures) return /* @__PURE__ */ new Date(NaN);
  const isWeekDate = !!captures[4];
  const dayOfYear = parseDateUnit(captures[1]);
  const month = parseDateUnit(captures[2]) - 1;
  const day = parseDateUnit(captures[3]);
  const week = parseDateUnit(captures[4]);
  const dayOfWeek = parseDateUnit(captures[5]) - 1;
  if (isWeekDate) {
    if (!validateWeekDate(year, week, dayOfWeek)) {
      return /* @__PURE__ */ new Date(NaN);
    }
    return dayOfISOWeekYear(year, week, dayOfWeek);
  } else {
    const date2 = /* @__PURE__ */ new Date(0);
    if (!validateDate(year, month, day) || !validateDayOfYearDate(year, dayOfYear)) {
      return /* @__PURE__ */ new Date(NaN);
    }
    date2.setUTCFullYear(year, month, Math.max(dayOfYear, day));
    return date2;
  }
}
function parseDateUnit(value) {
  return value ? parseInt(value) : 1;
}
function parseTime(timeString) {
  const captures = timeString.match(timeRegex);
  if (!captures) return NaN;
  const hours = parseTimeUnit(captures[1]);
  const minutes = parseTimeUnit(captures[2]);
  const seconds = parseTimeUnit(captures[3]);
  if (!validateTime(hours, minutes, seconds)) {
    return NaN;
  }
  return hours * millisecondsInHour + minutes * millisecondsInMinute + seconds * 1e3;
}
function parseTimeUnit(value) {
  return value && parseFloat(value.replace(",", ".")) || 0;
}
function parseTimezone(timezoneString) {
  if (timezoneString === "Z") return 0;
  const captures = timezoneString.match(timezoneRegex);
  if (!captures) return 0;
  const sign = captures[1] === "+" ? -1 : 1;
  const hours = parseInt(captures[2]);
  const minutes = captures[3] && parseInt(captures[3]) || 0;
  if (!validateTimezone(hours, minutes)) {
    return NaN;
  }
  return sign * (hours * millisecondsInHour + minutes * millisecondsInMinute);
}
function dayOfISOWeekYear(isoWeekYear, week, day) {
  const date2 = /* @__PURE__ */ new Date(0);
  date2.setUTCFullYear(isoWeekYear, 0, 4);
  const fourthOfJanuaryDay = date2.getUTCDay() || 7;
  const diff = (week - 1) * 7 + day + 1 - fourthOfJanuaryDay;
  date2.setUTCDate(date2.getUTCDate() + diff);
  return date2;
}
var daysInMonths = [31, null, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
function isLeapYearIndex(year) {
  return year % 400 === 0 || year % 4 === 0 && year % 100 !== 0;
}
function validateDate(year, month, date2) {
  return month >= 0 && month <= 11 && date2 >= 1 && date2 <= (daysInMonths[month] || (isLeapYearIndex(year) ? 29 : 28));
}
function validateDayOfYearDate(year, dayOfYear) {
  return dayOfYear >= 1 && dayOfYear <= (isLeapYearIndex(year) ? 366 : 365);
}
function validateWeekDate(_year, week, day) {
  return week >= 1 && week <= 53 && day >= 0 && day <= 6;
}
function validateTime(hours, minutes, seconds) {
  if (hours === 24) {
    return minutes === 0 && seconds === 0;
  }
  return seconds >= 0 && seconds < 60 && minutes >= 0 && minutes < 60 && hours >= 0 && hours < 25;
}
function validateTimezone(_hours, minutes) {
  return minutes >= 0 && minutes <= 59;
}

// node_modules/date-fns/subMinutes.mjs
function subMinutes(date2, amount) {
  return addMinutes(date2, -amount);
}

// server/providers/whoop/map.ts
function safeNumber(value) {
  if (typeof value === "number" && !isNaN(value)) {
    return value;
  }
  return null;
}
function safeRound(value) {
  return value !== null ? Math.round(value) : null;
}
function toSnapshot(data, targetDate) {
  const date2 = targetDate ? format(targetDate, "yyyy-MM-dd") : format(/* @__PURE__ */ new Date(), "yyyy-MM-dd");
  const hrv_ms = safeNumber(data.recovery?.score?.hrv_rmssd_milli) || safeNumber(data.recovery?.hrv_rmssd_milli) || null;
  const resting_hr_bpm = safeNumber(data.recovery?.score?.resting_heart_rate) || safeNumber(data.recovery?.resting_heart_rate) || null;
  const sleep_score = safeNumber(data.sleep?.score?.sleep_performance_percentage);
  const steps = null;
  const kilojoules = safeNumber(data.cycle?.score?.kilojoule);
  const calories = kilojoules ? safeRound(kilojoules * 0.239) : null;
  const stress_0_10 = null;
  return {
    provider: "Whoop",
    date: date2,
    hrv_ms,
    resting_hr_bpm,
    sleep_score,
    steps,
    calories,
    stress_0_10,
    raw: {
      cycle: data.cycle || null,
      recovery: data.recovery || null,
      sleep: data.sleep || null,
      workouts: data.workouts || []
    }
  };
}
function createNullSnapshot(targetDate) {
  const date2 = targetDate ? format(targetDate, "yyyy-MM-dd") : format(/* @__PURE__ */ new Date(), "yyyy-MM-dd");
  return {
    provider: "Whoop",
    date: date2,
    hrv_ms: null,
    resting_hr_bpm: null,
    sleep_score: null,
    steps: null,
    calories: null,
    stress_0_10: null,
    raw: {
      cycle: null,
      recovery: null,
      sleep: null,
      workouts: []
    }
  };
}

// server/providers/health/whoop.ts
init_db();
init_schema();
import { eq as eq7, and as and7 } from "drizzle-orm";
var WHOOP_AUTH_URL = "https://api.prod.whoop.com/oauth/oauth2/auth";
var WHOOP_TOKEN_URL = "https://api.prod.whoop.com/oauth/oauth2/token";
var WHOOP_API = "https://api.prod.whoop.com/developer/v2";
function siteUrl() {
  return process.env.SITE_URL || (process.env.VERCEL_URL ? `https://${process.env.VERCEL_URL}` : process.env.VITE_SITE_URL);
}
function redirectUri() {
  return `${siteUrl()}/api/connect/Whoop/callback`;
}
function hasConfigEnv() {
  return !!(process.env.WHOOP_CLIENT_ID && process.env.WHOOP_CLIENT_SECRET);
}
async function tokenExchange(code) {
  const body = new URLSearchParams({
    grant_type: "authorization_code",
    code,
    redirect_uri: redirectUri(),
    client_id: process.env.WHOOP_CLIENT_ID,
    client_secret: process.env.WHOOP_CLIENT_SECRET
  });
  const res = await fetch(WHOOP_TOKEN_URL, {
    method: "POST",
    headers: { "Content-Type": "application/x-www-form-urlencoded" },
    body
  });
  if (!res.ok) throw new Error(`WHOOP token exchange failed: ${res.status}`);
  return res.json();
}
async function tokenRefresh(refreshToken) {
  const body = new URLSearchParams({
    grant_type: "refresh_token",
    refresh_token: refreshToken,
    client_id: process.env.WHOOP_CLIENT_ID,
    client_secret: process.env.WHOOP_CLIENT_SECRET
  });
  const res = await fetch(WHOOP_TOKEN_URL, {
    method: "POST",
    headers: { "Content-Type": "application/x-www-form-urlencoded" },
    body
  });
  if (!res.ok) throw new Error(`WHOOP token refresh failed: ${res.status}`);
  return res.json();
}
async function authedFetch(userId, input, init2) {
  let tok = await getDecryptedTokens(userId, "Whoop");
  if (!tok) throw new Error("No WHOOP token on file");
  let res = await fetch(input, {
    ...init2 || {},
    headers: { ...init2?.headers || {}, Authorization: `Bearer ${tok.accessToken}` }
  });
  let tokenRefreshed = false;
  if (res.status === 401 && tok.refreshToken) {
    try {
      const refreshed = await tokenRefresh(tok.refreshToken);
      const expiresAt = refreshed.expires_in ? Date.now() + refreshed.expires_in * 1e3 : void 0;
      await storeEncryptedTokens(userId, "Whoop", {
        accessToken: refreshed.access_token,
        refreshToken: refreshed.refresh_token ?? tok.refreshToken,
        expiresAt: expiresAt ? new Date(expiresAt) : void 0
      });
      res = await fetch(input, {
        ...init2 || {},
        headers: { ...init2?.headers || {}, Authorization: `Bearer ${refreshed.access_token}` }
      });
      tokenRefreshed = true;
    } catch (refreshError) {
      await upsertWearable({
        userId,
        provider: "Whoop",
        connected: false,
        lastSync: null,
        error: "Session expired, please reconnect WHOOP",
        status: "error"
      });
      throw new Error("Session expired, please reconnect WHOOP");
    }
  }
  return { response: res, tokenRefreshed };
}
var WhoopHealthProvider = class {
  id = "Whoop";
  hasConfig() {
    return hasConfigEnv();
  }
  async authStart(userId) {
    console.log(`[WHOOP] authStart: Initiating OAuth for user ${userId}`);
    if (!hasConfigEnv()) throw new Error("WHOOP not configured");
    const scope = "read:profile read:body_measurement read:recovery read:cycles read:sleep read:workout";
    const url = new URL(WHOOP_AUTH_URL);
    url.searchParams.set("response_type", "code");
    url.searchParams.set("client_id", process.env.WHOOP_CLIENT_ID);
    url.searchParams.set("redirect_uri", redirectUri());
    url.searchParams.set("scope", scope);
    const state = signState({ userId, t: Date.now() });
    url.searchParams.set("state", state);
    console.log(`[WHOOP] authStart: Generated redirect URL for user ${userId}`);
    return { redirectUrl: url.toString() };
  }
  async authCallback(params) {
    console.log(`[WHOOP] callback: Processing OAuth callback with params`, { code: !!params.code, state: !!params.state });
    const { code, state } = params;
    if (!code || !state) throw new Error("Missing code/state");
    const { userId } = verifyState(state);
    console.log(`[WHOOP] callback: Verified state for user ${userId}`);
    const exchanged = await tokenExchange(code);
    const expiresAt = exchanged.expires_in ? Date.now() + exchanged.expires_in * 1e3 : void 0;
    await storeEncryptedTokens(userId, "Whoop", {
      accessToken: exchanged.access_token,
      refreshToken: exchanged.refresh_token,
      expiresAt: expiresAt ? new Date(expiresAt) : void 0
    });
    await upsertWearable({
      userId,
      provider: "Whoop",
      connected: true,
      lastSync: (/* @__PURE__ */ new Date()).toISOString()
    });
    console.log(`[WHOOP] callback: Successfully connected user ${userId}`);
  }
  async fetchLatest(userId) {
    console.log(`[WHOOP] fetchLatest: Starting data fetch for user ${userId}`);
    const now = /* @__PURE__ */ new Date();
    const connection = await db.select().from(wearableConnections).where(and7(
      eq7(wearableConnections.userId, userId),
      eq7(wearableConnections.provider, "Whoop")
    )).limit(1);
    const lastSync = connection[0]?.lastSync;
    if (lastSync) {
      const lastSyncDate = new Date(lastSync);
      const tenMinutesAgo = subMinutes(now, 10);
      if (lastSyncDate > tenMinutesAgo) {
        const nullSnapshot = createNullSnapshot(now);
        console.log(`WHOOP: Rate limit hit, last sync was ${lastSyncDate.toISOString()}`);
        return nullSnapshot;
      }
    }
    const end = now;
    const start = subDays(end, 2);
    let tokenRefreshed = false;
    try {
      let latestCycle = null;
      let latestRecovery = null;
      let latestSleep = null;
      let workouts3 = { records: [] };
      try {
        const { response: cyclesRes, tokenRefreshed: refreshed1 } = await authedFetch(
          userId,
          `${WHOOP_API}/cycle?limit=5&start=${start.toISOString()}&end=${end.toISOString()}`
        );
        tokenRefreshed = tokenRefreshed || refreshed1;
        if (cyclesRes.ok) {
          const cycles = await cyclesRes.json();
          latestCycle = cycles?.records?.[0] || null;
        } else {
          console.warn(`WHOOP cycles API returned ${cyclesRes.status}`);
        }
      } catch (error) {
        console.warn("WHOOP cycles fetch failed:", error);
      }
      try {
        const { response: recRes, tokenRefreshed: refreshed2 } = await authedFetch(
          userId,
          `${WHOOP_API}/recovery?limit=5&start=${start.toISOString()}&end=${end.toISOString()}`
        );
        tokenRefreshed = tokenRefreshed || refreshed2;
        if (recRes.ok) {
          const recData = await recRes.json();
          latestRecovery = recData?.records?.[0] || null;
        } else {
          console.warn(`WHOOP recovery API returned ${recRes.status}`);
        }
      } catch (error) {
        console.warn("WHOOP recovery fetch failed:", error);
      }
      try {
        const { response: sleepRes, tokenRefreshed: refreshed3 } = await authedFetch(
          userId,
          `${WHOOP_API}/sleep?limit=5&start=${start.toISOString()}&end=${end.toISOString()}`
        );
        tokenRefreshed = tokenRefreshed || refreshed3;
        if (sleepRes.ok) {
          const sleepData = await sleepRes.json();
          latestSleep = sleepData?.records?.[0] || null;
        } else {
          console.warn(`WHOOP sleep API returned ${sleepRes.status}`);
        }
      } catch (error) {
        console.warn("WHOOP sleep fetch failed:", error);
      }
      try {
        const { response: wRes, tokenRefreshed: refreshed4 } = await authedFetch(
          userId,
          `${WHOOP_API}/workout?limit=1&start=${start.toISOString()}&end=${end.toISOString()}`
        );
        tokenRefreshed = tokenRefreshed || refreshed4;
        if (wRes.ok) {
          workouts3 = await wRes.json();
        } else {
          console.warn(`WHOOP workout API returned ${wRes.status}`);
        }
      } catch (error) {
        console.warn("WHOOP workout fetch failed:", error);
      }
      const hasData = latestCycle || latestRecovery || latestSleep || workouts3.records && workouts3.records.length > 0;
      let snapshot;
      if (!hasData) {
        snapshot = createNullSnapshot(end);
        console.log("WHOOP: No data found in last 2 days, returning null snapshot");
      } else {
        snapshot = toSnapshot({
          cycle: latestCycle,
          recovery: latestRecovery,
          sleep: latestSleep,
          workouts: workouts3.records
        }, end);
      }
      await upsertWearable({
        userId,
        provider: "Whoop",
        connected: true,
        lastSync: (/* @__PURE__ */ new Date()).toISOString(),
        error: null,
        // Clear any previous errors
        status: "connected"
      });
      console.log(`[WHOOP] fetchLatest: Successfully fetched data for user ${userId}`, { hasData });
      return snapshot;
    } catch (error) {
      console.error(`[WHOOP] fetchLatest: Error for user ${userId}:`, error);
      if (error.message?.includes("Session expired")) {
        throw error;
      }
      await upsertWearable({
        userId,
        provider: "Whoop",
        connected: true,
        // Keep connected but log error
        lastSync: (/* @__PURE__ */ new Date()).toISOString(),
        error: `API Error: ${error.message}`,
        status: "error"
      });
      console.log(`[WHOOP] fetchLatest: Returning null snapshot due to error for user ${userId}`);
      return createNullSnapshot(end);
    }
  }
  async disconnect(userId) {
    try {
      await deleteTokens(userId, "Whoop");
      await upsertWearable({
        userId,
        provider: "Whoop",
        connected: false,
        lastSync: null,
        error: null,
        status: "disconnected"
      });
      return { success: true };
    } catch (error) {
      console.error("WHOOP disconnect error:", error);
      await upsertWearable({
        userId,
        provider: "Whoop",
        connected: false,
        lastSync: null,
        error: null,
        status: "disconnected"
      });
      throw error;
    }
  }
  canRevoke() {
    return false;
  }
};

// server/config.ts
var garmin = {
  clientId: process.env.GARMIN_CLIENT_ID || "",
  clientSecret: process.env.GARMIN_CLIENT_SECRET || "",
  redirectUrl: process.env.GARMIN_REDIRECT_URL || ""
};
var isGarminConfigured = () => !!(garmin.clientId && garmin.clientSecret && garmin.redirectUrl);

// server/lib/pkce.ts
import * as crypto7 from "crypto";
function randomString(len = 64) {
  return crypto7.randomBytes(len).toString("base64url").replace(/_/g, "-").replace(/\./g, "");
}
function sha256base64url(input) {
  return crypto7.createHash("sha256").update(input).digest("base64url");
}
function makePkce() {
  const code_verifier = randomString(64);
  const code_challenge = sha256base64url(code_verifier);
  return { code_verifier, code_challenge, method: "S256" };
}

// server/providers/health/garmin.ts
var AUTH_URL = "https://connect.garmin.com/oauth2Confirm";
var TOKEN_URL = "https://diauth.garmin.com/di-oauth2-service/oauth/token";
var USER_ID_URL = "https://apis.garmin.com/wellness-api/rest/user/id";
var GarminHealthProvider = class {
  id = "Garmin";
  hasConfig() {
    return isGarminConfigured();
  }
  async authStart(userId) {
    if (!garmin.clientId || !garmin.redirectUrl) throw new Error("Garmin not configured");
    const pkce = makePkce();
    const state = signState({ u: userId, v: pkce.code_verifier, p: "garmin" });
    const url = new URL(AUTH_URL);
    url.searchParams.set("response_type", "code");
    url.searchParams.set("client_id", garmin.clientId);
    url.searchParams.set("code_challenge", pkce.code_challenge);
    url.searchParams.set("code_challenge_method", pkce.method);
    url.searchParams.set("redirect_uri", garmin.redirectUrl);
    url.searchParams.set("state", state);
    return { redirectUrl: url.toString() };
  }
  async authCallback(params, userId) {
    const { code, state } = params;
    if (!code || !state) throw new Error("Missing code/state");
    const decoded = verifyState(state);
    if (decoded.p !== "garmin" || decoded.u !== userId) throw new Error("Bad state");
    const body = new URLSearchParams({
      grant_type: "authorization_code",
      client_id: garmin.clientId,
      client_secret: garmin.clientSecret,
      code,
      code_verifier: decoded.v,
      redirect_uri: garmin.redirectUrl
    });
    const res = await fetch(TOKEN_URL, {
      method: "POST",
      headers: { "Content-Type": "application/x-www-form-urlencoded" },
      body
    });
    if (!res.ok) throw new Error(`Garmin token exchange failed: ${res.status}`);
    const tok = await res.json();
    const expiresAt = tok.expires_in ? new Date(Date.now() + tok.expires_in * 1e3) : void 0;
    await storeEncryptedTokens(userId, "Garmin", {
      accessToken: tok.access_token,
      refreshToken: tok.refresh_token,
      expiresAt,
      scope: tok.scope
    });
    await upsertWearable({
      userId,
      provider: "Garmin",
      connected: true,
      status: "connected",
      lastSync: (/* @__PURE__ */ new Date()).toISOString(),
      error: null
    });
  }
  async fetchLatest(userId) {
    const tokens = await getDecryptedTokens(userId, "Garmin");
    if (!tokens) throw new Error("Not connected");
    const accessToken = await this.ensureGarminAccessToken(tokens, userId);
    const uidRes = await fetch(USER_ID_URL, {
      headers: { Authorization: `Bearer ${accessToken}` }
    });
    if (!uidRes.ok) throw new Error(`Garmin user id failed: ${uidRes.status}`);
    await uidRes.json();
    const end = Math.floor(Date.now() / 1e3);
    const start = end - 2 * 86400;
    const dailiesUrl = new URL("https://apis.garmin.com/wellness-api/rest/backfill/dailies");
    dailiesUrl.searchParams.set("summaryStartTimeInSeconds", String(start));
    dailiesUrl.searchParams.set("summaryEndTimeInSeconds", String(end));
    const dailiesRes = await fetch(dailiesUrl, {
      headers: { Authorization: `Bearer ${accessToken}` }
    });
    if (!dailiesRes.ok) throw new Error(`Garmin dailies failed: ${dailiesRes.status}`);
    const dailies = await dailiesRes.json();
    const latest = Array.isArray(dailies) && dailies.length ? dailies[dailies.length - 1] : null;
    const safeNumber2 = (value) => {
      if (typeof value === "number" && !isNaN(value)) return value;
      return null;
    };
    const safeNested = (obj, key) => {
      if (obj && typeof obj === "object" && key in obj) {
        return obj[key];
      }
      return null;
    };
    const snapshot = {
      date: typeof latest?.calendarDate === "string" ? latest.calendarDate : (/* @__PURE__ */ new Date()).toISOString().slice(0, 10),
      hrv: safeNumber2(safeNested(latest?.hrvSummary, "avgRmssd")),
      restingHR: safeNumber2(latest?.restingHeartRate),
      sleepScore: (() => {
        const sleepDuration = safeNumber2(latest?.sleepDurationInSeconds);
        if (sleepDuration === null) return null;
        return Math.round(Math.min(100, sleepDuration / 28800 * 100));
      })(),
      stress: safeNumber2(latest?.stressLevel),
      steps: safeNumber2(latest?.steps),
      calories: safeNumber2(latest?.calories),
      raw: latest ? { garminDaily: latest } : void 0
    };
    await upsertWearable({
      userId,
      provider: "Garmin",
      connected: true,
      status: "connected",
      lastSync: (/* @__PURE__ */ new Date()).toISOString(),
      error: null
    });
    return snapshot;
  }
  // Token refresh helper
  async ensureGarminAccessToken(tokens, userId) {
    const now = Date.now() / 1e3;
    const expiresAt = tokens.expiresAt ? new Date(tokens.expiresAt).getTime() / 1e3 : 0;
    const bufferTime = 600;
    if (now < expiresAt - bufferTime && tokens.accessToken) {
      return tokens.accessToken;
    }
    if (!tokens.refreshToken) {
      throw new Error("No refresh token available");
    }
    const body = new URLSearchParams({
      grant_type: "refresh_token",
      client_id: garmin.clientId,
      client_secret: garmin.clientSecret,
      refresh_token: tokens.refreshToken
    });
    const res = await fetch(TOKEN_URL, {
      method: "POST",
      headers: { "Content-Type": "application/x-www-form-urlencoded" },
      body
    });
    if (!res.ok) throw new Error(`Garmin refresh failed: ${res.status}`);
    const refreshed = await res.json();
    const newExpiresAt = refreshed.expires_in ? new Date(Date.now() + refreshed.expires_in * 1e3) : void 0;
    await storeEncryptedTokens(userId, "Garmin", {
      accessToken: refreshed.access_token,
      refreshToken: refreshed.refresh_token || tokens.refreshToken,
      expiresAt: newExpiresAt,
      scope: refreshed.scope
    });
    return refreshed.access_token;
  }
};

// server/providers/health/index.ts
function getProviderRegistry() {
  const hasOura = !!(process.env.OURA_CLIENT_ID && process.env.OURA_CLIENT_SECRET);
  const hasFitbit = !!(process.env.FITBIT_CLIENT_ID && process.env.FITBIT_CLIENT_SECRET);
  const hasWhoop = !!(process.env.WHOOP_CLIENT_ID && process.env.WHOOP_CLIENT_SECRET);
  const hasGarmin = !!(process.env.GARMIN_CLIENT_ID && process.env.GARMIN_CLIENT_SECRET);
  const reg = {
    Mock: new MockHealthProvider()
  };
  if (hasOura) reg["Oura"] = new OuraHealthProvider();
  if (hasFitbit) reg["Fitbit"] = new FitbitHealthProvider();
  if (hasWhoop) reg["Whoop"] = new WhoopHealthProvider();
  if (hasGarmin) reg["Garmin"] = new GarminHealthProvider();
  return reg;
}

// server/providers/health/garminBackfill.ts
async function backfillDailies(accessToken, start, end) {
  const url = new URL("https://apis.garmin.com/wellness-api/rest/backfill/dailies");
  url.searchParams.set("summaryStartTimeInSeconds", String(start));
  url.searchParams.set("summaryEndTimeInSeconds", String(end));
  const response = await fetch(url, {
    method: "GET",
    headers: {
      "Authorization": `Bearer ${accessToken}`,
      "Content-Type": "application/json"
    }
  });
  if (!response.ok) {
    throw new Error(`Garmin dailies backfill failed: ${response.status} ${response.statusText}`);
  }
  return await response.json();
}
async function backfillSleeps(accessToken, start, end) {
  const url = new URL("https://apis.garmin.com/wellness-api/rest/backfill/sleeps");
  url.searchParams.set("summaryStartTimeInSeconds", String(start));
  url.searchParams.set("summaryEndTimeInSeconds", String(end));
  const response = await fetch(url, {
    method: "GET",
    headers: {
      "Authorization": `Bearer ${accessToken}`,
      "Content-Type": "application/json"
    }
  });
  if (!response.ok) {
    throw new Error(`Garmin sleeps backfill failed: ${response.status} ${response.statusText}`);
  }
  return await response.json();
}
async function backfillHRV(accessToken, start, end) {
  const url = new URL("https://apis.garmin.com/wellness-api/rest/backfill/dailies");
  url.searchParams.set("summaryStartTimeInSeconds", String(start));
  url.searchParams.set("summaryEndTimeInSeconds", String(end));
  const response = await fetch(url, {
    method: "GET",
    headers: {
      "Authorization": `Bearer ${accessToken}`,
      "Content-Type": "application/json"
    }
  });
  if (!response.ok) {
    throw new Error(`Garmin HRV backfill failed: ${response.status} ${response.statusText}`);
  }
  const data = await response.json();
  if (Array.isArray(data)) {
    return data.map((daily) => ({
      calendarDate: daily.calendarDate,
      hrvSummary: daily.hrvSummary || null
    })).filter((item) => item.hrvSummary);
  }
  return data;
}

// server/services/metrics/index.ts
init_supabaseAdmin();

// server/services/environment/index.ts
var EnvironmentCache = class {
  cache = /* @__PURE__ */ new Map();
  CACHE_DURATION = 24 * 60 * 60 * 1e3;
  // 24 hours in ms
  generateKey(lat, lon, date2, type) {
    return `${lat.toFixed(4)}|${lon.toFixed(4)}|${date2}|${type}`;
  }
  get(lat, lon, date2, type) {
    const key = this.generateKey(lat, lon, date2, type);
    const entry = this.cache.get(key);
    if (!entry) return null;
    if (Date.now() > entry.expiresAt) {
      this.cache.delete(key);
      return null;
    }
    return entry.data;
  }
  set(lat, lon, date2, type, data) {
    const key = this.generateKey(lat, lon, date2, type);
    const now = Date.now();
    this.cache.set(key, {
      data,
      timestamp: now,
      expiresAt: now + this.CACHE_DURATION
    });
  }
  // Clean up expired entries periodically
  cleanup() {
    const now = Date.now();
    const entries = Array.from(this.cache.entries());
    for (const [key, entry] of entries) {
      if (now > entry.expiresAt) {
        this.cache.delete(key);
      }
    }
  }
};
var cache = new EnvironmentCache();
setInterval(() => cache.cleanup(), 6 * 60 * 60 * 1e3);
async function fetchWithTimeout(url, timeoutMs = 3e3) {
  const controller = new AbortController();
  const timeoutId = setTimeout(() => controller.abort(), timeoutMs);
  try {
    const response = await fetch(url, {
      signal: controller.signal,
      headers: {
        "User-Agent": "AXLE-Fitness-App/1.0"
      }
    });
    clearTimeout(timeoutId);
    if (!response.ok) {
      return null;
    }
    return await response.json();
  } catch (error) {
    clearTimeout(timeoutId);
    return null;
  }
}
async function getSolar(lat, lon, date2) {
  const nullResult = {
    sunrise: null,
    sunset: null,
    dayLength: null
  };
  if (lat == null || lon == null) {
    return nullResult;
  }
  try {
    const dateStr = typeof date2 === "string" ? date2 : format(date2, "yyyy-MM-dd");
    const cached = cache.get(lat, lon, dateStr, "solar");
    if (cached) {
      return cached;
    }
    const url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&daily=sunrise,sunset&timezone=auto&start_date=${dateStr}&end_date=${dateStr}`;
    const data = await fetchWithTimeout(url);
    if (!data?.daily?.sunrise?.[0] || !data?.daily?.sunset?.[0]) {
      return nullResult;
    }
    const sunrise = data.daily.sunrise[0];
    const sunset = data.daily.sunset[0];
    let dayLength = null;
    if (sunrise && sunset) {
      const sunriseTime = new Date(sunrise).getTime();
      const sunsetTime = new Date(sunset).getTime();
      dayLength = (sunsetTime - sunriseTime) / (1e3 * 60 * 60);
    }
    const result = {
      sunrise,
      sunset,
      dayLength
    };
    cache.set(lat, lon, dateStr, "solar", result);
    return result;
  } catch (error) {
    return nullResult;
  }
}
async function getWeather(lat, lon, date2) {
  const nullResult = {
    temperature: null,
    humidity: null,
    windSpeed: null,
    precipitationProbability: null,
    uvIndex: null
  };
  if (lat == null || lon == null) {
    return nullResult;
  }
  try {
    const dateStr = typeof date2 === "string" ? date2 : format(date2, "yyyy-MM-dd");
    const cached = cache.get(lat, lon, dateStr, "weather");
    if (cached) {
      return cached;
    }
    const today = format(/* @__PURE__ */ new Date(), "yyyy-MM-dd");
    const isToday = dateStr === today;
    const isPast = new Date(dateStr) < new Date(today);
    let url;
    if (isPast) {
      url = `https://archive-api.open-meteo.com/v1/archive?latitude=${lat}&longitude=${lon}&start_date=${dateStr}&end_date=${dateStr}&daily=temperature_2m_mean,relative_humidity_2m_mean,wind_speed_10m_max,precipitation_probability_mean,uv_index_max&timezone=auto`;
    } else {
      url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&daily=temperature_2m_mean,relative_humidity_2m_mean,wind_speed_10m_max,precipitation_probability_mean,uv_index_max&timezone=auto&start_date=${dateStr}&end_date=${dateStr}`;
    }
    const data = await fetchWithTimeout(url);
    if (!data?.daily) {
      return nullResult;
    }
    const daily = data.daily;
    const result = {
      temperature: daily.temperature_2m_mean?.[0] || null,
      humidity: daily.relative_humidity_2m_mean?.[0] || null,
      windSpeed: daily.wind_speed_10m_max?.[0] || null,
      precipitationProbability: daily.precipitation_probability_mean?.[0] || null,
      uvIndex: daily.uv_index_max?.[0] || null
    };
    cache.set(lat, lon, dateStr, "weather", result);
    return result;
  } catch (error) {
    return nullResult;
  }
}
async function getAQI(lat, lon, date2) {
  const nullResult = {
    pm25: null,
    pm10: null,
    no2: null,
    o3: null,
    overallIndex: null
  };
  if (lat == null || lon == null) {
    return nullResult;
  }
  try {
    const dateStr = typeof date2 === "string" ? date2 : format(date2, "yyyy-MM-dd");
    const cached = cache.get(lat, lon, dateStr, "aqi");
    if (cached) {
      return cached;
    }
    const url = `https://api.openaq.org/v2/measurements?coordinates=${lat},${lon}&radius=50000&limit=100&order_by=datetime&sort=desc&date_from=${dateStr}&date_to=${dateStr}`;
    const data = await fetchWithTimeout(url, 5e3);
    if (!data?.results || !Array.isArray(data.results)) {
      return nullResult;
    }
    const measurements = data.results;
    const parameterValues = {};
    measurements.forEach((measurement) => {
      if (measurement.parameter && typeof measurement.value === "number") {
        if (!parameterValues[measurement.parameter]) {
          parameterValues[measurement.parameter] = [];
        }
        parameterValues[measurement.parameter].push(measurement.value);
      }
    });
    const getAverage = (param) => {
      const values = parameterValues[param];
      if (!values || values.length === 0) return null;
      return values.reduce((sum, val) => sum + val, 0) / values.length;
    };
    const pm25 = getAverage("pm25");
    const pm10 = getAverage("pm10");
    const no2 = getAverage("no2");
    const o3 = getAverage("o3");
    let overallIndex = null;
    if (pm25 !== null) {
      if (pm25 <= 12) overallIndex = 1;
      else if (pm25 <= 35) overallIndex = 2;
      else if (pm25 <= 55) overallIndex = 3;
      else if (pm25 <= 150) overallIndex = 4;
      else if (pm25 <= 250) overallIndex = 5;
      else overallIndex = 6;
    }
    const result = {
      pm25,
      pm10,
      no2,
      o3,
      overallIndex
    };
    cache.set(lat, lon, dateStr, "aqi", result);
    return result;
  } catch (error) {
    return nullResult;
  }
}
async function getEnvironment(lat, lon, date2) {
  const dateStr = typeof date2 === "string" ? date2 : format(date2, "yyyy-MM-dd");
  if (lat == null || lon == null) {
    return {
      solar: {
        sunrise: null,
        sunset: null,
        dayLength: null
      },
      weather: {
        temperature: null,
        humidity: null,
        windSpeed: null,
        precipitationProbability: null,
        uvIndex: null
      },
      aqi: {
        pm25: null,
        pm10: null,
        no2: null,
        o3: null,
        overallIndex: null
      },
      location: null,
      date: dateStr,
      timestamp: Date.now()
    };
  }
  try {
    const cached = cache.get(lat, lon, dateStr, "environment");
    if (cached) {
      return cached;
    }
    const [solar, weather, aqi] = await Promise.all([
      getSolar(lat, lon, dateStr),
      getWeather(lat, lon, dateStr),
      getAQI(lat, lon, dateStr)
    ]);
    const result = {
      solar,
      weather,
      aqi,
      location: { lat, lon },
      date: dateStr,
      timestamp: Date.now()
    };
    cache.set(lat, lon, dateStr, "environment", result);
    return result;
  } catch (error) {
    return {
      solar: {
        sunrise: null,
        sunset: null,
        dayLength: null
      },
      weather: {
        temperature: null,
        humidity: null,
        windSpeed: null,
        precipitationProbability: null,
        uvIndex: null
      },
      aqi: {
        pm25: null,
        pm10: null,
        no2: null,
        o3: null,
        overallIndex: null
      },
      location: lat != null && lon != null ? { lat, lon } : null,
      date: dateStr,
      timestamp: Date.now()
    };
  }
}

// server/services/metrics/index.ts
function clamp(value, min, max) {
  return Math.max(min, Math.min(max, value));
}
function safeDiv(numerator, denominator) {
  if (denominator === 0 || !isFinite(numerator) || !isFinite(denominator)) {
    return 0;
  }
  return numerator / denominator;
}
function winsorize(values, lowerPercentile = 0.05, upperPercentile = 0.95) {
  if (values.length === 0) return [];
  const sorted = [...values].sort((a2, b) => a2 - b);
  const lowerIndex = Math.floor(sorted.length * lowerPercentile);
  const upperIndex = Math.floor(sorted.length * upperPercentile);
  const lowerCap = sorted[lowerIndex];
  const upperCap = sorted[upperIndex];
  return values.map((val) => clamp(val, lowerCap, upperCap));
}
function computeRollingBaseline(values) {
  if (values.length === 0) {
    return { mean: 0, std: 0, count: 0 };
  }
  const mean = values.reduce((sum, val) => sum + val, 0) / values.length;
  const variance = values.reduce((sum, val) => sum + Math.pow(val - mean, 2), 0) / values.length;
  const std = Math.sqrt(variance);
  return { mean, std, count: values.length };
}
async function computeBaselines(userId, windowDays = 21) {
  const endDate = /* @__PURE__ */ new Date();
  const startDate = subDays(endDate, windowDays);
  try {
    const { data: reports, error } = await supabaseAdmin.from("health_reports").select("metrics").eq("user_id", userId).gte("date", format(startDate, "yyyy-MM-dd")).lte("date", format(endDate, "yyyy-MM-dd")).order("date", { ascending: false });
    if (error) {
      console.warn("Failed to fetch health reports for baselines:", error);
    }
    const hrvValues = [];
    const restingHRValues = [];
    const sleepScoreValues = [];
    const stressValues = [];
    const stepsValues = [];
    (reports || []).forEach((report) => {
      if (report.metrics && typeof report.metrics === "object") {
        const metrics = report.metrics;
        if (typeof metrics.hrv === "number" && !isNaN(metrics.hrv)) hrvValues.push(metrics.hrv);
        if (typeof metrics.restingHR === "number" && !isNaN(metrics.restingHR)) restingHRValues.push(metrics.restingHR);
        if (typeof metrics.sleepScore === "number" && !isNaN(metrics.sleepScore)) sleepScoreValues.push(metrics.sleepScore);
        if (typeof metrics.stress === "number" && !isNaN(metrics.stress)) stressValues.push(metrics.stress);
        if (typeof metrics.steps === "number" && !isNaN(metrics.steps)) stepsValues.push(metrics.steps);
      }
    });
    return {
      hrv: computeRollingBaseline(winsorize(hrvValues)),
      restingHR: computeRollingBaseline(winsorize(restingHRValues)),
      sleepScore: computeRollingBaseline(winsorize(sleepScoreValues)),
      stress: computeRollingBaseline(winsorize(stressValues)),
      steps: computeRollingBaseline(winsorize(stepsValues))
    };
  } catch (error) {
    console.warn("Error computing baselines:", error);
    return {
      hrv: { mean: 0, std: 0, count: 0 },
      restingHR: { mean: 0, std: 0, count: 0 },
      sleepScore: { mean: 0, std: 0, count: 0 },
      stress: { mean: 0, std: 0, count: 0 },
      steps: { mean: 0, std: 0, count: 0 }
    };
  }
}
function scoreSleep(sleepScore, baselines) {
  if (sleepScore == null || !isFinite(sleepScore)) return 50;
  let score = clamp(sleepScore, 0, 100);
  if (baselines.sleepScore.count >= 5) {
    const deviation = sleepScore - baselines.sleepScore.mean;
    const adjustment = deviation / Math.max(baselines.sleepScore.std, 5) * 5;
    score += adjustment;
  }
  return clamp(score, 0, 100);
}
function scoreActivity(steps, baselines) {
  if (steps == null || !isFinite(steps)) return 50;
  let score = Math.min(100, steps / 1e4 * 80);
  if (baselines.steps.count >= 5) {
    const deviation = steps - baselines.steps.mean;
    const adjustment = deviation / Math.max(baselines.steps.std, 1e3) * 5;
    score += adjustment;
  }
  return clamp(score, 0, 100);
}
function scoreStressRecovery(hrv, restingHR, stress, baselines) {
  let totalScore = 0;
  let componentCount = 0;
  if (hrv != null && isFinite(hrv)) {
    let hrvScore = 50;
    if (baselines.hrv.count >= 5) {
      const zScore = (hrv - baselines.hrv.mean) / Math.max(baselines.hrv.std, 1);
      hrvScore = 50 + zScore * 15;
    } else {
      hrvScore = Math.min(100, hrv / 50 * 100);
    }
    totalScore += clamp(hrvScore, 0, 100);
    componentCount++;
  }
  if (restingHR != null && isFinite(restingHR)) {
    let hrScore = 50;
    if (baselines.restingHR.count >= 5) {
      const zScore = (restingHR - baselines.restingHR.mean) / Math.max(baselines.restingHR.std, 2);
      hrScore = 50 - zScore * 15;
    } else {
      hrScore = Math.max(0, 100 - (restingHR - 50) / 30 * 50);
    }
    totalScore += clamp(hrScore, 0, 100);
    componentCount++;
  }
  if (stress != null && isFinite(stress)) {
    const stressScore = Math.max(0, 100 - stress * 10);
    totalScore += clamp(stressScore, 0, 100);
    componentCount++;
  }
  return componentCount > 0 ? totalScore / componentCount : 50;
}
function scoreVitality(sleepScore, steps, hrv, restingHR, stress, baselines) {
  const sleepComponent = scoreSleep(sleepScore, baselines);
  const activityComponent = scoreActivity(steps, baselines);
  const stressRecoveryComponent = scoreStressRecovery(hrv, restingHR, stress, baselines);
  return Math.round(
    sleepComponent * 0.4 + activityComponent * 0.3 + stressRecoveryComponent * 0.3
  );
}
function scorePerformancePotential({
  hrv,
  sleepScore,
  strain48h,
  rpe24h
}) {
  let score = 100;
  if (hrv != null && isFinite(hrv)) {
    if (hrv < 20) score -= 30;
    else if (hrv < 30) score -= 15;
    else if (hrv > 50) score += 5;
  }
  if (sleepScore != null && isFinite(sleepScore)) {
    if (sleepScore < 60) score -= 25;
    else if (sleepScore < 75) score -= 10;
    else if (sleepScore >= 85) score += 5;
  }
  if (strain48h != null && isFinite(strain48h)) {
    if (strain48h > 16) score -= 20;
    else if (strain48h > 12) score -= 10;
    else if (strain48h < 6) score += 5;
  }
  if (rpe24h != null && isFinite(rpe24h)) {
    if (rpe24h >= 9) score -= 25;
    else if (rpe24h >= 7) score -= 15;
    else if (rpe24h >= 5) score -= 5;
  }
  return clamp(score, 0, 100);
}
function scoreCircadian({
  sleepMidpointSd,
  wakeTime,
  sunrise,
  stepsFirst2h,
  uvMax
}) {
  let score = 50;
  let componentCount = 1;
  if (sleepMidpointSd != null && isFinite(sleepMidpointSd)) {
    const consistencyScore = Math.max(0, 100 - sleepMidpointSd * 60);
    score += clamp(consistencyScore, 0, 100);
    componentCount++;
  }
  if (wakeTime && sunrise) {
    try {
      const wakeHour = parseISO(`2000-01-01T${wakeTime}`).getHours();
      const sunriseHour = parseISO(sunrise).getHours();
      const diff = Math.abs(wakeHour - sunriseHour);
      let alignmentScore = 50;
      if (diff <= 1) alignmentScore = 100;
      else if (diff <= 2) alignmentScore = 80;
      else if (diff <= 3) alignmentScore = 60;
      else alignmentScore = Math.max(20, 60 - diff * 10);
      score += alignmentScore;
      componentCount++;
    } catch {
    }
  }
  if (stepsFirst2h != null && isFinite(stepsFirst2h)) {
    const morningActivityScore = Math.min(100, stepsFirst2h / 500 * 80);
    score += morningActivityScore;
    componentCount++;
  }
  if (uvMax != null && isFinite(uvMax)) {
    let uvScore = 50;
    if (uvMax >= 3 && uvMax <= 7) uvScore = 80;
    else if (uvMax > 7) uvScore = Math.max(30, 80 - (uvMax - 7) * 10);
    else uvScore = Math.max(20, uvMax * 25);
    score += uvScore;
    componentCount++;
  }
  return clamp(score / componentCount, 0, 100);
}
function scoreEnergyBalance(zoneMinutes14d) {
  if (!zoneMinutes14d) return 50;
  const totalMinutes = Object.values(zoneMinutes14d).reduce((sum, min) => sum + min, 0);
  if (totalMinutes === 0) return 50;
  const zone1Pct = safeDiv(zoneMinutes14d.zone1, totalMinutes) * 100;
  const zone2Pct = safeDiv(zoneMinutes14d.zone2, totalMinutes) * 100;
  const zone3Pct = safeDiv(zoneMinutes14d.zone3, totalMinutes) * 100;
  const zone4Pct = safeDiv(zoneMinutes14d.zone4, totalMinutes) * 100;
  const zone5Pct = safeDiv(zoneMinutes14d.zone5, totalMinutes) * 100;
  const easyPct = zone1Pct + zone2Pct;
  const hardPct = zone4Pct + zone5Pct;
  let score = 50;
  if (easyPct >= 70 && easyPct <= 80) score += 25;
  else if (easyPct >= 60 && easyPct <= 85) score += 15;
  else if (easyPct >= 50 && easyPct <= 90) score += 5;
  else score -= Math.abs(easyPct - 75) * 0.5;
  if (hardPct >= 10 && hardPct <= 20) score += 25;
  else if (hardPct >= 5 && hardPct <= 25) score += 15;
  else if (hardPct >= 0 && hardPct <= 30) score += 5;
  else score -= Math.abs(hardPct - 15) * 0.5;
  return clamp(score, 0, 100);
}
async function computeDailyMetrics(userId, date2, location) {
  try {
    const { data: healthReport } = await supabaseAdmin.from("health_reports").select("metrics").eq("user_id", userId).eq("date", date2).single();
    const metrics = healthReport?.metrics || {};
    const rawBiometrics = {
      hrv: metrics.hrv ?? null,
      restingHR: metrics.restingHR ?? null,
      sleepScore: metrics.sleepScore ?? null,
      stress: metrics.stress ?? null,
      steps: metrics.steps ?? null,
      calories: metrics.calories ?? null,
      sleepMidpointSd: metrics.sleepMidpointSd ?? null,
      wakeTime: metrics.wakeTime ?? null
    };
    const dateStart = /* @__PURE__ */ new Date(`${date2}T00:00:00Z`);
    const date24hAgo = subDays(dateStart, 1);
    const date48hAgo = subDays(dateStart, 2);
    const date14dAgo = subDays(dateStart, 14);
    const { data: workouts24h } = await supabaseAdmin.from("workouts").select("feedback, request").eq("user_id", userId).gte("created_at", date24hAgo.toISOString()).lt("created_at", dateStart.toISOString());
    const { data: workouts48h } = await supabaseAdmin.from("workouts").select("feedback, request").eq("user_id", userId).gte("created_at", date48hAgo.toISOString()).lt("created_at", dateStart.toISOString());
    const { data: workouts14d } = await supabaseAdmin.from("workouts").select("feedback, request, created_at").eq("user_id", userId).gte("created_at", date14dAgo.toISOString()).lt("created_at", dateStart.toISOString());
    const strain24h = (workouts24h || []).reduce((sum, w) => {
      const intensity = w.request?.intensity || 0;
      return sum + intensity;
    }, 0);
    const strain48h = (workouts48h || []).reduce((sum, w) => {
      const intensity = w.request?.intensity || 0;
      return sum + intensity;
    }, 0);
    const rpeValues = (workouts24h || []).map((w) => w.feedback?.difficulty).filter((d) => typeof d === "number");
    const rpe24h = rpeValues.length > 0 ? rpeValues.reduce((sum, rpe) => sum + rpe, 0) / rpeValues.length : null;
    let zoneMinutes14d = null;
    if (workouts14d && workouts14d.length > 0) {
      const zones = { zone1: 0, zone2: 0, zone3: 0, zone4: 0, zone5: 0 };
      workouts14d.forEach((w) => {
        const duration = w.request?.duration || 0;
        const intensity = w.request?.intensity || 0;
        if (intensity <= 3) zones.zone1 += duration;
        else if (intensity <= 5) zones.zone2 += duration;
        else if (intensity <= 6) zones.zone3 += duration;
        else if (intensity <= 8) zones.zone4 += duration;
        else zones.zone5 += duration;
      });
      zoneMinutes14d = zones;
    }
    const stepsFirst2h = rawBiometrics.steps ? Math.round(rawBiometrics.steps * 0.2) : null;
    const derived = {
      strain24h: strain24h || null,
      strain48h: strain48h || null,
      rpe24h,
      zoneMinutes14d,
      stepsFirst2h
    };
    const environment = await getEnvironment(
      location?.lat ?? null,
      location?.lon ?? null,
      date2
    );
    const baselines = await computeBaselines(userId);
    const vitalityScore = scoreVitality(
      rawBiometrics.sleepScore ?? null,
      rawBiometrics.steps ?? null,
      rawBiometrics.hrv ?? null,
      rawBiometrics.restingHR ?? null,
      rawBiometrics.stress ?? null,
      baselines
    );
    const performancePotentialScore = scorePerformancePotential({
      hrv: rawBiometrics.hrv ?? null,
      sleepScore: rawBiometrics.sleepScore ?? null,
      strain48h: derived.strain48h ?? null,
      rpe24h: derived.rpe24h ?? null
    });
    const circadianScore = scoreCircadian({
      sleepMidpointSd: rawBiometrics.sleepMidpointSd ?? null,
      wakeTime: rawBiometrics.wakeTime ?? null,
      sunrise: environment?.solar?.sunrise ?? null,
      stepsFirst2h: derived.stepsFirst2h ?? null,
      uvMax: environment?.weather?.uvIndex ?? null
    });
    const energyBalanceScore = scoreEnergyBalance(derived.zoneMinutes14d);
    return {
      vitalityScore: Math.round(vitalityScore),
      performancePotentialScore: Math.round(performancePotentialScore),
      circadianScore: Math.round(circadianScore),
      energyBalanceScore: Math.round(energyBalanceScore),
      rawBiometrics,
      derived,
      environment,
      baselines,
      date: date2,
      userId,
      timestamp: Date.now()
    };
  } catch (error) {
    console.error("Error computing daily metrics:", error);
    return {
      vitalityScore: 50,
      performancePotentialScore: 50,
      circadianScore: 50,
      energyBalanceScore: 50,
      rawBiometrics: {
        hrv: null,
        restingHR: null,
        sleepScore: null,
        stress: null,
        steps: null,
        calories: null,
        sleepMidpointSd: null,
        wakeTime: null
      },
      derived: {
        strain24h: null,
        strain48h: null,
        rpe24h: null,
        zoneMinutes14d: null,
        stepsFirst2h: null
      },
      environment: null,
      baselines: {
        hrv: { mean: 0, std: 0, count: 0 },
        restingHR: { mean: 0, std: 0, count: 0 },
        sleepScore: { mean: 0, std: 0, count: 0 },
        stress: { mean: 0, std: 0, count: 0 },
        steps: { mean: 0, std: 0, count: 0 }
      },
      date: date2,
      userId,
      timestamp: Date.now()
    };
  }
}

// server/metrics/axle.ts
init_workouts();
init_reports();
async function computeAxleScores({ userId, dateISO, metrics }) {
  const p2 = metrics.provider;
  const w = metrics.weather;
  const recent = await getUserRecentWorkouts(userId, { days: 7 });
  const totalActiveMins = recent.reduce((s2, w2) => s2 + (w2.total_active_minutes ?? 0), 0);
  const avgIntensity = recent.length ? recent.reduce((s2, w2) => s2 + (w2.intensity ?? 5), 0) / recent.length : 5;
  const intensityFactor = Math.min(1, Math.max(0, (avgIntensity - 3) / 7));
  const sleepScore = p2.sleep_score ?? 0;
  const sleepQuality = Math.max(0, Math.min(100, sleepScore));
  const hrv = p2.hrv ?? 0;
  const rhr = p2.resting_hr ?? 0;
  const rhrTrend = await getRHRTrend(userId, 7);
  const rhrTrend01 = Math.max(0, Math.min(1, 10 - Math.min(10, Math.max(-10, rhrTrend))) / 10);
  const hrv01 = Math.max(0, Math.min(1, hrv / 120));
  const recovery01 = 0.65 * hrv01 + 0.35 * rhrTrend01;
  const activity01 = Math.max(0, Math.min(1, totalActiveMins / (45 * 7)));
  const uv = w?.uv_index ?? null;
  const aqi = w?.aqi ?? null;
  const sunrise = w?.sunrise ? new Date(w.sunrise) : null;
  const sunset = w?.sunset ? new Date(w.sunset) : null;
  let circadian01 = 0.5;
  if (sunrise && sunset) {
    const dayActivityBias = 0.6;
    const pollutionPenalty = aqi != null ? Math.max(0, Math.min(0.2, (aqi - 50) / 500)) : 0;
    const uvBonus = uv != null ? Math.max(0, Math.min(0.15, uv / 11 * 0.15)) : 0;
    circadian01 = Math.max(0, Math.min(1, dayActivityBias * activity01 + 0.4 * recovery01 + uvBonus - pollutionPenalty));
  }
  const vitality = 0.3 * (sleepQuality / 100) + 0.25 * activity01 + 0.25 * recovery01 + 0.2 * intensityFactor;
  const performance = 0.5 * recovery01 + 0.3 * intensityFactor + 0.2 * (1 - Math.max(0, Math.min(1, (rhr - 50) / 40)));
  const last28 = await getUserRecentWorkouts(userId, { days: 28 });
  const counts = { alactic: 0, lactic: 0, aerobic: 0 };
  for (const w2 of last28) {
    const sys = w2.energy_system ?? "aerobic";
    counts[sys] = (counts[sys] ?? 0) + 1;
  }
  const total = Math.max(1, counts.alactic + counts.lactic + counts.aerobic);
  const ideal = total / 3;
  const imbalance = Math.abs(counts.alactic - ideal) + Math.abs(counts.lactic - ideal) + Math.abs(counts.aerobic - ideal);
  const energyBalance01 = Math.max(0, 1 - imbalance / total);
  const axle = 0.25 * vitality + 0.25 * performance + 0.25 * circadian01 + 0.25 * energyBalance01;
  const toPct = (x) => Math.round(Math.max(0, Math.min(100, x * 100)));
  return {
    vitality_score: toPct(vitality),
    performance_potential: toPct(performance),
    circadian_alignment: toPct(circadian01),
    energy_systems_balance: toPct(energyBalance01),
    axle_health_score: toPct(axle)
  };
}

// server/routes/health.ts
init_reports();
init_suggestions();

// server/scripts/backfill-axle.ts
init_db();
init_schema();
import { eq as eq8, and as and8, gte as gte5 } from "drizzle-orm";
async function backfillAxleScores(userId, days = 30, force = false) {
  console.log(`[AXLE_BACKFILL] Starting backfill for user ${userId}, ${days} days, force=${force}`);
  const endDate = /* @__PURE__ */ new Date();
  const startDate = /* @__PURE__ */ new Date();
  startDate.setDate(endDate.getDate() - days);
  const startDateStr = startDate.toISOString().split("T")[0];
  try {
    const reports = await db.select().from(healthReports).where(
      and8(
        eq8(healthReports.userId, userId),
        gte5(healthReports.date, startDateStr)
      )
    ).orderBy(healthReports.date);
    console.log(`[AXLE_BACKFILL] Found ${reports.length} health reports to process`);
    const results = [];
    let updated = 0;
    let skipped = 0;
    let failed = 0;
    for (const report of reports) {
      const dateStr = report.date;
      try {
        const currentMetrics = report.metrics || {};
        if (!force && currentMetrics.axle && Object.keys(currentMetrics.axle).length > 0) {
          console.log(`[AXLE_BACKFILL] Skipping ${dateStr} - Axle scores already exist`);
          results.push({
            date: dateStr,
            success: true,
            action: "skipped"
          });
          skipped++;
          continue;
        }
        if (!currentMetrics.provider) {
          console.log(`[AXLE_BACKFILL] Skipping ${dateStr} - No provider data available`);
          results.push({
            date: dateStr,
            success: true,
            action: "skipped"
          });
          skipped++;
          continue;
        }
        const metricsEnvelope = {
          provider: currentMetrics.provider || {},
          weather: currentMetrics.weather || {},
          axle: currentMetrics.axle || {}
          // This will be overwritten
        };
        console.log(`[AXLE_BACKFILL] Computing Axle scores for ${dateStr}`);
        const axleScores = await computeAxleScores({
          userId,
          dateISO: dateStr,
          metrics: metricsEnvelope
        });
        const updatedMetrics = {
          ...currentMetrics,
          axle: axleScores
        };
        await db.update(healthReports).set({
          metrics: updatedMetrics
        }).where(
          and8(
            eq8(healthReports.userId, userId),
            eq8(healthReports.date, dateStr)
          )
        );
        console.log(`[AXLE_BACKFILL] Successfully updated ${dateStr}`, axleScores);
        results.push({
          date: dateStr,
          success: true,
          action: "updated",
          scores: axleScores
        });
        updated++;
      } catch (error) {
        console.error(`[AXLE_BACKFILL] Failed to process ${dateStr}:`, error);
        results.push({
          date: dateStr,
          success: false,
          action: "failed",
          error: error instanceof Error ? error.message : "Unknown error"
        });
        failed++;
      }
    }
    console.log(`[AXLE_BACKFILL] Completed: ${updated} updated, ${skipped} skipped, ${failed} failed`);
    return {
      processed: reports.length,
      updated,
      skipped,
      failed,
      results
    };
  } catch (error) {
    console.error("[AXLE_BACKFILL] Critical error during backfill:", error);
    throw error;
  }
}

// server/routes/health.ts
var router3 = Router4();
router3.get("/connect/providers", requireAuth, async (req, res) => {
  try {
    const authReq = req;
    const userId = authReq.user.id;
    const connections = await db.select().from(wearableConnections).where(eq9(wearableConnections.userId, userId));
    const providers = getProviderRegistry();
    const providerList = Object.values(providers).map((provider) => {
      const connection = connections.find((c2) => c2.provider === provider.id);
      return {
        id: provider.id,
        supported: provider.hasConfig(),
        connected: connection?.connected || false,
        last_sync: connection?.lastSync || null,
        status: connection?.status || "disconnected",
        error: connection?.error || null
      };
    });
    res.json(providerList);
  } catch (error) {
    console.error("Error fetching providers:", error);
    res.status(500).json({ message: "Failed to fetch providers" });
  }
});
router3.post("/connect/:provider/start", requireAuth, async (req, res) => {
  try {
    const authReq = req;
    const userId = authReq.user.id;
    const { provider: providerName } = req.params;
    const providers = getProviderRegistry();
    const provider = providers[providerName];
    if (!provider) {
      return res.status(404).json({ message: "Provider not found" });
    }
    if (!provider.hasConfig()) {
      return res.status(400).json({ message: "Provider not configured" });
    }
    if (provider.id === "Mock") {
      if (provider.authCallback) {
        await provider.authCallback({}, userId);
      }
      const existingConnection = await db.select().from(wearableConnections).where(and9(
        eq9(wearableConnections.userId, userId),
        eq9(wearableConnections.provider, provider.id)
      )).limit(1);
      if (existingConnection[0]) {
        await db.update(wearableConnections).set({
          connected: true,
          status: "connected",
          lastSync: /* @__PURE__ */ new Date(),
          error: null
        }).where(and9(
          eq9(wearableConnections.userId, userId),
          eq9(wearableConnections.provider, provider.id)
        ));
      } else {
        await db.insert(wearableConnections).values({
          userId,
          provider: provider.id,
          connected: true,
          status: "connected",
          lastSync: /* @__PURE__ */ new Date()
        });
      }
      return res.json({ success: true, connected: true });
    } else {
      if (!provider.authStart) {
        return res.status(500).json({ message: "Provider does not support authentication" });
      }
      console.log(`[${providerName}] authStart: Starting auth for provider ${providerName}, user ${userId}`);
      const { redirectUrl } = await provider.authStart(userId);
      console.log(`[${providerName}] authStart: Generated redirect URL for ${providerName}`);
      return res.json({ redirectUrl });
    }
  } catch (error) {
    const reqId = req.id || "unknown";
    console.error(`[${reqId}] Error starting provider connection:`, error instanceof Error ? error.message : error);
    res.status(500).json({ message: "Failed to start provider connection" });
  }
});
router3.get("/connect/:provider/callback", requireAuth, async (req, res) => {
  try {
    const authReq = req;
    const userId = authReq.user.id;
    const { provider: providerName } = req.params;
    const allowedCallbacks = ["Mock", "Fitbit", "Whoop", "Oura", "Garmin", "AppleHealth"];
    if (!allowedCallbacks.includes(providerName)) {
      return res.status(400).json({ message: "Invalid callback provider" });
    }
    const providers = getProviderRegistry();
    const provider = providers[providerName];
    if (!provider) {
      return res.status(404).json({ message: "Provider not found" });
    }
    if (!provider.hasConfig()) {
      return res.status(400).json({ message: "Provider not configured" });
    }
    if (provider.id === "Mock") {
      return res.json({ success: true });
    }
    if (!provider.authCallback) {
      return res.status(500).json({ message: "Provider does not support OAuth callback" });
    }
    console.log(`[${providerName}] callback: Processing callback for provider ${providerName}, user ${userId}`);
    await provider.authCallback(req.query, userId);
    console.log(`[${providerName}] callback: Successfully processed callback for ${providerName}`);
    await db.update(wearableConnections).set({
      connected: true,
      status: "connected",
      lastSync: /* @__PURE__ */ new Date(),
      error: null
    }).where(and9(
      eq9(wearableConnections.userId, userId),
      eq9(wearableConnections.provider, provider.id)
    ));
    res.json({ success: true });
  } catch (error) {
    const reqId = req.id || "unknown";
    console.error(`[${reqId}] Error handling provider callback:`, error instanceof Error ? error.message : error);
    res.status(500).json({ message: "Failed to handle provider callback" });
  }
});
router3.post("/connect/:provider/disconnect", requireAuth, async (req, res) => {
  try {
    const authReq = req;
    const userId = authReq.user.id;
    const { provider: providerName } = req.params;
    const providers = getProviderRegistry();
    const provider = providers[providerName];
    if (!provider) {
      return res.status(404).json({ error: "Unknown provider" });
    }
    if ("revoke" in provider && typeof provider.revoke === "function") {
      await provider.revoke(userId);
    } else {
      await deleteTokens(userId, providerName);
      await db.update(wearableConnections).set({
        connected: false,
        status: "disconnected",
        error: null
      }).where(and9(
        eq9(wearableConnections.userId, userId),
        eq9(wearableConnections.provider, providerName)
      ));
    }
    return res.json({ success: true });
  } catch (error) {
    const reqId = req.id || "unknown";
    console.error(`[${reqId}] Error disconnecting provider:`, error instanceof Error ? error.message : error);
    return res.status(500).json({ error: error instanceof Error ? error.message : "disconnect failed" });
  }
});
router3.post("/health/sync", requireAuth, async (req, res) => {
  try {
    const authReq = req;
    const userId = authReq.user.id;
    const bodySchema = z14.object({
      provider: z14.string()
    });
    const { provider: providerName } = bodySchema.parse(req.body);
    const providers = getProviderRegistry();
    const provider = providers[providerName];
    if (!provider) {
      return res.status(404).json({ message: "Provider not found" });
    }
    if (!provider.fetchLatest) {
      return res.status(500).json({ message: "Provider does not support data fetching" });
    }
    const connection = await db.select().from(wearableConnections).where(and9(
      eq9(wearableConnections.userId, userId),
      eq9(wearableConnections.provider, providerName)
    )).limit(1);
    if (!connection[0] || !connection[0].connected) {
      return res.status(400).json({ message: "Provider not connected" });
    }
    console.log(`[WHOOP] fetchLatest: Syncing data for provider ${providerName}, user ${userId}`);
    const healthSnapshot = await provider.fetchLatest(userId);
    console.log(`[WHOOP] fetchLatest: Completed sync for ${providerName}`, { snapshot: !!healthSnapshot });
    const today = (/* @__PURE__ */ new Date()).toISOString().split("T")[0];
    const existingReport = await db.select().from(healthReports).where(and9(
      eq9(healthReports.userId, userId),
      eq9(healthReports.date, today)
    )).limit(1);
    let weatherData = void 0;
    try {
      const profileResult = await db.execute(sql6`
        SELECT last_lat, last_lon 
        FROM profiles 
        WHERE user_id = ${userId}
      `);
      const profile = profileResult.rows;
      if (false) {
        console.log(`\u{1F30D} [SYNC] Fetching environmental data for user ${userId}`);
        const lat = Number(profile[0].last_lat);
        const lon = Number(profile[0].last_lon);
        const envData = await getEnvironment2(lat, lon, today);
        weatherData = {
          lat,
          lon,
          tz: envData.location?.lat ? "UTC" : void 0,
          sunrise: envData.solar.sunrise || void 0,
          sunset: envData.solar.sunset || void 0,
          uv_index: envData.weather.uvIndex,
          aqi: envData.aqi.overallIndex,
          temp_c: envData.weather.temperature
        };
      }
    } catch (error) {
      console.warn(`\u26A0\uFE0F [SYNC] Failed to fetch environmental data for user ${userId}:`, error);
    }
    const fourteenDaysAgo = /* @__PURE__ */ new Date();
    fourteenDaysAgo.setDate(fourteenDaysAgo.getDate() - 14);
    const last14Workouts = await db.select().from(workouts).where(and9(
      eq9(workouts.userId, userId),
      gte6(workouts.createdAt, fourteenDaysAgo)
    )).orderBy(desc6(workouts.createdAt));
    const tempHealthReport = {
      id: "",
      userId,
      date: today,
      metrics: {
        hrv: healthSnapshot.hrv,
        restingHR: healthSnapshot.restingHR,
        sleepScore: healthSnapshot.sleepScore,
        stress: healthSnapshot.stress,
        steps: healthSnapshot.steps,
        calories: healthSnapshot.calories
      },
      summary: null,
      suggestions: [],
      fatigueScore: null
    };
    const rulesApplied = [];
    const fatigueScore = computeFatigue(tempHealthReport, last14Workouts, rulesApplied);
    const envelope = {
      provider: {
        hrv: healthSnapshot.hrv,
        resting_hr: healthSnapshot.restingHR,
        sleep_score: healthSnapshot.sleepScore,
        fatigue_score: fatigueScore
      },
      weather: weatherData,
      axle: {}
      // Will be filled by computeAxleScores
    };
    console.log(`\u{1F9E0} [SYNC] Computing Axle scores for user ${userId}`);
    envelope.axle = await computeAxleScores({
      userId,
      dateISO: today,
      metrics: envelope
    });
    console.log(`\u2728 [SYNC] Computed Axle scores: Health ${envelope.axle.axle_health_score}/100, Vitality ${envelope.axle.vitality_score}/100`);
    await upsertDailyReport(userId, today, envelope);
    await db.update(wearableConnections).set({
      lastSync: /* @__PURE__ */ new Date(),
      status: "connected",
      error: null
    }).where(and9(
      eq9(wearableConnections.userId, userId),
      eq9(wearableConnections.provider, providerName)
    ));
    res.json({
      success: true,
      data: healthSnapshot,
      synced_at: (/* @__PURE__ */ new Date()).toISOString()
    });
  } catch (error) {
    console.error("Error syncing health data:", error);
    try {
      const { provider: providerName } = req.body;
      if (providerName) {
        await db.update(wearableConnections).set({
          status: "error",
          error: error instanceof Error ? error.message : "Unknown error"
        }).where(and9(
          eq9(wearableConnections.userId, req.user.id),
          eq9(wearableConnections.provider, providerName)
        ));
      }
    } catch (updateError) {
      console.error("Error updating connection status:", updateError);
    }
    res.status(500).json({ message: "Failed to sync health data" });
  }
});
router3.get("/health/reports", requireAuth, async (req, res) => {
  try {
    const authReq = req;
    const userId = authReq.user.id;
    const daysParam = req.query.days ? parseInt(req.query.days) : 14;
    const days = Math.max(1, Math.min(365, daysParam));
    const endDate = /* @__PURE__ */ new Date();
    const startDate = /* @__PURE__ */ new Date();
    startDate.setDate(endDate.getDate() - days);
    const reports = await db.select().from(healthReports).where(and9(
      eq9(healthReports.userId, userId)
      // Note: In a real implementation, you'd want to add proper date filtering
      // For now, we'll get all reports and filter in memory
    )).orderBy(desc6(healthReports.date)).limit(days);
    res.json(reports);
  } catch (error) {
    console.error("Error fetching health reports:", error);
    res.status(500).json({ message: "Failed to fetch health reports" });
  }
});
router3.get("/admin/whoop/ping", requireAdmin, async (req, res) => {
  try {
    const providers = getProviderRegistry();
    const whoopProvider = providers["Whoop"];
    if (!whoopProvider) {
      return res.status(404).json({
        ok: false,
        error: "WHOOP provider not found",
        redirectUri: null,
        scopes: null
      });
    }
    const hasConfig = whoopProvider.hasConfig();
    const redirectUri2 = hasConfig ? `${process.env.SITE_URL || process.env.VITE_SITE_URL}/api/connect/Whoop/callback` : null;
    const scopes = hasConfig ? "read:profile read:body_measurement read:recovery read:cycles read:sleep read:workout" : null;
    console.log(`[WHOOP] Admin ping: hasConfig=${hasConfig}, redirectUri=${redirectUri2}`);
    res.json({
      ok: hasConfig,
      redirectUri: redirectUri2,
      scopes,
      environment: {
        has_client_id: !!process.env.WHOOP_CLIENT_ID,
        has_client_secret: !!process.env.WHOOP_CLIENT_SECRET,
        has_site_url: !!(process.env.SITE_URL || process.env.VITE_SITE_URL)
      }
    });
  } catch (error) {
    console.error("[WHOOP] Admin ping error:", error);
    res.status(500).json({
      ok: false,
      error: error instanceof Error ? error.message : "Unknown error",
      redirectUri: null,
      scopes: null
    });
  }
});
if (process.env.NODE_ENV !== "production") {
  router3.get("/dev/garmin/test-backfill", requireAuth, async (req, res) => {
    try {
      const authReq = req;
      const userId = authReq.user.id;
      const tokens = await getDecryptedTokens(userId, "Garmin");
      if (!tokens) {
        return res.status(400).json({
          error: "No Garmin tokens found. Connect Garmin first.",
          available: false
        });
      }
      const end = Math.floor(Date.now() / 1e3);
      const start = end - 2 * 86400;
      console.log(`[DEV] Testing Garmin backfill for user ${userId}, range: ${start} to ${end}`);
      const results = {
        timeRange: { start, end },
        tests: {}
      };
      try {
        console.log("[DEV] Testing backfillDailies...");
        const dailies = await backfillDailies(tokens.accessToken, start, end);
        results.tests.dailies = {
          success: true,
          count: Array.isArray(dailies) ? dailies.length : 0,
          sample: Array.isArray(dailies) && dailies.length > 0 ? dailies[0] : null
        };
      } catch (error) {
        results.tests.dailies = {
          success: false,
          error: error instanceof Error ? error.message : "Unknown error"
        };
      }
      try {
        console.log("[DEV] Testing backfillSleeps...");
        const sleeps = await backfillSleeps(tokens.accessToken, start, end);
        results.tests.sleeps = {
          success: true,
          count: Array.isArray(sleeps) ? sleeps.length : 0,
          sample: Array.isArray(sleeps) && sleeps.length > 0 ? sleeps[0] : null
        };
      } catch (error) {
        results.tests.sleeps = {
          success: false,
          error: error instanceof Error ? error.message : "Unknown error"
        };
      }
      try {
        console.log("[DEV] Testing backfillHRV...");
        const hrv = await backfillHRV(tokens.accessToken, start, end);
        results.tests.hrv = {
          success: true,
          count: Array.isArray(hrv) ? hrv.length : 0,
          sample: Array.isArray(hrv) && hrv.length > 0 ? hrv[0] : null
        };
      } catch (error) {
        results.tests.hrv = {
          success: false,
          error: error instanceof Error ? error.message : "Unknown error"
        };
      }
      console.log("[DEV] Garmin backfill test results:", JSON.stringify(results, null, 2));
      res.json({
        message: "Garmin backfill test completed",
        available: true,
        ...results
      });
    } catch (error) {
      console.error("[DEV] Garmin backfill test error:", error);
      res.status(500).json({
        error: error instanceof Error ? error.message : "Unknown error",
        available: false
      });
    }
  });
}
router3.post("/health/compute/daily", requireAuth, async (req, res) => {
  try {
    const authReq = req;
    const userId = authReq.user.id;
    const bodySchema = z14.object({
      date: z14.string().regex(/^\d{4}-\d{2}-\d{2}$/).optional()
    });
    const { date: date2 } = bodySchema.parse(req.body);
    const targetDate = date2 || (/* @__PURE__ */ new Date()).toISOString().split("T")[0];
    console.log(`[COMPUTE] Computing daily metrics for user ${userId}, date: ${targetDate}`);
    const profile = await db.select().from(profiles).where(eq9(profiles.userId, userId)).limit(1);
    let userLocation = null;
    if (profile[0] && profile[0].latitude && profile[0].longitude) {
      userLocation = {
        lat: profile[0].latitude,
        lon: profile[0].longitude,
        timezone: profile[0].timezone || "UTC"
      };
      console.log(`[COMPUTE] Using profile location: lat=${userLocation.lat}, lon=${userLocation.lon}, tz=${userLocation.timezone}`);
    } else {
      console.log(`[COMPUTE] No location data in profile, environment service will use null coordinates`);
    }
    const metrics = await computeDailyMetrics(userId, targetDate, userLocation);
    console.log(`[COMPUTE] Computed metrics for ${targetDate}:`, {
      vitality: metrics.vitalityScore,
      performance: metrics.performancePotentialScore,
      circadian: metrics.circadianScore,
      energy: metrics.energyBalanceScore
    });
    const existingReport = await db.select().from(healthReports).where(and9(
      eq9(healthReports.userId, userId),
      eq9(healthReports.date, targetDate)
    )).limit(1);
    const reportData = {
      // Top-level fields for baseline computation compatibility
      hrv: metrics.rawBiometrics.hrv,
      restingHR: metrics.rawBiometrics.restingHR,
      sleepScore: metrics.rawBiometrics.sleepScore,
      stress: metrics.rawBiometrics.stress,
      steps: metrics.rawBiometrics.steps,
      calories: metrics.rawBiometrics.calories,
      // Computed scores (top-level for easy access)
      vitalityScore: metrics.vitalityScore,
      performancePotentialScore: metrics.performancePotentialScore,
      circadianScore: metrics.circadianScore,
      energyBalanceScore: metrics.energyBalanceScore,
      // Structured data for advanced analysis
      rawBiometrics: metrics.rawBiometrics,
      derived: metrics.derived,
      environment: metrics.environment,
      baselines: metrics.baselines
    };
    if (existingReport[0]) {
      const currentMetrics = existingReport[0].metrics || {};
      const mergedMetrics = {
        ...currentMetrics,
        ...reportData
      };
      await db.update(healthReports).set({
        metrics: mergedMetrics
      }).where(and9(
        eq9(healthReports.userId, userId),
        eq9(healthReports.date, targetDate)
      ));
      console.log(`[COMPUTE] Updated existing report for ${targetDate}`);
    } else {
      await db.insert(healthReports).values({
        userId,
        date: targetDate,
        metrics: reportData,
        suggestions: []
      });
      console.log(`[COMPUTE] Created new report for ${targetDate}`);
    }
    res.json({
      success: true,
      date: targetDate,
      computed_at: (/* @__PURE__ */ new Date()).toISOString(),
      scores: {
        vitality: metrics.vitalityScore,
        performance: metrics.performancePotentialScore,
        circadian: metrics.circadianScore,
        energy: metrics.energyBalanceScore
      }
    });
  } catch (error) {
    console.error("[COMPUTE] Error computing daily metrics:", error);
    res.status(500).json({
      message: "Failed to compute daily metrics",
      error: error instanceof Error ? error.message : "Unknown error"
    });
  }
});
router3.post("/health/compute/backfill", requireAdmin, async (req, res) => {
  try {
    const adminReq = req;
    const userId = adminReq.user.id;
    const bodySchema = z14.object({
      days: z14.number().min(1).max(365)
    });
    const { days } = bodySchema.parse(req.body);
    console.log(`[BACKFILL] Starting backfill for ${days} days, user: ${userId}`);
    const profile = await db.select().from(profiles).where(eq9(profiles.userId, userId)).limit(1);
    let userLocation = null;
    if (profile[0] && profile[0].latitude && profile[0].longitude) {
      userLocation = {
        lat: profile[0].latitude,
        lon: profile[0].longitude
      };
      console.log(`[BACKFILL] Using profile location: lat=${userLocation.lat}, lon=${userLocation.lon}`);
    } else {
      console.log(`[BACKFILL] No location data in profile, environment service will use null coordinates`);
    }
    const results = [];
    const today = /* @__PURE__ */ new Date();
    for (let i2 = 0; i2 < days; i2++) {
      const targetDate = new Date(today);
      targetDate.setDate(today.getDate() - i2);
      const dateStr = targetDate.toISOString().split("T")[0];
      try {
        console.log(`[BACKFILL] Processing date: ${dateStr} (${i2 + 1}/${days})`);
        const metrics = await computeDailyMetrics(userId, dateStr, userLocation);
        const existingReport = await db.select().from(healthReports).where(and9(
          eq9(healthReports.userId, userId),
          eq9(healthReports.date, dateStr)
        )).limit(1);
        const reportData = {
          // Top-level fields for baseline computation compatibility
          hrv: metrics.rawBiometrics.hrv,
          restingHR: metrics.rawBiometrics.restingHR,
          sleepScore: metrics.rawBiometrics.sleepScore,
          stress: metrics.rawBiometrics.stress,
          steps: metrics.rawBiometrics.steps,
          calories: metrics.rawBiometrics.calories,
          // Computed scores (top-level for easy access)
          vitalityScore: metrics.vitalityScore,
          performancePotentialScore: metrics.performancePotentialScore,
          circadianScore: metrics.circadianScore,
          energyBalanceScore: metrics.energyBalanceScore,
          // Structured data for advanced analysis
          rawBiometrics: metrics.rawBiometrics,
          derived: metrics.derived,
          environment: metrics.environment,
          baselines: metrics.baselines
        };
        if (existingReport[0]) {
          const currentMetrics = existingReport[0].metrics || {};
          const mergedMetrics = {
            ...currentMetrics,
            ...reportData
          };
          await db.update(healthReports).set({
            metrics: mergedMetrics
          }).where(and9(
            eq9(healthReports.userId, userId),
            eq9(healthReports.date, dateStr)
          ));
        } else {
          await db.insert(healthReports).values({
            userId,
            date: dateStr,
            metrics: reportData,
            suggestions: []
          });
        }
        results.push({
          date: dateStr,
          success: true,
          scores: {
            vitality: metrics.vitalityScore,
            performance: metrics.performancePotentialScore,
            circadian: metrics.circadianScore,
            energy: metrics.energyBalanceScore
          }
        });
      } catch (error) {
        console.error(`[BACKFILL] Error processing ${dateStr}:`, error);
        results.push({
          date: dateStr,
          success: false,
          error: error instanceof Error ? error.message : "Unknown error"
        });
      }
    }
    const successCount = results.filter((r4) => r4.success).length;
    console.log(`[BACKFILL] Completed: ${successCount}/${days} successful`);
    res.json({
      success: true,
      processed: days,
      successful: successCount,
      failed: days - successCount,
      results,
      backfilled_at: (/* @__PURE__ */ new Date()).toISOString()
    });
  } catch (error) {
    console.error("[BACKFILL] Error during backfill:", error);
    res.status(500).json({
      message: "Failed to backfill metrics",
      error: error instanceof Error ? error.message : "Unknown error"
    });
  }
});
router3.post("/health/backfill-axle", requireAdmin, async (req, res) => {
  try {
    const adminReq = req;
    const userId = adminReq.user.id;
    const bodySchema = z14.object({
      days: z14.number().min(1).max(90).default(30),
      force: z14.boolean().default(false)
    });
    const { days, force } = bodySchema.parse(req.body);
    console.log(`[AXLE_BACKFILL] Admin ${adminReq.user.email} triggered backfill for ${days} days, force=${force}`);
    const result = await backfillAxleScores(userId, days, force);
    res.json({
      success: true,
      message: `Backfill completed: ${result.updated} updated, ${result.skipped} skipped, ${result.failed} failed`,
      ...result,
      backfilled_at: (/* @__PURE__ */ new Date()).toISOString(),
      admin_user: adminReq.user.email
    });
  } catch (error) {
    console.error("[AXLE_BACKFILL] Error during admin backfill:", error);
    res.status(500).json({
      message: "Failed to backfill Axle scores",
      error: error instanceof Error ? error.message : "Unknown error"
    });
  }
});
var health_default = router3;

// server/routes/health-metrics.ts
import { Router as Router5 } from "express";
init_db();
init_schema();
import { eq as eq10, gte as gte7, and as and10 } from "drizzle-orm";
var router4 = Router5();
router4.get("/metrics", requireAuth, async (req, res) => {
  try {
    const authReq = req;
    const userId = authReq.user.id;
    const days = Math.min(60, Math.max(1, parseInt(String(req.query.days ?? "14"), 10)));
    const cutoffDate = new Date(Date.now() - days * 24 * 60 * 60 * 1e3);
    const cutoffDateStr = cutoffDate.toISOString().slice(0, 10);
    const data = await db.select({
      date: healthReports.date,
      metrics: healthReports.metrics
    }).from(healthReports).where(
      and10(
        eq10(healthReports.userId, userId),
        gte7(healthReports.date, cutoffDateStr)
      )
    ).orderBy(healthReports.date);
    const out = data.map((r4) => ({
      date: r4.date,
      // provider
      hrv: r4.metrics?.provider?.hrv ?? null,
      resting_hr: r4.metrics?.provider?.resting_hr ?? null,
      sleep_score: r4.metrics?.provider?.sleep_score ?? null,
      fatigue_score: r4.metrics?.provider?.fatigue_score ?? null,
      // axle
      axle_health_score: r4.metrics?.axle?.axle_health_score ?? null,
      vitality_score: r4.metrics?.axle?.vitality_score ?? null,
      performance_potential: r4.metrics?.axle?.performance_potential ?? null,
      circadian_alignment: r4.metrics?.axle?.circadian_alignment ?? null,
      energy_systems_balance: r4.metrics?.axle?.energy_systems_balance ?? null
    }));
    res.json({ days, points: out });
  } catch (error) {
    console.error("Error fetching health metrics:", error);
    res.status(500).json({ error: "Failed to fetch health metrics" });
  }
});
var health_metrics_default = router4;

// server/routes/push-native.ts
import { Router as Router6 } from "express";
import { z as z15 } from "zod";
init_db();
init_schema();
import { eq as eq11, and as and11 } from "drizzle-orm";

// server/lib/apns.ts
import jwt from "jsonwebtoken";
function getAPNsConfig() {
  const keyId = process.env.APNS_KEY_ID;
  const teamId = process.env.APNS_TEAM_ID;
  const bundleId = process.env.APNS_BUNDLE_ID || "com.axle.app";
  const key = process.env.APNS_KEY;
  if (!keyId || !teamId || !key) {
    console.warn("[APNS] Missing required environment variables:", {
      hasKeyId: !!keyId,
      hasTeamId: !!teamId,
      hasKey: !!key,
      hasBundleId: !!bundleId
    });
    return null;
  }
  console.log(`[APNS] Configuration loaded for bundle: ${bundleId}`);
  return { keyId, teamId, bundleId, key };
}
function generateJWT(config2) {
  const now = Math.floor(Date.now() / 1e3);
  const payload = {
    iss: config2.teamId,
    iat: now
  };
  const header = {
    alg: "ES256",
    kid: config2.keyId
  };
  return jwt.sign(payload, config2.key, {
    algorithm: "ES256",
    header
  });
}
async function sendAPNs(deviceToken, payload, config2) {
  const apnsConfig = config2 || getAPNsConfig();
  if (!apnsConfig) {
    return {
      success: false,
      error: "APNs configuration not available - missing environment variables"
    };
  }
  try {
    const jwt2 = generateJWT(apnsConfig);
    const notification = {
      aps: {
        alert: {
          title: payload.title,
          body: payload.body
        },
        badge: payload.badge,
        sound: payload.sound || "default"
      },
      ...payload.data
    };
    const useSandbox = process.env.NODE_ENV !== "production";
    const host = useSandbox ? "https://api.sandbox.push.apple.com" : "https://api.push.apple.com";
    const url = `${host}/3/device/${deviceToken}`;
    console.log(`[APNS] Sending notification to ${deviceToken.substring(0, 10)}... via ${useSandbox ? "sandbox" : "production"} (${host})`);
    const response = await fetch(url, {
      method: "POST",
      headers: {
        "Authorization": `Bearer ${jwt2}`,
        "apns-topic": apnsConfig.bundleId,
        "apns-push-type": "alert",
        "apns-priority": "10",
        "Content-Type": "application/json"
      },
      body: JSON.stringify(notification)
    });
    const responseText = await response.text();
    const apnsId = response.headers.get("apns-id");
    if (response.ok) {
      console.log(`[APNS] Successfully sent notification, apns-id: ${apnsId}`);
      return {
        success: true,
        apnsId: apnsId || void 0
      };
    } else {
      console.error(`[APNS] Failed to send notification:`, {
        status: response.status,
        statusText: response.statusText,
        response: responseText,
        apnsId
      });
      return {
        success: false,
        error: `APNs error ${response.status}: ${responseText || response.statusText}`
      };
    }
  } catch (error) {
    console.error("[APNS] Error sending notification:", error);
    return {
      success: false,
      error: error instanceof Error ? error.message : "Unknown APNs error"
    };
  }
}
function isAPNsConfigured() {
  return getAPNsConfig() !== null;
}

// server/routes/push-native.ts
var router5 = Router6();
router5.post("/register-device", requireAuth, async (req, res) => {
  try {
    const authReq = req;
    const userId = authReq.user.id;
    const bodySchema = z15.object({
      token: z15.string().min(1),
      platform: z15.enum(["ios", "web"]).default("ios")
    });
    const { token, platform } = bodySchema.parse(req.body);
    console.log(`[PUSH_NATIVE] Registering device token for user ${userId}, platform: ${platform}`);
    await db.insert(deviceTokens).values({
      userId,
      platform,
      token
    }).onConflictDoUpdate({
      target: [deviceTokens.userId, deviceTokens.token],
      set: {
        lastSeen: /* @__PURE__ */ new Date(),
        platform
        // Update platform in case it changed
      }
    });
    console.log(`[PUSH_NATIVE] Device token registered successfully for user ${userId}`);
    res.json({
      success: true,
      message: "Device token registered successfully",
      platform,
      registeredAt: (/* @__PURE__ */ new Date()).toISOString()
    });
  } catch (error) {
    console.error("[PUSH_NATIVE] Error registering device token:", error);
    if (error instanceof z15.ZodError) {
      return res.status(400).json({
        success: false,
        message: "Invalid request body",
        errors: error.issues
      });
    }
    res.status(500).json({
      success: false,
      message: "Failed to register device token",
      error: error instanceof Error ? error.message : "Unknown error"
    });
  }
});
router5.post("/test", requireAuth, async (req, res) => {
  try {
    const authReq = req;
    const userId = authReq.user.id;
    const bodySchema = z15.object({
      title: z15.string().default("Test Notification"),
      body: z15.string().default("This is a test push notification from AXLE!"),
      data: z15.record(z15.any()).optional()
    });
    const { title, body, data } = bodySchema.parse(req.body);
    console.log(`[PUSH_NATIVE] Sending test notification to user ${userId}`);
    const userTokens = await db.select().from(deviceTokens).where(eq11(deviceTokens.userId, userId));
    if (userTokens.length === 0) {
      return res.status(404).json({
        success: false,
        message: "No device tokens found for user",
        hint: "Please register for push notifications first"
      });
    }
    console.log(`[PUSH_NATIVE] Found ${userTokens.length} device tokens for user ${userId}`);
    const results = [];
    const apnsConfigured = isAPNsConfigured();
    for (const deviceToken of userTokens) {
      try {
        if (deviceToken.platform === "ios" && apnsConfigured) {
          const result = await sendAPNs(deviceToken.token, { title, body, data });
          results.push({
            platform: deviceToken.platform,
            tokenPreview: deviceToken.token.substring(0, 10) + "...",
            status: result.success ? "sent" : "failed",
            error: result.error,
            apnsId: result.apnsId,
            timestamp: (/* @__PURE__ */ new Date()).toISOString()
          });
        } else if (deviceToken.platform === "web") {
          console.log(`[PUSH_NATIVE] Sending web push notification to: ${deviceToken.token.substring(0, 10)}...`);
          try {
            const webpush = await import("web-push");
            webpush.setVapidDetails(
              process.env.VAPID_SUBJECT || "mailto:admin@axle.app",
              process.env.VAPID_PUBLIC_KEY,
              process.env.VAPID_PRIVATE_KEY
            );
            const subscription = JSON.parse(deviceToken.token);
            await webpush.sendNotification(subscription, JSON.stringify({
              title,
              body,
              data,
              icon: "/icon-192x192.png"
            }));
            results.push({
              platform: deviceToken.platform,
              tokenPreview: deviceToken.token.substring(0, 10) + "...",
              status: "sent",
              timestamp: (/* @__PURE__ */ new Date()).toISOString()
            });
          } catch (webPushError) {
            console.error(`[PUSH_NATIVE] Web push error:`, webPushError);
            results.push({
              platform: deviceToken.platform,
              tokenPreview: deviceToken.token.substring(0, 10) + "...",
              status: "failed",
              error: webPushError instanceof Error ? webPushError.message : "Web push failed",
              timestamp: (/* @__PURE__ */ new Date()).toISOString()
            });
          }
        } else {
          console.log(`[PUSH_NATIVE] APNs not configured or unknown platform ${deviceToken.platform}: ${deviceToken.token.substring(0, 10)}...`);
          results.push({
            platform: deviceToken.platform,
            tokenPreview: deviceToken.token.substring(0, 10) + "...",
            status: "simulated",
            error: apnsConfigured ? "Unknown platform" : "APNs not configured",
            timestamp: (/* @__PURE__ */ new Date()).toISOString()
          });
        }
      } catch (error) {
        console.error(`[PUSH_NATIVE] Failed to send to device ${deviceToken.id}:`, error);
        results.push({
          platform: deviceToken.platform,
          tokenPreview: deviceToken.token.substring(0, 10) + "...",
          status: "failed",
          error: error instanceof Error ? error.message : "Unknown error",
          timestamp: (/* @__PURE__ */ new Date()).toISOString()
        });
      }
    }
    res.json({
      success: true,
      message: `Test notification sent to ${userTokens.length} device(s)`,
      notification: { title, body, data },
      results,
      apnsConfigured
    });
  } catch (error) {
    console.error("[PUSH_NATIVE] Error sending test notification:", error);
    if (error instanceof z15.ZodError) {
      return res.status(400).json({
        success: false,
        message: "Invalid request body",
        errors: error.issues
      });
    }
    res.status(500).json({
      success: false,
      message: "Failed to send test notification",
      error: error instanceof Error ? error.message : "Unknown error"
    });
  }
});
router5.get("/devices", requireAuth, async (req, res) => {
  try {
    const authReq = req;
    const userId = authReq.user.id;
    const devices = await db.select({
      id: deviceTokens.id,
      platform: deviceTokens.platform,
      tokenPreview: deviceTokens.token,
      // Will be truncated in response
      createdAt: deviceTokens.createdAt,
      lastSeen: deviceTokens.lastSeen
    }).from(deviceTokens).where(eq11(deviceTokens.userId, userId)).orderBy(deviceTokens.lastSeen);
    const safeDevices = devices.map((device) => ({
      ...device,
      tokenPreview: device.tokenPreview.substring(0, 10) + "..."
    }));
    res.json({
      success: true,
      devices: safeDevices,
      count: devices.length
    });
  } catch (error) {
    console.error("[PUSH_NATIVE] Error listing devices:", error);
    res.status(500).json({
      success: false,
      message: "Failed to list devices",
      error: error instanceof Error ? error.message : "Unknown error"
    });
  }
});
router5.post("/unregister-device", requireAuth, async (req, res) => {
  try {
    const authReq = req;
    const userId = authReq.user.id;
    const bodySchema = z15.object({
      token: z15.string().min(1)
    });
    const { token } = bodySchema.parse(req.body);
    console.log(`[PUSH_NATIVE] Unregistering device token for user ${userId}`);
    const result = await db.delete(deviceTokens).where(
      and11(
        eq11(deviceTokens.userId, userId),
        eq11(deviceTokens.token, token)
      )
    );
    if (result.rowCount === 0) {
      return res.status(404).json({
        success: false,
        message: "Device token not found"
      });
    }
    console.log(`[PUSH_NATIVE] Device token unregistered successfully for user ${userId}`);
    res.json({
      success: true,
      message: "Device token unregistered successfully"
    });
  } catch (error) {
    console.error("[PUSH_NATIVE] Error unregistering device token:", error);
    if (error instanceof z15.ZodError) {
      return res.status(400).json({
        success: false,
        message: "Invalid request body",
        errors: error.issues
      });
    }
    res.status(500).json({
      success: false,
      message: "Failed to unregister device token",
      error: error instanceof Error ? error.message : "Unknown error"
    });
  }
});
router5.delete("/devices/:deviceId", requireAuth, async (req, res) => {
  try {
    const authReq = req;
    const userId = authReq.user.id;
    const { deviceId } = req.params;
    const result = await db.delete(deviceTokens).where(
      and11(
        eq11(deviceTokens.id, deviceId),
        eq11(deviceTokens.userId, userId)
      )
    );
    if (result.rowCount === 0) {
      return res.status(404).json({
        success: false,
        message: "Device not found or not owned by user"
      });
    }
    console.log(`[PUSH_NATIVE] Removed device token ${deviceId} for user ${userId}`);
    res.json({
      success: true,
      message: "Device token removed successfully"
    });
  } catch (error) {
    console.error("[PUSH_NATIVE] Error removing device:", error);
    res.status(500).json({
      success: false,
      message: "Failed to remove device",
      error: error instanceof Error ? error.message : "Unknown error"
    });
  }
});
router5.get("/debug/devices", requireAuth, async (req, res) => {
  try {
    if (process.env.NODE_ENV === "production") {
      return res.status(403).json({
        success: false,
        message: "Debug endpoints are not available in production"
      });
    }
    const authReq = req;
    const userId = authReq.user.id;
    console.log(`[PUSH_NATIVE] Debug: listing device tokens for user ${userId}`);
    const devices = await db.select({
      id: deviceTokens.id,
      platform: deviceTokens.platform,
      token: deviceTokens.token,
      createdAt: deviceTokens.createdAt,
      lastSeen: deviceTokens.lastSeen
    }).from(deviceTokens).where(eq11(deviceTokens.userId, userId)).orderBy(deviceTokens.lastSeen);
    console.log(`[PUSH_NATIVE] Debug: found ${devices.length} device tokens for user ${userId}`);
    const debugDevices = devices.map((device) => ({
      id: device.id,
      platform: device.platform,
      tokenPreview: device.token.substring(0, 10) + "...",
      tokenLength: device.token.length,
      createdAt: device.createdAt,
      lastSeen: device.lastSeen
    }));
    res.json({
      success: true,
      userId,
      deviceCount: devices.length,
      devices: debugDevices,
      environment: process.env.NODE_ENV || "development",
      apnsHost: process.env.NODE_ENV === "production" ? "https://api.push.apple.com" : "https://api.sandbox.push.apple.com",
      warning: "This debug endpoint is only available in development environments"
    });
  } catch (error) {
    console.error("[PUSH_NATIVE] Error in debug devices route:", error);
    res.status(500).json({
      success: false,
      message: "Failed to list debug devices",
      error: error instanceof Error ? error.message : "Unknown error"
    });
  }
});
var push_native_default = router5;

// server/routes/push.ts
import { Router as Router7 } from "express";
init_db();
init_schema();
import { eq as eq12, and as and12 } from "drizzle-orm";
import { z as z16 } from "zod";
var pushRouter = Router7();
pushRouter.post("/subscribe", requireAuth, async (req, res) => {
  try {
    const authReq = req;
    const userId = authReq.user.id;
    const bodySchema = z16.object({
      endpoint: z16.string().url(),
      p256dh: z16.string().min(1),
      auth: z16.string().min(1)
    });
    const { endpoint, p256dh, auth } = bodySchema.parse(req.body);
    console.log(`[PUSH_WEB] Subscribing to web push for user ${userId}`);
    await db.insert(pushSubscriptions).values({
      userId,
      endpoint,
      p256dh,
      auth
    }).onConflictDoUpdate({
      target: [pushSubscriptions.userId, pushSubscriptions.endpoint],
      set: {
        p256dh,
        auth,
        lastUsed: /* @__PURE__ */ new Date()
      }
    });
    console.log(`[PUSH_WEB] Web push subscription registered successfully for user ${userId}`);
    res.json({
      success: true,
      message: "Web push subscription registered successfully"
    });
  } catch (error) {
    console.error("[PUSH_WEB] Error subscribing to web push:", error);
    if (error instanceof z16.ZodError) {
      return res.status(400).json({
        success: false,
        message: "Invalid request body",
        errors: error.issues
      });
    }
    res.status(500).json({
      success: false,
      message: "Failed to subscribe to web push",
      error: error instanceof Error ? error.message : "Unknown error"
    });
  }
});
pushRouter.post("/unsubscribe", requireAuth, async (req, res) => {
  try {
    const authReq = req;
    const userId = authReq.user.id;
    const bodySchema = z16.object({
      endpoint: z16.string().url()
    });
    const { endpoint } = bodySchema.parse(req.body);
    console.log(`[PUSH_WEB] Unsubscribing from web push for user ${userId}`);
    const result = await db.delete(pushSubscriptions).where(
      and12(
        eq12(pushSubscriptions.userId, userId),
        eq12(pushSubscriptions.endpoint, endpoint)
      )
    );
    if (result.rowCount === 0) {
      return res.status(404).json({
        success: false,
        message: "Subscription not found"
      });
    }
    console.log(`[PUSH_WEB] Web push unsubscribed successfully for user ${userId}`);
    res.json({
      success: true,
      message: "Web push unsubscribed successfully"
    });
  } catch (error) {
    console.error("[PUSH_WEB] Error unsubscribing from web push:", error);
    if (error instanceof z16.ZodError) {
      return res.status(400).json({
        success: false,
        message: "Invalid request body",
        errors: error.issues
      });
    }
    res.status(500).json({
      success: false,
      message: "Failed to unsubscribe from web push",
      error: error instanceof Error ? error.message : "Unknown error"
    });
  }
});
pushRouter.get("/subscriptions", requireAuth, async (req, res) => {
  try {
    const authReq = req;
    const userId = authReq.user.id;
    const subscriptions = await db.select({
      id: pushSubscriptions.id,
      endpointPreview: pushSubscriptions.endpoint,
      // Will be truncated in response
      createdAt: pushSubscriptions.createdAt,
      lastUsed: pushSubscriptions.lastUsed
    }).from(pushSubscriptions).where(eq12(pushSubscriptions.userId, userId)).orderBy(pushSubscriptions.lastUsed);
    const safeSubscriptions = subscriptions.map((sub) => ({
      ...sub,
      endpointPreview: sub.endpointPreview.substring(0, 50) + "..."
    }));
    res.json({
      success: true,
      subscriptions: safeSubscriptions,
      count: subscriptions.length
    });
  } catch (error) {
    console.error("[PUSH_WEB] Error listing subscriptions:", error);
    res.status(500).json({
      success: false,
      message: "Failed to list subscriptions",
      error: error instanceof Error ? error.message : "Unknown error"
    });
  }
});
var push_default = pushRouter;

// server/routes/notification-prefs.ts
import { Router as Router8 } from "express";
import { z as z17 } from "zod";
init_db();
init_schema();
import { eq as eq13 } from "drizzle-orm";
var router6 = Router8();
router6.post("/", requireAuth, async (req, res) => {
  try {
    const authReq = req;
    const userId = authReq.user.id;
    const bodySchema = insertNotificationPrefsSchema.extend({
      platform: z17.enum(["auto", "native", "web"]).default("auto")
    });
    const prefs = bodySchema.parse(req.body);
    console.log(`[NOTIFICATION_PREFS] Saving preferences for user ${userId}:`, prefs);
    await db.insert(notificationPrefs).values({
      userId,
      enabled: prefs.enabled,
      dailyReminders: prefs.dailyReminders,
      reminderTime: prefs.reminderTime,
      platform: prefs.platform
    }).onConflictDoUpdate({
      target: [notificationPrefs.userId],
      set: {
        enabled: prefs.enabled,
        dailyReminders: prefs.dailyReminders,
        reminderTime: prefs.reminderTime,
        platform: prefs.platform,
        updatedAt: /* @__PURE__ */ new Date()
      }
    });
    console.log(`[NOTIFICATION_PREFS] Preferences saved successfully for user ${userId}`);
    res.json({
      success: true,
      message: "Notification preferences saved successfully",
      preferences: prefs
    });
  } catch (error) {
    console.error("[NOTIFICATION_PREFS] Error saving preferences:", error);
    if (error instanceof z17.ZodError) {
      return res.status(400).json({
        success: false,
        message: "Invalid request body",
        errors: error.issues
      });
    }
    res.status(500).json({
      success: false,
      message: "Failed to save notification preferences",
      error: error instanceof Error ? error.message : "Unknown error"
    });
  }
});
router6.get("/", requireAuth, async (req, res) => {
  try {
    const authReq = req;
    const userId = authReq.user.id;
    const preferences = await db.select().from(notificationPrefs).where(eq13(notificationPrefs.userId, userId)).limit(1);
    const userPrefs = preferences[0] || {
      enabled: false,
      dailyReminders: false,
      reminderTime: "09:00",
      platform: "auto"
    };
    res.json({
      success: true,
      preferences: userPrefs
    });
  } catch (error) {
    console.error("[NOTIFICATION_PREFS] Error getting preferences:", error);
    res.status(500).json({
      success: false,
      message: "Failed to get notification preferences",
      error: error instanceof Error ? error.message : "Unknown error"
    });
  }
});
var notification_prefs_default = router6;

// server/routes/notifications-topics.ts
import { Router as Router9 } from "express";
init_db();
init_schema();
import { eq as eq14 } from "drizzle-orm";
var r2 = Router9();
r2.post("/api/notifications/topics/enable", requireAuth, async (req, res) => {
  const { topic, enabled } = req.body ?? {};
  if (!topic || typeof enabled !== "boolean") {
    return res.status(400).json({ error: "bad_request" });
  }
  try {
    const authReq = req;
    const userId = authReq.user.id;
    await db.insert(notificationTopics).values({
      userId,
      topic,
      enabled,
      updatedAt: /* @__PURE__ */ new Date()
    }).onConflictDoUpdate({
      target: [notificationTopics.userId, notificationTopics.topic],
      set: {
        enabled,
        updatedAt: /* @__PURE__ */ new Date()
      }
    });
    res.json({ ok: true });
  } catch (error) {
    console.error("Error updating notification topic:", error);
    res.status(500).json({ error: "Failed to update topic preference" });
  }
});
r2.get("/api/notifications/topics", requireAuth, async (req, res) => {
  try {
    const authReq = req;
    const userId = authReq.user.id;
    const topics = await db.select().from(notificationTopics).where(eq14(notificationTopics.userId, userId));
    res.json({ topics: topics ?? [] });
  } catch (error) {
    console.error("Error fetching notification topics:", error);
    res.status(500).json({ error: "Failed to fetch topics" });
  }
});
var notifications_topics_default = r2;

// server/routes/cron-weekly.ts
init_db();
init_schema();
import { Router as Router10 } from "express";
import { eq as eq16, and as and15 } from "drizzle-orm";

// server/services/weeklyReport.ts
init_db();
init_schema();
import { eq as eq15, gte as gte8, and as and14 } from "drizzle-orm";

// node_modules/resend/dist/index.mjs
var __defProp2 = Object.defineProperty;
var __defProps = Object.defineProperties;
var __getOwnPropDescs = Object.getOwnPropertyDescriptors;
var __getOwnPropSymbols = Object.getOwnPropertySymbols;
var __hasOwnProp2 = Object.prototype.hasOwnProperty;
var __propIsEnum = Object.prototype.propertyIsEnumerable;
var __defNormalProp = (obj, key, value) => key in obj ? __defProp2(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;
var __spreadValues = (a2, b) => {
  for (var prop in b || (b = {}))
    if (__hasOwnProp2.call(b, prop))
      __defNormalProp(a2, prop, b[prop]);
  if (__getOwnPropSymbols)
    for (var prop of __getOwnPropSymbols(b)) {
      if (__propIsEnum.call(b, prop))
        __defNormalProp(a2, prop, b[prop]);
    }
  return a2;
};
var __spreadProps = (a2, b) => __defProps(a2, __getOwnPropDescs(b));
var __objRest = (source, exclude) => {
  var target = {};
  for (var prop in source)
    if (__hasOwnProp2.call(source, prop) && exclude.indexOf(prop) < 0)
      target[prop] = source[prop];
  if (source != null && __getOwnPropSymbols)
    for (var prop of __getOwnPropSymbols(source)) {
      if (exclude.indexOf(prop) < 0 && __propIsEnum.call(source, prop))
        target[prop] = source[prop];
    }
  return target;
};
var __async = (__this, __arguments, generator) => {
  return new Promise((resolve, reject) => {
    var fulfilled = (value) => {
      try {
        step(generator.next(value));
      } catch (e2) {
        reject(e2);
      }
    };
    var rejected = (value) => {
      try {
        step(generator.throw(value));
      } catch (e2) {
        reject(e2);
      }
    };
    var step = (x) => x.done ? resolve(x.value) : Promise.resolve(x.value).then(fulfilled, rejected);
    step((generator = generator.apply(__this, __arguments)).next());
  });
};
var version = "6.1.2";
function buildPaginationQuery(options) {
  const searchParams = new URLSearchParams();
  if (options.limit !== void 0) {
    searchParams.set("limit", options.limit.toString());
  }
  if ("after" in options && options.after !== void 0) {
    searchParams.set("after", options.after);
  }
  if ("before" in options && options.before !== void 0) {
    searchParams.set("before", options.before);
  }
  return searchParams.toString();
}
var ApiKeys = class {
  constructor(resend2) {
    this.resend = resend2;
  }
  create(_0) {
    return __async(this, arguments, function* (payload, options = {}) {
      const data = yield this.resend.post(
        "/api-keys",
        payload,
        options
      );
      return data;
    });
  }
  list() {
    return __async(this, arguments, function* (options = {}) {
      const queryString = buildPaginationQuery(options);
      const url = queryString ? `/api-keys?${queryString}` : "/api-keys";
      const data = yield this.resend.get(url);
      return data;
    });
  }
  remove(id) {
    return __async(this, null, function* () {
      const data = yield this.resend.delete(
        `/api-keys/${id}`
      );
      return data;
    });
  }
};
var Audiences = class {
  constructor(resend2) {
    this.resend = resend2;
  }
  create(_0) {
    return __async(this, arguments, function* (payload, options = {}) {
      const data = yield this.resend.post(
        "/audiences",
        payload,
        options
      );
      return data;
    });
  }
  list() {
    return __async(this, arguments, function* (options = {}) {
      const queryString = buildPaginationQuery(options);
      const url = queryString ? `/audiences?${queryString}` : "/audiences";
      const data = yield this.resend.get(url);
      return data;
    });
  }
  get(id) {
    return __async(this, null, function* () {
      const data = yield this.resend.get(
        `/audiences/${id}`
      );
      return data;
    });
  }
  remove(id) {
    return __async(this, null, function* () {
      const data = yield this.resend.delete(
        `/audiences/${id}`
      );
      return data;
    });
  }
};
function parseAttachments(attachments) {
  return attachments == null ? void 0 : attachments.map((attachment) => ({
    content: attachment.content,
    filename: attachment.filename,
    path: attachment.path,
    content_type: attachment.contentType,
    content_id: attachment.contentId
  }));
}
function parseEmailToApiOptions(email) {
  return {
    attachments: parseAttachments(email.attachments),
    bcc: email.bcc,
    cc: email.cc,
    from: email.from,
    headers: email.headers,
    html: email.html,
    reply_to: email.replyTo,
    scheduled_at: email.scheduledAt,
    subject: email.subject,
    tags: email.tags,
    text: email.text,
    to: email.to
  };
}
function render2(node) {
  return new Promise((resolve, reject) => {
    import("@react-email/render").then(({ render: render22 }) => {
      resolve(render22(node));
    }).catch(() => {
      reject(
        Error(
          "Failed to render React component. Make sure to install `@react-email/render` or `@react-email/components`."
        )
      );
    });
  });
}
var Batch = class {
  constructor(resend2) {
    this.resend = resend2;
  }
  send(payload, options) {
    return __async(this, null, function* () {
      return this.create(payload, options);
    });
  }
  create(payload, options) {
    return __async(this, null, function* () {
      var _a;
      const emails = [];
      for (const email of payload) {
        if (email.react) {
          email.html = yield render2(email.react);
          email.react = void 0;
        }
        emails.push(parseEmailToApiOptions(email));
      }
      const data = yield this.resend.post(
        "/emails/batch",
        emails,
        __spreadProps(__spreadValues({}, options), {
          headers: __spreadValues({
            "x-batch-validation": (_a = options == null ? void 0 : options.batchValidation) != null ? _a : "strict"
          }, options == null ? void 0 : options.headers)
        })
      );
      return data;
    });
  }
};
var Broadcasts = class {
  constructor(resend2) {
    this.resend = resend2;
  }
  create(_0) {
    return __async(this, arguments, function* (payload, options = {}) {
      if (payload.react) {
        payload.html = yield render2(payload.react);
      }
      const data = yield this.resend.post(
        "/broadcasts",
        {
          name: payload.name,
          audience_id: payload.audienceId,
          preview_text: payload.previewText,
          from: payload.from,
          html: payload.html,
          reply_to: payload.replyTo,
          subject: payload.subject,
          text: payload.text
        },
        options
      );
      return data;
    });
  }
  send(id, payload) {
    return __async(this, null, function* () {
      const data = yield this.resend.post(
        `/broadcasts/${id}/send`,
        { scheduled_at: payload == null ? void 0 : payload.scheduledAt }
      );
      return data;
    });
  }
  list() {
    return __async(this, arguments, function* (options = {}) {
      const queryString = buildPaginationQuery(options);
      const url = queryString ? `/broadcasts?${queryString}` : "/broadcasts";
      const data = yield this.resend.get(url);
      return data;
    });
  }
  get(id) {
    return __async(this, null, function* () {
      const data = yield this.resend.get(
        `/broadcasts/${id}`
      );
      return data;
    });
  }
  remove(id) {
    return __async(this, null, function* () {
      const data = yield this.resend.delete(
        `/broadcasts/${id}`
      );
      return data;
    });
  }
  update(id, payload) {
    return __async(this, null, function* () {
      if (payload.react) {
        payload.html = yield render2(payload.react);
      }
      const data = yield this.resend.patch(
        `/broadcasts/${id}`,
        {
          name: payload.name,
          audience_id: payload.audienceId,
          from: payload.from,
          html: payload.html,
          text: payload.text,
          subject: payload.subject,
          reply_to: payload.replyTo,
          preview_text: payload.previewText
        }
      );
      return data;
    });
  }
};
var Contacts = class {
  constructor(resend2) {
    this.resend = resend2;
  }
  create(_0) {
    return __async(this, arguments, function* (payload, options = {}) {
      const data = yield this.resend.post(
        `/audiences/${payload.audienceId}/contacts`,
        {
          unsubscribed: payload.unsubscribed,
          email: payload.email,
          first_name: payload.firstName,
          last_name: payload.lastName
        },
        options
      );
      return data;
    });
  }
  list(options) {
    return __async(this, null, function* () {
      const _a = options, { audienceId } = _a, paginationOptions = __objRest(_a, ["audienceId"]);
      const queryString = buildPaginationQuery(paginationOptions);
      const url = queryString ? `/audiences/${audienceId}/contacts?${queryString}` : `/audiences/${audienceId}/contacts`;
      const data = yield this.resend.get(url);
      return data;
    });
  }
  get(options) {
    return __async(this, null, function* () {
      if (!options.id && !options.email) {
        return {
          data: null,
          error: {
            message: "Missing `id` or `email` field.",
            name: "missing_required_field"
          }
        };
      }
      const data = yield this.resend.get(
        `/audiences/${options.audienceId}/contacts/${(options == null ? void 0 : options.email) ? options == null ? void 0 : options.email : options == null ? void 0 : options.id}`
      );
      return data;
    });
  }
  update(options) {
    return __async(this, null, function* () {
      if (!options.id && !options.email) {
        return {
          data: null,
          error: {
            message: "Missing `id` or `email` field.",
            name: "missing_required_field"
          }
        };
      }
      const data = yield this.resend.patch(
        `/audiences/${options.audienceId}/contacts/${(options == null ? void 0 : options.email) ? options == null ? void 0 : options.email : options == null ? void 0 : options.id}`,
        {
          unsubscribed: options.unsubscribed,
          first_name: options.firstName,
          last_name: options.lastName
        }
      );
      return data;
    });
  }
  remove(payload) {
    return __async(this, null, function* () {
      if (!payload.id && !payload.email) {
        return {
          data: null,
          error: {
            message: "Missing `id` or `email` field.",
            name: "missing_required_field"
          }
        };
      }
      const data = yield this.resend.delete(
        `/audiences/${payload.audienceId}/contacts/${(payload == null ? void 0 : payload.email) ? payload == null ? void 0 : payload.email : payload == null ? void 0 : payload.id}`
      );
      return data;
    });
  }
};
function parseDomainToApiOptions(domain) {
  return {
    name: domain.name,
    region: domain.region,
    custom_return_path: domain.customReturnPath
  };
}
var Domains = class {
  constructor(resend2) {
    this.resend = resend2;
  }
  create(_0) {
    return __async(this, arguments, function* (payload, options = {}) {
      const data = yield this.resend.post(
        "/domains",
        parseDomainToApiOptions(payload),
        options
      );
      return data;
    });
  }
  list() {
    return __async(this, arguments, function* (options = {}) {
      const queryString = buildPaginationQuery(options);
      const url = queryString ? `/domains?${queryString}` : "/domains";
      const data = yield this.resend.get(url);
      return data;
    });
  }
  get(id) {
    return __async(this, null, function* () {
      const data = yield this.resend.get(
        `/domains/${id}`
      );
      return data;
    });
  }
  update(payload) {
    return __async(this, null, function* () {
      const data = yield this.resend.patch(
        `/domains/${payload.id}`,
        {
          click_tracking: payload.clickTracking,
          open_tracking: payload.openTracking,
          tls: payload.tls
        }
      );
      return data;
    });
  }
  remove(id) {
    return __async(this, null, function* () {
      const data = yield this.resend.delete(
        `/domains/${id}`
      );
      return data;
    });
  }
  verify(id) {
    return __async(this, null, function* () {
      const data = yield this.resend.post(
        `/domains/${id}/verify`
      );
      return data;
    });
  }
};
var Emails = class {
  constructor(resend2) {
    this.resend = resend2;
  }
  send(_0) {
    return __async(this, arguments, function* (payload, options = {}) {
      return this.create(payload, options);
    });
  }
  create(_0) {
    return __async(this, arguments, function* (payload, options = {}) {
      if (payload.react) {
        payload.html = yield render2(payload.react);
      }
      const data = yield this.resend.post(
        "/emails",
        parseEmailToApiOptions(payload),
        options
      );
      return data;
    });
  }
  get(id) {
    return __async(this, null, function* () {
      const data = yield this.resend.get(
        `/emails/${id}`
      );
      return data;
    });
  }
  list() {
    return __async(this, arguments, function* (options = {}) {
      const queryString = buildPaginationQuery(options);
      const url = queryString ? `/emails?${queryString}` : "/emails";
      const data = yield this.resend.get(url);
      return data;
    });
  }
  update(payload) {
    return __async(this, null, function* () {
      const data = yield this.resend.patch(
        `/emails/${payload.id}`,
        {
          scheduled_at: payload.scheduledAt
        }
      );
      return data;
    });
  }
  cancel(id) {
    return __async(this, null, function* () {
      const data = yield this.resend.post(
        `/emails/${id}/cancel`
      );
      return data;
    });
  }
};
var defaultBaseUrl = "https://api.resend.com";
var defaultUserAgent = `resend-node:${version}`;
var baseUrl = typeof process !== "undefined" && process.env ? process.env.RESEND_BASE_URL || defaultBaseUrl : defaultBaseUrl;
var userAgent = typeof process !== "undefined" && process.env ? process.env.RESEND_USER_AGENT || defaultUserAgent : defaultUserAgent;
var Resend = class {
  constructor(key) {
    this.key = key;
    this.apiKeys = new ApiKeys(this);
    this.audiences = new Audiences(this);
    this.batch = new Batch(this);
    this.broadcasts = new Broadcasts(this);
    this.contacts = new Contacts(this);
    this.domains = new Domains(this);
    this.emails = new Emails(this);
    if (!key) {
      if (typeof process !== "undefined" && process.env) {
        this.key = process.env.RESEND_API_KEY;
      }
      if (!this.key) {
        throw new Error(
          'Missing API key. Pass it to the constructor `new Resend("re_123")`'
        );
      }
    }
    this.headers = new Headers({
      Authorization: `Bearer ${this.key}`,
      "User-Agent": userAgent,
      "Content-Type": "application/json"
    });
  }
  fetchRequest(_0) {
    return __async(this, arguments, function* (path, options = {}) {
      try {
        const response = yield fetch(`${baseUrl}${path}`, options);
        if (!response.ok) {
          try {
            const rawError = yield response.text();
            return { data: null, error: JSON.parse(rawError) };
          } catch (err) {
            if (err instanceof SyntaxError) {
              return {
                data: null,
                error: {
                  name: "application_error",
                  message: "Internal server error. We are unable to process your request right now, please try again later."
                }
              };
            }
            const error = {
              message: response.statusText,
              name: "application_error"
            };
            if (err instanceof Error) {
              return { data: null, error: __spreadProps(__spreadValues({}, error), { message: err.message }) };
            }
            return { data: null, error };
          }
        }
        const data = yield response.json();
        return { data, error: null };
      } catch (e2) {
        return {
          data: null,
          error: {
            name: "application_error",
            message: "Unable to fetch data. The request could not be resolved."
          }
        };
      }
    });
  }
  post(_0, _1) {
    return __async(this, arguments, function* (path, entity, options = {}) {
      const headers = new Headers(this.headers);
      if (options.headers) {
        for (const [key, value] of new Headers(options.headers).entries()) {
          headers.set(key, value);
        }
      }
      if (options.idempotencyKey) {
        headers.set("Idempotency-Key", options.idempotencyKey);
      }
      const requestOptions = __spreadProps(__spreadValues({
        method: "POST",
        body: JSON.stringify(entity)
      }, options), {
        headers
      });
      return this.fetchRequest(path, requestOptions);
    });
  }
  get(_0) {
    return __async(this, arguments, function* (path, options = {}) {
      const headers = new Headers(this.headers);
      if (options.headers) {
        for (const [key, value] of new Headers(options.headers).entries()) {
          headers.set(key, value);
        }
      }
      const requestOptions = __spreadProps(__spreadValues({
        method: "GET"
      }, options), {
        headers
      });
      return this.fetchRequest(path, requestOptions);
    });
  }
  put(_0, _1) {
    return __async(this, arguments, function* (path, entity, options = {}) {
      const headers = new Headers(this.headers);
      if (options.headers) {
        for (const [key, value] of new Headers(options.headers).entries()) {
          headers.set(key, value);
        }
      }
      const requestOptions = __spreadProps(__spreadValues({
        method: "PUT",
        body: JSON.stringify(entity)
      }, options), {
        headers
      });
      return this.fetchRequest(path, requestOptions);
    });
  }
  patch(_0, _1) {
    return __async(this, arguments, function* (path, entity, options = {}) {
      const headers = new Headers(this.headers);
      if (options.headers) {
        for (const [key, value] of new Headers(options.headers).entries()) {
          headers.set(key, value);
        }
      }
      const requestOptions = __spreadProps(__spreadValues({
        method: "PATCH",
        body: JSON.stringify(entity)
      }, options), {
        headers
      });
      return this.fetchRequest(path, requestOptions);
    });
  }
  delete(path, query) {
    return __async(this, null, function* () {
      const requestOptions = {
        method: "DELETE",
        body: JSON.stringify(query),
        headers: this.headers
      };
      return this.fetchRequest(path, requestOptions);
    });
  }
};

// server/services/email.ts
var resend = new Resend(process.env.RESEND_API_KEY);
async function sendEmail(to, subject, html) {
  if (!process.env.RESEND_API_KEY) {
    throw new Error("RESEND_API_KEY missing");
  }
  const result = await resend.emails.send({
    from: "AXLE <no-reply@axle.app>",
    to,
    subject,
    html
  });
  return result;
}

// server/services/weeklyReport.ts
async function buildWeeklyReportHtml(userId) {
  const sevenDaysAgo = new Date(Date.now() - 7 * 24 * 60 * 60 * 1e3);
  const dateString = sevenDaysAgo.toISOString().slice(0, 10);
  const reports = await db.select().from(healthReports).where(
    and14(
      eq15(healthReports.userId, userId),
      gte8(healthReports.date, dateString)
    )
  ).orderBy(healthReports.date);
  const pts = reports ?? [];
  const avg = (k) => {
    const arr = pts.map((p2) => p2.metrics?.axle?.[k] ?? null).filter((v) => v != null);
    if (arr.length === 0) return null;
    return Math.round(arr.reduce((a2, b) => a2 + b, 0) / arr.length);
  };
  const axle = avg("axle_health_score");
  const vit = avg("vitality_score");
  const perf = avg("performance_potential");
  const circ = avg("circadian_alignment");
  const ener = avg("energy_systems_balance");
  return `
  <div style="font-family:Inter,Arial,sans-serif;max-width:560px;margin:16px auto;padding:16px;border:1px solid #eee;border-radius:12px">
    <h2 style="margin:0 0 12px">Your AXLE Weekly Report</h2>
    <p style="color:#444">Here's your average for the past 7 days:</p>
    <ul style="line-height:1.8;color:#222">
      <li><b>AXLE Health Score:</b> ${axle ?? "--"}</li>
      <li><b>Vitality:</b> ${vit ?? "--"} &middot; <b>Performance:</b> ${perf ?? "--"}</li>
      <li><b>Circadian Alignment:</b> ${circ ?? "--"} &middot; <b>Energy Systems:</b> ${ener ?? "--"}</li>
    </ul>
    <p style="color:#666">Tip: If Performance is high but Energy Systems is low, mix in an under-trained zone this week.</p>
  </div>`;
}
async function sendWeeklyReport(userId, email) {
  const html = await buildWeeklyReportHtml(userId);
  await sendEmail(email, "Your AXLE Weekly Report", html);
}

// server/routes/cron-weekly.ts
var r3 = Router10();
r3.post("/api/cron/weekly-reports-run", requireAuth, async (req, res) => {
  const authReq = req;
  const adminEmails = (process.env.ADMIN_EMAILS || "").split(",").map((email) => email.trim());
  if (!adminEmails.includes(authReq.user.email || "")) {
    return res.status(403).json({
      success: false,
      error: "Admin access required for cron operations",
      timestamp: (/* @__PURE__ */ new Date()).toISOString()
    });
  }
  try {
    console.log("[CRON] Starting weekly reports job");
    const { supabaseAdmin: supabaseAdmin2 } = await Promise.resolve().then(() => (init_supabaseAdmin(), supabaseAdmin_exports));
    const { data: authData, error: authError } = await supabaseAdmin2.auth.admin.listUsers({
      page: 1,
      perPage: 1e3
      // Adjust as needed for your user base
    });
    if (authError) {
      throw new Error(`Failed to fetch users: ${authError.message}`);
    }
    const users2 = authData?.users ?? [];
    let sent = 0;
    for (const user of users2) {
      const userId = user.id;
      const email = user.email;
      if (!email) continue;
      try {
        const topicPrefs = await db.select().from(notificationTopics).where(
          and15(
            eq16(notificationTopics.userId, userId),
            eq16(notificationTopics.topic, "weekly-report")
          )
        );
        if (topicPrefs.length > 0 && !topicPrefs[0].enabled) {
          console.log(`[CRON] Skipping user ${userId} - weekly reports disabled`);
          continue;
        }
        console.log(`[CRON] Sending weekly report to user ${userId} (${email})`);
        await sendWeeklyReport(userId, email);
        sent++;
      } catch (error) {
        console.error(`[CRON] Failed to send weekly report to user ${userId}:`, error);
      }
    }
    console.log(`[CRON] Weekly reports job completed. Sent: ${sent} emails`);
    res.json({
      success: true,
      sent,
      total: users2.length,
      timestamp: (/* @__PURE__ */ new Date()).toISOString()
    });
  } catch (error) {
    console.error("[CRON] Weekly reports job failed:", error);
    res.status(500).json({
      success: false,
      error: error instanceof Error ? error.message : "Unknown error",
      timestamp: (/* @__PURE__ */ new Date()).toISOString()
    });
  }
});
var cron_weekly_default = r3;

// server/routes/storage.ts
import { Router as Router11 } from "express";
init_supabaseAdmin();
var router7 = Router11();
var isUuid = (v) => /^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(v);
router7.post("/group-photos/signed-upload", requireAuth2, async (req, res) => {
  try {
    const authReq = req;
    const { groupId, filename } = req.body ?? {};
    if (!groupId) return res.status(400).json({ error: "groupId required" });
    if (!isUuid(groupId)) return res.status(400).json({ error: "Invalid group id" });
    const supabase = supabaseFromReq(req);
    const { data: membership, error: memberError } = await supabase.from("group_memberships").select("id").eq("group_id", groupId).eq("user_id", authReq.user.id).single();
    if (memberError || !membership) {
      return res.status(403).json({ error: "Access denied: not a group member" });
    }
    const ext = String(filename || "jpg").split(".").pop()?.toLowerCase() || "jpg";
    const path = `${groupId}/${crypto.randomUUID()}.${ext}`;
    const { data, error } = await supabaseAdmin.storage.from("group-photos").createSignedUploadUrl(path);
    if (error) return res.status(400).json({ error: error.message });
    res.json({ path, token: data.token, signedUrl: data.signedUrl });
  } catch (error) {
    console.error("Storage signed upload error:", error);
    res.status(500).json({ error: "Internal server error" });
  }
});
router7.post("/profile-photos/signed-upload", requireAuth2, async (req, res) => {
  try {
    const authReq = req;
    const { filename } = req.body ?? {};
    const ext = String(filename || "jpg").split(".").pop()?.toLowerCase() || "jpg";
    const path = `${authReq.user.id}/${crypto.randomUUID()}.${ext}`;
    const { data, error } = await supabaseAdmin.storage.from("profile-photos").createSignedUploadUrl(path);
    if (error) return res.status(400).json({ error: error.message });
    res.json({ path, token: data.token, signedUrl: data.signedUrl });
  } catch (error) {
    console.error("Profile photo signed upload error:", error);
    res.status(500).json({ error: "Internal server error" });
  }
});
var storage_default = router7;

// server/routes/healthz.ts
init_db();
import { Router as Router12 } from "express";
import os from "node:os";
var router8 = Router12();
router8.get("/", async (_req, res) => {
  const checkEnvVar = (name) => {
    return process.env[name] ? "configured" : "missing";
  };
  const criticalVars = {
    SUPABASE_URL: checkEnvVar("SUPABASE_URL"),
    SUPABASE_SERVICE_ROLE_KEY: checkEnvVar("SUPABASE_SERVICE_ROLE_KEY"),
    DATABASE_URL: checkEnvVar("DATABASE_URL")
  };
  const requiredVars = {
    VITE_SUPABASE_URL: checkEnvVar("VITE_SUPABASE_URL"),
    VITE_SUPABASE_ANON_KEY: checkEnvVar("VITE_SUPABASE_ANON_KEY"),
    SUPABASE_ANON_KEY: checkEnvVar("SUPABASE_ANON_KEY")
  };
  const importantVars = {
    OPENAI_API_KEY: checkEnvVar("OPENAI_API_KEY")
  };
  const optionalVars = {
    // Email & Error Tracking
    RESEND_API_KEY: checkEnvVar("RESEND_API_KEY"),
    SENTRY_DSN_SERVER: checkEnvVar("SENTRY_DSN_SERVER"),
    SENTRY_ENV: checkEnvVar("SENTRY_ENV"),
    // Alternative AI Providers
    AZURE_OPENAI_API_KEY: checkEnvVar("AZURE_OPENAI_API_KEY"),
    MODEL_API_KEY: checkEnvVar("MODEL_API_KEY"),
    // Health Providers (require BOTH ID and SECRET)
    OURA_CLIENT_ID: checkEnvVar("OURA_CLIENT_ID"),
    OURA_CLIENT_SECRET: checkEnvVar("OURA_CLIENT_SECRET"),
    FITBIT_CLIENT_ID: checkEnvVar("FITBIT_CLIENT_ID"),
    FITBIT_CLIENT_SECRET: checkEnvVar("FITBIT_CLIENT_SECRET"),
    GARMIN_CLIENT_ID: checkEnvVar("GARMIN_CLIENT_ID"),
    GARMIN_CLIENT_SECRET: checkEnvVar("GARMIN_CLIENT_SECRET"),
    GARMIN_REDIRECT_URL: checkEnvVar("GARMIN_REDIRECT_URL"),
    WHOOP_CLIENT_ID: checkEnvVar("WHOOP_CLIENT_ID"),
    WHOOP_CLIENT_SECRET: checkEnvVar("WHOOP_CLIENT_SECRET"),
    // Site Configuration
    VITE_SITE_URL: checkEnvVar("VITE_SITE_URL"),
    SITE_URL: checkEnvVar("SITE_URL"),
    // Admin
    ADMIN_EMAILS: checkEnvVar("ADMIN_EMAILS")
  };
  const featureFlags2 = {
    HOBH_FORCE_PREMIUM: checkEnvVar("HOBH_FORCE_PREMIUM"),
    AXLE_DISABLE_SIMPLE: checkEnvVar("AXLE_DISABLE_SIMPLE"),
    AXLE_DISABLE_MOCK: checkEnvVar("AXLE_DISABLE_MOCK"),
    HOBH_PREMIUM_NOTES_MODE: checkEnvVar("HOBH_PREMIUM_NOTES_MODE"),
    HOBH_PREMIUM_STRICT: checkEnvVar("HOBH_PREMIUM_STRICT")
  };
  const missingCritical2 = Object.entries(criticalVars).filter(([_, status2]) => status2 === "missing").map(([name]) => name);
  const missingRequired = Object.entries(requiredVars).filter(([_, status2]) => status2 === "missing").map(([name]) => name);
  const missingImportant2 = Object.entries(importantVars).filter(([_, status2]) => status2 === "missing").map(([name]) => name);
  const warnings = [];
  let dbStatus = "unconfigured";
  let dbMessage = "";
  let dbError = null;
  if (process.env.DATABASE_URL) {
    try {
      const dbTest = await pool2.query("SELECT NOW() as current_time");
      dbStatus = "healthy";
      dbMessage = `Connected - server time: ${dbTest.rows[0]?.current_time}`;
    } catch (error) {
      dbStatus = "unhealthy";
      dbMessage = "Connection failed";
      dbError = error instanceof Error ? error.message : String(error);
      warnings.push(`\u274C Database connection failed: ${dbError}`);
    }
  } else {
    dbStatus = "unconfigured";
    dbMessage = "DATABASE_URL not configured";
  }
  let status;
  if (missingCritical2.length > 0 || dbStatus === "unhealthy") {
    status = "critical";
    if (missingCritical2.length > 0) {
      warnings.push(`\u274C CRITICAL: ${missingCritical2.length} critical variable(s) missing - app may crash: ${missingCritical2.join(", ")}`);
    }
  } else if (missingRequired.length > 0 || dbStatus === "unconfigured") {
    status = "degraded";
    if (missingRequired.length > 0) {
      warnings.push(`\u26A0\uFE0F ${missingRequired.length} required variable(s) missing - core features unavailable: ${missingRequired.join(", ")}`);
    }
  } else if (missingImportant2.length > 0) {
    status = "degraded";
    warnings.push(`\u26A0\uFE0F ${missingImportant2.length} important variable(s) missing - some features limited: ${missingImportant2.join(", ")}`);
  } else {
    status = "healthy";
  }
  res.type("application/json").status(200).send({
    ok: status !== "critical",
    service: "axle-api",
    node: process.version,
    uptime: process.uptime(),
    host: os.hostname(),
    env: process.env.NODE_ENV || "dev",
    timestamp: (/* @__PURE__ */ new Date()).toISOString(),
    environment: {
      status,
      variables: {
        critical: criticalVars,
        required: requiredVars,
        important: importantVars,
        optional: optionalVars,
        featureFlags: featureFlags2
      },
      missing: {
        critical: missingCritical2,
        required: missingRequired,
        important: missingImportant2
      },
      warnings
    },
    database: {
      status: dbStatus,
      message: dbMessage,
      ...dbError && { error: dbError }
    }
  });
});

// server/routes/suggest.ts
import { Router as Router13 } from "express";
var suggest = Router13();
suggest.post("/start", requireAuth, async (req, res) => {
  const authReq = req;
  const userId = authReq.user.id;
  try {
    const result = await startSuggestion(userId);
    return res.json({ ok: true, workoutId: result.workoutId });
  } catch (error) {
    console.error("Error starting suggestion:", error);
    return res.status(500).json({
      ok: false,
      error: "Failed to start workout from suggestion"
    });
  }
});

// server/routes/_debug-style.ts
init_style();
import { Router as Router14 } from "express";
var router9 = Router14();
router9.post("/api/_debug/resolve-style", (req, res) => {
  const raw = req.body?.goal || req.body?.style || req.body?.focus || "none";
  const resolved = normalizeStyle(raw) || raw.toLowerCase();
  return res.json({
    ok: true,
    raw,
    resolved,
    supported: SUPPORTED_STYLES
  });
});
var debug_style_default = router9;

// server/routes/_debug-trace.ts
init_style();
import { Router as Router15 } from "express";
var router10 = Router15();
router10.post("/api/_debug/trace", (req, res) => {
  const resolved = normalizeStyle(req.body?.style ?? req.body?.goal ?? req.body?.focus);
  res.setHeader("X-AXLE-Trace", "trace@routes.ts");
  return res.json({
    ok: true,
    raw: { style: req.body?.style, goal: req.body?.goal, focus: req.body?.focus },
    resolved,
    env: {
      HAS_OPENAI_KEY: !!process.env.OPENAI_API_KEY,
      AXLE_DISABLE_SIMPLE: !!process.env.AXLE_DISABLE_SIMPLE,
      AXLE_DISABLE_MOCK: !!process.env.AXLE_DISABLE_MOCK,
      HOBH_FORCE_PREMIUM: !!process.env.HOBH_FORCE_PREMIUM
    }
  });
});
var debug_trace_default = router10;

// server/routes/_debug-parse.ts
import { Router as Router16 } from "express";
var router11 = Router16();
router11.post("/api/_debug/parse", (req, res) => {
  try {
    const parsed = generatePayloadSchema.parse(req.body || {});
    return res.json({ ok: true, parsed });
  } catch (e2) {
    return res.status(400).json({ ok: false, error: e2?.message || String(e2) });
  }
});
var debug_parse_default = router11;

// server/routes/_debug-ai.ts
import { Router as Router17 } from "express";
var router12 = Router17();
router12.get("/api/_debug/ai", (req, res) => {
  const apiKey2 = process.env.OPENAI_API_KEY || "";
  const sample = apiKey2 ? apiKey2.slice(0, 3) + "\u2026" + apiKey2.slice(-4) : null;
  res.json({
    ok: true,
    NODE_ENV: process.env.NODE_ENV,
    HAS_OPENAI_KEY: !!process.env.OPENAI_API_KEY,
    OPENAI_KEY_SAMPLE: sample,
    AXLE_DISABLE_SIMPLE: !!process.env.AXLE_DISABLE_SIMPLE,
    AXLE_DISABLE_MOCK: !!process.env.AXLE_DISABLE_MOCK,
    HOBH_FORCE_PREMIUM: !!process.env.HOBH_FORCE_PREMIUM
  });
});
var debug_ai_default = router12;

// server/app.ts
initSentry();
var criticalEnvVars = [
  "SUPABASE_URL",
  "SUPABASE_SERVICE_ROLE_KEY",
  "DATABASE_URL"
];
var importantEnvVars = [
  "OPENAI_API_KEY"
  // Required for workout generation
];
var missingCritical = criticalEnvVars.filter((k) => !process.env[k]);
var missingImportant = importantEnvVars.filter((k) => !process.env[k]);
if (missingCritical.length > 0) {
  const errorMsg = `
\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557
\u2551 FATAL: Missing Critical Environment Variables                 \u2551
\u2560\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563
\u2551 The following CRITICAL environment variables are missing:     \u2551
\u2551 ${missingCritical.map((v) => `\u2022 ${v}`).join("\n\u2551 ")}                                \u2551
\u2551                                                                \u2551
\u2551 For Vercel deployment:                                        \u2551
\u2551 1. Go to your Vercel project settings                         \u2551
\u2551 2. Navigate to: Settings \u2192 Environment Variables              \u2551
\u2551 3. Add the missing variables for Production environment       \u2551
\u2551 4. Redeploy your application                                  \u2551
\u2551                                                                \u2551
\u2551 Get these values from your Supabase project settings          \u2551
\u255A\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255D
  `.trim();
  console.error(errorMsg);
  throw new Error(`Missing critical environment variables: ${missingCritical.join(", ")}`);
}
if (missingImportant.length > 0) {
  const warnMsg = `
\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557
\u2551 WARNING: Missing Important Environment Variables              \u2551
\u2560\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563
\u2551 The following IMPORTANT environment variables are missing:    \u2551
\u2551 ${missingImportant.map((v) => `\u2022 ${v}`).join("\n\u2551 ")}                                \u2551
\u2551                                                                \u2551
\u2551 Some features may be limited:                                 \u2551
\u2551 \u2022 Groups functionality requires DATABASE_URL                  \u2551
\u2551 \u2022 Advanced analytics require DATABASE_URL                     \u2551
\u2551                                                                \u2551
\u2551 See PRODUCTION_DEPLOYMENT.md for setup instructions           \u2551
\u255A\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255D
  `.trim();
  console.warn(warnMsg);
}
var app = express();
var allowed = [
  /^https?:\/\/.*\.replit\.dev$/,
  // Replit preview tabs
  /^https?:\/\/.*\.vercel\.app$/,
  // Vercel deployments
  "http://localhost:5173",
  // local Vite
  "https://axle-ebon.vercel.app"
  // production web
];
app.use(cors({
  origin: (origin, cb) => {
    if (!origin) return cb(null, true);
    if (allowed.some((a2) => a2 instanceof RegExp ? a2.test(origin) : a2 === origin)) {
      return cb(null, true);
    }
    cb(new Error("Not allowed by CORS"));
  },
  credentials: true
}));
app.use(logging);
app.use((req, _res, next) => {
  req.headers["x-request-id"] ||= req.id;
  next();
});
app.use(express.json({ limit: "50mb" }));
app.use(express.urlencoded({ extended: false, limit: "50mb" }));
app.use((req, res, next) => {
  const start = Date.now();
  const path = req.path;
  let capturedJsonResponse = void 0;
  res.setHeader("x-request-id", req.id);
  const originalResJson = res.json;
  res.json = function(bodyJson, ...args) {
    capturedJsonResponse = bodyJson;
    return originalResJson.apply(res, [bodyJson, ...args]);
  };
  res.on("finish", () => {
    const duration = Date.now() - start;
    if (path.startsWith("/api")) {
      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms [${req.id}]`;
      if (capturedJsonResponse) {
        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;
      }
      if (logLine.length > 80) logLine = logLine.slice(0, 79) + "\u2026";
      console.log(logLine);
    }
  });
  next();
});
initializeBlockLibrary();
app.use(debug_style_default);
app.use(debug_trace_default);
app.use(debug_parse_default);
app.use(debug_ai_default);
app.use("/api/workouts", workouts2);
registerSuggestionRoutes(app);
app.use(workout_freeform_default);
app.use(whisper_transcription_default);
registerGroupRoutes(app);
registerWorkoutGenerationRoutes(app);
registerSeedRoutes(app);
registerSimulateRoutes(app);
registerGenerateRoutes(app);
registerWorkoutSuggestionRoutes(app);
app.use(health_default);
app.use(health_metrics_default);
app.use(push_native_default);
app.use(push_default);
app.use(notification_prefs_default);
app.use(notifications_topics_default);
app.use(cron_weekly_default);
app.use(storage_default);
app.use(router8);
app.use(suggest);
app.use("/api/*", (req, res) => {
  res.type("application/json");
  res.status(404).json({
    ok: false,
    error: { code: "NOT_FOUND", message: `API endpoint ${req.path} not found` }
  });
});
app.use(jsonError);
var app_default = app;
export {
  app_default as default
};
//# sourceMappingURL=app.js.map
